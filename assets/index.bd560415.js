import{_,d as ee,u as ne,r as v,G as S,x as te,y as oe,H as ie,o as s,h as l,e as u,C as h,L as T,g as m,t as y,N as I,O as ae,f,b as B,P as K,F as O,j as D,D as L,A as se,Q as le,R as re,U as ce,V as ue,p as de}from"./index.df1344dc.js";import{g as me}from"./images.3f9c163e.js";const A=ee({name:"Search",props:{componentSetting:{type:Object,required:!0},element:{type:Object,required:!0},isAction:{type:Boolean,default:!1}},setup(e){const o=ne(),d=v(0),k=v(!1),r=v(""),a=v([]),i=v(-1),t=v(!1),p=v(),b=S(()=>e.componentSetting.engineList[d.value]||e.componentSetting.engineList[0]);let w;const U=n=>{d.value=n,k.value=!1},C=()=>{e.componentSetting.rememberHistory&&q(r.value);let n=b.value.link;/\[0\]/.test(n)?n=n.replace(/\[0\]/,encodeURIComponent(r.value)):n=n+encodeURIComponent(r.value),e.componentSetting.jumpType===2?window.location.href=n:window.open(n),r.value="",a.value=[],p.value.blur()},R=n=>{[9,13,38,40].includes(n.keyCode)?(n.keyCode===9&&(n.shiftKey?(d.value=d.value<=0?e.componentSetting.engineList.length-1:--d.value,n.preventDefault()):(d.value=d.value>=e.componentSetting.engineList.length-1?0:++d.value,n.preventDefault())),n.keyCode===13&&C(),n.keyCode===38&&(i.value=i.value<=0&&a.value.length>0?a.value.length-1:i.value-1,r.value=a.value[i.value]),n.keyCode===40&&(i.value=i.value<a.value.length-1&&a.value.length>0?i.value+1:0,r.value=a.value[i.value])):(w&&window.clearTimeout(w),w=window.setTimeout(()=>{E()},400))},H=S(()=>e.componentSetting.focusBgAnimation&&o.global.background.includes("url")),j=()=>{E(),e.componentSetting.showTabTips&&(!e.componentSetting.rememberHistory||e.componentSetting.rememberHistoryList.length===0)&&(t.value=!0),H.value&&o.updateState({key:"showBackgroundEffect",value:!0})},M=()=>{setTimeout(()=>{t.value=!1},200),a.value=[],H.value&&o.updateState({key:"showBackgroundEffect",value:!1})},P=()=>{t.value=!1;const n=JSON.parse(JSON.stringify(e.element));e.isAction?(n.actionSetting.actionClickValue.componentSetting.showTabTips=!1,o.updateActionElement(n)):n.componentSetting.showTabTips=!1,o.editComponent(n)},z=()=>{r.value=""},W=n=>{a.value=[],i.value=-1,r.value=n,setTimeout(()=>{C()},200)};async function E(){if(!r.value){e.componentSetting.rememberHistory?a.value=e.componentSetting.rememberHistoryList||[]:a.value=[],i.value=-1;return}if(!!e.componentSetting.keywordLink)try{const n=await fetch(`${re}/getAutomatedKeywords?s=${r.value}`),{errCode:c,data:g}=await n.json();if(c===200)t.value=!1,r.value&&(a.value=g);else throw new Error("403")}catch{a.value=[],i.value=-1}}function q(n){const c=JSON.parse(JSON.stringify(e.element)),g=c.componentSetting.rememberHistoryList||[];~g.indexOf(n)||(g.unshift(n),g.length>10&&(g.length=10),e.isAction?(c.actionSetting.actionClickValue.componentSetting.rememberHistoryList=g,o.updateActionElement(c)):c.componentSetting.rememberHistoryList=g,o.editComponent(c))}function G(){const n=JSON.parse(JSON.stringify(e.element));e.isAction?(n.actionSetting.actionClickValue.componentSetting.rememberHistoryList=[],o.updateActionElement(n)):n.componentSetting.rememberHistoryList=[],o.editComponent(n)}async function Q(n){const c=JSON.parse(JSON.stringify(e.element));e.isAction?(c.actionSetting.actionClickValue.componentSetting.rememberHistoryList.splice(n,1),o.updateActionElement(c)):c.componentSetting.rememberHistoryList.splice(n,1),o.editComponent(c),await ce(),p.value.focus(),E()}const N=v();function $(n){k.value&&!N.value.contains(n.target)&&(k.value=!1)}te(()=>{t.value=e.element.showTabTips,document.addEventListener("click",$)}),oe(()=>{document.removeEventListener("click",$)});const X=S(()=>ie(e.componentSetting.position)),F=S(()=>o.isLock),Y=n=>{F.value&&n.stopPropagation()},Z=S(()=>e.componentSetting.boxBackground||"rgba(255,255,255,0.9)"),x=S(()=>e.componentSetting.textColor||"#464650");return{activeEngine:d,showEngine:k,searchKey:r,linkSearchArr:a,linkSearchArrActive:i,showTabTips:t,activeEngineItem:b,handleChangeEngine:U,handleInputKeyDown:R,handleInputFocus:j,handleInputBlur:M,hanldeNoShowMore:P,handleClear:z,handleLinkSearchJump:W,handleSearchBtnClick:C,searchInput:p,engineSelector:N,positionCSS:X,getTargetIcon:me,clearHistory:G,removeHistory:Q,contextmenu:Y,isLock:F,boxBackground:Z,textColor:x}}}),V=()=>{ue(e=>({"6a770a62":e.boxBackground,a5e0b2a8:e.textColor}))},J=A.setup;A.setup=J?(e,o)=>(V(),J(e,o)):V;const pe=A,ge=["src"],ve=["src"],he={key:2,class:"no-icon"},ye={class:"search-input-box-wrapper"},fe=["onClick"],Se=["src"],ke=["src"],be={key:2,class:"no-icon"},we={class:"text"},Ce=["onClick"],Ee=["onClick"],Te={key:0,class:"clear-history"},Ie={class:"tab-tooltips"},Be={class:"main"};function Le(e,o,d,k,r,a){const i=de("Icon");return s(),l("div",{class:"wrapper material-search",style:h({padding:e.componentSetting.padding+"px",...e.positionCSS})},[u("div",{class:"search-wrapper-box",style:h({maxWidth:`${e.componentSetting.maxWidth||600}px`,pointerEvents:e.isLock?"all":"none"}),onContextmenu:o[9]||(o[9]=(...t)=>e.contextmenu&&e.contextmenu(...t))},[u("div",{class:"search-main-box",style:h({boxShadow:e.componentSetting.boxShadow,borderRadius:`${e.componentSetting.boxRadius||4}px`,padding:`0 ${(e.componentSetting.boxRadius||4)/4}px`,backdropFilter:e.componentSetting.backdropBlur?"blur(5px)":"none"})},[u("div",{class:"search-engine-box",style:h({filter:e.componentSetting.backdropBlur?"drop-shadow(1px 2px 4px #262626)":"none"}),onClick:o[0]||(o[0]=T(t=>e.showEngine=!e.showEngine,["stop"]))},[e.activeEngineItem.iconType==="local"||e.activeEngineItem.iconType==="network"?(s(),l("img",{key:0,src:e.activeEngineItem.iconPath,alt:"icon",width:"24",height:"24"},null,8,ge)):m("",!0),e.activeEngineItem.iconType==="api"?(s(),l("img",{key:1,src:e.getTargetIcon(e.activeEngineItem.link),alt:"icon",width:"24",height:"24"},null,8,ve)):m("",!0),e.activeEngineItem.iconType==="text"?(s(),l("div",he,y(e.activeEngineItem.name.slice(0,1)),1)):m("",!0)],4),u("div",ye,[I(u("input",{class:"search-input-box",style:h({color:e.componentSetting.textColor}),ref:"searchInput","onUpdate:modelValue":o[1]||(o[1]=t=>e.searchKey=t),onKeydown:o[2]||(o[2]=T((...t)=>e.handleInputKeyDown&&e.handleInputKeyDown(...t),["stop"])),onFocus:o[3]||(o[3]=(...t)=>e.handleInputFocus&&e.handleInputFocus(...t)),onBlur:o[4]||(o[4]=(...t)=>e.handleInputBlur&&e.handleInputBlur(...t)),tabindex:"1"},null,36),[[ae,e.searchKey]]),e.searchKey?(s(),l("div",{key:0,class:"clear-btn",onClick:o[5]||(o[5]=(...t)=>e.handleClear&&e.handleClear(...t))},[f(i,{name:"close"})])):m("",!0)]),u("div",{class:"search-btn",style:h({color:e.componentSetting.textColor,filter:e.componentSetting.backdropBlur?"drop-shadow(1px 2px 4px #262626)":"none"}),onClick:o[6]||(o[6]=(...t)=>e.handleSearchBtnClick&&e.handleSearchBtnClick(...t))},[f(i,{name:"search"})],4)],4),f(L,{name:"fadeInUp"},{default:B(()=>[I(u("div",{ref:"engineSelector",class:"engine-selector",style:h({backdropFilter:e.componentSetting.backdropBlur?"blur(5px)":"none",filter:e.componentSetting.backdropBlur?"drop-shadow(1px 2px 4px #262626)":"none"})},[(s(!0),l(O,null,D(e.componentSetting.engineList,(t,p)=>(s(),l("div",{key:p,class:"engine-list-item",onClick:b=>e.handleChangeEngine(p)},[t.iconType==="local"||t.iconType==="network"?(s(),l("img",{key:0,src:t.iconPath,alt:"icon",width:"24",height:"24"},null,8,Se)):m("",!0),t.iconType==="api"?(s(),l("img",{key:1,src:e.getTargetIcon(t.link),alt:"icon",width:"24",height:"24"},null,8,ke)):m("",!0),t.iconType==="text"?(s(),l("div",be,y(t.name.slice(0,1)),1)):m("",!0),u("div",we,y(t.name),1)],8,fe))),128))],4),[[K,e.showEngine]])]),_:1}),f(L,{name:"fadeInUp"},{default:B(()=>[e.linkSearchArr.length>0?(s(),l("div",{key:0,class:"link-search-wrapper",style:h({backdropFilter:e.componentSetting.backdropBlur?"blur(5px)":"none"})},[(s(!0),l(O,null,D(e.linkSearchArr,(t,p)=>(s(),l("div",{class:se(["link-search-item",{active:e.linkSearchArrActive===p}]),key:t},[u("div",{class:"text",onClick:b=>e.handleLinkSearchJump(t)},y(t),9,Ce),e.searchKey?m("",!0):(s(),l("div",{key:0,class:"remove-btn",onClick:b=>e.removeHistory(p)},[f(i,{name:"close",size:"1em"})],8,Ee))],2))),128)),!e.searchKey&&e.componentSetting.rememberHistory?(s(),l("div",Te,[u("div",{class:"clear-history-btn",onClick:o[7]||(o[7]=(...t)=>e.clearHistory&&e.clearHistory(...t))},[f(i,{name:"delete",size:"1em",style:{"margin-right":"2px"}}),le(" "+y(e.$t("\u6E05\u7A7A\u5386\u53F2\u8BB0\u5F55")),1)])])):m("",!0)],4)):m("",!0)]),_:1}),f(L,{name:"fadeInUp"},{default:B(()=>[I(u("div",Ie,[u("div",Be,y(e.$t("\u6309Tab\u952E\u53EF\u5FEB\u901F\u5207\u6362\u641C\u7D22\u5F15\u64CE")),1),u("div",{class:"no-more",onClick:o[8]||(o[8]=T((...t)=>e.hanldeNoShowMore&&e.hanldeNoShowMore(...t),["stop"]))},y(e.$t("\u4E0D\u518D\u63D0\u793A")),1)],512),[[K,e.showTabTips]])]),_:1})],36)],4)}var $e=_(pe,[["render",Le],["__scopeId","data-v-2d0e6bbc"]]);export{$e as default};
