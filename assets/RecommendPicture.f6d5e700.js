import{_ as U,d as H,r as u,w as O,o as t,h as a,e as s,t as h,f as q,b as M,A as k,N as C,P as w,F as v,j as p,g as $,R as E,p as T}from"./index.a48488ff.js";const G={key:0,class:"wrapper"},K={class:"tab-title-wrapper"},J={class:"tab-container"},Q={key:0,class:"text"},W={key:1,class:"text"},X={key:2,class:"item-wrapper"},Y=["onClick"],Z={class:"img-wrapper"},ee=["src"],te={class:"tab-container"},ae={key:0,class:"text"},se={key:1,class:"text"},le={key:2,class:"item-wrapper"},ne=["onClick"],oe={class:"img-wrapper"},ie=["src"],ue={class:"sub-tab-container"},re=["onClick"],ce={class:"tab-container"},ve={class:"item-wrapper"},de=["onClick"],pe={class:"img-wrapper"},he=["src"],_e={class:"load-more"},ge=["loading"],me=H({__name:"RecommendPicture",emits:["submit"],setup(fe,{emit:B}){const _=u(!1),g=u(!1),o=u(1),i=u(!1),r=u(!1),m=u([]),f=u([]),b=u([]),L=u(1),z=[{label:"\u98CE\u666F",value:9},{label:"4K",value:36},{label:"\u6E05\u65B0",value:15},{label:"\u840C\u5BA0",value:14},{label:"\u6E38\u620F",value:5},{label:"\u6C7D\u8F66",value:12},{label:"\u65F6\u5C1A",value:10},{label:"\u4F53\u80B2",value:16}],y=u(9),N=async()=>{try{i.value=!0,r.value=!1;const l=encodeURIComponent("https://cn.bing.com/HPImageArchive.aspx?format=js&idx=0&n=8&mkt=zh-CN"),n=await fetch(`${E}/api/transfer?target=${l}&noHeaders=1`,{headers:{"content-type":"application/json; charset=utf-8"}}),{images:d}=await n.json(),e=encodeURIComponent("https://cn.bing.com/HPImageArchive.aspx?format=js&idx=8&n=8&mkt=zh-CN"),c=await fetch(`${E}/api/transfer?target=${e}&noHeaders=1`,{headers:{"content-type":"application/json; charset=utf-8"}}),{images:P}=await c.json();P.shift();const I=[...d,...P];m.value=I.map(j=>{const V=`https://cn.bing.com/${j.url}`,D=`https://cn.bing.com/${j.urlbase}_320x240.jpg&rf=LaDigue_1920x1080.jpg&pid=hp`;return{url:V,thumb:D}})}catch(l){r.value=!0,console.error(l)}finally{i.value=!1}},S=async()=>{try{i.value=!0,r.value=!1;const l=await fetch(`${E}/photos?pageSize=18`),{errCode:n,data:d}=await l.json();if(n===200)f.value=d.list.map(e=>({url:e.urls.raw,thumb:e.urls.thumb}));else throw new Error("Api server error")}catch(l){r.value=!0,console.error(l)}finally{i.value=!1}},A=async(l=!1)=>{l&&(b.value=[],L.value=1);try{i.value=!0,r.value=!1;const n=await fetch(`${E}/api/360img?cid=${y.value}&page=${L.value}&pageSize=18`),{errno:d,data:e}=await n.json();if(d===0)b.value=[...b.value,...e.list.map(c=>({url:c.url.replace("http","https"),thumb:`${c.url.replace("http","https")}?x-oss-process=image/resize,w_300/quality,q_90`}))];else throw new Error("Api server error")}catch(n){r.value=!0,console.error(n)}finally{i.value=!1}},F=()=>{g.value=!0,_.value||(_.value=!0)};O(()=>[_.value,o.value,y.value],()=>{o.value===1?(!m.value||m.value.length===0)&&N():o.value===2?(!f.value||f.value.length===0)&&S():o.value===3&&A(!0)});const R=()=>{L.value++,A()},x=l=>{B("submit",l),g.value=!1};return(l,n)=>{const d=T("easy-dialog");return t(),a(v,null,[s("button",{type:"button",class:"btn btn-small btn-primary",style:{margin:"0","margin-right":"5px"},onClick:F},h(l.$t("\u4ECA\u65E5\u58C1\u7EB8\u63A8\u8350")),1),q(d,{modelValue:g.value,"onUpdate:modelValue":n[3]||(n[3]=e=>g.value=e),title:l.$t("\u4ECA\u65E5\u58C1\u7EB8\u63A8\u8350"),width:"min(760px, 94vw)",height:"min(560px, 80vh)"},{default:M(()=>[_.value?(t(),a("div",G,[s("div",K,[s("div",{class:k(["title",o.value===1&&"active"]),onClick:n[0]||(n[0]=e=>o.value=1)},h(l.$t("\u5FC5\u5E94\u58C1\u7EB8")),3),s("div",{class:k(["title",o.value===3&&"active"]),onClick:n[1]||(n[1]=e=>o.value=3)},h(l.$t("360\u58C1\u7EB8")),3),s("div",{class:k(["title",o.value===2&&"active"]),onClick:n[2]||(n[2]=e=>o.value=2)},"UNSPLAH",2)]),C(s("div",J,[i.value?(t(),a("div",Q,"Loading...")):r.value?(t(),a("div",W,"Something Error...")):(t(),a("div",X,[(t(!0),a(v,null,p(m.value,e=>(t(),a("div",{class:"item",key:e.url,onClick:c=>x(e.url)},[s("div",Z,[e.url?(t(),a("img",{key:0,src:e.thumb,loading:"lazy"},null,8,ee)):$("",!0)])],8,Y))),128)),(t(),a(v,null,p(4,e=>s("div",{class:"item-fake",key:e})),64))]))],512),[[w,o.value===1]]),C(s("div",te,[i.value?(t(),a("div",ae,"Loading...")):r.value?(t(),a("div",se,"Something Error...")):(t(),a("div",le,[(t(!0),a(v,null,p(f.value,e=>(t(),a("div",{class:"item",key:e.url,onClick:c=>x(e.url)},[s("div",oe,[e.url?(t(),a("img",{key:0,src:e.thumb,loading:"lazy"},null,8,ie)):$("",!0)])],8,ne))),128)),(t(),a(v,null,p(4,e=>s("div",{class:"item-fake",key:e})),64))]))],512),[[w,o.value===2]]),C(s("div",ue,[(t(),a(v,null,p(z,e=>s("div",{class:k(["sub-tab-title",y.value===e.value&&"active"]),key:e.value,onClick:c=>y.value=e.value},h(l.$t(e.label)),11,re)),64))],512),[[w,o.value===3]]),C(s("div",ce,[s("div",ve,[(t(!0),a(v,null,p(b.value,e=>(t(),a("div",{class:"item",key:e.url,onClick:c=>x(e.url)},[s("div",pe,[e.url?(t(),a("img",{key:0,src:e.thumb,loading:"lazy"},null,8,he)):$("",!0)])],8,de))),128)),(t(),a(v,null,p(4,e=>s("div",{class:"item-fake",key:e})),64))]),s("div",_e,[s("button",{class:"btn btn-warning",loading:i.value,onClick:R},h(i.value?"LOADING...":"LOAD MORE"),9,ge)])],512),[[w,o.value===3]])])):$("",!0)]),_:1},8,["modelValue","title"])],64)}}});var ye=U(me,[["__scopeId","data-v-d40f18e2"]]);export{ye as default};
