import{_ as os,d as hs,r as us,u as ls,J as cs,A as fs,w as ds,V as ps,N as ms,o as vs,k as bs}from"./index.20b17648.js";var xs=(()=>{var me=Object.defineProperty,zt=Object.getOwnPropertyDescriptor,yt=(t,e)=>()=>(e||(e={exports:{}},t(e.exports,e)),e.exports),wt=(t,e)=>{for(var r in e)me(t,r,{get:e[r],enumerable:!0})},k=(t,e,r,g)=>{for(var i=g>1?void 0:g?zt(e,r):e,A=t.length-1,C;A>=0;A--)(C=t[A])&&(i=(g?C(e,r,i):C(i))||i);return g&&i&&me(e,r,i),i},ve=(()=>{for(var t=new Uint8Array(128),e=0;e<64;e++)t[e<26?e+65:e<52?e+71:e<62?e-4:e*4-205]=e;return r=>{for(var g=r.length,i=new Uint8Array((g-(r[g-1]=="=")-(r[g-2]=="="))*3/4|0),A=0,C=0;A<g;){var s=t[r.charCodeAt(A++)],n=t[r.charCodeAt(A++)],I=t[r.charCodeAt(A++)],o=t[r.charCodeAt(A++)];i[C++]=s<<2|n>>4,i[C++]=n<<4|I>>2,i[C++]=I<<6|o}return i}})(),be=yt((t,e)=>{var r=class{constructor(g){this.animHandle=0;let i=g.canvas,A={spawnInterval:[.1,.1],spawnSize:[60,100],spawnLimit:2e3,viewport:new vt(f.zero(),f(i.width,i.height)),canvas:i,width:i.width,height:i.height,background:"",gravity:2400,slipRate:0,motionInterval:[.1,.4],colliderSize:1,trailDropDensity:.2,trailDistance:[20,30],trailDropSize:[.3,.5],trailSpread:.6,initialSpread:.5,shrinkRate:.01,velocitySpread:.3,evaporate:10,xShifting:[0,.1],backgroundBlurSteps:3,backgroundWrapMode:"clamp",mist:!0,mistColor:[.01,.01,.01,1],mistBlurStep:4,mistTime:10,dropletsPerSeconds:500,dropletSize:[10,30],smoothRaindrop:[.96,.99],refractBase:.4,refractScale:.6,raindropCompose:"smoother",raindropLightPos:[-1,1,2,0],raindropDiffuseLight:[.2,.2,.2],raindropShadowOffset:.8,raindropEraserSize:[.93,1],raindropSpecularLight:[0,0,0],raindropSpecularShininess:256,raindropLightBump:1};this.options={...A,...g},this.simulator=new qC(this.options),this.renderer=new HC(this.options)}async start(){await this.renderer.loadAssets();let g=i=>{let A={dt:.03,total:i/1e3};this.update(A),this.animHandle=requestAnimationFrame(g)};this.animHandle=requestAnimationFrame(g)}stop(){cancelAnimationFrame(this.animHandle)}resize(g,i){this.options.width=g,this.options.height=i,this.options.viewport=new vt(f.zero(),f(g,i)),this.renderer.resize()}async setBackground(g){this.renderer.options.background=g,await this.renderer.reloadBackground()}destroy(){this.stop(),this.renderer.renderer.destroy()}update(g){this.simulator.update(g),this.renderer.render(this.simulator.raindrops,g)}};e.exports=r}),N=1e-6,Q=typeof Float32Array!="undefined"?Float32Array:Array,nt=Math.random;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});function xe(){var t=new Q(9);return Q!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}var H={};wt(H,{add:()=>Pg,adjoint:()=>ae,clone:()=>se,copy:()=>Tt,create:()=>Ce,determinant:()=>Vt,equals:()=>Gg,exactEquals:()=>zg,frob:()=>Sg,fromQuat:()=>bg,fromQuat2:()=>fg,fromRotation:()=>hg,fromRotationTranslation:()=>We,fromRotationTranslationScale:()=>mg,fromRotationTranslationScaleOrigin:()=>vg,fromScaling:()=>og,fromTranslation:()=>ag,fromValues:()=>Ht,fromXRotation:()=>ug,fromYRotation:()=>lg,fromZRotation:()=>cg,frustum:()=>xg,getRotation:()=>pg,getScaling:()=>je,getTranslation:()=>dg,identity:()=>ne,invert:()=>Gt,lookAt:()=>Bg,mul:()=>Ng,multiply:()=>Dt,multiplyScalar:()=>Fg,multiplyScalarAndAdd:()=>Ug,ortho:()=>Eg,orthoNO:()=>_e,orthoZO:()=>Rg,perspective:()=>Mg,perspectiveFromFieldOfView:()=>wg,perspectiveNO:()=>Ke,perspectiveZO:()=>yg,rotate:()=>Cg,rotateX:()=>sg,rotateY:()=>ng,rotateZ:()=>Ig,scale:()=>Ag,set:()=>Me,str:()=>Dg,sub:()=>Lg,subtract:()=>He,targetTo:()=>Tg,translate:()=>ig,transpose:()=>Ie});function Ce(){var t=new Q(16);return Q!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function se(t){var e=new Q(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Tt(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Ht(t,e,r,g,i,A,C,s,n,I,o,a,h,u,p,v){var c=new Q(16);return c[0]=t,c[1]=e,c[2]=r,c[3]=g,c[4]=i,c[5]=A,c[6]=C,c[7]=s,c[8]=n,c[9]=I,c[10]=o,c[11]=a,c[12]=h,c[13]=u,c[14]=p,c[15]=v,c}function Me(t,e,r,g,i,A,C,s,n,I,o,a,h,u,p,v,c){return t[0]=e,t[1]=r,t[2]=g,t[3]=i,t[4]=A,t[5]=C,t[6]=s,t[7]=n,t[8]=I,t[9]=o,t[10]=a,t[11]=h,t[12]=u,t[13]=p,t[14]=v,t[15]=c,t}function ne(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Ie(t,e){if(t===e){var r=e[1],g=e[2],i=e[3],A=e[6],C=e[7],s=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=r,t[6]=e[9],t[7]=e[13],t[8]=g,t[9]=A,t[11]=e[14],t[12]=i,t[13]=C,t[14]=s}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function Gt(t,e){var r=e[0],g=e[1],i=e[2],A=e[3],C=e[4],s=e[5],n=e[6],I=e[7],o=e[8],a=e[9],h=e[10],u=e[11],p=e[12],v=e[13],c=e[14],M=e[15],z=r*s-g*C,F=r*n-i*C,P=r*I-A*C,D=g*n-i*s,S=g*I-A*s,$=i*I-A*n,Y=o*v-a*p,q=o*c-h*p,Z=o*M-u*p,tt=a*c-h*v,J=a*M-u*v,et=h*M-u*c,V=z*et-F*J+P*tt+D*Z-S*q+$*Y;return V?(V=1/V,t[0]=(s*et-n*J+I*tt)*V,t[1]=(i*J-g*et-A*tt)*V,t[2]=(v*$-c*S+M*D)*V,t[3]=(h*S-a*$-u*D)*V,t[4]=(n*Z-C*et-I*q)*V,t[5]=(r*et-i*Z+A*q)*V,t[6]=(c*P-p*$-M*F)*V,t[7]=(o*$-h*P+u*F)*V,t[8]=(C*J-s*Z+I*Y)*V,t[9]=(g*Z-r*J-A*Y)*V,t[10]=(p*S-v*P+M*z)*V,t[11]=(a*P-o*S-u*z)*V,t[12]=(s*q-C*tt-n*Y)*V,t[13]=(r*tt-g*q+i*Y)*V,t[14]=(v*F-p*D-c*z)*V,t[15]=(o*D-a*F+h*z)*V,t):null}function ae(t,e){var r=e[0],g=e[1],i=e[2],A=e[3],C=e[4],s=e[5],n=e[6],I=e[7],o=e[8],a=e[9],h=e[10],u=e[11],p=e[12],v=e[13],c=e[14],M=e[15];return t[0]=s*(h*M-u*c)-a*(n*M-I*c)+v*(n*u-I*h),t[1]=-(g*(h*M-u*c)-a*(i*M-A*c)+v*(i*u-A*h)),t[2]=g*(n*M-I*c)-s*(i*M-A*c)+v*(i*I-A*n),t[3]=-(g*(n*u-I*h)-s*(i*u-A*h)+a*(i*I-A*n)),t[4]=-(C*(h*M-u*c)-o*(n*M-I*c)+p*(n*u-I*h)),t[5]=r*(h*M-u*c)-o*(i*M-A*c)+p*(i*u-A*h),t[6]=-(r*(n*M-I*c)-C*(i*M-A*c)+p*(i*I-A*n)),t[7]=r*(n*u-I*h)-C*(i*u-A*h)+o*(i*I-A*n),t[8]=C*(a*M-u*v)-o*(s*M-I*v)+p*(s*u-I*a),t[9]=-(r*(a*M-u*v)-o*(g*M-A*v)+p*(g*u-A*a)),t[10]=r*(s*M-I*v)-C*(g*M-A*v)+p*(g*I-A*s),t[11]=-(r*(s*u-I*a)-C*(g*u-A*a)+o*(g*I-A*s)),t[12]=-(C*(a*c-h*v)-o*(s*c-n*v)+p*(s*h-n*a)),t[13]=r*(a*c-h*v)-o*(g*c-i*v)+p*(g*h-i*a),t[14]=-(r*(s*c-n*v)-C*(g*c-i*v)+p*(g*n-i*s)),t[15]=r*(s*h-n*a)-C*(g*h-i*a)+o*(g*n-i*s),t}function Vt(t){var e=t[0],r=t[1],g=t[2],i=t[3],A=t[4],C=t[5],s=t[6],n=t[7],I=t[8],o=t[9],a=t[10],h=t[11],u=t[12],p=t[13],v=t[14],c=t[15],M=e*C-r*A,z=e*s-g*A,F=e*n-i*A,P=r*s-g*C,D=r*n-i*C,S=g*n-i*s,$=I*p-o*u,Y=I*v-a*u,q=I*c-h*u,Z=o*v-a*p,tt=o*c-h*p,J=a*c-h*v;return M*J-z*tt+F*Z+P*q-D*Y+S*$}function Dt(t,e,r){var g=e[0],i=e[1],A=e[2],C=e[3],s=e[4],n=e[5],I=e[6],o=e[7],a=e[8],h=e[9],u=e[10],p=e[11],v=e[12],c=e[13],M=e[14],z=e[15],F=r[0],P=r[1],D=r[2],S=r[3];return t[0]=F*g+P*s+D*a+S*v,t[1]=F*i+P*n+D*h+S*c,t[2]=F*A+P*I+D*u+S*M,t[3]=F*C+P*o+D*p+S*z,F=r[4],P=r[5],D=r[6],S=r[7],t[4]=F*g+P*s+D*a+S*v,t[5]=F*i+P*n+D*h+S*c,t[6]=F*A+P*I+D*u+S*M,t[7]=F*C+P*o+D*p+S*z,F=r[8],P=r[9],D=r[10],S=r[11],t[8]=F*g+P*s+D*a+S*v,t[9]=F*i+P*n+D*h+S*c,t[10]=F*A+P*I+D*u+S*M,t[11]=F*C+P*o+D*p+S*z,F=r[12],P=r[13],D=r[14],S=r[15],t[12]=F*g+P*s+D*a+S*v,t[13]=F*i+P*n+D*h+S*c,t[14]=F*A+P*I+D*u+S*M,t[15]=F*C+P*o+D*p+S*z,t}function ig(t,e,r){var g=r[0],i=r[1],A=r[2],C,s,n,I,o,a,h,u,p,v,c,M;return e===t?(t[12]=e[0]*g+e[4]*i+e[8]*A+e[12],t[13]=e[1]*g+e[5]*i+e[9]*A+e[13],t[14]=e[2]*g+e[6]*i+e[10]*A+e[14],t[15]=e[3]*g+e[7]*i+e[11]*A+e[15]):(C=e[0],s=e[1],n=e[2],I=e[3],o=e[4],a=e[5],h=e[6],u=e[7],p=e[8],v=e[9],c=e[10],M=e[11],t[0]=C,t[1]=s,t[2]=n,t[3]=I,t[4]=o,t[5]=a,t[6]=h,t[7]=u,t[8]=p,t[9]=v,t[10]=c,t[11]=M,t[12]=C*g+o*i+p*A+e[12],t[13]=s*g+a*i+v*A+e[13],t[14]=n*g+h*i+c*A+e[14],t[15]=I*g+u*i+M*A+e[15]),t}function Ag(t,e,r){var g=r[0],i=r[1],A=r[2];return t[0]=e[0]*g,t[1]=e[1]*g,t[2]=e[2]*g,t[3]=e[3]*g,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*A,t[9]=e[9]*A,t[10]=e[10]*A,t[11]=e[11]*A,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Cg(t,e,r,g){var i=g[0],A=g[1],C=g[2],s=Math.hypot(i,A,C),n,I,o,a,h,u,p,v,c,M,z,F,P,D,S,$,Y,q,Z,tt,J,et,V,ht;return s<N?null:(s=1/s,i*=s,A*=s,C*=s,n=Math.sin(r),I=Math.cos(r),o=1-I,a=e[0],h=e[1],u=e[2],p=e[3],v=e[4],c=e[5],M=e[6],z=e[7],F=e[8],P=e[9],D=e[10],S=e[11],$=i*i*o+I,Y=A*i*o+C*n,q=C*i*o-A*n,Z=i*A*o-C*n,tt=A*A*o+I,J=C*A*o+i*n,et=i*C*o+A*n,V=A*C*o-i*n,ht=C*C*o+I,t[0]=a*$+v*Y+F*q,t[1]=h*$+c*Y+P*q,t[2]=u*$+M*Y+D*q,t[3]=p*$+z*Y+S*q,t[4]=a*Z+v*tt+F*J,t[5]=h*Z+c*tt+P*J,t[6]=u*Z+M*tt+D*J,t[7]=p*Z+z*tt+S*J,t[8]=a*et+v*V+F*ht,t[9]=h*et+c*V+P*ht,t[10]=u*et+M*V+D*ht,t[11]=p*et+z*V+S*ht,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function sg(t,e,r){var g=Math.sin(r),i=Math.cos(r),A=e[4],C=e[5],s=e[6],n=e[7],I=e[8],o=e[9],a=e[10],h=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=A*i+I*g,t[5]=C*i+o*g,t[6]=s*i+a*g,t[7]=n*i+h*g,t[8]=I*i-A*g,t[9]=o*i-C*g,t[10]=a*i-s*g,t[11]=h*i-n*g,t}function ng(t,e,r){var g=Math.sin(r),i=Math.cos(r),A=e[0],C=e[1],s=e[2],n=e[3],I=e[8],o=e[9],a=e[10],h=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=A*i-I*g,t[1]=C*i-o*g,t[2]=s*i-a*g,t[3]=n*i-h*g,t[8]=A*g+I*i,t[9]=C*g+o*i,t[10]=s*g+a*i,t[11]=n*g+h*i,t}function Ig(t,e,r){var g=Math.sin(r),i=Math.cos(r),A=e[0],C=e[1],s=e[2],n=e[3],I=e[4],o=e[5],a=e[6],h=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=A*i+I*g,t[1]=C*i+o*g,t[2]=s*i+a*g,t[3]=n*i+h*g,t[4]=I*i-A*g,t[5]=o*i-C*g,t[6]=a*i-s*g,t[7]=h*i-n*g,t}function ag(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function og(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function hg(t,e,r){var g=r[0],i=r[1],A=r[2],C=Math.hypot(g,i,A),s,n,I;return C<N?null:(C=1/C,g*=C,i*=C,A*=C,s=Math.sin(e),n=Math.cos(e),I=1-n,t[0]=g*g*I+n,t[1]=i*g*I+A*s,t[2]=A*g*I-i*s,t[3]=0,t[4]=g*i*I-A*s,t[5]=i*i*I+n,t[6]=A*i*I+g*s,t[7]=0,t[8]=g*A*I+i*s,t[9]=i*A*I-g*s,t[10]=A*A*I+n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function ug(t,e){var r=Math.sin(e),g=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=g,t[6]=r,t[7]=0,t[8]=0,t[9]=-r,t[10]=g,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function lg(t,e){var r=Math.sin(e),g=Math.cos(e);return t[0]=g,t[1]=0,t[2]=-r,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=r,t[9]=0,t[10]=g,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function cg(t,e){var r=Math.sin(e),g=Math.cos(e);return t[0]=g,t[1]=r,t[2]=0,t[3]=0,t[4]=-r,t[5]=g,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function We(t,e,r){var g=e[0],i=e[1],A=e[2],C=e[3],s=g+g,n=i+i,I=A+A,o=g*s,a=g*n,h=g*I,u=i*n,p=i*I,v=A*I,c=C*s,M=C*n,z=C*I;return t[0]=1-(u+v),t[1]=a+z,t[2]=h-M,t[3]=0,t[4]=a-z,t[5]=1-(o+v),t[6]=p+c,t[7]=0,t[8]=h+M,t[9]=p-c,t[10]=1-(o+u),t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}function fg(t,e){var r=new Q(3),g=-e[0],i=-e[1],A=-e[2],C=e[3],s=e[4],n=e[5],I=e[6],o=e[7],a=g*g+i*i+A*A+C*C;return a>0?(r[0]=(s*C+o*g+n*A-I*i)*2/a,r[1]=(n*C+o*i+I*g-s*A)*2/a,r[2]=(I*C+o*A+s*i-n*g)*2/a):(r[0]=(s*C+o*g+n*A-I*i)*2,r[1]=(n*C+o*i+I*g-s*A)*2,r[2]=(I*C+o*A+s*i-n*g)*2),We(t,e,r),t}function dg(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function je(t,e){var r=e[0],g=e[1],i=e[2],A=e[4],C=e[5],s=e[6],n=e[8],I=e[9],o=e[10];return t[0]=Math.hypot(r,g,i),t[1]=Math.hypot(A,C,s),t[2]=Math.hypot(n,I,o),t}function pg(t,e){var r=new Q(3);je(r,e);var g=1/r[0],i=1/r[1],A=1/r[2],C=e[0]*g,s=e[1]*i,n=e[2]*A,I=e[4]*g,o=e[5]*i,a=e[6]*A,h=e[8]*g,u=e[9]*i,p=e[10]*A,v=C+o+p,c=0;return v>0?(c=Math.sqrt(v+1)*2,t[3]=.25*c,t[0]=(a-u)/c,t[1]=(h-n)/c,t[2]=(s-I)/c):C>o&&C>p?(c=Math.sqrt(1+C-o-p)*2,t[3]=(a-u)/c,t[0]=.25*c,t[1]=(s+I)/c,t[2]=(h+n)/c):o>p?(c=Math.sqrt(1+o-C-p)*2,t[3]=(h-n)/c,t[0]=(s+I)/c,t[1]=.25*c,t[2]=(a+u)/c):(c=Math.sqrt(1+p-C-o)*2,t[3]=(s-I)/c,t[0]=(h+n)/c,t[1]=(a+u)/c,t[2]=.25*c),t}function mg(t,e,r,g){var i=e[0],A=e[1],C=e[2],s=e[3],n=i+i,I=A+A,o=C+C,a=i*n,h=i*I,u=i*o,p=A*I,v=A*o,c=C*o,M=s*n,z=s*I,F=s*o,P=g[0],D=g[1],S=g[2];return t[0]=(1-(p+c))*P,t[1]=(h+F)*P,t[2]=(u-z)*P,t[3]=0,t[4]=(h-F)*D,t[5]=(1-(a+c))*D,t[6]=(v+M)*D,t[7]=0,t[8]=(u+z)*S,t[9]=(v-M)*S,t[10]=(1-(a+p))*S,t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}function vg(t,e,r,g,i){var A=e[0],C=e[1],s=e[2],n=e[3],I=A+A,o=C+C,a=s+s,h=A*I,u=A*o,p=A*a,v=C*o,c=C*a,M=s*a,z=n*I,F=n*o,P=n*a,D=g[0],S=g[1],$=g[2],Y=i[0],q=i[1],Z=i[2],tt=(1-(v+M))*D,J=(u+P)*D,et=(p-F)*D,V=(u-P)*S,ht=(1-(h+M))*S,Pt=(c+z)*S,Ft=(p+F)*$,ie=(c-z)*$,Ae=(1-(h+v))*$;return t[0]=tt,t[1]=J,t[2]=et,t[3]=0,t[4]=V,t[5]=ht,t[6]=Pt,t[7]=0,t[8]=Ft,t[9]=ie,t[10]=Ae,t[11]=0,t[12]=r[0]+Y-(tt*Y+V*q+Ft*Z),t[13]=r[1]+q-(J*Y+ht*q+ie*Z),t[14]=r[2]+Z-(et*Y+Pt*q+Ae*Z),t[15]=1,t}function bg(t,e){var r=e[0],g=e[1],i=e[2],A=e[3],C=r+r,s=g+g,n=i+i,I=r*C,o=g*C,a=g*s,h=i*C,u=i*s,p=i*n,v=A*C,c=A*s,M=A*n;return t[0]=1-a-p,t[1]=o+M,t[2]=h-c,t[3]=0,t[4]=o-M,t[5]=1-I-p,t[6]=u+v,t[7]=0,t[8]=h+c,t[9]=u-v,t[10]=1-I-a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function xg(t,e,r,g,i,A,C){var s=1/(r-e),n=1/(i-g),I=1/(A-C);return t[0]=A*2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=A*2*n,t[6]=0,t[7]=0,t[8]=(r+e)*s,t[9]=(i+g)*n,t[10]=(C+A)*I,t[11]=-1,t[12]=0,t[13]=0,t[14]=C*A*2*I,t[15]=0,t}function Ke(t,e,r,g,i){var A=1/Math.tan(e/2),C;return t[0]=A/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=A,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,i!=null&&i!==1/0?(C=1/(g-i),t[10]=(i+g)*C,t[14]=2*i*g*C):(t[10]=-1,t[14]=-2*g),t}var Mg=Ke;function yg(t,e,r,g,i){var A=1/Math.tan(e/2),C;return t[0]=A/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=A,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,i!=null&&i!==1/0?(C=1/(g-i),t[10]=i*C,t[14]=i*g*C):(t[10]=-1,t[14]=-g),t}function wg(t,e,r,g){var i=Math.tan(e.upDegrees*Math.PI/180),A=Math.tan(e.downDegrees*Math.PI/180),C=Math.tan(e.leftDegrees*Math.PI/180),s=Math.tan(e.rightDegrees*Math.PI/180),n=2/(C+s),I=2/(i+A);return t[0]=n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=I,t[6]=0,t[7]=0,t[8]=-((C-s)*n*.5),t[9]=(i-A)*I*.5,t[10]=g/(r-g),t[11]=-1,t[12]=0,t[13]=0,t[14]=g*r/(r-g),t[15]=0,t}function _e(t,e,r,g,i,A,C){var s=1/(e-r),n=1/(g-i),I=1/(A-C);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*n,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*I,t[11]=0,t[12]=(e+r)*s,t[13]=(i+g)*n,t[14]=(C+A)*I,t[15]=1,t}var Eg=_e;function Rg(t,e,r,g,i,A,C){var s=1/(e-r),n=1/(g-i),I=1/(A-C);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*n,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=I,t[11]=0,t[12]=(e+r)*s,t[13]=(i+g)*n,t[14]=A*I,t[15]=1,t}function Bg(t,e,r,g){var i,A,C,s,n,I,o,a,h,u,p=e[0],v=e[1],c=e[2],M=g[0],z=g[1],F=g[2],P=r[0],D=r[1],S=r[2];return Math.abs(p-P)<N&&Math.abs(v-D)<N&&Math.abs(c-S)<N?ne(t):(o=p-P,a=v-D,h=c-S,u=1/Math.hypot(o,a,h),o*=u,a*=u,h*=u,i=z*h-F*a,A=F*o-M*h,C=M*a-z*o,u=Math.hypot(i,A,C),u?(u=1/u,i*=u,A*=u,C*=u):(i=0,A=0,C=0),s=a*C-h*A,n=h*i-o*C,I=o*A-a*i,u=Math.hypot(s,n,I),u?(u=1/u,s*=u,n*=u,I*=u):(s=0,n=0,I=0),t[0]=i,t[1]=s,t[2]=o,t[3]=0,t[4]=A,t[5]=n,t[6]=a,t[7]=0,t[8]=C,t[9]=I,t[10]=h,t[11]=0,t[12]=-(i*p+A*v+C*c),t[13]=-(s*p+n*v+I*c),t[14]=-(o*p+a*v+h*c),t[15]=1,t)}function Tg(t,e,r,g){var i=e[0],A=e[1],C=e[2],s=g[0],n=g[1],I=g[2],o=i-r[0],a=A-r[1],h=C-r[2],u=o*o+a*a+h*h;u>0&&(u=1/Math.sqrt(u),o*=u,a*=u,h*=u);var p=n*h-I*a,v=I*o-s*h,c=s*a-n*o;return u=p*p+v*v+c*c,u>0&&(u=1/Math.sqrt(u),p*=u,v*=u,c*=u),t[0]=p,t[1]=v,t[2]=c,t[3]=0,t[4]=a*c-h*v,t[5]=h*p-o*c,t[6]=o*v-a*p,t[7]=0,t[8]=o,t[9]=a,t[10]=h,t[11]=0,t[12]=i,t[13]=A,t[14]=C,t[15]=1,t}function Dg(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function Sg(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])}function Pg(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t[9]=e[9]+r[9],t[10]=e[10]+r[10],t[11]=e[11]+r[11],t[12]=e[12]+r[12],t[13]=e[13]+r[13],t[14]=e[14]+r[14],t[15]=e[15]+r[15],t}function He(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t[9]=e[9]-r[9],t[10]=e[10]-r[10],t[11]=e[11]-r[11],t[12]=e[12]-r[12],t[13]=e[13]-r[13],t[14]=e[14]-r[14],t[15]=e[15]-r[15],t}function Fg(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t[9]=e[9]*r,t[10]=e[10]*r,t[11]=e[11]*r,t[12]=e[12]*r,t[13]=e[13]*r,t[14]=e[14]*r,t[15]=e[15]*r,t}function Ug(t,e,r,g){return t[0]=e[0]+r[0]*g,t[1]=e[1]+r[1]*g,t[2]=e[2]+r[2]*g,t[3]=e[3]+r[3]*g,t[4]=e[4]+r[4]*g,t[5]=e[5]+r[5]*g,t[6]=e[6]+r[6]*g,t[7]=e[7]+r[7]*g,t[8]=e[8]+r[8]*g,t[9]=e[9]+r[9]*g,t[10]=e[10]+r[10]*g,t[11]=e[11]+r[11]*g,t[12]=e[12]+r[12]*g,t[13]=e[13]+r[13]*g,t[14]=e[14]+r[14]*g,t[15]=e[15]+r[15]*g,t}function zg(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function Gg(t,e){var r=t[0],g=t[1],i=t[2],A=t[3],C=t[4],s=t[5],n=t[6],I=t[7],o=t[8],a=t[9],h=t[10],u=t[11],p=t[12],v=t[13],c=t[14],M=t[15],z=e[0],F=e[1],P=e[2],D=e[3],S=e[4],$=e[5],Y=e[6],q=e[7],Z=e[8],tt=e[9],J=e[10],et=e[11],V=e[12],ht=e[13],Pt=e[14],Ft=e[15];return Math.abs(r-z)<=N*Math.max(1,Math.abs(r),Math.abs(z))&&Math.abs(g-F)<=N*Math.max(1,Math.abs(g),Math.abs(F))&&Math.abs(i-P)<=N*Math.max(1,Math.abs(i),Math.abs(P))&&Math.abs(A-D)<=N*Math.max(1,Math.abs(A),Math.abs(D))&&Math.abs(C-S)<=N*Math.max(1,Math.abs(C),Math.abs(S))&&Math.abs(s-$)<=N*Math.max(1,Math.abs(s),Math.abs($))&&Math.abs(n-Y)<=N*Math.max(1,Math.abs(n),Math.abs(Y))&&Math.abs(I-q)<=N*Math.max(1,Math.abs(I),Math.abs(q))&&Math.abs(o-Z)<=N*Math.max(1,Math.abs(o),Math.abs(Z))&&Math.abs(a-tt)<=N*Math.max(1,Math.abs(a),Math.abs(tt))&&Math.abs(h-J)<=N*Math.max(1,Math.abs(h),Math.abs(J))&&Math.abs(u-et)<=N*Math.max(1,Math.abs(u),Math.abs(et))&&Math.abs(p-V)<=N*Math.max(1,Math.abs(p),Math.abs(V))&&Math.abs(v-ht)<=N*Math.max(1,Math.abs(v),Math.abs(ht))&&Math.abs(c-Pt)<=N*Math.max(1,Math.abs(c),Math.abs(Pt))&&Math.abs(M-Ft)<=N*Math.max(1,Math.abs(M),Math.abs(Ft))}var Ng=Dt,Lg=He,Et={};wt(Et,{add:()=>AA,calculateW:()=>Xi,clone:()=>eA,conjugate:()=>Zi,copy:()=>gA,create:()=>Te,dot:()=>Er,equals:()=>oA,exactEquals:()=>aA,exp:()=>xr,fromEuler:()=>$i,fromMat3:()=>yr,fromValues:()=>rA,getAngle:()=>ji,getAxisAngle:()=>Wi,identity:()=>Qi,invert:()=>qi,len:()=>nA,length:()=>Rr,lerp:()=>sA,ln:()=>Mr,mul:()=>CA,multiply:()=>br,normalize:()=>De,pow:()=>Ji,random:()=>Yi,rotateX:()=>Ki,rotateY:()=>_i,rotateZ:()=>Hi,rotationTo:()=>hA,scale:()=>wr,set:()=>iA,setAxes:()=>lA,setAxisAngle:()=>vr,slerp:()=>he,sqlerp:()=>uA,sqrLen:()=>IA,squaredLength:()=>Br,str:()=>tA});var Xt={};wt(Xt,{add:()=>Qg,angle:()=>ni,bezier:()=>ti,ceil:()=>Wg,clone:()=>Og,copy:()=>kg,create:()=>ye,cross:()=>oe,dist:()=>fi,distance:()=>Ze,div:()=>ci,divide:()=>qe,dot:()=>Ee,equals:()=>hi,exactEquals:()=>oi,floor:()=>jg,forEach:()=>mi,fromValues:()=>we,hermite:()=>$g,inverse:()=>qg,len:()=>rr,length:()=>Xe,lerp:()=>Zg,max:()=>_g,min:()=>Kg,mul:()=>li,multiply:()=>Ye,negate:()=>Yg,normalize:()=>er,random:()=>ei,rotateX:()=>Ai,rotateY:()=>Ci,rotateZ:()=>si,round:()=>Hg,scale:()=>Xg,scaleAndAdd:()=>Jg,set:()=>Vg,sqrDist:()=>di,sqrLen:()=>pi,squaredDistance:()=>$e,squaredLength:()=>tr,str:()=>ai,sub:()=>ui,subtract:()=>Je,transformMat3:()=>gi,transformMat4:()=>ri,transformQuat:()=>ii,zero:()=>Ii});function ye(){var t=new Q(3);return Q!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function Og(t){var e=new Q(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function Xe(t){var e=t[0],r=t[1],g=t[2];return Math.hypot(e,r,g)}function we(t,e,r){var g=new Q(3);return g[0]=t,g[1]=e,g[2]=r,g}function kg(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function Vg(t,e,r,g){return t[0]=e,t[1]=r,t[2]=g,t}function Qg(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t}function Je(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t}function Ye(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t}function qe(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t}function Wg(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t}function jg(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t}function Kg(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t}function _g(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t}function Hg(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t}function Xg(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t}function Jg(t,e,r,g){return t[0]=e[0]+r[0]*g,t[1]=e[1]+r[1]*g,t[2]=e[2]+r[2]*g,t}function Ze(t,e){var r=e[0]-t[0],g=e[1]-t[1],i=e[2]-t[2];return Math.hypot(r,g,i)}function $e(t,e){var r=e[0]-t[0],g=e[1]-t[1],i=e[2]-t[2];return r*r+g*g+i*i}function tr(t){var e=t[0],r=t[1],g=t[2];return e*e+r*r+g*g}function Yg(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function qg(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function er(t,e){var r=e[0],g=e[1],i=e[2],A=r*r+g*g+i*i;return A>0&&(A=1/Math.sqrt(A)),t[0]=e[0]*A,t[1]=e[1]*A,t[2]=e[2]*A,t}function Ee(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function oe(t,e,r){var g=e[0],i=e[1],A=e[2],C=r[0],s=r[1],n=r[2];return t[0]=i*n-A*s,t[1]=A*C-g*n,t[2]=g*s-i*C,t}function Zg(t,e,r,g){var i=e[0],A=e[1],C=e[2];return t[0]=i+g*(r[0]-i),t[1]=A+g*(r[1]-A),t[2]=C+g*(r[2]-C),t}function $g(t,e,r,g,i,A){var C=A*A,s=C*(2*A-3)+1,n=C*(A-2)+A,I=C*(A-1),o=C*(3-2*A);return t[0]=e[0]*s+r[0]*n+g[0]*I+i[0]*o,t[1]=e[1]*s+r[1]*n+g[1]*I+i[1]*o,t[2]=e[2]*s+r[2]*n+g[2]*I+i[2]*o,t}function ti(t,e,r,g,i,A){var C=1-A,s=C*C,n=A*A,I=s*C,o=3*A*s,a=3*n*C,h=n*A;return t[0]=e[0]*I+r[0]*o+g[0]*a+i[0]*h,t[1]=e[1]*I+r[1]*o+g[1]*a+i[1]*h,t[2]=e[2]*I+r[2]*o+g[2]*a+i[2]*h,t}function ei(t,e){e=e||1;var r=nt()*2*Math.PI,g=nt()*2-1,i=Math.sqrt(1-g*g)*e;return t[0]=Math.cos(r)*i,t[1]=Math.sin(r)*i,t[2]=g*e,t}function ri(t,e,r){var g=e[0],i=e[1],A=e[2],C=r[3]*g+r[7]*i+r[11]*A+r[15];return C=C||1,t[0]=(r[0]*g+r[4]*i+r[8]*A+r[12])/C,t[1]=(r[1]*g+r[5]*i+r[9]*A+r[13])/C,t[2]=(r[2]*g+r[6]*i+r[10]*A+r[14])/C,t}function gi(t,e,r){var g=e[0],i=e[1],A=e[2];return t[0]=g*r[0]+i*r[3]+A*r[6],t[1]=g*r[1]+i*r[4]+A*r[7],t[2]=g*r[2]+i*r[5]+A*r[8],t}function ii(t,e,r){var g=r[0],i=r[1],A=r[2],C=r[3],s=e[0],n=e[1],I=e[2],o=i*I-A*n,a=A*s-g*I,h=g*n-i*s,u=i*h-A*a,p=A*o-g*h,v=g*a-i*o,c=C*2;return o*=c,a*=c,h*=c,u*=2,p*=2,v*=2,t[0]=s+o+u,t[1]=n+a+p,t[2]=I+h+v,t}function Ai(t,e,r,g){var i=[],A=[];return i[0]=e[0]-r[0],i[1]=e[1]-r[1],i[2]=e[2]-r[2],A[0]=i[0],A[1]=i[1]*Math.cos(g)-i[2]*Math.sin(g),A[2]=i[1]*Math.sin(g)+i[2]*Math.cos(g),t[0]=A[0]+r[0],t[1]=A[1]+r[1],t[2]=A[2]+r[2],t}function Ci(t,e,r,g){var i=[],A=[];return i[0]=e[0]-r[0],i[1]=e[1]-r[1],i[2]=e[2]-r[2],A[0]=i[2]*Math.sin(g)+i[0]*Math.cos(g),A[1]=i[1],A[2]=i[2]*Math.cos(g)-i[0]*Math.sin(g),t[0]=A[0]+r[0],t[1]=A[1]+r[1],t[2]=A[2]+r[2],t}function si(t,e,r,g){var i=[],A=[];return i[0]=e[0]-r[0],i[1]=e[1]-r[1],i[2]=e[2]-r[2],A[0]=i[0]*Math.cos(g)-i[1]*Math.sin(g),A[1]=i[0]*Math.sin(g)+i[1]*Math.cos(g),A[2]=i[2],t[0]=A[0]+r[0],t[1]=A[1]+r[1],t[2]=A[2]+r[2],t}function ni(t,e){var r=t[0],g=t[1],i=t[2],A=e[0],C=e[1],s=e[2],n=Math.sqrt(r*r+g*g+i*i),I=Math.sqrt(A*A+C*C+s*s),o=n*I,a=o&&Ee(t,e)/o;return Math.acos(Math.min(Math.max(a,-1),1))}function Ii(t){return t[0]=0,t[1]=0,t[2]=0,t}function ai(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function oi(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function hi(t,e){var r=t[0],g=t[1],i=t[2],A=e[0],C=e[1],s=e[2];return Math.abs(r-A)<=N*Math.max(1,Math.abs(r),Math.abs(A))&&Math.abs(g-C)<=N*Math.max(1,Math.abs(g),Math.abs(C))&&Math.abs(i-s)<=N*Math.max(1,Math.abs(i),Math.abs(s))}var ui=Je,li=Ye,ci=qe,fi=Ze,di=$e,rr=Xe,pi=tr,mi=function(){var t=ye();return function(e,r,g,i,A,C){var s,n;for(r||(r=3),g||(g=0),i?n=Math.min(i*r+g,e.length):n=e.length,s=g;s<n;s+=r)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],A(t,t,C),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2];return e}}(),Nt={};wt(Nt,{add:()=>nr,ceil:()=>vi,clone:()=>ir,copy:()=>Cr,create:()=>gr,cross:()=>Bi,dist:()=>Ni,distance:()=>ur,div:()=>Gi,divide:()=>or,dot:()=>fr,equals:()=>mr,exactEquals:()=>pr,floor:()=>bi,forEach:()=>Vi,fromValues:()=>Ar,inverse:()=>Ri,len:()=>Oi,length:()=>Re,lerp:()=>dr,max:()=>Mi,min:()=>xi,mul:()=>zi,multiply:()=>ar,negate:()=>Ei,normalize:()=>cr,random:()=>Ti,round:()=>yi,scale:()=>hr,scaleAndAdd:()=>wi,set:()=>sr,sqrDist:()=>Li,sqrLen:()=>ki,squaredDistance:()=>lr,squaredLength:()=>Be,str:()=>Fi,sub:()=>Ui,subtract:()=>Ir,transformMat4:()=>Di,transformQuat:()=>Si,zero:()=>Pi});function gr(){var t=new Q(4);return Q!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function ir(t){var e=new Q(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function Ar(t,e,r,g){var i=new Q(4);return i[0]=t,i[1]=e,i[2]=r,i[3]=g,i}function Cr(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function sr(t,e,r,g,i){return t[0]=e,t[1]=r,t[2]=g,t[3]=i,t}function nr(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t}function Ir(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t}function ar(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t[3]=e[3]*r[3],t}function or(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t[3]=e[3]/r[3],t}function vi(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t}function bi(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t}function xi(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t[3]=Math.min(e[3],r[3]),t}function Mi(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t[3]=Math.max(e[3],r[3]),t}function yi(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t}function hr(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t}function wi(t,e,r,g){return t[0]=e[0]+r[0]*g,t[1]=e[1]+r[1]*g,t[2]=e[2]+r[2]*g,t[3]=e[3]+r[3]*g,t}function ur(t,e){var r=e[0]-t[0],g=e[1]-t[1],i=e[2]-t[2],A=e[3]-t[3];return Math.hypot(r,g,i,A)}function lr(t,e){var r=e[0]-t[0],g=e[1]-t[1],i=e[2]-t[2],A=e[3]-t[3];return r*r+g*g+i*i+A*A}function Re(t){var e=t[0],r=t[1],g=t[2],i=t[3];return Math.hypot(e,r,g,i)}function Be(t){var e=t[0],r=t[1],g=t[2],i=t[3];return e*e+r*r+g*g+i*i}function Ei(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t}function Ri(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t}function cr(t,e){var r=e[0],g=e[1],i=e[2],A=e[3],C=r*r+g*g+i*i+A*A;return C>0&&(C=1/Math.sqrt(C)),t[0]=r*C,t[1]=g*C,t[2]=i*C,t[3]=A*C,t}function fr(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function Bi(t,e,r,g){var i=r[0]*g[1]-r[1]*g[0],A=r[0]*g[2]-r[2]*g[0],C=r[0]*g[3]-r[3]*g[0],s=r[1]*g[2]-r[2]*g[1],n=r[1]*g[3]-r[3]*g[1],I=r[2]*g[3]-r[3]*g[2],o=e[0],a=e[1],h=e[2],u=e[3];return t[0]=a*I-h*n+u*s,t[1]=-(o*I)+h*C-u*A,t[2]=o*n-a*C+u*i,t[3]=-(o*s)+a*A-h*i,t}function dr(t,e,r,g){var i=e[0],A=e[1],C=e[2],s=e[3];return t[0]=i+g*(r[0]-i),t[1]=A+g*(r[1]-A),t[2]=C+g*(r[2]-C),t[3]=s+g*(r[3]-s),t}function Ti(t,e){e=e||1;var r,g,i,A,C,s;do r=nt()*2-1,g=nt()*2-1,C=r*r+g*g;while(C>=1);do i=nt()*2-1,A=nt()*2-1,s=i*i+A*A;while(s>=1);var n=Math.sqrt((1-C)/s);return t[0]=e*r,t[1]=e*g,t[2]=e*i*n,t[3]=e*A*n,t}function Di(t,e,r){var g=e[0],i=e[1],A=e[2],C=e[3];return t[0]=r[0]*g+r[4]*i+r[8]*A+r[12]*C,t[1]=r[1]*g+r[5]*i+r[9]*A+r[13]*C,t[2]=r[2]*g+r[6]*i+r[10]*A+r[14]*C,t[3]=r[3]*g+r[7]*i+r[11]*A+r[15]*C,t}function Si(t,e,r){var g=e[0],i=e[1],A=e[2],C=r[0],s=r[1],n=r[2],I=r[3],o=I*g+s*A-n*i,a=I*i+n*g-C*A,h=I*A+C*i-s*g,u=-C*g-s*i-n*A;return t[0]=o*I+u*-C+a*-n-h*-s,t[1]=a*I+u*-s+h*-C-o*-n,t[2]=h*I+u*-n+o*-s-a*-C,t[3]=e[3],t}function Pi(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t}function Fi(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function pr(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function mr(t,e){var r=t[0],g=t[1],i=t[2],A=t[3],C=e[0],s=e[1],n=e[2],I=e[3];return Math.abs(r-C)<=N*Math.max(1,Math.abs(r),Math.abs(C))&&Math.abs(g-s)<=N*Math.max(1,Math.abs(g),Math.abs(s))&&Math.abs(i-n)<=N*Math.max(1,Math.abs(i),Math.abs(n))&&Math.abs(A-I)<=N*Math.max(1,Math.abs(A),Math.abs(I))}var Ui=Ir,zi=ar,Gi=or,Ni=ur,Li=lr,Oi=Re,ki=Be,Vi=function(){var t=gr();return function(e,r,g,i,A,C){var s,n;for(r||(r=4),g||(g=0),i?n=Math.min(i*r+g,e.length):n=e.length,s=g;s<n;s+=r)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],t[3]=e[s+3],A(t,t,C),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2],e[s+3]=t[3];return e}}();function Te(){var t=new Q(4);return Q!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function Qi(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function vr(t,e,r){r=r*.5;var g=Math.sin(r);return t[0]=g*e[0],t[1]=g*e[1],t[2]=g*e[2],t[3]=Math.cos(r),t}function Wi(t,e){var r=Math.acos(e[3])*2,g=Math.sin(r/2);return g>N?(t[0]=e[0]/g,t[1]=e[1]/g,t[2]=e[2]/g):(t[0]=1,t[1]=0,t[2]=0),r}function ji(t,e){var r=Er(t,e);return Math.acos(2*r*r-1)}function br(t,e,r){var g=e[0],i=e[1],A=e[2],C=e[3],s=r[0],n=r[1],I=r[2],o=r[3];return t[0]=g*o+C*s+i*I-A*n,t[1]=i*o+C*n+A*s-g*I,t[2]=A*o+C*I+g*n-i*s,t[3]=C*o-g*s-i*n-A*I,t}function Ki(t,e,r){r*=.5;var g=e[0],i=e[1],A=e[2],C=e[3],s=Math.sin(r),n=Math.cos(r);return t[0]=g*n+C*s,t[1]=i*n+A*s,t[2]=A*n-i*s,t[3]=C*n-g*s,t}function _i(t,e,r){r*=.5;var g=e[0],i=e[1],A=e[2],C=e[3],s=Math.sin(r),n=Math.cos(r);return t[0]=g*n-A*s,t[1]=i*n+C*s,t[2]=A*n+g*s,t[3]=C*n-i*s,t}function Hi(t,e,r){r*=.5;var g=e[0],i=e[1],A=e[2],C=e[3],s=Math.sin(r),n=Math.cos(r);return t[0]=g*n+i*s,t[1]=i*n-g*s,t[2]=A*n+C*s,t[3]=C*n-A*s,t}function Xi(t,e){var r=e[0],g=e[1],i=e[2];return t[0]=r,t[1]=g,t[2]=i,t[3]=Math.sqrt(Math.abs(1-r*r-g*g-i*i)),t}function xr(t,e){var r=e[0],g=e[1],i=e[2],A=e[3],C=Math.sqrt(r*r+g*g+i*i),s=Math.exp(A),n=C>0?s*Math.sin(C)/C:0;return t[0]=r*n,t[1]=g*n,t[2]=i*n,t[3]=s*Math.cos(C),t}function Mr(t,e){var r=e[0],g=e[1],i=e[2],A=e[3],C=Math.sqrt(r*r+g*g+i*i),s=C>0?Math.atan2(C,A)/C:0;return t[0]=r*s,t[1]=g*s,t[2]=i*s,t[3]=.5*Math.log(r*r+g*g+i*i+A*A),t}function Ji(t,e,r){return Mr(t,e),wr(t,t,r),xr(t,t),t}function he(t,e,r,g){var i=e[0],A=e[1],C=e[2],s=e[3],n=r[0],I=r[1],o=r[2],a=r[3],h,u,p,v,c;return u=i*n+A*I+C*o+s*a,u<0&&(u=-u,n=-n,I=-I,o=-o,a=-a),1-u>N?(h=Math.acos(u),p=Math.sin(h),v=Math.sin((1-g)*h)/p,c=Math.sin(g*h)/p):(v=1-g,c=g),t[0]=v*i+c*n,t[1]=v*A+c*I,t[2]=v*C+c*o,t[3]=v*s+c*a,t}function Yi(t){var e=nt(),r=nt(),g=nt(),i=Math.sqrt(1-e),A=Math.sqrt(e);return t[0]=i*Math.sin(2*Math.PI*r),t[1]=i*Math.cos(2*Math.PI*r),t[2]=A*Math.sin(2*Math.PI*g),t[3]=A*Math.cos(2*Math.PI*g),t}function qi(t,e){var r=e[0],g=e[1],i=e[2],A=e[3],C=r*r+g*g+i*i+A*A,s=C?1/C:0;return t[0]=-r*s,t[1]=-g*s,t[2]=-i*s,t[3]=A*s,t}function Zi(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function yr(t,e){var r=e[0]+e[4]+e[8],g;if(r>0)g=Math.sqrt(r+1),t[3]=.5*g,g=.5/g,t[0]=(e[5]-e[7])*g,t[1]=(e[6]-e[2])*g,t[2]=(e[1]-e[3])*g;else{var i=0;e[4]>e[0]&&(i=1),e[8]>e[i*3+i]&&(i=2);var A=(i+1)%3,C=(i+2)%3;g=Math.sqrt(e[i*3+i]-e[A*3+A]-e[C*3+C]+1),t[i]=.5*g,g=.5/g,t[3]=(e[A*3+C]-e[C*3+A])*g,t[A]=(e[A*3+i]+e[i*3+A])*g,t[C]=(e[C*3+i]+e[i*3+C])*g}return t}function $i(t,e,r,g){var i=.5*Math.PI/180;e*=i,r*=i,g*=i;var A=Math.sin(e),C=Math.cos(e),s=Math.sin(r),n=Math.cos(r),I=Math.sin(g),o=Math.cos(g);return t[0]=A*n*o-C*s*I,t[1]=C*s*o+A*n*I,t[2]=C*n*I-A*s*o,t[3]=C*n*o+A*s*I,t}function tA(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}var eA=ir,rA=Ar,gA=Cr,iA=sr,AA=nr,CA=br,wr=hr,Er=fr,sA=dr,Rr=Re,nA=Rr,Br=Be,IA=Br,De=cr,aA=pr,oA=mr,hA=function(){var t=ye(),e=we(1,0,0),r=we(0,1,0);return function(g,i,A){var C=Ee(i,A);return C<-.999999?(oe(t,e,i),rr(t)<1e-6&&oe(t,r,i),er(t,t),vr(g,t,Math.PI),g):C>.999999?(g[0]=0,g[1]=0,g[2]=0,g[3]=1,g):(oe(t,i,A),g[0]=t[0],g[1]=t[1],g[2]=t[2],g[3]=1+C,De(g,g))}}(),uA=function(){var t=Te(),e=Te();return function(r,g,i,A,C,s){return he(t,g,C,s),he(e,i,A,s),he(r,t,e,2*s*(1-s)),r}}(),lA=function(){var t=xe();return function(e,r,g,i){return t[0]=g[0],t[3]=g[1],t[6]=g[2],t[1]=i[0],t[4]=i[1],t[7]=i[2],t[2]=-r[0],t[5]=-r[1],t[8]=-r[2],De(e,yr(e,t))}}(),Tr={};wt(Tr,{add:()=>mA,angle:()=>OA,ceil:()=>vA,clone:()=>cA,copy:()=>dA,create:()=>Dr,cross:()=>SA,dist:()=>XA,distance:()=>Ur,div:()=>HA,divide:()=>Fr,dot:()=>DA,equals:()=>WA,exactEquals:()=>QA,floor:()=>bA,forEach:()=>qA,fromValues:()=>fA,inverse:()=>BA,len:()=>jA,length:()=>Gr,lerp:()=>PA,max:()=>MA,min:()=>xA,mul:()=>_A,multiply:()=>Pr,negate:()=>RA,normalize:()=>TA,random:()=>FA,rotate:()=>LA,round:()=>yA,scale:()=>wA,scaleAndAdd:()=>EA,set:()=>pA,sqrDist:()=>JA,sqrLen:()=>YA,squaredDistance:()=>zr,squaredLength:()=>Nr,str:()=>VA,sub:()=>KA,subtract:()=>Sr,transformMat2:()=>UA,transformMat2d:()=>zA,transformMat3:()=>GA,transformMat4:()=>NA,zero:()=>kA});function Dr(){var t=new Q(2);return Q!=Float32Array&&(t[0]=0,t[1]=0),t}function cA(t){var e=new Q(2);return e[0]=t[0],e[1]=t[1],e}function fA(t,e){var r=new Q(2);return r[0]=t,r[1]=e,r}function dA(t,e){return t[0]=e[0],t[1]=e[1],t}function pA(t,e,r){return t[0]=e,t[1]=r,t}function mA(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t}function Sr(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t}function Pr(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t}function Fr(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t}function vA(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t}function bA(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t}function xA(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t}function MA(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t}function yA(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t}function wA(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t}function EA(t,e,r,g){return t[0]=e[0]+r[0]*g,t[1]=e[1]+r[1]*g,t}function Ur(t,e){var r=e[0]-t[0],g=e[1]-t[1];return Math.hypot(r,g)}function zr(t,e){var r=e[0]-t[0],g=e[1]-t[1];return r*r+g*g}function Gr(t){var e=t[0],r=t[1];return Math.hypot(e,r)}function Nr(t){var e=t[0],r=t[1];return e*e+r*r}function RA(t,e){return t[0]=-e[0],t[1]=-e[1],t}function BA(t,e){return t[0]=1/e[0],t[1]=1/e[1],t}function TA(t,e){var r=e[0],g=e[1],i=r*r+g*g;return i>0&&(i=1/Math.sqrt(i)),t[0]=e[0]*i,t[1]=e[1]*i,t}function DA(t,e){return t[0]*e[0]+t[1]*e[1]}function SA(t,e,r){var g=e[0]*r[1]-e[1]*r[0];return t[0]=t[1]=0,t[2]=g,t}function PA(t,e,r,g){var i=e[0],A=e[1];return t[0]=i+g*(r[0]-i),t[1]=A+g*(r[1]-A),t}function FA(t,e){e=e||1;var r=nt()*2*Math.PI;return t[0]=Math.cos(r)*e,t[1]=Math.sin(r)*e,t}function UA(t,e,r){var g=e[0],i=e[1];return t[0]=r[0]*g+r[2]*i,t[1]=r[1]*g+r[3]*i,t}function zA(t,e,r){var g=e[0],i=e[1];return t[0]=r[0]*g+r[2]*i+r[4],t[1]=r[1]*g+r[3]*i+r[5],t}function GA(t,e,r){var g=e[0],i=e[1];return t[0]=r[0]*g+r[3]*i+r[6],t[1]=r[1]*g+r[4]*i+r[7],t}function NA(t,e,r){var g=e[0],i=e[1];return t[0]=r[0]*g+r[4]*i+r[12],t[1]=r[1]*g+r[5]*i+r[13],t}function LA(t,e,r,g){var i=e[0]-r[0],A=e[1]-r[1],C=Math.sin(g),s=Math.cos(g);return t[0]=i*s-A*C+r[0],t[1]=i*C+A*s+r[1],t}function OA(t,e){var r=t[0],g=t[1],i=e[0],A=e[1],C=Math.sqrt(r*r+g*g)*Math.sqrt(i*i+A*A),s=C&&(r*i+g*A)/C;return Math.acos(Math.min(Math.max(s,-1),1))}function kA(t){return t[0]=0,t[1]=0,t}function VA(t){return"vec2("+t[0]+", "+t[1]+")"}function QA(t,e){return t[0]===e[0]&&t[1]===e[1]}function WA(t,e){var r=t[0],g=t[1],i=e[0],A=e[1];return Math.abs(r-i)<=N*Math.max(1,Math.abs(r),Math.abs(i))&&Math.abs(g-A)<=N*Math.max(1,Math.abs(g),Math.abs(A))}var jA=Gr,KA=Sr,_A=Pr,HA=Fr,XA=Ur,JA=zr,YA=Nr,qA=function(){var t=Dr();return function(e,r,g,i,A,C){var s,n;for(r||(r=2),g||(g=0),i?n=Math.min(i*r+g,e.length):n=e.length,s=g;s<n;s+=r)t[0]=e[s],t[1]=e[s+1],A(t,t,C),e[s]=t[0],e[s+1]=t[1];return e}}();function w(t,e,r){return(...g)=>{if(g.length<=e){let i=r();return t(i,...g)}else{let[i,...A]=g;return i===void 0&&(i=r()),t(i,...A)}}}var ZA=Array,Rt=class extends ZA{get x(){return this[0]}set x(t){this[0]=t}get y(){return this[1]}set y(t){this[1]=t}get z(){return this[2]}set z(t){this[2]=t}get magnitude(){return Math.hypot(...this)}get magnitudeSqr(){return this[0]*this[0]+this[1]*this[1]+this[2]*this[2]}get normalized(){let t=this.magnitude;return t==0?m.zero():this.clone().div(m(t,t,t))}get negative(){return this.clone().negate()}get inversed(){return this.clone().inverse()}constructor(t,e,r){super(t,e,r)}static zero(){return new Rt(0,0,0)}static one(){return new Rt(1,1,1)}asMut(){return this}plus(t){return m.plus(this,this,t)}minus(t){return m.minus(this,this,t)}mul(t){return m.mul(this,this,t)}div(t){return m.div(this,this,t)}dot(t){return this[0]*t[0]+this[1]*t[1]+this[2]*t[2]}normalize(){return m.normalize(this,this)}inverse(){return this[0]=1/this[0],this[1]=1/this[1],this[2]=1/this[2],this}negate(){return this[0]=-this[0],this[1]=-this[1],this[2]=-this[2],this}cross(t){return m(this.y*t.z-this.z*t.y,this.z*t.x-this.x*t.z,this.x*t.y-this.y*t.x)}set(t){return this[0]=t[0]||0,this[1]=t[1]||0,this[2]=t[2]||0,this}fill(t){return this[0]=this[1]=this[2]=t,this}clone(t=m.zero()){return t.set(this)}setX(t){return this[0]=t,this}setY(t){return this[1]=t,this}setZ(t){return this[2]=t,this}toVec2(){return f(this[0],this[1])}toVec4(t=0){return E(this[0],this[1],this[2],t)}equals(t){return t===void 0?!1:t[0]===this[0]&&t[1]===this[1]&&t[2]===this[2]}static math(t){return(...e)=>m(t(...e.map(r=>r.x)),t(...e.map(r=>r.y)),t(...e.map(r=>r.z)))}static mathNonAlloc(t,e,...r){return e[0]=t(...r.map(g=>g[0])),e[1]=t(...r.map(g=>g[1])),e[2]=t(...r.map(g=>g[2])),e}__to(t){switch(t){case ft:return E(this[0],this[1],this[2],0);case it:return f(this[0],this[1])}return this.clone()}};function m(t,e=t,r=t){return new Rt(t,e,r)}m.from=t=>{let[e=0,r=0,g=0]=t;return m(e,r,g)},m.zero=Rt.zero,m.one=Rt.one,m.math=Rt.math,m.normalize=w(Xt.normalize,1,m.zero),m.inverse=w(Xt.inverse,1,m.zero),m.negate=w(Xt.negate,1,m.zero),m.plus=w((t,e,r)=>(typeof r=="number"?(t[0]=e[0]+r,t[1]=e[1]+r,t[2]=e[2]+r):(t[0]=e[0]+r[0],t[1]=e[1]+(r[1]||0),t[2]=e[2]+(r[2]||0)),t),2,m.zero),m.minus=w((t,e,r)=>(typeof r=="number"?(t[0]=e[0]-r,t[1]=e[1]-r,t[2]=e[2]-r):(t[0]=e[0]-r[0],t[1]=e[1]-(r[1]||0),t[2]=e[2]-(r[2]||0)),t),2,m.zero),m.mul=w((t,e,r)=>(typeof r=="number"?(t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r):(t[0]=e[0]*r[0],t[1]=e[1]*(r[1]===void 0?1:r[1]),t[2]=e[2]*(r[2]===void 0?1:r[2])),t),2,m.zero),m.div=w((t,e,r)=>(typeof r=="number"?(t[0]=e[0]/r,t[1]=e[1]/r,t[2]=e[2]/r):(t[0]=e[0]/r[0],t[1]=e[1]/(r[1]===void 0?1:r[1]),t[2]=e[2]/(r[2]===void 0?1:r[2])),t),2,m.zero),m.set=w((t,e)=>(t[0]=e[0],t[1]=e[1],t[2]=e[2],t),1,m.zero),m.fill=w((t,e)=>(t[0]=t[1]=t[2]=e,t),1,m.zero),m.distance=(t,e)=>Math.hypot(t.x-e.x,t.y-e.y,t.z-e.z);var $A=Array,ft=class extends $A{get x(){return this[0]}set x(t){this[0]=t}get y(){return this[1]}set y(t){this[1]=t}get z(){return this[2]}set z(t){this[2]=t}get w(){return this[3]}set w(t){this[3]=t}get magnitude(){return Math.hypot(...this)}get normalized(){let t=this.magnitude;return t==0?E.zero():this.clone().div(E(t,t,t,t))}get negative(){return this.clone().negate()}get inversed(){return this.clone().inverse()}constructor(t,e,r=0,g=0){super(t,e,r||0,g||0)}static zero(){return new ft(0,0,0,0)}static one(){return new ft(1,1,1,1)}asMut(){return this}plus(t){return E.plus(this,this,t)}minus(t){return E.minus(this,this,t)}mul(t){return E.mul(this,this,t)}div(t){return E.div(this,this,t)}dot(t){return this[0]*t[0]+this[1]*t[1]+this[2]*t[2]+this[3]*t[3]}normalize(){return E.normalize(this,this)}inverse(){return this[0]=1/this[0],this[1]=1/this[1],this[2]=1/this[2],this[3]=1/this[3],this}negate(){return this[0]=-this[0],this[1]=-this[1],this[2]=-this[2],this[3]=-this[3],this}clone(t=E.zero()){return t.set(this)}equals(t){return t===void 0?!1:t[0]===this[0]&&t[1]===this[1]&&t[2]===this[2]&&t[3]===this[3]}set(t){return this[0]=t[0]||0,this[1]=t[1]||0,this[2]=t[2]||0,this[3]=t[3]||0,this}fill(t){return this[0]=this[1]=this[2]=this[3]=t,this}static math(t){return(...e)=>E(t(...e.map(r=>r.x)),t(...e.map(r=>r.y)),t(...e.map(r=>r.z)),t(...e.map(r=>r.w)))}static mathNonAlloc(t){return(e,...r)=>(e[0]=t(...r.map(g=>g[0])),e[1]=t(...r.map(g=>g[1])),e[2]=t(...r.map(g=>g[2])),e[3]=t(...r.map(g=>g[3])),e)}__to(t){switch(t){case ft:return this.clone();case Rt:return m(this[0],this[1],this[2]);case it:return f(this[0],this[1])}return this.clone()}};function E(t,e=t,r=t,g=t){return new ft(t,e,r,g)}E.from=t=>{let[e=0,r=0,g=0,i=0]=t;return E(e,r,g,i)},E.floor=t=>E(Math.floor(t.x),Math.floor(t.y),Math.floor(t.z),Math.floor(t.w)),E.zero=ft.zero,E.one=ft.one,E.math=ft.math,E.mathNonAlloc=ft.mathNonAlloc,E.normalize=w(Nt.normalize,1,E.zero),E.plus=w((t,e,r)=>(typeof r=="number"?(t[0]=e[0]+r,t[1]=e[1]+r,t[2]=e[2]+r,t[3]=e[3]+r):(t[0]=e[0]+r[0],t[1]=e[1]+(r[1]||0),t[2]=e[2]+(r[2]||0),t[3]=e[3]+(r[3]||0)),t),2,E.zero),E.minus=w((t,e,r)=>(typeof r=="number"?(t[0]=e[0]-r,t[1]=e[1]-r,t[2]=e[2]-r,t[3]=e[3]-r):(t[0]=e[0]-r[0],t[1]=e[1]-(r[1]||0),t[2]=e[2]-(r[2]||0),t[3]=e[3]-(r[3]||0)),t),2,E.zero),E.mul=w((t,e,r)=>(typeof r=="number"?(t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r):(t[0]=e[0]*r[0],t[1]=e[1]*(r[1]===void 0?1:r[1]),t[2]=e[2]*(r[2]===void 0?1:r[2]),t[3]=e[3]*(r[3]===void 0?1:r[3])),t),2,E.zero),E.div=w((t,e,r)=>(typeof r=="number"?(t[0]=e[0]/r,t[1]=e[1]/r,t[2]=e[2]/r,t[3]=e[3]/r):(t[0]=e[0]/r[0],t[1]=e[1]/(r[1]===void 0?1:r[1]),t[2]=e[2]/(r[2]===void 0?1:r[2]),t[3]=e[3]/(r[3]===void 0?1:r[3])),t),2,E.zero),E.set=w((t,e)=>(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t),1,E.zero),E.fill=w((t,e)=>(t[0]=t[1]=t[2]=t[3]=e,t),1,E.zero);var tC=Array,it=class extends tC{get x(){return this[0]}set x(t){this[0]=t}get y(){return this[1]}set y(t){this[1]=t}get magnitude(){return Math.hypot(...this)}get magnitudeSqr(){return this[0]*this[0]+this[1]*this[1]}get normalized(){let t=this.magnitude;return t==0?f.zero():this.clone().div(f(t,t))}get negative(){return this.clone().negate()}get inversed(){return this.clone().inverse()}get isZero(){return this.x===0&&this.y===0}constructor(t,e){super(t,e)}static zero(){return new it(0,0)}static one(){return new it(1,1)}static up(){return new it(0,1)}static down(){return new it(0,-1)}static left(){return new it(-1,0)}static right(){return new it(1,0)}static distance(t,e){return Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y))}static distanceSquared(t,e){return(t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y)}static math(t){return(...e)=>f(t(...e.map(r=>r.x)),t(...e.map(r=>r.y)))}asMut(){return this}plus(t){return f.plus(this,this,t)}minus(t){return f.minus(this,this,t)}mul(t){return f.mul(this,this,t)}div(t){return f.div(this,this,t)}dot(t){return this[0]*t[0]+this[1]*t[1]}normalize(){return f.normalize(this,this)}inverse(){return this[0]=1/this[0],this[1]=1/this[1],this}negate(){return this[0]=-this[0],this[1]=-this[1],this}oneMinus(){return this[0]=1-this[0],this[1]=1-this[1],this}equals(t){return t===void 0?!1:t[0]===this[0]&&t[1]===this[1]}clone(t=f.zero()){return t.set(this)}set(t){return this[0]=t[0]||0,this[1]=t[1]||0,this}fill(t){return this[0]=this[1]=t,this}toVec3(t=0){return m(this[0],this[1],t)}__to(t){switch(t){case ft:return E(this[0],this[1],0,0);case Rt:return m(this[0],this[1],0)}return this.clone()}};function f(t,e=t){return new it(t,e)}f.from=t=>{let[e=0,r=0]=t;return f(e,r)},f.floor=t=>f(Math.floor(t.x),Math.floor(t.y)),f.zero=it.zero,f.one=it.one,f.left=it.left,f.right=it.right,f.down=it.down,f.up=it.up,f.math=it.math,f.plus=w((t,e,r)=>(typeof r=="number"?(t[0]=e[0]+r,t[1]=e[1]+r):(t[0]=e[0]+r[0],t[1]=e[1]+(r[1]||0)),t),2,f.zero),f.minus=w((t,e,r)=>(typeof r=="number"?(t[0]=e[0]-r,t[1]=e[1]-r):(t[0]=e[0]-r[0],t[1]=e[1]-(r[1]||0)),t),2,f.zero),f.mul=w((t,e,r)=>(typeof r=="number"?(t[0]=e[0]*r,t[1]=e[1]*r):(t[0]=e[0]*r[0],t[1]=e[1]*r[1]),t),2,f.zero),f.div=w((t,e,r)=>(typeof r=="number"?(t[0]=e[0]/r,t[1]=e[1]/r):(t[0]=e[0]/r[0],t[1]=e[1]/r[1]),t),2,f.zero),f.exp=w((t,e)=>(typeof e=="number"?(t[0]=Math.exp(e),t[1]=Math.exp(e)):(t[0]=Math.exp(e[0]),t[1]=Math.exp(e[1])),t),1,f.zero),f.inverse=w((t,e)=>(t[0]=1/e[0],t[1]=1/e[1],t),1,f.zero),f.dot=(t,e)=>t[0]*e[0]+t[1]*e[1],f.cross=(t,e)=>t[0]*e[1]-t[1]*e[0],f.normalize=w(Tr.normalize,1,f.zero),f.perpendicular=w((t,e)=>(t[0]=-e[1],t[1]=e[0],t),1,f.zero),f.set=w((t,e)=>(t[0]=e[0],t[1]=e[1],t),1,f.zero),f.fill=w((t,e)=>(t[0]=t[1]=e,t),1,f.zero);var X=class extends ft{get r(){return this[0]}set r(t){this[0]=t}get g(){return this[1]}set g(t){this[1]=t}get b(){return this[2]}set b(t){this[2]=t}get a(){return this[3]}set a(t){this[3]=t}constructor(t,e,r,g=1){super(t,e,r,g)}static get white(){return new X(1,1,1)}static get transparent(){return new X(1,1,1,0)}static get black(){return new X(0,0,0)}static get red(){return new X(1,0,0)}static get green(){return new X(0,1,0)}static get blue(){return new X(0,0,1)}static get cyan(){return new X(0,1,1)}static get yellow(){return new X(1,1,0)}static get magenta(){return new X(1,0,1)}static get gray(){return new X(.5,.5,.5)}transparent(){return new X(this.r,this.g,this.b,0)}setHSL(t,e,r){t=t<0?t+360:t;let g=(1-Math.abs(2*r-1))*e;if(isNaN(t))return this.r=this.g=this.b=0,this;t=t/60;let i=g*(1-Math.abs(t%2-1)),A=[0,0,0];0<=t&&t<=1?A=[g,i,0]:t<=2?A=[i,g,0]:t<=3?A=[0,g,i]:t<=4?A=[0,i,g]:t<=5?A=[i,0,g]:t<=6&&(A=[g,0,i]);let C=r-g/2;return this.r=A[0]+C,this.g=A[1]+C,this.b=A[2]+C,this}get hue(){let t=this.r,e=this.g,r=this.b,g=Math.max(t,e,r),i=Math.min(t,e,r),A=0;return g===i?A=0:g===t?A=60*(0+(e-r)/(g-i)):g===e?A=60*(2+(r-t)/(g-i)):g===r&&(A=60*(4+(t-e)/(g-i))),A<0?A+360:A}get saturation(){let t=Math.max(this.r,this.g,this.b),e=Math.min(this.r,this.g,this.b);return t===0||e==1?0:(t-e)/(1-Math.abs(t+e-1))}get lightness(){let t=Math.max(this.r,this.g,this.b),e=Math.min(this.r,this.g,this.b);return(t+e)/2}toHSL(){return[this.hue,this.saturation,this.lightness]}static fromHSL(t,e,r,g=1){return new X(0,0,0,g).setHSL(t,e,r)}static fromString(t,e){t=t.replace(new RegExp(/\s/g),"");var r=new RegExp("#[0-9a-fA-F]{6}");if(r.test(t)){t=t.replace("#","");var g=t.charAt(0)+t.charAt(1),i=t.charAt(2)+t.charAt(3),A=t.charAt(4)+t.charAt(5),C=parseInt(g,16),s=parseInt(i,16),n=parseInt(A,16);return new X(C/255,s/255,n/255,e||1)}if(r=new RegExp("rgb\\(([0-9]+(\\.[0-9]+){0,1}),([0-9]+(\\.[0-9]+){0,1}),([0-9]+(\\.[0-9]+){0,1})\\)"),r.test(t)){var I=t.replace("rgb(","").replace(")","").split(","),C=parseInt(I[0]),s=parseInt(I[1]),n=parseInt(I[2]),o=e||1;return new X(C/255,s/255,n/255,o/255)}if(r=new RegExp("rgba\\(([0-9]+(\\.[0-9]+){0,1}),([0-9]+(\\.[0-9]+){0,1}),([0-9]+(\\.[0-9]+){0,1}),([0-9]+(\\.[0-9]+){0,1})\\)"),r.test(t)){var I=t.replace("rgba(","").replace(")","").split(","),C=parseInt(I[0]),s=parseInt(I[1]),n=parseInt(I[2]),o=e||parseFloat(I[3]);return new X(C/255,s/255,n/255,o)}throw new Error(`Invalid color string '${t}'`)}},eC=Array,Se=class extends eC{static create(){return new Se(0,0,0,0)}asMut(){return this}equals(t){return!t||!(t instanceof Array)?!1:Et.exactEquals(this,t)}clone(t=Se.create()){return t.set(this)}set(t){return this[0]=t[0]||0,this[1]=t[1]||0,this[2]=t[2]||0,this[3]=t[3]||0,this}fill(t){return this[0]=t,this[1]=t,this[2]=t,this[3]=t,this}};function rt(t=0,e=t,r=t,g=t){return new Se(t,e,r,g)}rt.create=()=>rt(0),rt.identity=w(Et.identity,0,rt.create),rt.axisAngle=w((t,e,r)=>Et.setAxisAngle(t,e,r),2,rt.create),rt.mul=w(Et.mul,2,rt.create),rt.invert=w(Et.invert,1,rt.create),rt.normalize=w(Et.normalize,1,rt.create),rt.euler=w((t,e)=>(t[0]=Math.atan2(2*(e[3]*e[0]+e[1]*e[2]),1-2*(e[0]**2+e[1]**2))*Fe,t[1]=Math.asin(2*(e[3]*e[1]-e[2]*e[0]))*Fe,t[2]=Math.atan2(2*(e[3]*e[2]+e[0]*e[1]),1-2*(e[1]**2,e[2]**2))*Fe,t),1,m.zero),rt.fromEuler=w((t,e)=>Et.fromEuler(t,e[0],e[1],e[2]),1,rt.create),rt.rotate=w((t,e,r)=>Xt.transformQuat(t,r,e),2,m.zero),rt.equals=(t,e)=>Et.exactEquals(t,e);var rC=Array,W=E.zero(),ut=class extends rC{constructor(t=0,e=0,r=0,g=0,i=0,A=0,C=0,s=0,n=0,I=0,o=0,a=0,h=0,u=0,p=0,v=0){super(t,e,r,g,i,A,C,s,n,I,o,a,h,u,p,v)}static create(){return new ut}asMut(){return this}set(t){return H.set(this,...t)}fill(t){return y.fill(this,t)}clone(t=y.create()){return t.set(this)}equals(t){return y.equal(this,t)}};function y(t=0,e=0,r=0,g=0,i=0,A=0,C=0,s=0,n=0,I=0,o=0,a=0,h=0,u=0,p=0,v=0){return new ut(t,e,r,g,i,A,C,s,n,I,o,a,h,u,p,v)}y.create=ut.create,y.identity=w(H.identity,0,y.create),y.rts=w(H.fromRotationTranslationScale,3,y.create),y.translate=w(H.translate,2,ut.create),y.invert=w(H.invert,1,ut.create),y.getTranslation=w(H.getTranslation,1,m.zero),y.getRotation=w(H.getRotation,1,rt.create),y.getScaling=w(H.getScaling,1,m.zero),y.mulVec4=w((t,e,r)=>Nt.transformMat4(t,r,e),2,E.zero),y.perspective=w(H.perspective,4,ut.create),y.transpose=w(H.transpose,1,ut.create),y.rotate=w((t,e,r,g)=>H.rotate(t,e,g,r),3,ut.create),y.scale=w(H.scale,2,ut.create),y.fromTranslation=w(H.fromTranslation,1,ut.create),y.fromRotation=w(H.fromRotation,1,ut.create),y.fromScaling=w(H.fromScaling,1,ut.create),y.mul=w(H.mul,2,ut.create),y.add=w(H.add,2,y.create),y.sub=w(H.sub,2,y.create),y.plus=y.add,y.minus=y.sub,y.mulVector=w((t,e,r)=>(W[0]=r[0],W[1]=r[1],W[2]=r[2],W[3]=0,Nt.transformMat4(W,W,e),t[0]=W[0],t[1]=W[1],t[2]=W[2],t),2,m.zero),y.mulPoint=w((t,e,r)=>(W[0]=r[0],W[1]=r[1],W[2]=r[2],W[3]=1,Nt.transformMat4(W,W,e),t[0]=W[0],t[1]=W[1],t[2]=W[2],t),2,m.zero),y.mulPoint2=w((t,e,r)=>(W[0]=r[0],W[1]=r[1],W[2]=0,W[3]=1,Nt.transformMat4(W,W,e),t[0]=W[0],t[1]=W[1],t),2,f.zero),y.mulVector2=w((t,e,r)=>(W[0]=r[0],W[1]=r[1],W[2]=0,W[3]=0,Nt.transformMat4(W,W,e),t[0]=W[0],t[1]=W[1],t),2,f.zero);function gC(t,e,r,g){let i=y.create();return H.ortho(i,-e*t,e*t,-t,t,r,g),i}function iC(...t){if(t.length===4)return gC(...t);let e=y.create();return H.ortho(e,...t),e}y.ortho=iC,y.equal=(t,e)=>t===void 0||e===void 0||!(t instanceof Array||t instanceof Float32Array)||!(e instanceof Array||e instanceof Float32Array)?!1:H.exactEquals(t,e),y.set=w(H.set,1,y.create),y.fill=w((t,e)=>(t[0]=t[1]=t[2]=t[3]=t[4]=t[5]=t[6]=t[7]=t[8]=t[9]=t[10]=t[11]=t[12]=t[13]=t[14]=t[15]=e,t),1,y.create),Number.prototype.__to=function(t){switch(t){case ft:return E(this.valueOf(),this.valueOf(),this.valueOf(),this.valueOf());case Rt:return m(this.valueOf(),this.valueOf(),this.valueOf());case it:return f(this.valueOf(),this.valueOf())}return this.valueOf()};function ue(t,e){let r=Math.max(t.length||0,e.length||0);switch(r){case 2:return typeof t=="number"?f.fill(t):f.set(t);case 3:return typeof t=="number"?f.fill(t):m.set(t);case 4:return typeof t=="number"?f.fill(t):E.set(t);case 16:return typeof t=="number"?f.fill(t):y.set(t)}return console.warn(`Unsupported vector length '${r}'`),new Array}function Qt(t,e,r){if(typeof t=="number"&&typeof e=="number")return t+e;let g=r||ue(t,e);switch(g.length){case 2:return f.plus(g,g,e);case 3:return m.plus(g,g,e);case 4:return E.plus(g,g,e)}return console.warn(`Unsupported vector length '${g.length}'`),E.plus(g,g,e)}function Jt(t,e,r){if(typeof t=="number"&&typeof e=="number")return t+e;let g=r||ue(t,e);switch(g.length){case 2:return f.minus(g,g,e);case 3:return m.minus(g,g,e);case 4:return E.minus(g,g,e)}return console.warn(`Unsupported vector length '${g.length}'`),E.minus(g,g,e)}function Pe(t,e,r){if(typeof t=="number"&&typeof e=="number")return t+e;let g=r||ue(t,e);switch(g.length){case 2:return f.mul(g,g,e);case 3:return m.mul(g,g,e);case 4:return E.mul(g,g,e)}return console.warn(`Unsupported vector length '${g.length}'`),E.mul(g,g,e)}function le(t,e,r){if(typeof t=="number"&&typeof e=="number")return t+e;let g=r||ue(t,e);switch(g.length){case 2:return f.div(g,g,e);case 3:return m.div(g,g,e);case 4:return E.div(g,g,e)}return console.warn(`Unsupported vector length '${g.length}'`),E.div(g,g,e)}function AC(t,e,r=m.zero()){return r[0]=t[1]*e[2]-t[2]*e[1],r[1]=t[2]*e[0]-t[0]*e[2],r[2]=t[0]*e[1]-t[1]*e[0],r}var Fe=180/Math.PI,vt=class{constructor(t,e){this.min=t,this.max=Qt(t,e)}get xMin(){return this.min.x}get yMin(){return this.min.y}get xMax(){return this.max.x}get yMax(){return this.max.y}get width(){return this.max.x-this.min.x}get height(){return this.max.y-this.min.y}get size(){return Jt(this.max,this.min)}get center(){return Qt(this.min,this.max).mul(f(.5))}shrink(t){let e=Qt(this.min,f(t)),r=Jt(this.max,f(t));return e.x>r.x&&(e.x=r.x=(e.x+r.x)/2),e.y>r.y&&(e.y=r.y=(e.y+r.y)/2),new vt(e,r.minus(e))}expand(t){return new vt(Jt(this.min,f(t)),Qt(this.size,f(2*t)))}static box01(){return new vt(f.zero(),f.one())}},Lr;(function(t){(function(e){var r=typeof global=="object"?global:typeof self=="object"?self:typeof this=="object"?this:Function("return this;")(),g=i(t);typeof r.Reflect=="undefined"?r.Reflect=t:g=i(r.Reflect,g),e(g);function i(A,C){return function(s,n){typeof A[s]!="function"&&Object.defineProperty(A,s,{configurable:!0,writable:!0,value:n}),C&&C(s,n)}}})(function(e){var r=Object.prototype.hasOwnProperty,g=typeof Symbol=="function",i=g&&typeof Symbol.toPrimitive!="undefined"?Symbol.toPrimitive:"@@toPrimitive",A=g&&typeof Symbol.iterator!="undefined"?Symbol.iterator:"@@iterator",C=typeof Object.create=="function",s={__proto__:[]}instanceof Array,n=!C&&!s,I={create:C?function(){return Qe(Object.create(null))}:s?function(){return Qe({__proto__:null})}:function(){return Qe({})},has:n?function(l,d){return r.call(l,d)}:function(l,d){return d in l},get:n?function(l,d){return r.call(l,d)?l[d]:void 0}:function(l,d){return l[d]}},o=Object.getPrototypeOf(Function),a=typeof process=="object"&&process.env&&{}.REFLECT_METADATA_USE_MAP_POLYFILL==="true",h=!a&&typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:ns(),u=!a&&typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:Is(),p=!a&&typeof WeakMap=="function"?WeakMap:as(),v=new p;function c(l,d,b,x){if(gt(b)){if(!tg(l))throw new TypeError;if(!eg(d))throw new TypeError;return Z(l,d)}else{if(!tg(l))throw new TypeError;if(!At(d))throw new TypeError;if(!At(x)&&!gt(x)&&!Kt(x))throw new TypeError;return Kt(x)&&(x=void 0),b=Bt(b),tt(l,d,b,x)}}e("decorate",c);function M(l,d){function b(x,R){if(!At(x))throw new TypeError;if(!gt(R)&&!gs(R))throw new TypeError;Ft(l,d,x,R)}return b}e("metadata",M);function z(l,d,b,x){if(!At(b))throw new TypeError;return gt(x)||(x=Bt(x)),Ft(l,d,b,x)}e("defineMetadata",z);function F(l,d,b){if(!At(d))throw new TypeError;return gt(b)||(b=Bt(b)),et(l,d,b)}e("hasMetadata",F);function P(l,d,b){if(!At(d))throw new TypeError;return gt(b)||(b=Bt(b)),V(l,d,b)}e("hasOwnMetadata",P);function D(l,d,b){if(!At(d))throw new TypeError;return gt(b)||(b=Bt(b)),ht(l,d,b)}e("getMetadata",D);function S(l,d,b){if(!At(d))throw new TypeError;return gt(b)||(b=Bt(b)),Pt(l,d,b)}e("getOwnMetadata",S);function $(l,d){if(!At(l))throw new TypeError;return gt(d)||(d=Bt(d)),ie(l,d)}e("getMetadataKeys",$);function Y(l,d){if(!At(l))throw new TypeError;return gt(d)||(d=Bt(d)),Ae(l,d)}e("getOwnMetadataKeys",Y);function q(l,d,b){if(!At(d))throw new TypeError;gt(b)||(b=Bt(b));var x=J(d,b,!1);if(gt(x)||!x.delete(l))return!1;if(x.size>0)return!0;var R=v.get(d);return R.delete(b),R.size>0||v.delete(d),!0}e("deleteMetadata",q);function Z(l,d){for(var b=l.length-1;b>=0;--b){var x=l[b],R=x(d);if(!gt(R)&&!Kt(R)){if(!eg(R))throw new TypeError;d=R}}return d}function tt(l,d,b,x){for(var R=l.length-1;R>=0;--R){var st=l[R],G=st(d,b,x);if(!gt(G)&&!Kt(G)){if(!At(G))throw new TypeError;x=G}}return x}function J(l,d,b){var x=v.get(l);if(gt(x)){if(!b)return;x=new h,v.set(l,x)}var R=x.get(d);if(gt(R)){if(!b)return;R=new h,x.set(d,R)}return R}function et(l,d,b){var x=V(l,d,b);if(x)return!0;var R=Ve(d);return Kt(R)?!1:et(l,R,b)}function V(l,d,b){var x=J(d,b,!1);return gt(x)?!1:es(x.has(l))}function ht(l,d,b){var x=V(l,d,b);if(x)return Pt(l,d,b);var R=Ve(d);if(!Kt(R))return ht(l,R,b)}function Pt(l,d,b){var x=J(d,b,!1);if(!gt(x))return x.get(l)}function Ft(l,d,b,x){var R=J(b,x,!0);R.set(l,d)}function ie(l,d){var b=Ae(l,d),x=Ve(l);if(x===null)return b;var R=ie(x,d);if(R.length<=0)return b;if(b.length<=0)return R;for(var st=new u,G=[],L=0,B=b;L<B.length;L++){var K=B[L],_=st.has(K);_||(st.add(K),G.push(K))}for(var Ut=0,gg=R;Ut<gg.length;Ut++){var K=gg[Ut],_=st.has(K);_||(st.add(K),G.push(K))}return G}function Ae(l,d){var b=[],x=J(l,d,!1);if(gt(x))return b;for(var R=x.keys(),st=is(R),G=0;;){var L=Cs(st);if(!L)return b.length=G,b;var B=As(L);try{b[G]=B}catch(K){try{ss(st)}finally{throw K}}G++}}function $r(l){if(l===null)return 1;switch(typeof l){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return l===null?1:6;default:return 6}}function gt(l){return l===void 0}function Kt(l){return l===null}function ZC(l){return typeof l=="symbol"}function At(l){return typeof l=="object"?l!==null:typeof l=="function"}function $C(l,d){switch($r(l)){case 0:return l;case 1:return l;case 2:return l;case 3:return l;case 4:return l;case 5:return l}var b=d===3?"string":d===5?"number":"default",x=rg(l,i);if(x!==void 0){var R=x.call(l,b);if(At(R))throw new TypeError;return R}return ts(l,b==="default"?"number":b)}function ts(l,d){if(d==="string"){var b=l.toString;if(_t(b)){var x=b.call(l);if(!At(x))return x}var R=l.valueOf;if(_t(R)){var x=R.call(l);if(!At(x))return x}}else{var R=l.valueOf;if(_t(R)){var x=R.call(l);if(!At(x))return x}var st=l.toString;if(_t(st)){var x=st.call(l);if(!At(x))return x}}throw new TypeError}function es(l){return!!l}function rs(l){return""+l}function Bt(l){var d=$C(l,3);return ZC(d)?d:rs(d)}function tg(l){return Array.isArray?Array.isArray(l):l instanceof Object?l instanceof Array:Object.prototype.toString.call(l)==="[object Array]"}function _t(l){return typeof l=="function"}function eg(l){return typeof l=="function"}function gs(l){switch($r(l)){case 3:return!0;case 4:return!0;default:return!1}}function rg(l,d){var b=l[d];if(b!=null){if(!_t(b))throw new TypeError;return b}}function is(l){var d=rg(l,A);if(!_t(d))throw new TypeError;var b=d.call(l);if(!At(b))throw new TypeError;return b}function As(l){return l.value}function Cs(l){var d=l.next();return d.done?!1:d}function ss(l){var d=l.return;d&&d.call(l)}function Ve(l){var d=Object.getPrototypeOf(l);if(typeof l!="function"||l===o||d!==o)return d;var b=l.prototype,x=b&&Object.getPrototypeOf(b);if(x==null||x===Object.prototype)return d;var R=x.constructor;return typeof R!="function"||R===l?d:R}function ns(){var l={},d=[],b=function(){function G(L,B,K){this._index=0,this._keys=L,this._values=B,this._selector=K}return G.prototype["@@iterator"]=function(){return this},G.prototype[A]=function(){return this},G.prototype.next=function(){var L=this._index;if(L>=0&&L<this._keys.length){var B=this._selector(this._keys[L],this._values[L]);return L+1>=this._keys.length?(this._index=-1,this._keys=d,this._values=d):this._index++,{value:B,done:!1}}return{value:void 0,done:!0}},G.prototype.throw=function(L){throw this._index>=0&&(this._index=-1,this._keys=d,this._values=d),L},G.prototype.return=function(L){return this._index>=0&&(this._index=-1,this._keys=d,this._values=d),{value:L,done:!0}},G}();return function(){function G(){this._keys=[],this._values=[],this._cacheKey=l,this._cacheIndex=-2}return Object.defineProperty(G.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),G.prototype.has=function(L){return this._find(L,!1)>=0},G.prototype.get=function(L){var B=this._find(L,!1);return B>=0?this._values[B]:void 0},G.prototype.set=function(L,B){var K=this._find(L,!0);return this._values[K]=B,this},G.prototype.delete=function(L){var B=this._find(L,!1);if(B>=0){for(var K=this._keys.length,_=B+1;_<K;_++)this._keys[_-1]=this._keys[_],this._values[_-1]=this._values[_];return this._keys.length--,this._values.length--,L===this._cacheKey&&(this._cacheKey=l,this._cacheIndex=-2),!0}return!1},G.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=l,this._cacheIndex=-2},G.prototype.keys=function(){return new b(this._keys,this._values,x)},G.prototype.values=function(){return new b(this._keys,this._values,R)},G.prototype.entries=function(){return new b(this._keys,this._values,st)},G.prototype["@@iterator"]=function(){return this.entries()},G.prototype[A]=function(){return this.entries()},G.prototype._find=function(L,B){return this._cacheKey!==L&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=L)),this._cacheIndex<0&&B&&(this._cacheIndex=this._keys.length,this._keys.push(L),this._values.push(void 0)),this._cacheIndex},G}();function x(G,L){return G}function R(G,L){return L}function st(G,L){return[G,L]}}function Is(){return function(){function l(){this._map=new h}return Object.defineProperty(l.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),l.prototype.has=function(d){return this._map.has(d)},l.prototype.add=function(d){return this._map.set(d,d),this},l.prototype.delete=function(d){return this._map.delete(d)},l.prototype.clear=function(){this._map.clear()},l.prototype.keys=function(){return this._map.keys()},l.prototype.values=function(){return this._map.values()},l.prototype.entries=function(){return this._map.entries()},l.prototype["@@iterator"]=function(){return this.keys()},l.prototype[A]=function(){return this.keys()},l}()}function as(){var l=16,d=I.create(),b=x();return function(){function B(){this._key=x()}return B.prototype.has=function(K){var _=R(K,!1);return _!==void 0?I.has(_,this._key):!1},B.prototype.get=function(K){var _=R(K,!1);return _!==void 0?I.get(_,this._key):void 0},B.prototype.set=function(K,_){var Ut=R(K,!0);return Ut[this._key]=_,this},B.prototype.delete=function(K){var _=R(K,!1);return _!==void 0?delete _[this._key]:!1},B.prototype.clear=function(){this._key=x()},B}();function x(){var B;do B="@@WeakMap@@"+L();while(I.has(d,B));return d[B]=!0,B}function R(B,K){if(!r.call(B,b)){if(!K)return;Object.defineProperty(B,b,{value:I.create()})}return B[b]}function st(B,K){for(var _=0;_<K;++_)B[_]=Math.random()*255|0;return B}function G(B){return typeof Uint8Array=="function"?typeof crypto!="undefined"?crypto.getRandomValues(new Uint8Array(B)):typeof msCrypto!="undefined"?msCrypto.getRandomValues(new Uint8Array(B)):st(new Uint8Array(B),B):st(new Array(B),B)}function L(){var B=G(l);B[6]=B[6]&79|64,B[8]=B[8]&191|128;for(var K="",_=0;_<l;++_){var Ut=B[_];(_===4||_===6||_===8)&&(K+="-"),Ut<16&&(K+="0"),K+=Ut.toString(16).toLowerCase()}return K}}function Qe(l){return l.__=void 0,delete l.__,l}})})(Lr||(Lr={}));function ce(t,e){if(t===null)throw new Error(e);return t}function bt(t){throw new Error(t)}function CC(t,e,r){let g={};for(let i in r)g[i]=t.getUniformLocation(e,r[i]);return g}var Or=class{constructor(){this.gl=null,this.width=0,this.height=0,this.assets=null,this.renderer=null}},kr,Vr=t=>kr=t,j=()=>kr,Yt=()=>{var t;return(t=j())===null||t===void 0?void 0:t.gl},sC=`#version 300 es\r
precision mediump float;\r
\r
in vec3 aPos;\r
in vec4 aColor;\r
in vec2 aUV;\r
in vec3 aNormal;\r
\r
uniform mat4 uTransformM;\r
uniform mat4 uTransformVP;\r
uniform mat4 uTransformMVP;\r
\r
out vec4 vColor;\r
out vec4 vPos;\r
out vec2 vUV;\r
out vec3 vNormal;\r
\r
void main()\r
{\r
    gl_Position = uTransformMVP * vec4(aPos, 1);\r
    vColor = aColor;\r
    vUV = aUV;\r
    vNormal = aNormal;\r
}`,nC=`#version 300 es\r
precision mediump float;\r
\r
in vec4 vColor;\r
in vec4 vPos;\r
in vec2 vUV;\r
\r
uniform sampler2D uMainTex;\r
uniform vec4 uColor;\r
\r
out vec4 fragColor;\r
\r
void main()\r
{\r
    vec4 color = texture(uMainTex, vUV.xy).rgba;\r
    color = color * vColor * uColor;\r
    fragColor = color;\r
}`,IC=`#version 300 es\r
precision mediump float;\r
\r
in vec4 vColor;\r
in vec4 vPos;\r
in vec2 vUV;\r
in vec3 vNormal;\r
\r
uniform sampler2D uMainTex;\r
\r
out vec4 fragColor;\r
\r
void main()\r
{\r
    fragColor = texture(uMainTex, vUV).rgba;\r
}`,aC=`#version 300 es\r
precision mediump float;\r
\r
in vec4 vColor;\r
in vec4 vPos;\r
\r
out vec4 fragColor;\r
\r
void main()\r
{\r
    fragColor = vColor;\r
}`,oC=`#version 300 es\r
precision mediump float;\r
\r
in vec3 aPos;\r
in vec4 aColor;\r
\r
uniform mat4 uTransformM;\r
uniform mat4 uTransformVP;\r
uniform mat4 uTransformMVP;\r
\r
out vec4 vColor;\r
out vec4 vPos;\r
\r
void main()\r
{\r
    gl_Position = uTransformMVP * vec4(aPos, 1);\r
    vColor = aColor;\r
}`,hC=`#version 300 es\r
precision mediump float;\r
\r
in vec3 aPos;\r
in vec2 aUV;\r
\r
out vec2 vUV;\r
\r
void main()\r
{\r
    gl_Position = vec4(aPos, 1);\r
    vUV = vec2(aUV.x, vec2(1) - aUV.y);\r
}`,uC=`#version 300 es\r
precision mediump float;\r
\r
in vec4 vPos;\r
in vec2 vUV;\r
\r
uniform sampler2D uMainTex;\r
\r
out vec4 fragColor;\r
\r
void main()\r
{\r
    fragColor = texture(uMainTex, vUV).rgba;\r
}`,mt={defaultVert:sC,defaultFrag:nC,blitCopy:IC,colorFrag:aC,colorVert:oC,flipVert:hC,texFrag:uC},Wt={matM:"uTransformM",matM_IT:"uTransformM_IT",matMInv:"uTransformMInv",matVP:"uTransformVP",matMVP:"uTransformMVP",matMV_IT:"uTransformMV_IT",flipUV:"uFlipUV",mainTex:"uMainTex",color:"uColor"};function lC(t){return{DefaultShader:new lt(mt.defaultVert,mt.defaultFrag,{name:"DefaultShader"},t),BlitCopy:new lt(mt.defaultVert,mt.blitCopy,{name:"BlitCopy",depth:xt.Always,blend:U.Disable,zWrite:!1},t),FlipTexture:new lt(mt.flipVert,mt.blitCopy,{},t),ColoredLine:new lt(mt.colorVert,mt.colorFrag,{blend:[U.SrcAlpha,U.OneMinusSrcAlpha],depth:xt.Disable,zWrite:!1},t),ErrorShader:new lt(mt.defaultVert,mt.texFrag,{name:"Error"},t)}}var cC=class{constructor(){this.listeners=new Map}on(t,e){var r;this.listeners.has(t)||this.listeners.set(t,[]),(r=this.listeners.get(t))===null||r===void 0||r.push(e)}off(t,e){var r,g;this.listeners.has(t)&&this.listeners.set(t,(g=(r=this.listeners.get(t))===null||r===void 0?void 0:r.filter(i=>i!==e))!==null&&g!==void 0?g:[])}emit(t,...e){var r;(r=this.listeners.get(t))===null||r===void 0||r.forEach(g=>g(...e))}with(){return this}},qt=class{constructor(t){this.destroyed=!1,this.assetID=fe.newAssetID(this),this.name=t||`Asset_${this.assetID}`}destroy(){this.destroyed=!0,fe.destroy(this.assetID)}valid(){return!this.destroyed}},Qr=class extends qt{constructor(t=j(),e){super(e),this.initialized=!1,this.ctx=t}tryInit(t=!1){if(this.initialized)return!0;this.ctx||(this.ctx=j());let e=this.ctx&&this.init();if(!e&&t)throw new Error(`Failed to init GPU Asset '${this.name}' without global gl context.`);return this.initialized=e,e}},fC=class{constructor(){this.assetsMap=new Map,this.id=1,this.eventEmitter=new cC}newAssetID(t){let e=++this.id;return this.assetsMap.set(e,t),t.assetID=e}find(t){if(typeof t=="number")return this.assetsMap.get(t);if(typeof t=="string"){for(let e of this.assetsMap.values())if(e.name===t)return e}}destroy(t){!this.assetsMap.get(t)||this.assetsMap.delete(t)}destroyAll(){for(let[t,e]of this.assetsMap)e.destroy();this.assetsMap=new Map}findAssetsOfType(t){return Array.from(this.assetsMap.values()).filter(e=>e instanceof t)}on(t,e){return this.eventEmitter.on(t,e)}off(t,e){return this.eventEmitter.off(t,e)}},fe=new fC;function ys(t){return t}var Ue={float:1,vec2:2,vec3:3,vec4:4,mat4:16,int:1,ivec2:2,ivec3:3,ivec4:4},ze={from(t){let e={elements:[],byteSize:0,totalSize:0},r=0;for(let g in t){let i={key:g,type:t[g],location:r,length:Ue[t[g]]};i.byteLength=i.length*4,i.offset=e.totalSize,i.byteOffset=e.byteSize,e.totalSize+=i.length,e.byteSize+=i.byteLength,e.elements.push(i),r+=t[g]==="mat4"?4:1}return e}},Zt=class extends Array{constructor(t,e,r=!0,g=j()){super(e),this.static=!0,this.Data=null,this.dirty=!1,this.initialized=!1,this.destroyed=!1,this.glBuf=null,this.swapBuffer=null,this.structure=ze.from(t),this.ctx=g,this.innerBuffer=null,this.resize(e,r),this.tryInit(!1),this.assetID=fe.newAssetID(this),this.name=`GLArrayBuffer_${this.assetID}`}get byteLength(){return this.length*this.structure.byteSize}valid(){return!this.destroyed}resize(t,e=!0,r=!0){let g=this.innerBuffer;if(this.innerBuffer=new Float32Array(this.structure.totalSize*t),e&&g&&(g.length>this.innerBuffer.length?this.innerBuffer.set(new Float32Array(g.buffer,0,this.innerBuffer.length)):this.innerBuffer.set(g,0)),this.length=t,r)for(let i=0;i<this.length;i++){let A={};for(let C of this.structure.elements){let s=i*this.structure.byteSize+C.byteOffset;switch(C.type){case"float":case"vec2":case"vec3":case"vec4":case"mat4":A[C.key]=new Float32Array(this.innerBuffer.buffer,s,Ue[C.type]);break;case"int":case"ivec2":case"ivec3":case"ivec4":A[C.key]=new Int32Array(this.innerBuffer.buffer,s,Ue[C.type]);break;default:console.warn(`Unknown element type '${C.type}'`)}}this[i]=A}this.dirty=!0}copyFrom(t,e=0,r=0,g=t.length){let i=e*this.structure.byteSize,A=this.innerBuffer.buffer.byteLength-i,C=r*t.structure.byteSize,s=(g-r)*t.structure.byteSize,n=Math.min(A,s),I=new Uint8Array(this.innerBuffer.buffer,i,n),o=new Uint8Array(t.innerBuffer.buffer,C,n);I.set(o)}swapVertices(t,e){this.swapBuffer||(this.swapBuffer=new Float32Array(this.structure.totalSize));let r=t*this.structure.byteSize,g=e*this.structure.byteSize,i=this.swapBuffer,A=new Float32Array(this.innerBuffer.buffer,r,this.structure.totalSize);i.set(A);let C=new Float32Array(this.innerBuffer.buffer,g,this.structure.totalSize);this.innerBuffer.set(C,t*this.structure.totalSize),this.innerBuffer.set(i,e*this.structure.totalSize)}markDirty(){this.dirty=!0}upload(t=!1){if(this.tryInit(!0),!this.dirty&&!t&&this.static)return!1;let e=this.ctx.gl;return e.bindBuffer(e.ARRAY_BUFFER,this.glBuf),e.bufferData(e.ARRAY_BUFFER,this.innerBuffer,this.static?e.STATIC_DRAW:e.DYNAMIC_DRAW),this.dirty=!1,!0}bind(){this.tryInit(!0);let t=this.ctx.gl;this.upload(),t.bindBuffer(t.ARRAY_BUFFER,this.glBuf)}bindVertexArray(t=!1,e){this.tryInit(!0);let r=this.ctx.gl;this.upload(),r.bindBuffer(r.ARRAY_BUFFER,this.glBuf);for(let g of this.structure.elements){let i=e?e[g.key]||-1:g.location;if(!(i<0))switch(g.type){case"float":case"vec2":case"vec3":case"vec4":r.enableVertexAttribArray(i),r.vertexAttribPointer(i,g.length,r.FLOAT,!1,this.structure.byteSize,g.byteOffset),t&&r.vertexAttribDivisor(i,1);break;case"int":case"ivec2":case"ivec3":case"ivec4":r.enableVertexAttribArray(i),r.vertexAttribIPointer(i,g.length,r.INT,this.structure.byteSize,g.byteOffset),t&&r.vertexAttribDivisor(i,1);break;case"mat4":r.enableVertexAttribArray(i+0),r.enableVertexAttribArray(i+1),r.enableVertexAttribArray(i+2),r.enableVertexAttribArray(i+3),r.vertexAttribPointer(i+0,4,r.FLOAT,!1,this.structure.byteSize,g.byteOffset+0*16),r.vertexAttribPointer(i+1,4,r.FLOAT,!1,this.structure.byteSize,g.byteOffset+1*16),r.vertexAttribPointer(i+2,4,r.FLOAT,!1,this.structure.byteSize,g.byteOffset+2*16),r.vertexAttribPointer(i+3,4,r.FLOAT,!1,this.structure.byteSize,g.byteOffset+3*16),t&&(r.vertexAttribDivisor(i+0,1),r.vertexAttribDivisor(i+1,1),r.vertexAttribDivisor(i+2,1),r.vertexAttribDivisor(i+3,1));break;default:console.warn(`Unknown attribute type '${g.type}'`)}}}unbindVertexArray(t=!1,e){this.tryInit(!0);let r=this.ctx.gl;for(let g of this.structure.elements){let i=e?e[g.key]||-1:g.location;i<0||(g.type==="mat4"?(r.disableVertexAttribArray(i+0),r.disableVertexAttribArray(i+1),r.disableVertexAttribArray(i+2),r.disableVertexAttribArray(i+3),t&&(r.vertexAttribDivisor(i+0,0),r.vertexAttribDivisor(i+1,0),r.vertexAttribDivisor(i+2,0),r.vertexAttribDivisor(i+3,0))):(r.disableVertexAttribArray(i),t&&r.vertexAttribDivisor(i,0)))}}unbind(){this.tryInit(!0);let t=this.ctx.gl;t.bindBuffer(t.ARRAY_BUFFER,null),t.bindVertexArray(null)}destroy(){if(this.destroyed||!this.initialized)return;let t=this.ctx.gl;this.length=0,t.deleteBuffer(this.glBuf),this.destroyed=!0,this.initialized=!1}tryInit(t=!1){var e;if(this.destroyed)throw new Error("Attempt to use destroyed array buffer.");if(this.initialized)return!0;let r=this.ctx||j();if(!r){if(t)throw new Error("Failed to init render buffer without a global GL context.");return!1}this.ctx=r;let g=r.gl;return this.glBuf=(e=g.createBuffer())!==null&&e!==void 0?e:bt("Failed to create render buffer"),g.bindBuffer(g.ARRAY_BUFFER,this.glBuf),g.bufferData(g.ARRAY_BUFFER,this.byteLength,this.static?g.STATIC_DRAW:g.DYNAMIC_DRAW),g.bindBuffer(g.ARRAY_BUFFER,null),this.initialized=!0,!0}},Lt={vert:"vec3",color:"vec4",normal:"vec3",uv:"vec2",uv2:"vec2"};ze.from(Lt);var de=class extends qt{constructor(...t){super("Mesh"),this.ctx=null,this.initialized=!1,this.vertexArray=null,this.elementBuffer=null,this.dirty=!0,this.indices=new Uint32Array,t.length===0?(this.ctx=j(),this.vertices=new Zt(Lt,0,!0,this.ctx)):t.length===1?t[0]instanceof Or?(this.ctx=t[0],this.vertices=new Zt(Lt,0,!0,this.ctx)):(this.ctx=j(),this.vertices=new Zt(t[0],0,!0,this.ctx)):(this.ctx=t[1]||j(),this.vertices=new Zt(t[0],0,!0,this.ctx)),this.tryInit(!1)}get verts(){return this.getVertexDataArray("vert",m.zero)}set verts(t){this.setVertexDataArray("vert",t)}get uvs(){return this.getVertexDataArray("uv",f.zero)}set uvs(t){this.setVertexDataArray("uv",t)}get colors(){return this.getVertexDataArray("color",()=>X.black)}set colors(t){this.setVertexDataArray("color",t)}get normals(){return this.getVertexDataArray("uv2",m.zero)}set normals(t){this.setVertexDataArray("normal",t)}get uv2(){return this.getVertexDataArray("uv2",f.zero)}set uv2(t){this.setVertexDataArray("uv2",t)}get triangles(){return Array.from(this.indices)}set triangles(t){t.length>this.indices.length&&(this.indices=new Uint32Array(t.length)),this.indices.set(t)}getVertexDataArray(t,e){return this.vertices.map(r=>e().set(r[t]))}setVertexDataArray(t,e){this.vertices,e.length>=this.vertices.length&&this.vertices.resize(e.length),e.forEach((r,g)=>this.vertices[g][t].set(r))}resize(t,e,r=!1){this.vertices.resize(t,r);let g=this.indices;this.indices=new Uint32Array(e),r&&(e<g.length&&(g=new Uint32Array(g.buffer,0,e)),this.indices.set(g,0)),this.dirty=!0}update(t=!1){this.dirty=!0,this.vertices.markDirty(),t&&this.upload()}upload(){if(this.tryInit(!0),!this.dirty)return!1;let t=this.ctx.gl;return this.vertices.upload(),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.elementBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.indices,t.STATIC_DRAW),this.dirty=!1,!0}bind(){this.upload();let t=this.ctx.gl;return t.bindVertexArray(this.vertexArray),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.elementBuffer),this.indices.length}unbind(){this.tryInit(!0);let t=this.ctx.gl;t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null),t.bindVertexArray(null)}calculateNormals(t=0){if(this.triangles.length%3!=0)throw new Error("Invalid triangles.");for(let e=0;e<this.triangles.length;e+=3){let r=this.vertices[this.triangles[e+0]].vert,g=this.vertices[this.triangles[e+1]].vert,i=this.vertices[this.triangles[e+2]].vert,A=Jt(g,r),C=Jt(i,r),s=AC(A,C).normalize();m.plus(this.vertices[this.triangles[e+0]].normal,this.vertices[this.triangles[e+0]].normal,s),m.plus(this.vertices[this.triangles[e+1]].normal,this.vertices[this.triangles[e+1]].normal,s),m.plus(this.vertices[this.triangles[e+2]].normal,this.vertices[this.triangles[e+2]].normal,s)}for(let e=0;e<this.vertices.length;e++)m.normalize(this.vertices[e].normal,this.vertices[e].normal)}destroy(){if(super.destroy(),this.destroyed)return;this.vertices.destroy();let t=this.ctx.gl;t.deleteBuffer(this.elementBuffer),t.deleteVertexArray(this.vertexArray),this.destroyed=!0,this.initialized=!1}tryInit(t=!1){var e,r;if(this.initialized)return!0;if(this.destroyed)throw new Error("Attempt to use destroyed mesh");if(this.ctx=this.ctx||j(),!this.ctx){if(t)throw new Error("Failed to init mesh without global GL context");return!1}let g=this.ctx.gl;return this.elementBuffer=(e=g.createBuffer())!==null&&e!==void 0?e:bt("Failed to create element buffer object."),this.vertexArray=(r=g.createVertexArray())!==null&&r!==void 0?r:bt("Failed to create vertex array object."),g.bindBuffer(g.ELEMENT_ARRAY_BUFFER,this.elementBuffer),g.bindVertexArray(this.vertexArray),this.vertices.bindVertexArray(),g.bindVertexArray(null),this.initialized=!0,!0}},xt;(function(t){t[t.Disable=-1]="Disable",t[t.Always=WebGL2RenderingContext.ALWAYS]="Always",t[t.Never=WebGL2RenderingContext.NEVER]="Never",t[t.Less=WebGL2RenderingContext.LESS]="Less",t[t.Equal=WebGL2RenderingContext.EQUAL]="Equal",t[t.LEqual=WebGL2RenderingContext.LEQUAL]="LEqual",t[t.Greater=WebGL2RenderingContext.GREATER]="Greater",t[t.NotEqual=WebGL2RenderingContext.NOTEQUAL]="NotEqual",t[t.GEqual=WebGL2RenderingContext.GEQUAL]="GEqual"})(xt||(xt={}));var U;(function(t){t[t.Disable=-1]="Disable",t[t.Zero=WebGL2RenderingContext.ZERO]="Zero",t[t.One=WebGL2RenderingContext.ONE]="One",t[t.SrcColor=WebGL2RenderingContext.SRC_COLOR]="SrcColor",t[t.OneMinusSrcColor=WebGL2RenderingContext.ONE_MINUS_SRC_COLOR]="OneMinusSrcColor",t[t.DstColor=WebGL2RenderingContext.DST_COLOR]="DstColor",t[t.OneMinusDstColor=WebGL2RenderingContext.ONE_MINUS_DST_COLOR]="OneMinusDstColor",t[t.SrcAlpha=WebGL2RenderingContext.SRC_ALPHA]="SrcAlpha",t[t.OneMinusSrcAlpha=WebGL2RenderingContext.ONE_MINUS_SRC_ALPHA]="OneMinusSrcAlpha",t[t.DstAlpha=WebGL2RenderingContext.DST_ALPHA]="DstAlpha",t[t.OneMinusDstAlpha=WebGL2RenderingContext.ONE_MINUS_DST_ALPHA]="OneMinusDstAlpha"})(U||(U={}));var $t;(function(t){t[t.Disable=-1]="Disable",t[t.Back=WebGL2RenderingContext.BACK]="Back",t[t.Front=WebGL2RenderingContext.FRONT]="Front",t[t.Both=WebGL2RenderingContext.FRONT_AND_BACK]="Both"})($t||($t={}));var Wr={vert:"aPos",color:"aColor",uv:"aUV",uv2:"aUV2",normal:"aNormal"},lt=class extends qt{constructor(t,e,r={},g=Yt()){super(r.name),this.attributes={},this.initialized=!1,this.gl=null,this.program=null,this.vertexShader=null,this.fragmentShader=null,this.pipelineStates={},this.builtinUniformLocations=null,this._compiled=!1,r.name||(this.name=`Shader_${this.assetID}`),this.vertexShaderSource=t,this.fragmentShaderSouce=e,this.options=r,this.gl=g,this.vertexStruct=ze.from(this.options.vertexStructure||Lt),this.attributeNames=Object.assign(Object.assign({},Wr),r.attributes),this.setPipelineStateInternal(this.options),this.tryInit()}get compiled(){return this._compiled}uniformLocation(t){return this.tryInit(!0),this.gl.getUniformLocation(this.program,t)}use(){this.tryInit(!0),this.gl.useProgram(this.program)}setupBuiltinUniform(t){this.tryInit(!0);let e=this.gl;this.builtinUniformLocations.matM&&e.uniformMatrix4fv(this.builtinUniformLocations.matM,!1,t.matM.asMut()),this.builtinUniformLocations.matVP&&e.uniformMatrix4fv(this.builtinUniformLocations.matVP,!1,t.matVP.asMut()),this.builtinUniformLocations.matMVP&&e.uniformMatrix4fv(this.builtinUniformLocations.matMVP,!1,t.matMVP.asMut()),this.builtinUniformLocations.matM_IT&&e.uniformMatrix4fv(this.builtinUniformLocations.matM_IT,!1,t.matM_IT.asMut()),this.builtinUniformLocations.matMV_IT&&e.uniformMatrix4fv(this.builtinUniformLocations.matMV_IT,!1,t.matMV_IT.asMut())}clone(){return new lt(this.vertexShaderSource,this.fragmentShaderSouce,this.options)}setPipelineStateInternal(t){let e=!1,r=[U.One,U.Zero],g=[U.One,U.OneMinusSrcAlpha];typeof t.blend=="number"&&t.blend!==U.Disable?(e=!0,r=[t.blend,t.blend],g=[t.blend,t.blend]):t.blend instanceof Array&&(e=!0,r=t.blend),t.blendRGB&&(e=t.blend!==!1&&t.blend!==U.Disable,r=t.blendRGB),t.blendAlpha&&(e=t.blend!==!1&&t.blend!==U.Disable,g=t.blendAlpha),this.pipelineStates={depth:t.depth||xt.Less,blend:e,blendRGB:r,blendAlpha:g,zWrite:t.zWrite!==!1,cull:t.cull||$t.Back}}_internal(){return this.tryInit(!0),{options:this.options}}tryInit(t=!1){if(this.initialized)return!0;let e=this.gl||Yt();if(!e)return t?bt("Failed to init shader without a global GL context"):!1;this.gl=e,this.program=ce(e.createProgram(),"Failed to create shader program"),this.vertexShader=ce(e.createShader(e.VERTEX_SHADER),"Failed to create vertex shader"),this.fragmentShader=ce(e.createShader(e.FRAGMENT_SHADER),"Failed to create fragment shader"),this.compile(),e.useProgram(this.program);let r=Object.assign(Object.assign({},Wr),this.options.attributes);this.attributes={};for(let g in r)this.attributes[g]=e.getAttribLocation(this.program,r[g]);return this.builtinUniformLocations=CC(e,this.program,Wt),this.initialized=!0,!0}compile(){if(this.gl.shaderSource(this.vertexShader,this.vertexShaderSource),this.gl.compileShader(this.vertexShader),!this.gl.getShaderParameter(this.vertexShader,this.gl.COMPILE_STATUS))throw new Error(`Failed to compile vertex shader:\r
`+this.gl.getShaderInfoLog(this.vertexShader));if(this.gl.shaderSource(this.fragmentShader,this.fragmentShaderSouce),this.gl.compileShader(this.fragmentShader),!this.gl.getShaderParameter(this.fragmentShader,this.gl.COMPILE_STATUS))throw new Error(`Failed to compile fragment shader:\r
`+this.gl.getShaderInfoLog(this.fragmentShader));this.gl.attachShader(this.program,this.vertexShader),this.gl.attachShader(this.program,this.fragmentShader);for(let t of this.vertexStruct.elements)this.attributeNames[t.key]&&this.gl.bindAttribLocation(this.program,t.location,this.attributeNames[t.key]);if(this.gl.linkProgram(this.program),!this.gl.getProgramParameter(this.program,this.gl.LINK_STATUS))throw new Error(`Failed to link shader program:\r
`+this.gl.getProgramInfoLog(this.program))}},T;(function(t){t[t.RGB=WebGL2RenderingContext.RGB]="RGB",t[t.RGBA=WebGL2RenderingContext.RGBA]="RGBA",t[t.LUMINANCE_ALPHA=WebGL2RenderingContext.LUMINANCE_ALPHA]="LUMINANCE_ALPHA",t[t.LUMINANCE=WebGL2RenderingContext.LUMINANCE]="LUMINANCE",t[t.ALPHA=WebGL2RenderingContext.ALPHA]="ALPHA",t[t.R8=WebGL2RenderingContext.R8]="R8",t[t.R16F=WebGL2RenderingContext.R16F]="R16F",t[t.R32F=WebGL2RenderingContext.R32F]="R32F",t[t.R8UI=WebGL2RenderingContext.R8UI]="R8UI",t[t.RG8=WebGL2RenderingContext.RG8]="RG8",t[t.RG16F=WebGL2RenderingContext.RG16F]="RG16F",t[t.RG32F=WebGL2RenderingContext.RG32F]="RG32F",t[t.RG8UI=WebGL2RenderingContext.RG8UI]="RG8UI",t[t.RGB8=WebGL2RenderingContext.RGB8]="RGB8",t[t.SRGB8=WebGL2RenderingContext.SRGB8]="SRGB8",t[t.RGB565=WebGL2RenderingContext.RGB565]="RGB565",t[t.R11F_G11F_B10F=WebGL2RenderingContext.R11F_G11F_B10F]="R11F_G11F_B10F",t[t.RGB9_E5=WebGL2RenderingContext.RGB9_E5]="RGB9_E5",t[t.RGB16F=WebGL2RenderingContext.RGB16F]="RGB16F",t[t.RGB32F=WebGL2RenderingContext.RGB32F]="RGB32F",t[t.RGB8UI=WebGL2RenderingContext.RGB8UI]="RGB8UI",t[t.RGBA8=WebGL2RenderingContext.RGBA8]="RGBA8",t[t.SRGB8_ALPHA8=WebGL2RenderingContext.SRGB8_ALPHA8]="SRGB8_ALPHA8",t[t.RGB5_A1=WebGL2RenderingContext.RGB5_A1]="RGB5_A1",t[t.RGB10_A2=WebGL2RenderingContext.RGB10_A2]="RGB10_A2",t[t.RGBA4=WebGL2RenderingContext.RGBA4]="RGBA4",t[t.RGBA16F=WebGL2RenderingContext.RGBA16F]="RGBA16F",t[t.RGBA32F=WebGL2RenderingContext.RGBA32F]="RGBA32F",t[t.RGBA8UI=WebGL2RenderingContext.RGBA8UI]="RGBA8UI",t[t.DEPTH_COMPONENT=WebGL2RenderingContext.DEPTH_COMPONENT]="DEPTH_COMPONENT",t[t.DEPTH_STENCIL=WebGL2RenderingContext.DEPTH_STENCIL]="DEPTH_STENCIL",t[t.DEPTH24_STENCIL8=WebGL2RenderingContext.DEPTH24_STENCIL8]="DEPTH24_STENCIL8",t[t.DEPTH32F_STENCIL8=WebGL2RenderingContext.DEPTH32F_STENCIL8]="DEPTH32F_STENCIL8",t[t.DEPTH_COMPONENT24=WebGL2RenderingContext.DEPTH_COMPONENT24]="DEPTH_COMPONENT24",t[t.DEPTH_COMPONENT32F=WebGL2RenderingContext.DEPTH_COMPONENT32F]="DEPTH_COMPONENT32F"})(T||(T={}));function jr(t,e){return{[T.RGB]:[t.RGB,t.RGB,t.UNSIGNED_BYTE],[T.RGBA]:[t.RGBA,t.RGBA,t.UNSIGNED_BYTE],[T.LUMINANCE_ALPHA]:[t.LUMINANCE_ALPHA,t.LUMINANCE_ALPHA,t.UNSIGNED_BYTE],[T.LUMINANCE]:[t.LUMINANCE,t.LUMINANCE,t.UNSIGNED_BYTE],[T.ALPHA]:[t.ALPHA,t.ALPHA,t.UNSIGNED_BYTE],[T.R8]:[t.R8,t.RED,t.UNSIGNED_BYTE],[T.R16F]:[t.R16F,t.RED,t.HALF_FLOAT],[T.R32F]:[t.R32F,t.RED,t.FLOAT],[T.R8UI]:[t.R8UI,t.RED_INTEGER,t.UNSIGNED_BYTE],[T.RG8]:[t.RG8,t.RG,t.UNSIGNED_BYTE],[T.RG16F]:[t.RG16F,t.RG,t.HALF_FLOAT],[T.RG32F]:[t.RG32F,t.RG,t.FLOAT],[T.RG8UI]:[t.RG8UI,t.RG_INTEGER,t.UNSIGNED_BYTE],[T.RGB8]:[t.RGB8,t.RGB,t.UNSIGNED_BYTE],[T.SRGB8]:[t.SRGB8,t.RGB,t.UNSIGNED_BYTE],[T.RGB565]:[t.RGB565,t.RGB,t.UNSIGNED_BYTE],[T.R11F_G11F_B10F]:[t.R11F_G11F_B10F,t.RGB,t.UNSIGNED_INT_10F_11F_11F_REV],[T.RGB9_E5]:[t.RGB9_E5,t.RGB,t.HALF_FLOAT],[T.RGB16F]:[t.RGB16F,t.RGB,t.HALF_FLOAT],[T.RGB32F]:[t.RGB32F,t.RGB,t.FLOAT],[T.RGB8UI]:[t.RGB8UI,t.RGB_INTEGER,t.UNSIGNED_BYTE],[T.RGBA8]:[t.RGBA8,t.RGBA,t.UNSIGNED_BYTE],[T.SRGB8_ALPHA8]:[t.SRGB8_ALPHA8,t.RGBA,t.UNSIGNED_BYTE],[T.RGB5_A1]:[t.RGB5_A1,t.RGBA,t.UNSIGNED_BYTE],[T.RGB10_A2]:[t.RGB10_A2,t.RGBA,t.UNSIGNED_INT_2_10_10_10_REV],[T.RGBA4]:[t.RGBA4,t.RGBA,t.UNSIGNED_BYTE],[T.RGBA16F]:[t.RGBA16F,t.RGBA,t.HALF_FLOAT],[T.RGBA32F]:[t.RGBA32F,t.RGBA,t.FLOAT],[T.RGBA8UI]:[t.RGBA8UI,t.RGBA_INTEGER,t.UNSIGNED_BYTE],[T.DEPTH_COMPONENT]:[t.DEPTH_COMPONENT,t.DEPTH_COMPONENT,t.UNSIGNED_INT],[T.DEPTH_STENCIL]:[t.DEPTH_STENCIL,t.DEPTH_COMPONENT,t.UNSIGNED_INT],[T.DEPTH_COMPONENT24]:[t.DEPTH_COMPONENT24,t.DEPTH_COMPONENT,t.UNSIGNED_INT],[T.DEPTH_COMPONENT32F]:[t.DEPTH_COMPONENT32F,t.DEPTH_COMPONENT,t.FLOAT]}[e]}var Ct;(function(t){t[t.Stretch=1]="Stretch",t[t.Cover=2]="Cover",t[t.Contain=3]="Contain",t[t.KeepLower=4]="KeepLower",t[t.KeepHigher=5]="KeepHigher",t[t.Center=6]="Center"})(Ct||(Ct={}));function Kr(t,e,r){let g=new vt(f.zero(),t),i=new vt(f.zero(),e);if(r===Ct.Contain){let A=t.x/t.y,C=e.x/e.y;if(A>C){let s=e.y-t.y*(e.x/t.x);i.min.y+=s/2,i.max.y-=s/2}else{let s=e.x-t.x*(e.y/t.y);i.min.x+=s/2,i.max.x-=s/2}}else if(r===Ct.Cover){let A=t.x/t.y,C=e.x/e.y;if(A>C){let s=t.x-e.x*(t.y/e.y);g.min.x+=s/2,g.max.x-=s/2}else{let s=t.y-e.y*(t.x/e.x);g.min.y+=s/2,g.max.y-=s/2}}else{if(t.x<e.x)switch(r){case Ct.Center:let A=e.x-t.x;i.min.x+=A/2,i.max.x-=A/2;break;case Ct.KeepHigher:i.min.x=e.x-t.x;break;case Ct.KeepLower:i.max.x=t.x;break}else if(t.x>e.x)switch(r){case Ct.Center:let A=t.x-e.x;g.min.x+=A/2,g.max.x-=A/2;break;case Ct.KeepHigher:g.min.x=t.x-e.x;break;case Ct.KeepLower:g.max.x=e.x;break}if(t.y<e.y)switch(r){case Ct.Center:let A=e.y-t.y;i.min.y+=A/2,i.max.y-=A/2;break;case Ct.KeepHigher:i.min.y=e.y-t.y;break;case Ct.KeepLower:i.max.y=t.y;break}else if(t.y>e.y)switch(r){case Ct.Center:let A=t.y-e.y;g.min.y+=A/2,g.max.y-=A/2;break;case Ct.KeepHigher:g.min.y=t.y-e.y;break;case Ct.KeepLower:g.max.y=e.y;break}}return[g,i]}var dC=class{get name(){return""}get assetID(){return-1}get width(){return j().width}get height(){return j().height}get size(){return j().renderer.canvasSize}bind(){let t=j().gl;t.bindFramebuffer(t.FRAMEBUFFER,null),t.viewport(0,0,this.width,this.height)}destroy(){}},ot=class extends Qr{constructor(t=0,e=0,r=j()){super(r),this.frameBuffer=null,this._colorAttachments=[],this._depthAttachment=null,this.activeBuffers=[],this.dirty=!0,this.size=f(Math.floor(t),Math.floor(e)),this.tryInit(!1)}get width(){return this.size.x}get height(){return this.size.y}get colorAttachments(){return this._colorAttachments}get depthAttachment(){return this._depthAttachment}glFBO(){return this.tryInit(!0),this.frameBuffer}addColorAttachment(t,e=this._colorAttachments.length){(t.width!==this.size.x||t.height!==this.size.y)&&console.warn(`Color attachment size [${t.width}, ${t.height}] missmatch with framebuffer.`),this._colorAttachments[e]=t,this.dirty=!0}setDepthAttachment(t){(t.width!==this.size.x||t.height!==this.size.y)&&console.warn(`Depth attachment size [${t.width}, ${t.height}] missmatch with framebuffer.`),this._depthAttachment=t,this.dirty=!0}reset(t=this.width,e=this.height){this.size.x=t,this.size.y=e,this._colorAttachments=[],this._depthAttachment=null,this.dirty=!0}init(){var t;let e=this.ctx.gl;return this.frameBuffer=(t=e.createFramebuffer())!==null&&t!==void 0?t:bt("Failed to create frame buffer object"),!0}bind(){this.tryInit(!0);let t=this.ctx.gl;this.activeBuffers=[],t.bindFramebuffer(t.FRAMEBUFFER,this.frameBuffer);for(let e=0;e<this._colorAttachments.length;e++)this._colorAttachments[e]?(this._colorAttachments[e].bindFramebuffer(e),this.activeBuffers.push(t.COLOR_ATTACHMENT0+e)):t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+e,t.RENDERBUFFER,null);this._depthAttachment?this._depthAttachment.bindFramebuffer():t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,null),t.viewport(0,0,this.width,this.height),t.drawBuffers(this.activeBuffers)}destroy(){super.destroy(),this.ctx.gl.deleteFramebuffer(this.frameBuffer)}};ot.CanvasBuffer=Object.freeze(new dC);var ct;(function(t){t[t.Linear=WebGL2RenderingContext.LINEAR]="Linear",t[t.Nearest=WebGL2RenderingContext.NEAREST]="Nearest"})(ct||(ct={}));var dt;(function(t){t[t.Repeat=WebGL2RenderingContext.REPEAT]="Repeat",t[t.Clamp=WebGL2RenderingContext.CLAMP_TO_EDGE]="Clamp",t[t.Mirror=WebGL2RenderingContext.MIRRORED_REPEAT]="Mirror"})(dt||(dt={}));var Ot;(function(t){t[t.Discard=0]="Discard",t[t.Stretch=1]="Stretch",t[t.Cover=2]="Cover",t[t.Contain=3]="Contain",t[t.KeepLower=4]="KeepLower",t[t.KeepHigher=5]="KeepHigher",t[t.Center=6]="Center"})(Ot||(Ot={}));var te=class extends qt{constructor(t,e,r=T.RGBA,g=ct.Linear,i=j()){super(),this.autoMipmap=!0,this.wrapMode=dt.Repeat,this._glTex=null,this.initialized=!1,this.created=!1,this.name=`Texture_${this.assetID}`,this.ctx=i,this.format=r,this.width=t,this.height=e,this.filterMode=g,this.tryInit(!1)}get size(){return f(this.width,this.height)}glTex(){return this.create(),this._glTex}bind(t){this.create();let e=this.ctx.gl;e.activeTexture(e.TEXTURE0+t),e.bindTexture(e.TEXTURE_2D,this._glTex)}unbind(t){this.create();let e=this.ctx.gl;e.activeTexture(e.TEXTURE0+t),e.bindTexture(e.TEXTURE_2D,null)}destroy(){!this.initialized||this.destroyed||(this.ctx.gl.deleteTexture(this._glTex),super.destroy())}resize(t,e,r=Ot.Discard){this.tryInit(!0);let g=this.ctx.gl,i=te.wrapGlTex(this._glTex,this.width,this.height,this.format,this.filterMode,this.ctx),A=new It(t,e,!1,this.format,this.filterMode,this.ctx);A.wrapMode=this.wrapMode,A.autoMipmap=this.autoMipmap,A.create(),A.updateParameters();let C=this.size;switch(this.width=t,this.height=e,r){case Ot.Discard:break;default:let[s,n]=Kr(C,A.size,r);this.ctx.renderer.blit(i,A,this.ctx.assets.materials.blitCopy,s,n);break}return this.autoMipmap&&A.generateMipmap(),this._glTex=A._glTex,g.deleteTexture(i._glTex),this}generateMipmap(){this.create();let t=this.ctx.gl;t.bindTexture(t.TEXTURE_2D,this._glTex),t.generateMipmap(t.TEXTURE_2D)}updateParameters(){this.create();let t=this.ctx.gl;t.bindTexture(t.TEXTURE_2D,this._glTex),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,this.filterMode),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,this.filterMode),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,this.wrapMode),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,this.wrapMode)}create(){if(this.created)return;this.tryInit(!0);let t=this.ctx.gl;t.bindTexture(t.TEXTURE_2D,this._glTex);let[e,r,g]=jr(t,this.format);t.texImage2D(t.TEXTURE_2D,0,e,this.width,this.height,0,r,g,null),this.created=!0,this.updateParameters(),t.bindTexture(t.TEXTURE_2D,null)}setData(t){this.create();let e=this.ctx.gl;e.bindTexture(e.TEXTURE_2D,this._glTex),pC(this.ctx,this._glTex,t,this.width,this.height,this.format,this.filterMode,this.wrapMode,0)}tryInit(t=!1){var e;if(this.initialized)return!0;let r=this.ctx||j();if(!r){if(t)throw new Error("Failed to initialize texture without a global GL context");return!1}let g=r.gl;return this._glTex=(e=g.createTexture())!==null&&e!==void 0?e:bt("Failed to create texture."),this.initialized=!0,!0}static wrapGlTex(t,e,r,g=T.RGBA,i=ct.Linear,A=j()){var C=new te(e,r,g,i,A);return C._glTex=t,C.initialized=!0,C.created=!0,C}},jt=class extends te{constructor(t=0,e=0,r=T.RGBA,g=ct.Linear,i=j()){super(t,e,r,g,i)}setData(t){t.width!==void 0&&t.height!==void 0&&(t=t,this.width=t.width,this.height=t.height),super.setData(t)}clone(){this.created||this.create();let t=new It(this.width,this.height,!1,this.format,this.filterMode,this.ctx);this.ctx.renderer.blit(this,t);let e=new jt(this.width,this.height,this.format,this.filterMode,this.ctx);return e._glTex=t.glTex(),e.initialized=!0,e.created=!0,e}},_r=class extends te{constructor(t,e,r=j()){super(t,e,T.DEPTH_COMPONENT32F,ct.Nearest,r),this.autoMipmap=!1}bindFramebuffer(){this.create();let t=this.ctx.gl;t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_COMPONENT32F,t.TEXTURE_2D,this._glTex,0)}},It=class extends te{constructor(t,e,r=!1,g=T.RGBA,i=ct.Linear,A=j()){super(t,e,g,i,A),this.depthTexture=null,r&&(this.depthTexture=new _r(t,e,A))}setData(t){super.setData(t)}destroy(){var t;!this.initialized||this.destroyed||((t=this.depthTexture)===null||t===void 0||t.destroy(),super.destroy())}bindFramebuffer(t){this.create();let e=this.ctx.gl;e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.TEXTURE_2D,this._glTex,0)}createFramebuffer(){this.create();let t=new ot(this.width,this.height);return t.addColorAttachment(this,0),t}};function pC(t,e,r,g,i,A,C,s,n){var I,o;let a=t.gl;t.renderer;let h=(I=a.createTexture())!==null&&I!==void 0?I:bt("Failed to create texture."),[u,p,v]=jr(a,A);a.bindTexture(a.TEXTURE_2D,h),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.NEAREST),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.NEAREST),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,s),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,s),r.width!==void 0&&r.height!==void 0?(r=r,a.texImage2D(a.TEXTURE_2D,n,u,p,v,r)):(r=r,a.texImage2D(a.TEXTURE_2D,n,u,g,i,0,p,v,r));let c=(o=a.createFramebuffer())!==null&&o!==void 0?o:bt("Failed to create frame buffer");a.bindFramebuffer(a.FRAMEBUFFER,c),a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,e,0),a.viewport(0,0,g,i),a.drawBuffers([a.COLOR_ATTACHMENT0]),a.disable(a.CULL_FACE);let M=t.assets.shaders.FlipTexture;M.use(),a.activeTexture(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,h),a.uniform1i(M.uniformLocation(Wt.mainTex),0);let z=t.assets.meshes.screenQuad;z.bind(),a.drawElements(a.TRIANGLE_STRIP,z.indices.length,a.UNSIGNED_INT,0),a.activeTexture(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,null),a.deleteFramebuffer(c),a.bindFramebuffer(a.FRAMEBUFFER,null),a.deleteTexture(h)}var Hr=function(t,e,r,g){var i=arguments.length,A=i<3?e:g===null?g=Object.getOwnPropertyDescriptor(e,r):g,C;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")A=Reflect.decorate(t,e,r,g);else for(var s=t.length-1;s>=0;s--)(C=t[s])&&(A=(i<3?C(A):i>3?C(e,r,A):C(e,r))||A);return i>3&&A&&Object.defineProperty(e,r,A),A},Xr;(function(t){t[t.Field=0]="Field",t[t.Dynamic=1]="Dynamic"})(Xr||(Xr={}));var Ge=class extends qt{constructor(t,e=Yt()){super(),this.properties={},this.textureCount=0,this.boundTextures=[],this.initialized=!1,this.name=`Material_${this.assetID}`,this.gl=e,this._shader=t,this.pipelineStateOverride=Object.assign({},t.pipelineStates)}get shader(){return this._shader}upload(t){this.tryInit(!0),this.setupPipelineStateOverride();for(let e in this.properties){let r=this.properties[e],g=r.key?this[r.key]:r.value;g!==void 0&&this.uploadUniform(r,g)}}setProp(t,e,r){this.tryInit(!0);let g=this.getOrCreatePropInfo(t,e);if(e!==g.type){console.warn("Uniform type missmatch");return}g.key?this[g.key]=r:g.value=r}unbindRenderTextures(){this.tryInit(!0),this.gl;for(let t=0;t<this.boundTextures.length;t++){let e=this.boundTextures[t];e instanceof It&&e.unbind(t)}this.boundTextures.length=0}tryInit(t=!1){if(this.initialized)return!0;let e=this.gl||Yt();if(!e){if(t)throw new Error("Failed to intialize material without global GL context");return!1}this.gl=e;for(let r in this){let g=mC(this,r);if(!g)continue;let i=this.getOrCreatePropInfo(g.name,g.type);i.key=r}return this.initialized=!0,!0}setUniformDirectly(t,e,r){if(r===void 0)throw new Error("");this.tryInit(!0);let g=this.getOrCreatePropInfo(t,e);!g.location||this.uploadUniform(g,r)}getOrCreatePropInfo(t,e){let r=this.properties[t];return r||(e==="tex2d"?r={type:e,value:void 0,uploaed:void 0,location:this.shader.uniformLocation(t)}:e==="tex2d[]"?r={type:e,value:void 0,uploaded:void 0,location:this.shader.uniformLocation(t),buffer:new Array}:e.endsWith("[]")?r={type:e,value:void 0,uploaded:void 0,location:this.shader.uniformLocation(t),buffer:new Float32Array}:r={type:e,value:void 0,uploaded:void 0,location:this.shader.uniformLocation(t)},this.properties[t]=r,r)}setPipelineStateOverride(t){let e=!1,r=[U.One,U.Zero],g=[U.One,U.OneMinusSrcAlpha];typeof t.blend=="number"&&t.blend!==U.Disable?(e=!0,r=[t.blend,t.blend],g=[t.blend,t.blend]):t.blend instanceof Array&&(e=!0,r=t.blend),t.blendRGB&&(e=t.blend!==!1&&t.blend!==U.Disable,r=t.blendRGB),t.blendAlpha&&(e=t.blend!==!1&&t.blend!==U.Disable,g=t.blendAlpha),this.pipelineStateOverride={depth:t.depth||xt.Less,blend:e,blendRGB:r,blendAlpha:g,zWrite:t.zWrite!==!1,cull:t.cull||$t.Back}}setupPipelineStateOverride(){let t=this.gl;if(this.pipelineStateOverride.depth===xt.Disable?t.disable(t.DEPTH_TEST):(t.enable(t.DEPTH_TEST),t.depthMask(this.pipelineStateOverride.zWrite),t.depthFunc(this.pipelineStateOverride.depth)),!this.pipelineStateOverride.blend)t.disable(t.BLEND);else{let[e,r]=this.pipelineStateOverride.blendRGB,[g,i]=this.pipelineStateOverride.blendAlpha;t.enable(t.BLEND),t.blendFuncSeparate(e,r,g,i)}this.pipelineStateOverride.cull===$t.Disable?t.disable(t.CULL_FACE):(t.enable(t.CULL_FACE),t.cullFace(this.pipelineStateOverride.cull),t.frontFace(t.CCW))}uploadUniform(t,e){var r;let g=this.gl,i=j();if(!t.location||t.uploaded===null&&e===null&&t.type!=="tex2d")return!1;let A=e;switch(t.type){case"int":g.uniform1i(t.location,e);break;case"float":g.uniform1f(t.location,e);break;case"vec2":g.uniform2fv(t.location,e);break;case"vec3":g.uniform3fv(t.location,e);break;case"vec4":g.uniform4fv(t.location,e);break;case"color":g.uniform4fv(t.location,e);break;case"mat4":g.uniformMatrix4fv(t.location,!1,e);break;case"int[]":e.length&&g.uniform1iv(t.location,e);break;case"float[]":e.length&&g.uniform1fv(t.location,e);break;case"vec2[]":{let C=this.setVectorUniformBuffer(t,2,e);C&&g.uniform2fv(t.location,t.buffer,0,C);break}case"vec3[]":{let C=this.setVectorUniformBuffer(t,3,e);C&&g.uniform3fv(t.location,t.buffer,0,C);break}case"color[]":case"vec4[]":{let C=this.setVectorUniformBuffer(t,4,e);C&&g.uniform4fv(t.location,t.buffer,0,C);break}case"mat4[]":{let C=this.setVectorUniformBuffer(t,16,e);C&&g.uniform4fv(t.location,t.buffer,0,C);break}case"tex2d":{let C=t;e=e||i.renderer.assets.textures.default;let s=this.bindNextTexture(e);C.uploaded!==s&&(g.uniform1i(C.location,s),C.uploaded=s),A=s;break}case"tex2d[]":{let C=t,s=e,n=!1,I=C.uploaded||[];for(let o=0;o<s.length;o++){let a=s[o]||i.renderer.assets.textures.default,h=this.bindNextTexture(a);((r=C.uploaded)===null||r===void 0?void 0:r[o])!==h&&(n=!0),I[o]=h}n&&(g.uniform1iv(C.location,I,0,s.length),C.uploaded=I),A=I}}t.uploaded=A}bindNextTexture(t){return t.bind(this.boundTextures.length),this.boundTextures.push(t)-1}setVectorUniformBuffer(t,e,r){t.buffer.length<e*r.length&&(t.buffer=new Float32Array(e*r.length));for(let g=0;g<r.length;g++)t.buffer.set(r[g],g*e);return e*r.length}},Jr=Symbol("shaderProp");function O(t,e){return Reflect.metadata(Jr,{name:t,type:e})}function mC(t,e){return Reflect.getMetadata(Jr,t,e)}function St(t){let e=t.clone();return class extends Ge{constructor(r=Yt()){e.valid()||(e=t.clone()),super(e,r)}}}function Ne(t){class e extends St(t){constructor(){super(...arguments),this.texture=null,this.color=new X(1,1,1,1)}}return Hr([O(Wt.mainTex,"tex2d")],e.prototype,"texture",void 0),Hr([O(Wt.color,"color")],e.prototype,"color",void 0),e}function Le(t){return class extends t{constructor(...e){super(...e)}}}var at=function(t,e,r,g){var i=arguments.length,A=i<3?e:g===null?g=Object.getOwnPropertyDescriptor(e,r):g,C;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")A=Reflect.decorate(t,e,r,g);else for(var s=t.length-1;s>=0;s--)(C=t[s])&&(A=(i<3?C(A):i>3?C(e,r,A):C(e,r))||A);return i>3&&A&&Object.defineProperty(e,r,A),A};function vC(t,e,r,g){let i=new Ge(r.ErrorShader,t);return i.setProp("uMainTex","tex2d",g.error),{error:i,default:new e.DefaultMaterial(t),blitCopy:new e.BlitCopy(t),ColoredLine:new Ge(r.ColoredLine,t)}}function bC(t,e,r){let g=class extends St(r.DefaultShader){constructor(){super(...arguments),this.color=X.white,this.mainTexture=e.default}};at([O("uColor","color")],g.prototype,"color",void 0),at([O("uMainTex","tex2d")],g.prototype,"mainTexture",void 0),g=at([Le],g);let i=class extends St(r.BlitCopy){constructor(){super(...arguments),this.source=null,this.flip=f(0,0)}};at([O("uMainTex","tex2d")],i.prototype,"source",void 0),at([O("uFlip","vec2")],i.prototype,"flip",void 0),i=at([Le],i);let A=class extends St(r.DefaultShader){constructor(){super(...arguments),this.color=X.white,this.mainTexture=e.default,this.normalTexture=e.defaultNormal,this.emission=X.black,this.specular=X.white,this.metiallic=.023,this.smoothness=.5,this.fresnel=5}};return at([O("uColor","color")],A.prototype,"color",void 0),at([O("uMainTex","tex2d")],A.prototype,"mainTexture",void 0),at([O("uNormalTex","tex2d")],A.prototype,"normalTexture",void 0),at([O("uEmission","color")],A.prototype,"emission",void 0),at([O("uSpecular","color")],A.prototype,"specular",void 0),at([O("uMetallic","float")],A.prototype,"metiallic",void 0),at([O("uSmoothness","float")],A.prototype,"smoothness",void 0),at([O("uFresnel","float")],A.prototype,"fresnel",void 0),A=at([Le],A),{DefaultMaterial:g,BlitCopy:i,DefaultLit:A}}function xC(t){var e;let r=64,g=document.createElement("canvas");g.width=g.height=r;let i=(e=g.getContext("2d"))!==null&&e!==void 0?e:bt("Failed to create default texture.");i.fillStyle="black",i.fillRect(0,0,r,r),i.fillStyle="cyan",i.fillRect(0,0,r/2,r/2),i.fillRect(r/2,r/2,r/2,r/2);let A=new jt(r,r,T.RGBA,ct.Linear,t);A.setData(g),A.name="Texture-Error",i.fillStyle="blue",i.fillRect(0,0,r,r);let C=new jt(r,r,T.RGBA,ct.Linear,t);C.setData(g),C.name="Default-Normal",i.fillStyle="white",i.fillRect(0,0,r,r);let s=new jt(r,r,T.RGBA,ct.Linear,t);return s.setData(g),s.name="Default-White",{default:s,defaultNormal:C,error:A}}var kt=class{constructor(t=16,e=t*3,r=Lt,g=j()){this.verticesCount=0,this.indicesCount=0,this.mesh=new de(r,g),this.mesh.resize(t,e)}addPolygon(...t){if(t.length<=0)return;this.verticesCount+t.length>this.mesh.vertices.length&&this.mesh.resize(this.mesh.vertices.length*2,this.mesh.indices.length*2,!0);let e=this.verticesCount;for(let r in t[0])for(let g=0;g<t.length;g++)this.mesh.vertices[e+g][r].set(t[g][r]);for(let r=0;r<t.length-2;r++)this.mesh.indices[this.indicesCount+r*3+0]=e+0,this.mesh.indices[this.indicesCount+r*3+1]=e+r+1,this.mesh.indices[this.indicesCount+r*3+2]=e+r+2;this.verticesCount+=t.length,this.indicesCount+=(t.length-2)*3}toMesh(){return this.mesh.indices.length!=this.indicesCount?this.mesh.resize(this.verticesCount,this.indicesCount,!0):this.mesh.vertices.length!=this.verticesCount&&this.mesh.vertices.resize(this.verticesCount,!0),this.mesh}static quad(t=f.zero(),e=f.one(),r=j()){let g=f.mul(e,.5),i=new de(r);return i.resize(4,6),i.vertices[0].vert.set([t.x-g.x,t.y-g.y,0]),i.vertices[1].vert.set([t.x+g.x,t.y-g.y,0]),i.vertices[2].vert.set([t.x+g.x,t.y+g.y,0]),i.vertices[3].vert.set([t.x-g.x,t.y+g.y,0]),i.vertices[0].uv.set([0,0]),i.vertices[1].uv.set([1,0]),i.vertices[2].uv.set([1,1]),i.vertices[3].uv.set([0,1]),i.vertices[0].normal.set([0,0,1]),i.vertices[1].normal.set([0,0,1]),i.vertices[2].normal.set([0,0,1]),i.vertices[3].normal.set([0,0,1]),i.vertices[0].color.fill(1),i.vertices[1].color.fill(1),i.vertices[2].color.fill(1),i.vertices[3].color.fill(1),i.indices.set([0,1,2,0,2,3]),i}static ndcQuad(t=j()){return this.quad(f.zero(),f(2,2),t)}static ndcTriangle(t=j()){let e=new de(t);return e.resize(3,3),e.vertices[0].vert.set([-1,-1,0]),e.vertices[1].vert.set([3,-1,0]),e.vertices[2].vert.set([-1,3,0]),e.vertices[0].uv.set([0,0]),e.vertices[1].uv.set([2,0]),e.vertices[2].uv.set([0,2]),e.vertices[0].normal.set([0,0,1]),e.vertices[1].normal.set([0,0,1]),e.vertices[2].normal.set([0,0,1]),e.vertices[0].color.fill(1),e.vertices[1].color.fill(1),e.vertices[2].color.fill(1),e.indices.set([0,1,2]),e.name="mesh_ndc_triangle",e}static cube(t=m.zero(),e=m.one(),r=j()){let g=[m(-.5,-.5,-.5).mul(e).plus(t),m(.5,-.5,-.5).mul(e).plus(t),m(.5,.5,-.5).mul(e).plus(t),m(-.5,.5,-.5).mul(e).plus(t),m(-.5,-.5,.5).mul(e).plus(t),m(.5,-.5,.5).mul(e).plus(t),m(.5,.5,.5).mul(e).plus(t),m(-.5,.5,.5).mul(e).plus(t)],i=[f(0,0),f(1,0),f(1,1),f(0,1)],A=new kt(24,36,Lt,r);A.addPolygon({vert:g[1],uv:i[0],normal:m(0,0,-1)},{vert:g[0],uv:i[1],normal:m(0,0,-1)},{vert:g[3],uv:i[2],normal:m(0,0,-1)},{vert:g[2],uv:i[3],normal:m(0,0,-1)}),A.addPolygon({vert:g[5],uv:i[0],normal:m(1,0,0)},{vert:g[1],uv:i[1],normal:m(1,0,0)},{vert:g[2],uv:i[2],normal:m(1,0,0)},{vert:g[6],uv:i[3],normal:m(1,0,0)}),A.addPolygon({vert:g[4],uv:i[0],normal:m(0,0,1)},{vert:g[5],uv:i[1],normal:m(0,0,1)},{vert:g[6],uv:i[2],normal:m(0,0,1)},{vert:g[7],uv:i[3],normal:m(0,0,1)}),A.addPolygon({vert:g[0],uv:i[0],normal:m(-1,0,0)},{vert:g[4],uv:i[1],normal:m(-1,0,0)},{vert:g[7],uv:i[2],normal:m(-1,0,0)},{vert:g[3],uv:i[3],normal:m(-1,0,0)}),A.addPolygon({vert:g[7],uv:i[0],normal:m(0,1,0)},{vert:g[6],uv:i[1],normal:m(0,1,0)},{vert:g[2],uv:i[2],normal:m(0,1,0)},{vert:g[3],uv:i[3],normal:m(0,1,0)}),A.addPolygon({vert:g[0],uv:i[0],normal:m(0,-1,0)},{vert:g[1],uv:i[1],normal:m(0,-1,0)},{vert:g[5],uv:i[2],normal:m(0,-1,0)},{vert:g[4],uv:i[3],normal:m(0,-1,0)});let C=A.toMesh();return C.vertices.forEach(s=>s.color.fill(1)),C.name="mesh_cube",C}static sphereNormalizedCube(t=m.zero(),e=.5,r=12,g=j()){let i=6*(r+1)*(r+1),A=r*r*3*2*6,C=new de;C.resize(i,A);let s=0,n=[],I=[];for(let a=0;a<6;++a)for(let h=0;h<=r;++h)for(let u=0;u<=r;++u){let p=[()=>m(0,h,u),()=>m(r,h,u),()=>m(h,u,0),()=>m(h,u,r),()=>m(h,0,u),()=>m(h,r,u)][a](),v=I[p.x]||(I[p.x]=[]),c=v[p.y]||(v[p.y]=[]);c[p.z]===void 0&&(c[p.z]=n.length,n.push(p))}C.resize(n.length,A),n.forEach((a,h)=>{let u=m.div(a,r).mul(2).minus(1).normalize(),p=m.mul(u,e),[v,c,M]=MC(p),z=[M/(Math.PI*2),c/Math.PI];C.vertices[h].vert.set(p),C.vertices[h].normal.set(u),C.vertices[h].color.set(X.white),C.vertices[h].uv.set(z),C.vertices[h].uv2.set(z)});let o=[];for(let a=0;a<6;++a){for(let h=0;h<=r;++h)for(let u=0;u<=r;++u){let p=[()=>m(r,h,u),()=>m(0,h,r-u),()=>m(h,u,r),()=>m(h,r-u,0),()=>m(h,r,r-u),()=>m(h,0,u)][a]();o.push(I[p.x][p.y][p.z])}for(let h=0;h<r;++h)for(let u=0;u<r;++u){let p=a*(r+1)*(r+1)+h*(r+1)+u,v=p+(r+1);C.indices[s++]=o[v+0],C.indices[s++]=o[p+1],C.indices[s++]=o[p+0],C.indices[s++]=o[v+0],C.indices[s++]=o[v+1],C.indices[s++]=o[p+1]}}return C}};function MC(t){let e=t.magnitude,r=Math.acos(t.y/e),g=Math.atan2(t.z,t.x);return[e,r,g]}function yC(t){return{quad:kt.quad(f.zero(),f.one(),t),screenQuad:kt.ndcQuad(t),cube:kt.cube(m.zero(),m.one(),t)}}var wC=class{constructor(t){let e=t.gl;this.gl=e,t.assets=this,this.BuiltinUniforms=Wt,this.shaderSources=mt,this.shaders=lC(e),this.meshes=yC(t),this.textures=xC(t),this.types=bC(e,this.textures,this.shaders),this.materials=vC(e,this.types,this.shaders,this.textures)}},EC=class{constructor(t){this.pool=[],this.allocator=t}get(...t){return this.pool.length<=0?this.allocator(...t):this.pool.pop()}release(t){this.pool.push(t)}},RC=class{constructor(t,e,r){this.viewProjectionMatrix=y.identity(),this.viewMatrix=y.identity(),this.projectionMatrix=y.identity(),this.target=ot.CanvasBuffer,this.shader=null,this.globalUniforms=new Map,this.globalTextures=new Map,this.framebufferPool=new EC((g,i)=>new ot(g,i)),this.canvas=t,this.width=e===void 0?t.width:e,this.height=r===void 0?t.height:r,this.canvas.width=this.width,this.canvas.height=this.height,this.scissor=new vt(f.zero(),f(this.width,this.height)),this.gl=ce(this.canvas.getContext("webgl2"),"WebGL2 is not support on current device."),this.gl.getExtension("EXT_color_buffer_float"),this.gl.getExtension("EXT_color_buffer_half_float"),this.gl.getExtension("WEBGL_depth_texture"),console.log(this.gl.getExtension("WEBGL_depth_texture")||this.gl.getExtension("MOZ_WEBGL_depth_texture")||this.gl.getExtension("WEBKIT_WEBGL_depth_texture")),console.log(this.gl.getSupportedExtensions()),this.ctx=new Or,Object.assign(this.ctx,{gl:this.gl,width:this.width,height:this.height,assets:{},renderer:this}),this.assets=new wC(this.ctx),this.ctx.assets=this.assets,this.blitFramebuffer=[new ot(0,0,this.ctx),new ot(0,0,this.ctx)],j()||this.use(),this.helperAssets={clipBlitMesh:kt.ndcQuad(),blitMesh:kt.ndcTriangle(),depthBlitTex:new _r(this.width,this.height)}}use(){Vr(this.ctx)}setSize(t,e){t=Math.floor(t),e=Math.floor(e),this.canvas.width=t,this.canvas.height=e,this.width=t,this.height=e,this.ctx.width=t,this.ctx.height=e}get canvasSize(){return f(this.width,this.height)}setViewProjection(t,e){y.mul(this.viewProjectionMatrix,e,t)}setFramebuffer(t,e){let r;if(t===ot.CanvasBuffer)r=ot.CanvasBuffer;else if(t instanceof ot)r=t;else if(t instanceof Array){let g=0,i=0;t.length>0?(g=t[0].width,i=t[0].height):e&&(g=e.width,i=e.height);let A=this.getTempFramebuffer(g,i);for(let C=0;C<t.length;C++)A.addColorAttachment(t[C],C);e&&A.setDepthAttachment(e),r=A}else{let g=t,i=this.getTempFramebuffer(g.width,g.height);i.addColorAttachment(g,0),e&&i.setDepthAttachment(e),r=i}r!==this.target&&(this.detachCurrentFramebuffer(),this.target=r),this.scissor.min.set([0,0]),this.scissor.max.set(this.target.size),this.target.bind()}detachCurrentFramebuffer(){this.target.__isTemp&&this.framebufferPool.release(this.target)}getTempFramebuffer(t,e){let r=this.framebufferPool.get(t,e);return r.__isTemp=!0,r.reset(t,e),r}blitCopy(t,e){let r=this.gl,[g,i]=this.blitFramebuffer;g.reset(t.width,t.height),g.addColorAttachment(t),g.bind(),i.reset(t.width,t.height),r.bindFramebuffer(r.READ_FRAMEBUFFER,g.glFBO()),t instanceof It?r.framebufferTexture2D(r.READ_FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.RENDERBUFFER,t.glTex(),0):r.framebufferRenderbuffer(r.READ_FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.RENDERBUFFER,t.glBuf()),r.bindFramebuffer(r.DRAW_FRAMEBUFFER,i.glFBO()),e instanceof It?r.framebufferTexture2D(r.DRAW_FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,e.glTex(),0):r.framebufferRenderbuffer(r.DRAW_FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,e.glBuf()),r.blitFramebuffer(0,0,t.width,t.height,0,0,e.width,e.height,r.COLOR_BUFFER_BIT,r.NEAREST),r.bindFramebuffer(r.READ_FRAMEBUFFER,null),r.bindFramebuffer(r.DRAW_FRAMEBUFFER,null)}blitCopyDepth(t,e){let r=this.gl;if(t instanceof BC){let g=this.helperAssets.depthBlitTex;g.resize(t.width,t.height);let[i,A]=this.blitFramebuffer;i.reset(t.width,t.height),i.bind(),A.reset(t.width,t.height),A.bind(),r.bindFramebuffer(r.READ_FRAMEBUFFER,i.glFBO()),r.framebufferRenderbuffer(r.READ_FRAMEBUFFER,r.DEPTH_ATTACHMENT,r.RENDERBUFFER,t.glBuf()),r.bindFramebuffer(r.DRAW_FRAMEBUFFER,A.glFBO()),r.framebufferTexture2D(r.DRAW_FRAMEBUFFER,r.DEPTH_ATTACHMENT,r.TEXTURE_2D,g.glTex(),0),r.blitFramebuffer(0,0,t.width,t.height,0,0,e.width,e.height,r.DEPTH_BUFFER_BIT,r.NEAREST),t=g}this.blit(t,e)}clear(t=X.black,e=!0){this.target.bind(),this.setupScissor(),this.gl.clearColor(t.r,t.g,t.b,t.a),this.gl.clearDepth(1),this.gl.depthMask(e),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT|this.gl.STENCIL_BUFFER_BIT)}blit(t,e,r=this.assets.materials.blitCopy,g,i){let A=this.target;this.setFramebuffer(e),e=this.target;let C=this.viewProjectionMatrix,s=this.helperAssets.blitMesh,n=e===ot.CanvasBuffer?new vt(f.zero(),this.canvasSize):new vt(f.zero(),e.size.clone());if(t&&(g||i)&&(n=i||n,g)){s=this.helperAssets.clipBlitMesh;let I=le(g.min,t.size),o=le(g.max,t.size);s.uvs=[f(I.x,I.y),f(o.x,I.y),f(o.x,o.y),f(I.x,o.y)],s.update()}this.target=e,this.scissor=n,this.viewProjectionMatrix=y.identity(),t&&r.setProp(Wt.mainTex,"tex2d",t),this.drawMesh(s,y.identity(),r),this.setFramebuffer(A),this.viewProjectionMatrix=C}useShader(t){this.gl,this.shader=t,t.use()}setupTransforms(t,e){this.gl;let r=y.mul(this.viewProjectionMatrix,e),g=y.create();y.invert(g,e)?y.transpose(g,g):g.fill(0);let i=y.mul(this.viewMatrix,e);y.invert(i,i)?y.transpose(i,i):i.fill(0),t.setupBuiltinUniform({matM:e,matVP:this.viewProjectionMatrix,matMVP:r,matM_IT:g,matMV_IT:i})}setupGlobalUniforms(t){for(let e of this.globalUniforms.values())t.setUniformDirectly(e.name,e.type,e.value)}drawMeshInstance(t,e,r,g){r||(r=this.assets.materials.error);let i=this.gl,A={assets:this.assets,gl:i,nextTextureUnit:0,size:f(this.width,this.height)};this.target.bind(),this.setupScissor(),this.useShader(r.shader),r.upload(A),this.setupTransforms(r.shader,y.identity());let C=t.bind();e.bindVertexArray(!0,r.shader.attributes),i.drawElementsInstanced(i.TRIANGLES,C,i.UNSIGNED_INT,0,g),e.unbindVertexArray(!0,r.shader.attributes),t.unbind(),r.unbindRenderTextures()}drawMeshProceduralInstance(t,e,r){e||(e=this.assets.materials.error);let g=this.gl,i={assets:this.assets,gl:g,nextTextureUnit:0,size:f(this.width,this.height)};this.target.bind(),this.setupScissor(),this.useShader(e.shader),e.upload(i),this.setupTransforms(e.shader,y.identity());let A=t.bind();g.drawElementsInstanced(g.TRIANGLES,A,g.UNSIGNED_INT,0,r),e.unbindRenderTextures()}drawMesh(t,e,r){r||(r=this.assets.materials.error);let g=this.gl,i={assets:this.assets,gl:g,nextTextureUnit:0,size:f(this.width,this.height)};this.target.bind(),this.setupScissor(),this.useShader(r.shader),r.upload(i),this.setupTransforms(r.shader,e),this.setupGlobalUniforms(r);let A=t.bind();g.drawElements(g.TRIANGLES,A,g.UNSIGNED_INT,0),t.unbind(),r.unbindRenderTextures()}drawLines(t,e,r){let g=this.gl,i={assets:this.assets,gl:g,nextTextureUnit:0,size:f(this.width,this.height)};this.target.bind(),this.setupScissor(),this.useShader(r.shader),r.upload(i),this.setupTransforms(r.shader,e),t.bind(r.shader),g.drawElements(g.LINES,t.lines.length,g.UNSIGNED_INT,0)}setGlobalUniform(t,e,r){this.globalUniforms.set(t,{name:t,type:e,value:r})}unsetGlobalUniform(t){this.globalUniforms.delete(t)}destroy(){fe.destroyAll(),Vr(null)}setupScissor(){this.gl.viewport(this.scissor.xMin,this.scissor.yMin,this.scissor.size.x,this.scissor.size.y)}},BC=class extends Qr{constructor(t,e,r=0,g=j()){super(g),this.multiSampling=0,this.format=T.DEPTH_COMPONENT,this._glBuf=null,this.size=f(t,e),this.format=T.DEPTH_COMPONENT,this.multiSampling=r,this.tryInit(!1)}glBuf(){return this.tryInit(!0),this._glBuf}get width(){return this.size.x}set width(t){this.size.x=t}get height(){return this.size.y}set height(t){this.size.y=t}updateParams(){this.tryInit(!0);let t=this.ctx.gl;t.bindRenderbuffer(t.RENDERBUFFER,this._glBuf),t.renderbufferStorageMultisample(t.RENDERBUFFER,this.multiSampling,WebGL2RenderingContext.DEPTH_COMPONENT32F,this.size.x,this.size.y)}init(){var t;let e=this.ctx.gl;return this._glBuf=(t=e.createRenderbuffer())!==null&&t!==void 0?t:bt("Failed to create render buffer."),e.bindRenderbuffer(e.RENDERBUFFER,this._glBuf),e.renderbufferStorageMultisample(e.RENDERBUFFER,this.multiSampling,WebGL2RenderingContext.DEPTH_COMPONENT32F,this.size.x,this.size.y),e.bindRenderbuffer(e.RENDERBUFFER,null),!0}bindFramebuffer(){this.tryInit(!0);let t=this.ctx.gl;t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,this._glBuf)}destroy(){super.destroy(),this.ctx.gl.deleteRenderbuffer(this._glBuf)}},TC=class{constructor(t){this.importers=t}async url(t,e=j()){let r=await fetch(t).then(g=>g.arrayBuffer());return await this.buffer(r,e)}async blob(t,e=j()){let r=await t.arrayBuffer();return await this.buffer(r,e)}async buffer(t,e=j()){let r={};for(let g in this.importers)r[g]=i=>this.importers[g].import(t,i,e);return r}},DC={import(t,e,r=j()){return new Promise((g,i)=>{let A=new Blob([t]),C=new Image;C.src=URL.createObjectURL(A);let s=()=>{let n={width:C.width,height:C.height,filterMode:ct.Linear,format:T.RGBA,mipmap:!0,wrapMpde:dt.Repeat},I=Object.assign(Object.assign({},n),e),o=new jt(I.width,I.height,I.format,I.filterMode,r);o.autoMipmap=I.mipmap,o.wrapMode=I.wrapMpde,o.updateParameters(),o.setData(C),g(o)};C.complete?s():C.onload=s})}},SC={tex2d:DC},Yr=new TC(SC),ee={};wt(ee,{ImageSizing:()=>Ct,imageResize:()=>Kr});var PC=ve("iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAYAAABccqhmAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH5QIZBzY36WJJGwAAABJ0RVh0RmlsZSBOYW1lAM60serM4i0xjMwnJwAAOd9pVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+Cjx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4KICAgPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgICAgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIgogICAgICAgICAgICB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIKICAgICAgICAgICAgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIKICAgICAgICAgICAgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIgogICAgICAgICAgICB4bWxuczpwaG90b3Nob3A9Imh0dHA6Ly9ucy5hZG9iZS5jb20vcGhvdG9zaG9wLzEuMC8iCiAgICAgICAgICAgIHhtbG5zOnRpZmY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vdGlmZi8xLjAvIgogICAgICAgICAgICB4bWxuczpleGlmPSJodHRwOi8vbnMuYWRvYmUuY29tL2V4aWYvMS4wLyI+CiAgICAgICAgIDx4bXA6Q3JlYXRvclRvb2w+QWRvYmUgUGhvdG9zaG9wIENDIChXaW5kb3dzKTwveG1wOkNyZWF0b3JUb29sPgogICAgICAgICA8eG1wOkNyZWF0ZURhdGU+MjAyMS0wMi0yNVQxNTo1NDo1MyswODowMDwveG1wOkNyZWF0ZURhdGU+CiAgICAgICAgIDx4bXA6TWV0YWRhdGFEYXRlPjIwMjEtMDItMjVUMTU6NTQ6NTMrMDg6MDA8L3htcDpNZXRhZGF0YURhdGU+CiAgICAgICAgIDx4bXA6TW9kaWZ5RGF0ZT4yMDIxLTAyLTI1VDE1OjU0OjUzKzA4OjAwPC94bXA6TW9kaWZ5RGF0ZT4KICAgICAgICAgPHhtcE1NOkluc3RhbmNlSUQ+eG1wLmlpZDo4MjdmMjExZi1iNjczLWVlNDktYTc5NC05YTVjMWJmY2EzZmU8L3htcE1NOkluc3RhbmNlSUQ+CiAgICAgICAgIDx4bXBNTTpEb2N1bWVudElEPmFkb2JlOmRvY2lkOnBob3Rvc2hvcDoxNTVhOWVmYy1kMmYwLTBkNDItYTcwYS02ZGY5M2UwNjljYWE8L3htcE1NOkRvY3VtZW50SUQ+CiAgICAgICAgIDx4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ+eG1wLmRpZDo2NjBiMDZmYi0xZjczLWFkNDQtYWQwMS1kNGU5ZDlhOTE4NDM8L3htcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD4KICAgICAgICAgPHhtcE1NOkhpc3Rvcnk+CiAgICAgICAgICAgIDxyZGY6U2VxPgogICAgICAgICAgICAgICA8cmRmOmxpIHJkZjpwYXJzZVR5cGU9IlJlc291cmNlIj4KICAgICAgICAgICAgICAgICAgPHN0RXZ0OmFjdGlvbj5jcmVhdGVkPC9zdEV2dDphY3Rpb24+CiAgICAgICAgICAgICAgICAgIDxzdEV2dDppbnN0YW5jZUlEPnhtcC5paWQ6NjYwYjA2ZmItMWY3My1hZDQ0LWFkMDEtZDRlOWQ5YTkxODQzPC9zdEV2dDppbnN0YW5jZUlEPgogICAgICAgICAgICAgICAgICA8c3RFdnQ6d2hlbj4yMDIxLTAyLTI1VDE1OjU0OjUzKzA4OjAwPC9zdEV2dDp3aGVuPgogICAgICAgICAgICAgICAgICA8c3RFdnQ6c29mdHdhcmVBZ2VudD5BZG9iZSBQaG90b3Nob3AgQ0MgKFdpbmRvd3MpPC9zdEV2dDpzb2Z0d2FyZUFnZW50PgogICAgICAgICAgICAgICA8L3JkZjpsaT4KICAgICAgICAgICAgICAgPHJkZjpsaSByZGY6cGFyc2VUeXBlPSJSZXNvdXJjZSI+CiAgICAgICAgICAgICAgICAgIDxzdEV2dDphY3Rpb24+c2F2ZWQ8L3N0RXZ0OmFjdGlvbj4KICAgICAgICAgICAgICAgICAgPHN0RXZ0Omluc3RhbmNlSUQ+eG1wLmlpZDo4MjdmMjExZi1iNjczLWVlNDktYTc5NC05YTVjMWJmY2EzZmU8L3N0RXZ0Omluc3RhbmNlSUQ+CiAgICAgICAgICAgICAgICAgIDxzdEV2dDp3aGVuPjIwMjEtMDItMjVUMTU6NTQ6NTMrMDg6MDA8L3N0RXZ0OndoZW4+CiAgICAgICAgICAgICAgICAgIDxzdEV2dDpzb2Z0d2FyZUFnZW50PkFkb2JlIFBob3Rvc2hvcCBDQyAoV2luZG93cyk8L3N0RXZ0OnNvZnR3YXJlQWdlbnQ+CiAgICAgICAgICAgICAgICAgIDxzdEV2dDpjaGFuZ2VkPi88L3N0RXZ0OmNoYW5nZWQ+CiAgICAgICAgICAgICAgIDwvcmRmOmxpPgogICAgICAgICAgICA8L3JkZjpTZXE+CiAgICAgICAgIDwveG1wTU06SGlzdG9yeT4KICAgICAgICAgPGRjOmZvcm1hdD5pbWFnZS9wbmc8L2RjOmZvcm1hdD4KICAgICAgICAgPHBob3Rvc2hvcDpDb2xvck1vZGU+MzwvcGhvdG9zaG9wOkNvbG9yTW9kZT4KICAgICAgICAgPHRpZmY6T3JpZW50YXRpb24+MTwvdGlmZjpPcmllbnRhdGlvbj4KICAgICAgICAgPHRpZmY6WFJlc29sdXRpb24+NzIwMDAwLzEwMDAwPC90aWZmOlhSZXNvbHV0aW9uPgogICAgICAgICA8dGlmZjpZUmVzb2x1dGlvbj43MjAwMDAvMTAwMDA8L3RpZmY6WVJlc29sdXRpb24+CiAgICAgICAgIDx0aWZmOlJlc29sdXRpb25Vbml0PjI8L3RpZmY6UmVzb2x1dGlvblVuaXQ+CiAgICAgICAgIDxleGlmOkNvbG9yU3BhY2U+NjU1MzU8L2V4aWY6Q29sb3JTcGFjZT4KICAgICAgICAgPGV4aWY6UGl4ZWxYRGltZW5zaW9uPjI1NjwvZXhpZjpQaXhlbFhEaW1lbnNpb24+CiAgICAgICAgIDxleGlmOlBpeGVsWURpbWVuc2lvbj4yNTY8L2V4aWY6UGl4ZWxZRGltZW5zaW9uPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAKPD94cGFja2V0IGVuZD0idyI/PsD6WFoAAAAYdEVYdFNvZnR3YXJlAEFkb2JlIFBob3Rvc2hvcDTLjmcAAAAPdEVYdFdyaXRlcgBTdXBlclBOR8XEr90AACAASURBVHja7V3pduPMCgTZz32f/LO4P6KFpllb7YyTKOfMxIvseFEVRUHT+L//wf1z/9w/f/RnuT+C++f++bs/z/sj+DU/+M1/j+6P/CaA++d3gnvWa7pJ4iaA++eHA/0d7+cmhpsA7p9fCPjR930Twk0AN+B/KInQTQg3Adw/7wUn/tD3SDch3ARwg/4zwF59XnrT36SLz3OTwU0Avwr4+A/+5uznpgvPS4Ov6yaCmwD+FOi/W1nQxeemgceO/s2bDG4C+Hjg4xuO/WQFMEIKV8ngJoKbAD4K+DOBjG98nVdVAQ6SAk0mg5sIbgL4McDHN98/gxCo8Dw0AHYsksFNBDcBfCzwr4L+Hfd9x/unpArAAmFklAbdRHATwE8H/qzb300Eo8DHJCHQAHDxJoKb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"),re=`#version 300 es\r
precision mediump float;\r
\r
in vec3 aPos;\r
in vec4 aColor;\r
in vec2 aUV;\r
in vec3 aNormal;\r
\r
uniform mat4 uTransformM;\r
uniform mat4 uTransformVP;\r
uniform mat4 uTransformMVP;\r
uniform mat4 uTransformM_IT;\r
\r
out vec4 vColor;\r
out vec4 vPos;\r
out vec2 vUV;\r
out vec3 vNormal;\r
out vec3 vWorldPos;\r
\r
void main()\r
{\r
    gl_Position = uTransformMVP * vec4(aPos, 1);\r
    vPos = gl_Position;\r
    vColor = aColor;\r
    vUV = aUV;\r
    vNormal = (uTransformM_IT *  vec4(aNormal, 0)).xyz;\r
    vWorldPos = (uTransformM * vec4(aPos, 1)).xyz;\r
    \r
}`,FC=`#version 300 es\r
precision mediump float;\r
\r
in vec4 vColor;\r
in vec4 vPos;\r
in vec2 vUV;\r
\r
uniform sampler2D uMainTex;\r
uniform vec4 uTexSize; // (w, h, 1/w, 1/h)\r
uniform float uSampleOffset;\r
\r
out vec4 fragColor;\r
\r
void main()\r
{\r
    vec2 delta = vec2(-uSampleOffset, uSampleOffset);\r
    vec4 color = \r
      texture(uMainTex, clamp(vUV.xy + uTexSize.zw * delta.xx, vec2(0), vec2(1)))\r
    + texture(uMainTex, clamp(vUV.xy + uTexSize.zw * delta.yx, vec2(0), vec2(1)))\r
    + texture(uMainTex, clamp(vUV.xy + uTexSize.zw * delta.yy, vec2(0), vec2(1)))\r
    + texture(uMainTex, clamp(vUV.xy + uTexSize.zw * delta.xy, vec2(0), vec2(1)));\r
\r
    color /= vec4(4.0);\r
\r
    fragColor = color.rgba;\r
}`,pe=class extends St(new lt(re,FC)){constructor(){super(...arguments),this.texture=null,this.textureSize=E.one(),this.sampleOffset=1}};k([O("uMainTex","tex2d")],pe.prototype,"texture",2),k([O("uTexSize","vec4")],pe.prototype,"textureSize",2),k([O("uSampleOffset","float")],pe.prototype,"sampleOffset",2);var UC=class{constructor(t){this.steps=[],this.mateiralBlur=new pe,this.renderer=t}init(t){this.steps[0]||(this.steps[0]=new It(t.width,t.height,!1,t.format,t.filterMode),this.steps[0].wrapMode=dt.Clamp,this.steps[0].updateParameters()),(this.steps[0].width!==t.width||this.steps[0].height!==t.height)&&this.steps[0].resize(t.width,t.height,Ot.Discard)}blur(t,e=4,r=this.steps[0]){return this.steps[0]||(this.steps[0]=new It(t.width,t.height,!1,t.format,t.filterMode)),r=r||this.steps[0],(this.steps[0].width!==t.width||this.steps[0].height!==t.height)&&this.steps[0].resize(t.width,t.height,Ot.Discard),this.downSample(t,e),this.upSample(e,r)}downSample(t,e){for(let r=1;r<=e;r++){let g=f.floor(le(t.size,f(2)));this.steps[r]||(this.steps[r]=new It(g.x,g.y,!1,T.RGBA,ct.Linear),this.steps[r].wrapMode=dt.Clamp,this.steps[r].updateParameters());let i=this.steps[r];(i.width!==g.x||i.height!==g.y)&&i.resize(g.x,g.y,Ot.Discard),this.mateiralBlur.texture=t,this.mateiralBlur.textureSize=E(t.width,t.height,1/t.width,1/t.height),this.mateiralBlur.sampleOffset=1,this.renderer.blit(t,i,this.mateiralBlur),t=i}}upSample(t,e=this.steps[0]){let r=this.steps[t];for(let g=t-1;g>=0;g--){let i=Pe(r.size,f(2));this.steps[g]||(this.steps[g]=new It(i.x,i.y,!1,T.RGBA,ct.Linear),this.steps[g].wrapMode=dt.Clamp,this.steps[g].updateParameters());let A=g===0?e:this.steps[g];this.mateiralBlur.texture=r,this.mateiralBlur.textureSize=E(r.width,r.height,1/r.width,1/r.height),this.mateiralBlur.sampleOffset=1,this.renderer.blit(r,A,this.mateiralBlur),r=A}return r}};function zC(t){return f(Math.random(),Math.random()).mul(t.size).plus(t.min)}function GC(){return Math.random()*2-1}function Mt(t,e){return Math.random()*(e-t)+t}var NC=`#version 300 es\r
precision mediump float;\r
\r
in vec4 vColor;\r
in vec4 vPos;\r
in vec2 vUV;\r
\r
uniform sampler2D uMainTex;\r
uniform vec4 uColor;\r
\r
out vec4 fragColor;\r
\r
void main()\r
{\r
    vec4 color = texture(uMainTex, vUV.xy).rgba;\r
    color.rgba = color * uColor;\r
    fragColor = color.rgba;\r
}`,LC=`#version 300 es\r
precision mediump float;\r
\r
in vec2 vUV;\r
\r
uniform sampler2D uMainTex;\r
uniform sampler2D uMistTex;\r
uniform vec4 uMistColor;\r
\r
out vec4 fragColor;\r
\r
void main()\r
{\r
    vec4 color = texture(uMainTex, vUV.xy).rgba;\r
    color.rgb += vec3(uMistColor);\r
    color.a = texture(uMistTex, vUV.xy).r * uMistColor.a;\r
    fragColor = color.rgba;\r
}`,OC=`#version 300 es\r
precision mediump float;\r
\r
in vec4 vColor;\r
in vec4 vPos;\r
in vec2 vUV;\r
\r
uniform sampler2D uMainTex;\r
uniform vec4 uBackgroundSize; // (x, y, 1/x, 1/y)\r
uniform sampler2D uRaindropTex;\r
uniform sampler2D uDropletTex;\r
uniform sampler2D uMistTex;\r
uniform vec4 uColor;\r
uniform vec2 uSmoothRaindrop;\r
uniform vec2 uRefractParams; // (refractBase, refractScale)\r
uniform vec4 uLightPos;\r
uniform vec4 uDiffuseColor; // (color.rgb, shadowOffset)\r
uniform vec4 uSpecularParams; // (color.rgb, exponent)\r
uniform float uBump;\r
\r
out vec4 fragColor;\r
\r
void main()\r
{\r
    // vec3 lightPos = vec3(0.5, 1, 1);\r
\r
    vec4 raindrop = texture(uRaindropTex, vUV.xy).rgba;\r
    vec4 droplet = texture(uDropletTex, vUV.xy).rgba;\r
    float mist = texture(uMistTex, vUV.xy).r;\r
\r
    vec4 compose = vec4(raindrop.rgb + droplet.rgb - vec3(2.0) * raindrop.rgb * droplet.rgb, max(droplet.a, raindrop.a));\r
\r
    float mask = smoothstep(uSmoothRaindrop.x, uSmoothRaindrop.y, compose.a);\r
    \r
    vec2 uv = vUV.xy + -(compose.xy - vec2(0.5)) * vec2(compose.b * uRefractParams.y + uRefractParams.x);\r
    vec3 normal = normalize(vec3((compose.xy - vec2(0.5)) * vec2(2), 1.0));\r
\r
    // vec3 lightDir = lightPos - vec3(vUV, 0);\r
    vec3 lightDir = uLightPos.xyz - uLightPos.w * vec3(vUV.xy, 0.0);\r
    vec3 viewDir = vec3(0, 0, 1);\r
    vec3 halfDir = normalize(lightDir + viewDir);\r
    float lambertian = clamp(dot(normalize(lightDir), normal), 0.0, 1.0);\r
    float blinnPhon = pow(max(dot(normal, halfDir), 0.0), uSpecularParams.a);\r
\r
\r
    // offset = pow(offset, vec2(2));\r
    vec4 color = texture(uMainTex, uv.xy).rgba;\r
    vec3 diffuse = vec3((lambertian - uDiffuseColor.a) * uDiffuseColor.rgb);\r
\r
    color.rgb += vec3((lambertian - uDiffuseColor.a) * uDiffuseColor.rgb);\r
    color.rgb += vec3(blinnPhon) * uSpecularParams.rgb;\r
    \r
\r
    // fragColor = vec4(mask, mask, mask, 1);\r
    // color = color * vec3(uColor);\r
\r
    fragColor = vec4(color.rgb, mask);// vec4(color.rgb, mask);\r
}`,kC=`#version 300 es\r
precision mediump float;\r
\r
in vec3 aPos;\r
in vec2 aUV;\r
\r
uniform mat4 uTransformVP;\r
\r
uniform float uSeed;\r
uniform vec4 uSpawnRect; // (xmin, ymin, xsize, ysize)\r
uniform vec2 uSizeRange; \r
\r
out vec2 vUV;\r
\r
// Gold Noise \xA92015 dcerisano@standard3d.com\r
// - based on the Golden Ratio\r
// - uniform normalized distribution\r
// - fastest static noise generator function (also runs at low precision)\r
// Ref: https://www.shadertoy.com/view/ltB3zD\r
const float PHI = 1.61803398874989484820459; // \u03A6 = Golden Ratio \r
\r
float gold_noise(in vec2 xy, in float seed)\r
{\r
    return fract(tan(distance(xy*PHI, xy)*seed)*xy.x);\r
}\r
\r
vec2 lerp(vec2 a, vec2 b, vec2 t)\r
{\r
    return a + (b - a) * t;\r
}\r
\r
void main()\r
{\r
    int id = gl_InstanceID + 1;\r
    vec2 pos = uSpawnRect.xy + uSpawnRect.zw * vec2(\r
        gold_noise(vec2(1, id), uSeed + 1.0),\r
        gold_noise(vec2(id, 1), uSeed + 2.0));\r
\r
    vec2 size = vec2(\r
        gold_noise(vec2(1, id), uSeed + 3.0),\r
        gold_noise(vec2(id, 1), uSeed + 4.0));\r
    size = lerp(vec2(uSizeRange.x), vec2(uSizeRange.y), size);\r
    \r
    mat4 model = mat4(size.x, 0.0, 0.0, 0.0,  \r
                      0.0, size.x, 0.0, 0.0,  \r
                      0.0, 0.0, 1, 0.0,  \r
                      pos.x, pos.y, 0.0, 1.0); \r
    mat4 mvp = uTransformVP * model;\r
    gl_Position = mvp * vec4(aPos, 1);\r
    vUV = aUV;\r
}`,VC=`#version 300 es\r
precision mediump float;\r
\r
in vec2 vUV;\r
\r
uniform sampler2D uMainTex;\r
uniform vec4 uColor;\r
\r
out vec4 fragColor;\r
\r
void main()\r
{\r
    vec4 color = texture(uMainTex, vUV.xy).rgba;\r
    color.rgb *= color.a;\r
    fragColor = vec4(color.rg, 0.0, color.a);\r
}`,QC=`#version 300 es\r
precision mediump float;\r
\r
in vec4 vColor;\r
in vec4 vPos;\r
in vec2 vUV;\r
\r
uniform sampler2D uMainTex;\r
uniform vec4 uColor;\r
uniform vec2 uEraserSmooth;\r
\r
out vec4 fragColor;\r
\r
void main()\r
{\r
    vec4 color = texture(uMainTex, vUV.xy).rgba;\r
    color.a = smoothstep(uEraserSmooth.x, uEraserSmooth.y, color.a);\r
    fragColor = color.rgba;\r
}`,WC=`#version 300 es\r
precision mediump float;\r
\r
in vec4 vColor;\r
in vec4 vPos;\r
in vec2 vUV;\r
in float vSize;\r
\r
uniform sampler2D uMainTex;\r
uniform float uSize;\r
\r
out vec4 fragColor;\r
\r
void main()\r
{\r
    vec4 color = texture(uMainTex, vUV.xy).rgba;\r
    \r
    fragColor = vec4(color.rg * color.a, vSize * color.a, color.a);\r
}`,jC=`#version 300 es\r
precision mediump float;\r
\r
in vec3 aPos;\r
in vec4 aColor;\r
in vec2 aUV;\r
in vec3 aNormal;\r
\r
in float aSize;\r
in mat4 aModelMatrix;\r
\r
uniform mat4 uTransformM;\r
uniform mat4 uTransformVP;\r
uniform mat4 uTransformMVP;\r
uniform mat4 uTransformM_IT;\r
\r
out vec4 vColor;\r
out vec4 vPos;\r
out vec2 vUV;\r
out vec3 vNormal;\r
out vec3 vWorldPos;\r
out float vSize;\r
\r
void main()\r
{\r
    mat4 mvp = uTransformVP * aModelMatrix;\r
    gl_Position = mvp * vec4(aPos, 1);\r
    vPos = gl_Position;\r
    vColor = aColor;\r
    vUV = aUV;\r
    vNormal = (uTransformM_IT *  vec4(aNormal, 0)).xyz;\r
    vWorldPos = (uTransformM * vec4(aPos, 1)).xyz;\r
    vSize = aSize;\r
}`,KC={size:"float",modelMatrix:"mat4"},Oe=class extends St(new lt(jC,WC,{blendRGB:[U.OneMinusDstColor,U.OneMinusSrcColor],depth:xt.Disable,zWrite:!1,attributes:{size:"aSize",modelMatrix:"aModelMatrix"}})){constructor(){super(...arguments),this.texture=null,this.size=0}};k([O("uMainTex","tex2d")],Oe.prototype,"texture",2),k([O("uSize","float")],Oe.prototype,"size",2);var ge=class extends St(new lt(kC,VC,{vertexStructure:Lt,blendRGB:[U.OneMinusDstColor,U.OneMinusSrcColor],depth:xt.Disable,zWrite:!1,attributes:{size:"aSize",modelMatrix:"aModelMatrix"}})){constructor(){super(...arguments),this.texture=null,this.spawnRect=E(0,0,1,1),this.sizeRange=f(10,20),this.seed=1}};k([O("uMainTex","tex2d")],ge.prototype,"texture",2),k([O("uSpawnRect","vec4")],ge.prototype,"spawnRect",2),k([O("uSizeRange","vec2")],ge.prototype,"sizeRange",2),k([O("uSeed","float")],ge.prototype,"seed",2);var pt=class extends St(new lt(re,OC,{blend:[U.SrcAlpha,U.OneMinusSrcAlpha],depth:xt.Disable,zWrite:!1})){constructor(){super(...arguments),this.background=null,this.backgroundSize=E.one(),this.raindropTex=null,this.dropletTex=null,this.mistTex=null,this.smoothRaindrop=f(.95,1),this.refractParams=f(.4,.6),this.lightPos=E(.5,.5,2,1),this.diffuseLight=new X(.3,.3,.3,.8),this.specularParams=E(1,1,1,32),this.bump=1}};k([O("uMainTex","tex2d")],pt.prototype,"background",2),k([O("uBackgroundSize","vec4")],pt.prototype,"backgroundSize",2),k([O("uRaindropTex","tex2d")],pt.prototype,"raindropTex",2),k([O("uDropletTex","tex2d")],pt.prototype,"dropletTex",2),k([O("uMistTex","tex2d")],pt.prototype,"mistTex",2),k([O("uSmoothRaindrop","vec2")],pt.prototype,"smoothRaindrop",2),k([O("uRefractParams","vec2")],pt.prototype,"refractParams",2),k([O("uLightPos","vec4")],pt.prototype,"lightPos",2),k([O("uDiffuseColor","color")],pt.prototype,"diffuseLight",2),k([O("uSpecularParams","vec4")],pt.prototype,"specularParams",2),k([O("uBump","float")],pt.prototype,"bump",2);var qr=class extends Ne(new lt(re,QC,{blendRGB:[U.Zero,U.OneMinusSrcAlpha],blendAlpha:[U.Zero,U.OneMinusSrcAlpha]})){constructor(){super(...arguments),this.eraserSize=f(.93,1)}};k([O("uEraserSmooth","vec2")],qr.prototype,"eraserSize",2);var _C=Ne(new lt(re,NC,{blend:[U.One,U.One]})),ke=class extends Ne(new lt(re,LC,{blend:[U.SrcAlpha,U.OneMinusSrcAlpha]})){constructor(){super(...arguments),this.mistColor=new X(.01,.01,.01,1),this.mistTex=null}};k([O("uMistColor","color")],ke.prototype,"mistColor",2),k([O("uMistTex","tex2d")],ke.prototype,"mistTex",2);var HC=class{constructor(t){this.raindropTex=null,this.originalBackground=null,this.matrlCompose=new pt,this.matrlRaindrop=new Oe,this.matrlDroplet=new ge,this.matrlErase=new qr,this.matrlMist=new _C,this.matrlMistCompose=new ke,this.raindropBuffer=new Zt(KC,3e3),this.renderer=new RC(t.canvas),this.renderer.gl.getExtension("EXT_color_buffer_float"),this.options=t,this.projectionMatrix=y.ortho(0,t.width,0,t.height,1,-1),this.raindropComposeTex=new It(t.width,t.height,!1),this.background=new It(t.width,t.height,!1),this.dropletTexture=new It(t.width,t.height,!1),this.blurryBackground=new It(t.width,t.height,!1),this.mistBackground=new It(t.width,t.height,!1),this.mistTexture=new It(t.width,t.height,!1,T.R16F),this.blurRenderer=new UC(this.renderer),this.mesh=kt.quad(),this.renderer.setViewProjection(y.identity(),this.projectionMatrix)}async loadAssets(){this.raindropTex=await Yr.buffer(PC).then(t=>t.tex2d()),this.matrlRaindrop.texture=this.raindropTex,this.matrlDroplet.texture=this.raindropTex,await this.reloadBackground()}async reloadBackground(){var g;(g=this.originalBackground)==null||g.destroy(),typeof this.options.background=="string"?(this.originalBackground=await Yr.url(this.options.background).then(i=>i.tex2d({wrapMpde:dt.Clamp})),this.originalBackground.wrapMode=dt.Clamp,this.originalBackground.updateParameters()):(this.originalBackground=new jt,this.originalBackground.setData(this.options.background),this.originalBackground.updateParameters());let[t,e]=ee.imageResize(this.originalBackground.size,this.background.size,ee.ImageSizing.Cover);this.renderer.blit(this.originalBackground,this.background,this.renderer.assets.materials.blitCopy,t,e),this.background.generateMipmap(),this.blurBackground();let r={clamp:dt.Clamp,mirror:dt.Mirror,repeat:dt.Repeat};this.background.wrapMode=this.blurryBackground.wrapMode=r[this.options.backgroundWrapMode],this.background.updateParameters(),this.blurryBackground.updateParameters()}resize(){this.renderer.setSize(this.options.width,this.options.height),this.projectionMatrix=y.ortho(0,this.options.width,0,this.options.height,1,-1),this.renderer.setViewProjection(y.identity(),this.projectionMatrix),this.raindropComposeTex.resize(this.options.width,this.options.height),this.background.resize(this.options.width,this.options.height),this.dropletTexture.resize(this.options.width,this.options.height),this.blurryBackground.resize(this.options.width,this.options.height),this.mistBackground.resize(this.options.width,this.options.height),this.mistTexture.resize(this.options.width,this.options.height);let[t,e]=ee.imageResize(this.originalBackground.size,this.background.size,ee.ImageSizing.Cover);this.renderer.blit(this.originalBackground,this.background,this.renderer.assets.materials.blitCopy,t,e),this.background.generateMipmap(),this.blurBackground()}render(t,e){this.drawDroplet(e),this.drawMist(e.dt),this.drawRaindrops(t),this.renderer.setFramebuffer(ot.CanvasBuffer),this.renderer.clear(X.black),this.drawBackground(),this.matrlCompose.background=this.blurryBackground,this.matrlCompose.backgroundSize=E(this.options.width,this.options.height,1/this.options.width,1/this.options.height),this.matrlCompose.raindropTex=this.raindropComposeTex,this.matrlCompose.dropletTex=this.dropletTexture,this.matrlCompose.mistTex=this.mistTexture,this.matrlCompose.smoothRaindrop=f(...this.options.smoothRaindrop),this.matrlCompose.refractParams=f(this.options.refractBase,this.options.refractScale),this.matrlCompose.lightPos=E(...this.options.raindropLightPos),this.matrlCompose.diffuseLight=new X(...this.options.raindropDiffuseLight,this.options.raindropShadowOffset),this.matrlCompose.specularParams=E(...this.options.raindropSpecularLight,this.options.raindropSpecularShininess),this.matrlCompose.bump=this.options.raindropLightBump,this.renderer.blit(null,ot.CanvasBuffer,this.matrlCompose)}blurBackground(){this.options.mist?(this.blurRenderer.init(this.background),this.blurRenderer.downSample(this.background,Math.max(this.options.backgroundBlurSteps,this.options.mistBlurStep)),this.options.backgroundBlurSteps===this.options.mistBlurStep?(this.blurRenderer.upSample(this.options.backgroundBlurSteps,this.blurryBackground),this.renderer.blit(this.blurryBackground,this.mistBackground)):this.options.mistBlurStep>this.options.backgroundBlurSteps?(this.blurRenderer.upSample(this.options.backgroundBlurSteps,this.blurryBackground),this.blurRenderer.upSample(this.options.mistBlurStep,this.mistBackground)):(this.blurRenderer.upSample(this.options.mistBlurStep,this.mistBackground),this.blurRenderer.upSample(this.options.backgroundBlurSteps,this.blurryBackground))):this.blurRenderer.blur(this.background,this.options.backgroundBlurSteps,this.blurryBackground)}drawMist(t){!this.options.mist||(this.matrlMist.color.r=t/this.options.mistTime,this.renderer.blit(this.renderer.assets.textures.default,this.mistTexture,this.matrlMist))}drawBackground(){this.renderer.blit(this.blurryBackground,ot.CanvasBuffer),this.options.mist&&(this.matrlMistCompose.mistTex=this.mistTexture,this.matrlMistCompose.texture=this.mistBackground,this.matrlMistCompose.mistColor=new X(...this.options.mistColor),this.renderer.blit(this.mistBackground,ot.CanvasBuffer,this.matrlMistCompose))}drawRaindrops(t){t.length>this.raindropBuffer.length&&this.raindropBuffer.resize(this.raindropBuffer.length*2),this.renderer.setFramebuffer(this.raindropComposeTex),this.renderer.clear(X.black.transparent());for(let e=0;e<t.length;e++){let r=t[e],g=y.rts(rt.identity(),r.pos.toVec3(),r.size.toVec3(1));this.raindropBuffer[e].modelMatrix.set(g),this.raindropBuffer[e].size[0]=r.size.x/100}switch(this.raindropBuffer.markDirty(),this.options.raindropCompose){case"smoother":this.matrlRaindrop.setPipelineStateOverride({blendRGB:[U.OneMinusDstColor,U.OneMinusSrcColor]}),this.matrlDroplet.setPipelineStateOverride({blendRGB:[U.OneMinusDstColor,U.OneMinusSrcColor]});break;case"harder":this.matrlRaindrop.setPipelineStateOverride({blendRGB:[U.One,U.OneMinusSrcAlpha]}),this.matrlDroplet.setPipelineStateOverride({blendRGB:[U.One,U.OneMinusSrcAlpha]});break}this.renderer.drawMeshInstance(this.mesh,this.raindropBuffer,this.matrlRaindrop,t.length),this.matrlErase.eraserSize=f(...this.options.raindropEraserSize),this.renderer.blit(this.raindropComposeTex,this.dropletTexture,this.matrlErase),this.options.mist&&this.renderer.blit(this.raindropComposeTex,this.mistTexture,this.matrlErase)}drawDroplet(t){this.renderer.setFramebuffer(this.dropletTexture);let e=this.options.dropletsPerSeconds*t.dt;this.matrlDroplet.spawnRect=E(0,0,this.options.width,this.options.height),this.matrlDroplet.sizeRange=f(...this.options.dropletSize),this.matrlDroplet.seed=Mt(0,133),this.renderer.drawMeshProceduralInstance(this.mesh,this.matrlDroplet,e)}};function XC(t,e,r){return t+(e-t)*r}var Zr=class{constructor(t,e,r,g=1){this.density=1,this.velocity=f.zero(),this.destroied=!1,this._mass=0,this._size=f.zero(),this.resistance=0,this.shifting=0,this.nextRandomTime=0,this.pos=e,this.simulator=t,this.density=g,this.lastTrailPos=e.clone(),this.nextTrailDistance=Mt(...t.options.trailDistance),this.spread=f(t.options.initialSpread),this.mass=(r*g)**2}get mass(){return this._mass}set mass(t){this._mass=t;let e=Math.sqrt(t)/this.density;this._size.x=(this.spread.x+1)*e,this._size.y=(this.spread.y+1)*e}get size(){return this._size}get mergeDistance(){return this.size.x*(1+this.spread.x)*.16*this.simulator.options.colliderSize}get options(){return this.simulator.options}updateRaindrop(t){this.nextRandomTime<=t.total&&(this.nextRandomTime=t.total+Mt(...this.simulator.options.motionInterval),this.randomMotion()),this.mass-=this.simulator.options.evaporate*t.dt;let e=(this.options.gravity*this.mass-this.resistance)/this.mass;this.velocity.y-=e*t.dt,this.velocity.y>0&&(this.velocity.y=0),this.velocity.x=Math.abs(this.velocity.y)*this.shifting,this.pos.x+=this.velocity.x*t.dt,this.pos.y+=this.velocity.y*t.dt;let r=this.simulator.options.velocitySpread*2*Math.atan(Math.abs(this.velocity.y*.005))/Math.PI;this.spread.y=Math.max(this.spread.y,r),this.spread.x*=Math.pow(this.simulator.options.shrinkRate,t.dt),this.spread.y*=Math.pow(this.simulator.options.shrinkRate,t.dt),it.distanceSquared(this.lastTrailPos,this.pos)>this.nextTrailDistance*this.nextTrailDistance&&this.split()}split(){if(this.mass<1e3)return;let t=this.size.x*Mt(...this.simulator.options.trailDropSize),e=Qt(f(Mt(-5,5),this.size.y/4),this.pos),r=this.simulator.spawner.spawn(e.clone(),t,this.simulator.options.trailDropDensity);r.spread=f(.1,Math.abs(this.velocity.y)*.01*this.options.trailSpread),r.parent=this,this.mass-=r.mass,this.simulator.add(r),this.lastTrailPos=this.pos.clone(),this.nextTrailDistance=Mt(...this.simulator.options.trailDistance)}randomMotion(){let t=XC(...this.simulator.options.spawnSize,1-this.simulator.options.slipRate)**2*4;this.resistance=Mt(0,1)*this.options.gravity*t,this.shifting=GC()*Mt(...this.simulator.options.xShifting)}merge(t){let e=Pe(this.velocity,this.mass),r=Pe(t.velocity,t.mass),g=Qt(e,r);this.mass+=t.mass,this.velocity=le(g,this.mass)}},JC=class{constructor(t,e){this.currentTime=0,this.nextSpawn=0,this.simulator=t}get interval(){return this.simulator.options.spawnInterval}get size(){return this.simulator.options.spawnSize}get spawnRect(){return this.simulator.options.viewport}update(t){return this.currentTime+=t,this}*trySpawn(){for(;this.currentTime>=this.nextSpawn;){let t=Mt(...this.size),e=zC(this.spawnRect);this.nextSpawn+=Mt(...this.interval),yield new Zr(this.simulator,e,t)}this.currentTime>=this.nextSpawn}spawn(t,e,r=1){return new Zr(this.simulator,t,e,r)}},YC=class extends Array{push(...t){return super.push(...t)}add(t){let e=super.push(t);t.gridIdx=e-1,t.grid=this}delete(t){this[t.gridIdx]=this[this.length-1],this[t.gridIdx].gridIdx=t.gridIdx,this.length--,t.gridIdx=-1,t.grid=void 0}},qC=class{constructor(t){this.raindrops=[],this.grid=[],this.options=t,this.spawner=new JC(this,t),this.resize()}get gridSize(){return this.options.spawnSize[1]*.3}resize(){let t=Math.ceil(this.options.viewport.size.x/this.gridSize),e=Math.ceil(this.options.viewport.size.y/this.gridSize),r=0;this.grid.length<t*e&&(r=this.grid.length,this.grid.length=t*e);for(let g=r;g<this.grid.length;g++)this.grid[g]=new YC}gridAt(t,e){if(t<0||e<0)return;let r=Math.ceil((this.options.viewport.xMax-this.options.viewport.xMin)/this.gridSize),g=e*r+t;if(!(g>=this.grid.length))return this.grid[g]}gridAtWorldPos(t,e){return this.gridAt(...this.worldToGrid(t,e))}worldToGrid(t,e){let r=Math.floor(t/this.gridSize),g=Math.floor(e/this.gridSize);return[r,g]}add(t){this.raindrops.push(t);let e=this.gridAtWorldPos(t.pos.x,t.pos.y);e&&(e.add(t),t.gridIdx=e.length-1)}update(t){var e;if(this.raindrops.length<=this.options.spawnLimit)for(let r of this.spawner.update(t.dt).trySpawn())this.raindrops.push(r);this.raindropUpdate(t),this.collisionUpdate();for(let r=0;r<this.raindrops.length;r++)this.raindrops[r].destroied&&((e=this.raindrops[r].grid)==null||e.delete(this.raindrops[r]),this.raindrops[r]=this.raindrops[this.raindrops.length-1],this.raindrops.length--)}raindropUpdate(t){var e;for(let r=0;r<this.raindrops.length;r++){let g=this.raindrops[r];if(g.destroied||(g.updateRaindrop(t),g.pos.y<-100&&(g.destroied=!0),g.destroied))continue;let[i,A]=this.worldToGrid(g.pos.x,g.pos.y),C=this.gridAt(i,A);C!==g.grid&&((e=g.grid)==null||e.delete(g),C==null||C.add(g),g.grid=C)}}collisionUpdate(){for(let t=0;t<this.raindrops.length;t++){let e=this.raindrops[t];if(e.destroied)continue;let[r,g]=this.worldToGrid(e.pos.x,e.pos.y);for(let i=-1;i<=1;i++)for(let A=-1;A<=1;A++){let C=this.gridAt(r+i,g+A);if(C)for(let s of C){let n=s===e,I=s.parent===e||e.parent===s,o=e.parent&&e.parent===s.parent;if(s.destroied||I||o||n)continue;let a=e.pos.x-s.pos.x,h=e.pos.y-s.pos.y;Math.sqrt(a*a+h*h)-e.mergeDistance-s.mergeDistance<0&&(e.mass>=s.mass?(e.merge(s),s.destroied=!0):(s.merge(e),e.destroied=!0))}}}}};return be()})();const Ms=hs({__name:"RainDrop",setup(me){const zt=us(),yt=ls(),{t:wt}=cs();let k=null;const ve=Q=>new Promise((nt,xe)=>{const H=new Image;H.src=Q,H.crossOrigin="anonymous",H.onload=()=>{const Ce=H.width,se=H.height,Tt=document.createElement("canvas"),Ht=Tt.getContext("2d");if(Tt.setAttribute("width",Ce+"px"),Tt.setAttribute("height",se+"px"),Ht.drawImage(H,0,0,Ce,se),yt.global.backgroundFilter&&yt.global.backgroundFilter.includes("brightness")){const ne=/brightness\((\d+(\.\d+)?)\)/,Ie=yt.global.backgroundFilter.match(ne);if(Ie){const Gt=parseFloat(Ie[1]);if(Gt>0&&Gt<1){const ae=Ht.getImageData(0,0,Tt.width,Tt.height),Vt=ae.data;for(let Dt=0;Dt<Vt.length;Dt+=4)Vt[Dt]*=Gt,Vt[Dt+1]*=Gt,Vt[Dt+2]*=Gt;Ht.putImageData(ae,0,0)}}}const Me=Tt.toDataURL("image/png",1);nt(Me)},H.onerror=()=>{xe(new Error("Load img error"))}});fs(()=>{var Q;(Q=k==null?void 0:k.destroy)==null||Q.call(k),window.removeEventListener("resize",be),N&&clearTimeout(N)});function be(){if(k){const Q=zt.value.getBoundingClientRect();k.resize(Q.width,Q.height)}}let N;return ds(()=>[yt.realBackgroundURL,yt.global.backgroundFilter],()=>{N&&clearTimeout(N),N=setTimeout(async()=>{let Q=!0;if(k||(await ps(),zt.value.width=window.innerWidth,zt.value.height=window.innerHeight,k=new xs({canvas:zt.value}),Q=!1),document.querySelector(".global-bg-img")&&yt.realBackgroundURL)try{const nt=await ve(yt.realBackgroundURL);await k.setBackground(nt),Q||await k.start()}catch{ms({title:wt("\u9519\u8BEF"),type:"error",message:wt("\u96E8\u6EF4\u7279\u6548\u5B9E\u73B0\u5931\u8D25, \u8BF7\u786E\u4FDD\u58C1\u7EB8\u5730\u5740\u5141\u8BB8\u8DE8\u57DF")})}},100)},{immediate:!0}),(Q,nt)=>(vs(),bs("canvas",{class:"bg-effect-canvas",ref_key:"bgEffectCanvas",ref:zt},null,512))}});var Es=os(Ms,[["__scopeId","data-v-f0ab0d30"]]);export{Es as default};
