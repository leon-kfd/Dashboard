import{h as q,r,K as M,e as t,g as s,q as T,t as V,G,u as K,F as v,l as W,b as a,z as b,y,af as C,v as p,D as k,E as P}from"./vendor.0ec422ce.js";import{_ as J,a as Q,f as w}from"./index.3f70ec74.js";const X={key:0,class:"wrapper"},Y={class:"tab-title-wrapper"},Z={class:"tab-container"},ee={key:0,class:"text"},te={key:1,class:"text"},ae={key:2,class:"item-wrapper"},se=["onClick"],le={class:"img-wrapper"},ne=["src"],oe={class:"tab-container"},ie={key:0,class:"text"},re={key:1,class:"text"},ue={key:2,class:"item-wrapper"},ce=["onClick"],ve={class:"img-wrapper"},de=["src"],pe={class:"sub-tab-container"},_e=["onClick"],he={class:"tab-container"},ge={class:"item-wrapper"},me=["onClick"],fe={class:"img-wrapper"},be=["src"],ye={class:"load-more"},Ce=["loading"],ke=q({emits:["submit"],setup(we,{emit:z}){const _=r(!1),x=r(),l=r(1),i=r(!1),u=r(!1),h=r([]),g=r([]),m=r([]),E=r(1),j=[{label:"\u98CE\u666F",value:9},{label:"4K",value:36},{label:"\u6E05\u65B0",value:15},{label:"\u840C\u5BA0",value:14},{label:"\u6E38\u620F",value:5},{label:"\u6C7D\u8F66",value:12},{label:"\u65F6\u5C1A",value:10},{label:"\u4F53\u80B2",value:16}],f=r(9),S=async()=>{try{i.value=!0,u.value=!1;const o=encodeURIComponent("https://cn.bing.com/HPImageArchive.aspx?format=js&idx=0&n=8&mkt=zh-CN"),n=await fetch(`${w}/api/transfer?target=${o}&noHeaders=1`,{headers:{"content-type":"application/json; charset=utf-8"}}),{images:d}=await n.json(),e=encodeURIComponent("https://cn.bing.com/HPImageArchive.aspx?format=js&idx=8&n=8&mkt=zh-CN"),c=await fetch(`${w}/api/transfer?target=${e}&noHeaders=1`,{headers:{"content-type":"application/json; charset=utf-8"}}),{images:A}=await c.json();A.shift();const R=[...d,...A];h.value=R.map(B=>{const H=`https://cn.bing.com/${B.url}`,U=`https://cn.bing.com/${B.urlbase}_320x240.jpg&rf=LaDigue_1920x1080.jpg&pid=hp`;return{url:H,thumb:U}})}catch(o){u.value=!0,console.error(o)}finally{i.value=!1}},D=async()=>{try{i.value=!0,u.value=!1;const o=await fetch(`${w}/photos?pageSize=18`),{errCode:n,data:d}=await o.json();if(n===200)g.value=d.list.map(e=>({url:e.urls.raw,thumb:e.urls.thumb}));else throw new Error("Api server error")}catch(o){u.value=!0,console.error(o)}finally{i.value=!1}},L=async(o=!1)=>{o&&(m.value=[],E.value=1);try{i.value=!0,u.value=!1;const n=await fetch(`${w}/api/360img?cid=${f.value}&page=${E.value}&pageSize=18`),{errno:d,data:e}=await n.json();if(d===0)m.value=[...m.value,...e.list.map(c=>({url:c.url.replace("http","https"),thumb:`${c.url.replace("http","https")}?x-oss-process=image/resize,w_300/quality,q_90`}))];else throw new Error("Api server error")}catch(n){u.value=!0,console.error(n)}finally{i.value=!1}},F=()=>{x.value.open(),_.value||(_.value=!0)};M(()=>[_.value,l.value,f.value],()=>{l.value===1?(!h.value||h.value.length===0)&&S():l.value===2?(!g.value||g.value.length===0)&&D():l.value===3&&L(!0)});const N=()=>{E.value++,L()},O=()=>{},$=o=>{z("submit",o),x.value.close()},I=Q(!0);return(o,n)=>{const d=W("animation-dialog");return a(),t(v,null,[s("button",{type:"button",class:"btn btn-small btn-primary",style:{margin:"0","margin-right":"5px"},onClick:F},"\u4ECA\u65E5\u58C1\u7EB8\u63A8\u8350"),T(d,G({ref_key:"dialog",ref:x,animationMode:"",title:"\u4ECA\u65E5\u58C1\u7EB8\u63A8\u8350",width:"min(760px, 94vw)",height:"min(520px, 80vh)",appendToBody:"",closeOnClickOutside:!1,listenWindowSizeChange:!0,onBeforeClose:O},K(I),{customWrapperClass:"recommend-picture"}),{default:V(()=>[_.value?(a(),t("div",X,[s("div",Y,[s("div",{class:b(["title",l.value===1&&"active"]),onClick:n[0]||(n[0]=e=>l.value=1)},"\u5FC5\u5E94\u58C1\u7EB8",2),s("div",{class:b(["title",l.value===3&&"active"]),onClick:n[1]||(n[1]=e=>l.value=3)},"360\u58C1\u7EB8",2),s("div",{class:b(["title",l.value===2&&"active"]),onClick:n[2]||(n[2]=e=>l.value=2)},"UNSPLAH",2)]),y(s("div",Z,[i.value?(a(),t("div",ee,"Loading...")):u.value?(a(),t("div",te,"Something Error...")):(a(),t("div",ae,[(a(!0),t(v,null,p(h.value,e=>(a(),t("div",{class:"item",key:e.url,onClick:c=>$(e.url)},[s("div",le,[e.url?(a(),t("img",{key:0,src:e.thumb,loading:"lazy"},null,8,ne)):k("",!0)])],8,se))),128)),(a(),t(v,null,p(4,e=>s("div",{class:"item-fake",key:e})),64))]))],512),[[C,l.value===1]]),y(s("div",oe,[i.value?(a(),t("div",ie,"Loading...")):u.value?(a(),t("div",re,"Something Error...")):(a(),t("div",ue,[(a(!0),t(v,null,p(g.value,e=>(a(),t("div",{class:"item",key:e.url,onClick:c=>$(e.url)},[s("div",ve,[e.url?(a(),t("img",{key:0,src:e.thumb,loading:"lazy"},null,8,de)):k("",!0)])],8,ce))),128)),(a(),t(v,null,p(4,e=>s("div",{class:"item-fake",key:e})),64))]))],512),[[C,l.value===2]]),y(s("div",pe,[(a(),t(v,null,p(j,e=>s("div",{class:b(["sub-tab-title",f.value===e.value&&"active"]),key:e.value,onClick:c=>f.value=e.value},P(e.label),11,_e)),64))],512),[[C,l.value===3]]),y(s("div",he,[s("div",ge,[(a(!0),t(v,null,p(m.value,e=>(a(),t("div",{class:"item",key:e.url,onClick:c=>$(e.url)},[s("div",fe,[e.url?(a(),t("img",{key:0,src:e.thumb,loading:"lazy"},null,8,be)):k("",!0)])],8,me))),128)),(a(),t(v,null,p(4,e=>s("div",{class:"item-fake",key:e})),64))]),s("div",ye,[s("button",{class:"btn btn-warning",loading:i.value,onClick:N},P(i.value?"LOADING...":"LOAD MORE"),9,Ce)])],512),[[C,l.value===3]])])):k("",!0)]),_:1},16)],64)}}});var $e=J(ke,[["__scopeId","data-v-69e8dec2"]]);export{$e as default};
