import{_ as ne,d as oe,O as ie,u as ae,r as h,H as x,z as se,A as le,I as ce,e as re,o as l,k as c,h as d,D as f,P as B,j as p,p as V,t as y,Q as L,R as ue,i as k,g as A,U as D,F as J,n as K,E as H,C as de,V as me,K as pe,W as ve}from"./index.27ec1541.js";import{g as U}from"./images.af872614.js";const ge=["src"],he=["src"],fe={key:2,class:"no-icon"},ye={class:"search-input-box-wrapper"},ke=["onKeydown"],Se=["onClick"],be=["src"],xe=["src"],we={key:2,class:"no-icon"},Ce={class:"text"},Te=["onClick"],Ee=["onClick"],_e={key:0,class:"clear-history"},Be={class:"tab-tooltips"},Le={class:"main"},Ae=["onClick"],He=oe({__name:"index",props:{componentSetting:{type:Object,required:!0},element:{type:Object,required:!0},isAction:{type:Boolean,default:!1}},setup(o){const t=o;ie(e=>({74906747:ee.value,"1cf48f24":te.value}));const m=ae(),v=h(0),S=h(!1),i=h(""),a=h([]),r=h(-1),b=h(!1),T=h(),g=x(()=>t.componentSetting.engineList[v.value]||t.componentSetting.engineList[0]);let w;const R=e=>{v.value=e,S.value=!1},E=()=>{w&&window.clearTimeout(w),t.componentSetting.rememberHistory&&Q(i.value);let e=g.value.link;/\[0\]/.test(e)?e=e.replace(/\[0\]/,encodeURIComponent(i.value)):e=e+encodeURIComponent(i.value),i.value="",a.value=[],T.value.blur(),t.componentSetting.jumpType===2?window.location.href=e:window.open(e)},j=e=>{[9,13,38,40].includes(e.keyCode)?(e.keyCode===9&&(e.shiftKey?(v.value=v.value<=0?t.componentSetting.engineList.length-1:--v.value,e.preventDefault()):(v.value=v.value>=t.componentSetting.engineList.length-1?0:++v.value,e.preventDefault())),e.keyCode===13&&E(),e.keyCode===38&&(r.value=r.value<=0&&a.value.length>0?a.value.length-1:r.value-1,i.value=a.value[r.value]),e.keyCode===40&&(r.value=r.value<a.value.length-1&&a.value.length>0?r.value+1:0,i.value=a.value[r.value])):(w&&window.clearTimeout(w),w=window.setTimeout(()=>{_()},400))},I=x(()=>t.componentSetting.focusBgAnimation&&m.global.background.includes("url")),z=()=>{_(),t.componentSetting.showTabTips&&(!t.componentSetting.rememberHistory||t.componentSetting.rememberHistoryList.length===0)&&(b.value=!0),I.value&&m.updateState({key:"showBackgroundEffect",value:!0})},P=()=>{setTimeout(()=>{b.value=!1},200),a.value=[],I.value&&m.updateState({key:"showBackgroundEffect",value:!1})},M=()=>{b.value=!1;const e=JSON.parse(JSON.stringify(t.element));t.isAction?(e.actionSetting.actionClickValue.componentSetting.showTabTips=!1,m.updateActionElement(e)):e.componentSetting.showTabTips=!1,m.editComponent(e)},W=()=>{i.value=""},q=e=>{a.value=[],r.value=-1,i.value=e,setTimeout(()=>{E()},200)};async function _(){if(!i.value){t.componentSetting.rememberHistory?a.value=t.componentSetting.rememberHistoryList||[]:a.value=[],r.value=-1;return}if(!!t.componentSetting.keywordLink)try{const e=await fetch(`${pe}/getAutomatedKeywords?s=${i.value}`),{errCode:n,data:u}=await e.json();if(n===200)b.value=!1,i.value&&(a.value=u);else throw new Error("403")}catch{a.value=[],r.value=-1}}function Q(e){if(!e||e.trim().length===0)return;const n=JSON.parse(JSON.stringify(t.element)),u=n.componentSetting.rememberHistoryList||[];~u.indexOf(e)||(u.unshift(e),u.length>10&&(u.length=10),t.isAction?(n.actionSetting.actionClickValue.componentSetting.rememberHistoryList=u,m.updateActionElement(n)):n.componentSetting.rememberHistoryList=u,m.editComponent(n))}function G(){a.value=[],r.value=-1;const e=JSON.parse(JSON.stringify(t.element));t.isAction?(e.actionSetting.actionClickValue.componentSetting.rememberHistoryList=[],m.updateActionElement(e)):e.componentSetting.rememberHistoryList=[],m.editComponent(e)}async function X(e){const n=JSON.parse(JSON.stringify(t.element));t.isAction?(n.actionSetting.actionClickValue.componentSetting.rememberHistoryList.splice(e,1),m.updateActionElement(n)):n.componentSetting.rememberHistoryList.splice(e,1),m.editComponent(n),await ve(),T.value.focus(),_()}const F=h();function N(e){S.value&&!F.value.contains(e.target)&&(S.value=!1)}se(()=>{b.value=t.element.showTabTips,document.addEventListener("click",N)}),le(()=>{document.removeEventListener("click",N)});const Y=x(()=>ce(t.componentSetting.position)),O=x(()=>m.isLock),Z=e=>{O.value&&e.stopPropagation()},ee=x(()=>t.componentSetting.boxBackground||"rgba(255,255,255,0.9)"),te=x(()=>t.componentSetting.textColor||"#464650");return(e,n)=>{const u=re("Icon");return l(),c("div",{class:"wrapper material-search",style:f({padding:o.componentSetting.padding+"px",...Y.value})},[d("div",{class:"search-wrapper-box",style:f({maxWidth:`${o.componentSetting.maxWidth||600}px`,pointerEvents:O.value?"all":"none"}),onContextmenu:Z},[d("div",{class:"search-main-box",style:f({boxShadow:o.componentSetting.boxShadow,borderRadius:`${o.componentSetting.boxRadius||4}px`,padding:`0 ${(o.componentSetting.boxRadius||4)/4}px`,backdropFilter:o.componentSetting.backdropBlur?"blur(5px)":"none"})},[d("div",{class:"search-engine-box",style:f({filter:o.componentSetting.backdropBlur?"drop-shadow(1px 2px 4px #262626)":"none"}),onClick:n[0]||(n[0]=B(s=>S.value=!S.value,["stop"]))},[g.value.iconType==="local"||g.value.iconType==="network"?(l(),c("img",{key:0,src:g.value.iconPath,alt:"icon",width:"24",height:"24"},null,8,ge)):p("",!0),g.value.iconType==="api"?(l(),c("img",{key:1,src:V(U)(g.value.link),alt:"icon",width:"24",height:"24"},null,8,he)):p("",!0),g.value.iconType==="text"?(l(),c("div",fe,y(g.value.name.slice(0,1)),1)):p("",!0)],4),d("div",ye,[L(d("input",{class:"search-input-box",style:f({color:o.componentSetting.textColor}),ref_key:"searchInput",ref:T,"onUpdate:modelValue":n[1]||(n[1]=s=>i.value=s),onKeydown:B(j,["stop"]),onFocus:z,onBlur:P,tabindex:"1"},null,44,ke),[[ue,i.value]]),i.value?(l(),c("div",{key:0,class:"clear-btn",onClick:W},[k(u,{name:"close"})])):p("",!0)]),d("div",{class:"search-btn",style:f({color:o.componentSetting.textColor,filter:o.componentSetting.backdropBlur?"drop-shadow(1px 2px 4px #262626)":"none"}),onClick:E},[k(u,{name:"search"})],4)],4),k(H,{name:"fadeInUp"},{default:A(()=>[L(d("div",{ref_key:"engineSelector",ref:F,class:"engine-selector",style:f({backdropFilter:o.componentSetting.backdropBlur?"blur(5px)":"none",filter:o.componentSetting.backdropBlur?"drop-shadow(1px 2px 4px #262626)":"none"})},[(l(!0),c(J,null,K(o.componentSetting.engineList,(s,C)=>(l(),c("div",{key:C,class:"engine-list-item",onClick:$=>R(C)},[s.iconType==="local"||s.iconType==="network"?(l(),c("img",{key:0,src:s.iconPath,alt:"icon",width:"24",height:"24"},null,8,be)):p("",!0),s.iconType==="api"?(l(),c("img",{key:1,src:V(U)(s.link),alt:"icon",width:"24",height:"24"},null,8,xe)):p("",!0),s.iconType==="text"?(l(),c("div",we,y(s.name.slice(0,1)),1)):p("",!0),d("div",Ce,y(s.name),1)],8,Se))),128))],4),[[D,S.value]])]),_:1}),k(H,{name:"fadeInUp"},{default:A(()=>[a.value.length>0?(l(),c("div",{key:0,class:"link-search-wrapper",style:f({backdropFilter:o.componentSetting.backdropBlur?"blur(5px)":"none"})},[(l(!0),c(J,null,K(a.value,(s,C)=>(l(),c("div",{class:de(["link-search-item",{active:r.value===C}]),key:s},[d("div",{class:"text",onClick:$=>q(s)},y(s),9,Te),i.value?p("",!0):(l(),c("div",{key:0,class:"remove-btn",onClick:$=>X(C)},[k(u,{name:"close",size:"1em"})],8,Ee))],2))),128)),!i.value&&o.componentSetting.rememberHistory?(l(),c("div",_e,[d("div",{class:"clear-history-btn",onClick:G},[k(u,{name:"delete",size:"1em",style:{"margin-right":"2px"}}),me(" "+y(e.$t("\u6E05\u7A7A\u5386\u53F2\u8BB0\u5F55")),1)])])):p("",!0)],4)):p("",!0)]),_:1}),k(H,{name:"fadeInUp"},{default:A(()=>[L(d("div",Be,[d("div",Le,y(e.$t("\u6309Tab\u952E\u53EF\u5FEB\u901F\u5207\u6362\u641C\u7D22\u5F15\u64CE")),1),d("div",{class:"no-more",onClick:B(M,["stop"])},y(e.$t("\u4E0D\u518D\u63D0\u793A")),9,Ae)],512),[[D,b.value]])]),_:1})],36)],4)}}});var Ne=ne(He,[["__scopeId","data-v-28e09daa"]]);export{Ne as default};
