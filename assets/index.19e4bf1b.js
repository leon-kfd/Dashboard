import{d as e,a0 as t,L as n,r,G as o,i,o as s,k as a,n as c,x as l,C as u,a1 as f,_ as d,u as p,B as h,f as m,g,t as v,z as y,A as b,a2 as w}from"./index.f259aa9c.js";import{l as k}from"./color.556e4bcb.js";
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function x(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(t){i(t)}}function a(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))}function C(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)}const S=(e,t)=>"function"==typeof t?"[Function]":t,M=e=>JSON.stringify(e,S),O=()=>new Error("Stack over flow, cannot pop on an empty stack."),A=()=>new Error("It seems that no theme found in editor, please make sure you have use theme in front of all plugins.\nIf you prefer to use an empty theme, you can use `themeFactory({})`.");var E,T,N,D,I=Object.defineProperty,z=Object.getOwnPropertySymbols,F=Object.prototype.hasOwnProperty,R=Object.prototype.propertyIsEnumerable,$=(e,t,n)=>t in e?I(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,_=(e,t,n)=>{if(!t.has(e))throw TypeError("Cannot "+n)},P=(e,t,n)=>(_(e,t,"read from private field"),n?n.call(e):t.get(e)),j=(e,t,n)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,n)},L=(e,t,n,r)=>(_(e,t,"write to private field"),r?r.call(e,n):t.set(e,n),n);const B=()=>{const e=new Map;return{getSlice:t=>{const n=e.get(t.id);if(!n)throw r=t.sliceName,new Error(`Context "${r}" not found, do you forget to inject it?`);var r;return n},sliceMap:e}},V=e=>Array.isArray(e)?[...e]:"object"==typeof e?((e,t)=>{for(var n in t||(t={}))F.call(t,n)&&$(e,n,t[n]);if(z)for(var n of z(t))R.call(t,n)&&$(e,n,t[n]);return e})({},e):e,H=(e,t)=>{const n=Symbol("Context"),r=(t,r=V(e))=>{let o=r;const i={id:n,set:e=>{o=e},get:()=>o,update:e=>{o=e(o)}};return t.set(n,i),i};return r.sliceName=t,r.id=n,r._typeInfo=()=>{throw new Error("Should not call a context out of the plugin.")},r};class W{constructor(e,t){j(this,E,void 0),j(this,T,void 0),this.use=e=>P(this,E).getSlice(e),this.get=e=>this.use(e).get(),this.set=(e,t)=>this.use(e).set(t),this.update=(e,t)=>this.use(e).update(t),this.timing=e=>P(this,T).get(e),this.wait=e=>this.timing(e)(),this.done=e=>this.timing(e).done(),this.waitTimers=async e=>{await Promise.all(this.get(e).map((e=>this.wait(e))))},L(this,E,e),L(this,T,t)}}E=new WeakMap,T=new WeakMap;class q{constructor(e,t){j(this,N,void 0),j(this,D,void 0),this.inject=(e,t)=>(e(P(this,N).sliceMap,t),this),this.record=e=>(e(P(this,D).store),this),L(this,N,e),L(this,D,t)}}N=new WeakMap,D=new WeakMap;const J=()=>{const e=new Map;return{store:e,get:t=>{const n=e.get(t.id);if(!n)throw new Error("Timer not found, do you forget to record it?");return n}}},K=(e,t=3e3)=>{const n=Symbol("Timer"),r=r=>{const o=Symbol(e),i=()=>new Promise(((n,r)=>{setTimeout((()=>{r(`Timing ${e} timeout.`)}),t),addEventListener(e,(e=>{e instanceof CustomEvent&&e.detail.id===o&&n(void 0)}))}));return i.done=()=>{const t=new CustomEvent(e,{detail:{id:o}});dispatchEvent(t)},r.set(n,i),i};return r.id=n,r};function U(e){this.content=e}U.prototype={constructor:U,find:function(e){for(var t=0;t<this.content.length;t+=2)if(this.content[t]===e)return t;return-1},get:function(e){var t=this.find(e);return-1==t?void 0:this.content[t+1]},update:function(e,t,n){var r=n&&n!=e?this.remove(n):this,o=r.find(e),i=r.content.slice();return-1==o?i.push(n||e,t):(i[o+1]=t,n&&(i[o]=n)),new U(i)},remove:function(e){var t=this.find(e);if(-1==t)return this;var n=this.content.slice();return n.splice(t,2),new U(n)},addToStart:function(e,t){return new U([e,t].concat(this.remove(e).content))},addToEnd:function(e,t){var n=this.remove(e).content.slice();return n.push(e,t),new U(n)},addBefore:function(e,t,n){var r=this.remove(t),o=r.content.slice(),i=r.find(e);return o.splice(-1==i?o.length:i,0,t,n),new U(o)},forEach:function(e){for(var t=0;t<this.content.length;t+=2)e(this.content[t],this.content[t+1])},prepend:function(e){return(e=U.from(e)).size?new U(e.content.concat(this.subtract(e).content)):this},append:function(e){return(e=U.from(e)).size?new U(this.subtract(e).content.concat(e.content)):this},subtract:function(e){var t=this;e=U.from(e);for(var n=0;n<e.content.length;n+=2)t=t.remove(e.content[n]);return t},get size(){return this.content.length>>1}},U.from=function(e){if(e instanceof U)return e;var t=[];if(e)for(var n in e)t.push(n,e[n]);return new U(t)};var G=U;function Q(e,t,n){for(var r=0;;r++){if(r==e.childCount||r==t.childCount)return e.childCount==t.childCount?null:n;var o=e.child(r),i=t.child(r);if(o!=i){if(!o.sameMarkup(i))return n;if(o.isText&&o.text!=i.text){for(var s=0;o.text[s]==i.text[s];s++)n++;return n}if(o.content.size||i.content.size){var a=Q(o.content,i.content,n+1);if(null!=a)return a}n+=o.nodeSize}else n+=o.nodeSize}}function Z(e,t,n,r){for(var o=e.childCount,i=t.childCount;;){if(0==o||0==i)return o==i?null:{a:n,b:r};var s=e.child(--o),a=t.child(--i),c=s.nodeSize;if(s!=a){if(!s.sameMarkup(a))return{a:n,b:r};if(s.isText&&s.text!=a.text){for(var l=0,u=Math.min(s.text.length,a.text.length);l<u&&s.text[s.text.length-l-1]==a.text[a.text.length-l-1];)l++,n--,r--;return{a:n,b:r}}if(s.content.size||a.content.size){var f=Z(s.content,a.content,n-1,r-1);if(f)return f}n-=c,r-=c}else n-=c,r-=c}}var X=function(e,t){if(this.content=e,this.size=t||0,null==t)for(var n=0;n<e.length;n++)this.size+=e[n].nodeSize},Y={firstChild:{configurable:!0},lastChild:{configurable:!0},childCount:{configurable:!0}};X.prototype.nodesBetween=function(e,t,n,r,o){void 0===r&&(r=0);for(var i=0,s=0;s<t;i++){var a=this.content[i],c=s+a.nodeSize;if(c>e&&!1!==n(a,r+s,o,i)&&a.content.size){var l=s+1;a.nodesBetween(Math.max(0,e-l),Math.min(a.content.size,t-l),n,r+l)}s=c}},X.prototype.descendants=function(e){this.nodesBetween(0,this.size,e)},X.prototype.textBetween=function(e,t,n,r){var o="",i=!0;return this.nodesBetween(e,t,(function(s,a){s.isText?(o+=s.text.slice(Math.max(e,a)-a,t-a),i=!n):s.isLeaf&&r?(o+="function"==typeof r?r(s):r,i=!n):!i&&s.isBlock&&(o+=n,i=!0)}),0),o},X.prototype.append=function(e){if(!e.size)return this;if(!this.size)return e;var t=this.lastChild,n=e.firstChild,r=this.content.slice(),o=0;for(t.isText&&t.sameMarkup(n)&&(r[r.length-1]=t.withText(t.text+n.text),o=1);o<e.content.length;o++)r.push(e.content[o]);return new X(r,this.size+e.size)},X.prototype.cut=function(e,t){if(null==t&&(t=this.size),0==e&&t==this.size)return this;var n=[],r=0;if(t>e)for(var o=0,i=0;i<t;o++){var s=this.content[o],a=i+s.nodeSize;a>e&&((i<e||a>t)&&(s=s.isText?s.cut(Math.max(0,e-i),Math.min(s.text.length,t-i)):s.cut(Math.max(0,e-i-1),Math.min(s.content.size,t-i-1))),n.push(s),r+=s.nodeSize),i=a}return new X(n,r)},X.prototype.cutByIndex=function(e,t){return e==t?X.empty:0==e&&t==this.content.length?this:new X(this.content.slice(e,t))},X.prototype.replaceChild=function(e,t){var n=this.content[e];if(n==t)return this;var r=this.content.slice(),o=this.size+t.nodeSize-n.nodeSize;return r[e]=t,new X(r,o)},X.prototype.addToStart=function(e){return new X([e].concat(this.content),this.size+e.nodeSize)},X.prototype.addToEnd=function(e){return new X(this.content.concat(e),this.size+e.nodeSize)},X.prototype.eq=function(e){if(this.content.length!=e.content.length)return!1;for(var t=0;t<this.content.length;t++)if(!this.content[t].eq(e.content[t]))return!1;return!0},Y.firstChild.get=function(){return this.content.length?this.content[0]:null},Y.lastChild.get=function(){return this.content.length?this.content[this.content.length-1]:null},Y.childCount.get=function(){return this.content.length},X.prototype.child=function(e){var t=this.content[e];if(!t)throw new RangeError("Index "+e+" out of range for "+this);return t},X.prototype.maybeChild=function(e){return this.content[e]},X.prototype.forEach=function(e){for(var t=0,n=0;t<this.content.length;t++){var r=this.content[t];e(r,n,t),n+=r.nodeSize}},X.prototype.findDiffStart=function(e,t){return void 0===t&&(t=0),Q(this,e,t)},X.prototype.findDiffEnd=function(e,t,n){return void 0===t&&(t=this.size),void 0===n&&(n=e.size),Z(this,e,t,n)},X.prototype.findIndex=function(e,t){if(void 0===t&&(t=-1),0==e)return te(0,e);if(e==this.size)return te(this.content.length,e);if(e>this.size||e<0)throw new RangeError("Position "+e+" outside of fragment ("+this+")");for(var n=0,r=0;;n++){var o=r+this.child(n).nodeSize;if(o>=e)return o==e||t>0?te(n+1,o):te(n,r);r=o}},X.prototype.toString=function(){return"<"+this.toStringInner()+">"},X.prototype.toStringInner=function(){return this.content.join(", ")},X.prototype.toJSON=function(){return this.content.length?this.content.map((function(e){return e.toJSON()})):null},X.fromJSON=function(e,t){if(!t)return X.empty;if(!Array.isArray(t))throw new RangeError("Invalid input for Fragment.fromJSON");return new X(t.map(e.nodeFromJSON))},X.fromArray=function(e){if(!e.length)return X.empty;for(var t,n=0,r=0;r<e.length;r++){var o=e[r];n+=o.nodeSize,r&&o.isText&&e[r-1].sameMarkup(o)?(t||(t=e.slice(0,r)),t[t.length-1]=o.withText(t[t.length-1].text+o.text)):t&&t.push(o)}return new X(t||e,n)},X.from=function(e){if(!e)return X.empty;if(e instanceof X)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new X([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))},Object.defineProperties(X.prototype,Y);var ee={index:0,offset:0};function te(e,t){return ee.index=e,ee.offset=t,ee}function ne(e,t){if(e===t)return!0;if(!e||"object"!=typeof e||!t||"object"!=typeof t)return!1;var n=Array.isArray(e);if(Array.isArray(t)!=n)return!1;if(n){if(e.length!=t.length)return!1;for(var r=0;r<e.length;r++)if(!ne(e[r],t[r]))return!1}else{for(var o in e)if(!(o in t)||!ne(e[o],t[o]))return!1;for(var i in t)if(!(i in e))return!1}return!0}X.empty=new X([],0);var re=function(e,t){this.type=e,this.attrs=t};function oe(e){var t=Error.call(this,e);return t.__proto__=oe.prototype,t}re.prototype.addToSet=function(e){for(var t,n=!1,r=0;r<e.length;r++){var o=e[r];if(this.eq(o))return e;if(this.type.excludes(o.type))t||(t=e.slice(0,r));else{if(o.type.excludes(this.type))return e;!n&&o.type.rank>this.type.rank&&(t||(t=e.slice(0,r)),t.push(this),n=!0),t&&t.push(o)}}return t||(t=e.slice()),n||t.push(this),t},re.prototype.removeFromSet=function(e){for(var t=0;t<e.length;t++)if(this.eq(e[t]))return e.slice(0,t).concat(e.slice(t+1));return e},re.prototype.isInSet=function(e){for(var t=0;t<e.length;t++)if(this.eq(e[t]))return!0;return!1},re.prototype.eq=function(e){return this==e||this.type==e.type&&ne(this.attrs,e.attrs)},re.prototype.toJSON=function(){var e={type:this.type.name};for(var t in this.attrs){e.attrs=this.attrs;break}return e},re.fromJSON=function(e,t){if(!t)throw new RangeError("Invalid input for Mark.fromJSON");var n=e.marks[t.type];if(!n)throw new RangeError("There is no mark type "+t.type+" in this schema");return n.create(t.attrs)},re.sameSet=function(e,t){if(e==t)return!0;if(e.length!=t.length)return!1;for(var n=0;n<e.length;n++)if(!e[n].eq(t[n]))return!1;return!0},re.setFrom=function(e){if(!e||0==e.length)return re.none;if(e instanceof re)return[e];var t=e.slice();return t.sort((function(e,t){return e.type.rank-t.type.rank})),t},re.none=[],oe.prototype=Object.create(Error.prototype),oe.prototype.constructor=oe,oe.prototype.name="ReplaceError";var ie=function(e,t,n){this.content=e,this.openStart=t,this.openEnd=n},se={size:{configurable:!0}};function ae(e,t,n){var r=e.findIndex(t),o=r.index,i=r.offset,s=e.maybeChild(o),a=e.findIndex(n),c=a.index,l=a.offset;if(i==t||s.isText){if(l!=n&&!e.child(c).isText)throw new RangeError("Removing non-flat range");return e.cut(0,t).append(e.cut(n))}if(o!=c)throw new RangeError("Removing non-flat range");return e.replaceChild(o,s.copy(ae(s.content,t-i-1,n-i-1)))}function ce(e,t,n,r){var o=e.findIndex(t),i=o.index,s=o.offset,a=e.maybeChild(i);if(s==t||a.isText)return r&&!r.canReplace(i,i,n)?null:e.cut(0,t).append(n).append(e.cut(t));var c=ce(a.content,t-s-1,n);return c&&e.replaceChild(i,a.copy(c))}function le(e,t,n){if(n.openStart>e.depth)throw new oe("Inserted content deeper than insertion position");if(e.depth-n.openStart!=t.depth-n.openEnd)throw new oe("Inconsistent open depths");return ue(e,t,n,0)}function ue(e,t,n,r){var o=e.index(r),i=e.node(r);if(o==t.index(r)&&r<e.depth-n.openStart){var s=ue(e,t,n,r+1);return i.copy(i.content.replaceChild(o,s))}if(n.content.size){if(n.openStart||n.openEnd||e.depth!=r||t.depth!=r){var a=function(e,t){for(var n=t.depth-e.openStart,r=t.node(n).copy(e.content),o=n-1;o>=0;o--)r=t.node(o).copy(X.from(r));return{start:r.resolveNoCache(e.openStart+n),end:r.resolveNoCache(r.content.size-e.openEnd-n)}}(n,e);return me(i,ge(e,a.start,a.end,t,r))}var c=e.parent,l=c.content;return me(c,l.cut(0,e.parentOffset).append(n.content).append(l.cut(t.parentOffset)))}return me(i,ve(e,t,r))}function fe(e,t){if(!t.type.compatibleContent(e.type))throw new oe("Cannot join "+t.type.name+" onto "+e.type.name)}function de(e,t,n){var r=e.node(n);return fe(r,t.node(n)),r}function pe(e,t){var n=t.length-1;n>=0&&e.isText&&e.sameMarkup(t[n])?t[n]=e.withText(t[n].text+e.text):t.push(e)}function he(e,t,n,r){var o=(t||e).node(n),i=0,s=t?t.index(n):o.childCount;e&&(i=e.index(n),e.depth>n?i++:e.textOffset&&(pe(e.nodeAfter,r),i++));for(var a=i;a<s;a++)pe(o.child(a),r);t&&t.depth==n&&t.textOffset&&pe(t.nodeBefore,r)}function me(e,t){if(!e.type.validContent(t))throw new oe("Invalid content for node "+e.type.name);return e.copy(t)}function ge(e,t,n,r,o){var i=e.depth>o&&de(e,t,o+1),s=r.depth>o&&de(n,r,o+1),a=[];return he(null,e,o,a),i&&s&&t.index(o)==n.index(o)?(fe(i,s),pe(me(i,ge(e,t,n,r,o+1)),a)):(i&&pe(me(i,ve(e,t,o+1)),a),he(t,n,o,a),s&&pe(me(s,ve(n,r,o+1)),a)),he(r,null,o,a),new X(a)}function ve(e,t,n){var r=[];(he(null,e,n,r),e.depth>n)&&pe(me(de(e,t,n+1),ve(e,t,n+1)),r);return he(t,null,n,r),new X(r)}se.size.get=function(){return this.content.size-this.openStart-this.openEnd},ie.prototype.insertAt=function(e,t){var n=ce(this.content,e+this.openStart,t,null);return n&&new ie(n,this.openStart,this.openEnd)},ie.prototype.removeBetween=function(e,t){return new ie(ae(this.content,e+this.openStart,t+this.openStart),this.openStart,this.openEnd)},ie.prototype.eq=function(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd},ie.prototype.toString=function(){return this.content+"("+this.openStart+","+this.openEnd+")"},ie.prototype.toJSON=function(){if(!this.content.size)return null;var e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e},ie.fromJSON=function(e,t){if(!t)return ie.empty;var n=t.openStart||0,r=t.openEnd||0;if("number"!=typeof n||"number"!=typeof r)throw new RangeError("Invalid input for Slice.fromJSON");return new ie(X.fromJSON(e,t.content),n,r)},ie.maxOpen=function(e,t){void 0===t&&(t=!0);for(var n=0,r=0,o=e.firstChild;o&&!o.isLeaf&&(t||!o.type.spec.isolating);o=o.firstChild)n++;for(var i=e.lastChild;i&&!i.isLeaf&&(t||!i.type.spec.isolating);i=i.lastChild)r++;return new ie(e,n,r)},Object.defineProperties(ie.prototype,se),ie.empty=new ie(X.empty,0,0);var ye=function(e,t,n){this.pos=e,this.path=t,this.depth=t.length/3-1,this.parentOffset=n},be={parent:{configurable:!0},doc:{configurable:!0},textOffset:{configurable:!0},nodeAfter:{configurable:!0},nodeBefore:{configurable:!0}};ye.prototype.resolveDepth=function(e){return null==e?this.depth:e<0?this.depth+e:e},be.parent.get=function(){return this.node(this.depth)},be.doc.get=function(){return this.node(0)},ye.prototype.node=function(e){return this.path[3*this.resolveDepth(e)]},ye.prototype.index=function(e){return this.path[3*this.resolveDepth(e)+1]},ye.prototype.indexAfter=function(e){return e=this.resolveDepth(e),this.index(e)+(e!=this.depth||this.textOffset?1:0)},ye.prototype.start=function(e){return 0==(e=this.resolveDepth(e))?0:this.path[3*e-1]+1},ye.prototype.end=function(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size},ye.prototype.before=function(e){if(!(e=this.resolveDepth(e)))throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[3*e-1]},ye.prototype.after=function(e){if(!(e=this.resolveDepth(e)))throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[3*e-1]+this.path[3*e].nodeSize},be.textOffset.get=function(){return this.pos-this.path[this.path.length-1]},be.nodeAfter.get=function(){var e=this.parent,t=this.index(this.depth);if(t==e.childCount)return null;var n=this.pos-this.path[this.path.length-1],r=e.child(t);return n?e.child(t).cut(n):r},be.nodeBefore.get=function(){var e=this.index(this.depth),t=this.pos-this.path[this.path.length-1];return t?this.parent.child(e).cut(0,t):0==e?null:this.parent.child(e-1)},ye.prototype.posAtIndex=function(e,t){t=this.resolveDepth(t);for(var n=this.path[3*t],r=0==t?0:this.path[3*t-1]+1,o=0;o<e;o++)r+=n.child(o).nodeSize;return r},ye.prototype.marks=function(){var e=this.parent,t=this.index();if(0==e.content.size)return re.none;if(this.textOffset)return e.child(t).marks;var n=e.maybeChild(t-1),r=e.maybeChild(t);if(!n){var o=n;n=r,r=o}for(var i=n.marks,s=0;s<i.length;s++)!1!==i[s].type.spec.inclusive||r&&i[s].isInSet(r.marks)||(i=i[s--].removeFromSet(i));return i},ye.prototype.marksAcross=function(e){var t=this.parent.maybeChild(this.index());if(!t||!t.isInline)return null;for(var n=t.marks,r=e.parent.maybeChild(e.index()),o=0;o<n.length;o++)!1!==n[o].type.spec.inclusive||r&&n[o].isInSet(r.marks)||(n=n[o--].removeFromSet(n));return n},ye.prototype.sharedDepth=function(e){for(var t=this.depth;t>0;t--)if(this.start(t)<=e&&this.end(t)>=e)return t;return 0},ye.prototype.blockRange=function(e,t){if(void 0===e&&(e=this),e.pos<this.pos)return e.blockRange(this);for(var n=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);n>=0;n--)if(e.pos<=this.end(n)&&(!t||t(this.node(n))))return new Ce(this,e,n)},ye.prototype.sameParent=function(e){return this.pos-this.parentOffset==e.pos-e.parentOffset},ye.prototype.max=function(e){return e.pos>this.pos?e:this},ye.prototype.min=function(e){return e.pos<this.pos?e:this},ye.prototype.toString=function(){for(var e="",t=1;t<=this.depth;t++)e+=(e?"/":"")+this.node(t).type.name+"_"+this.index(t-1);return e+":"+this.parentOffset},ye.resolve=function(e,t){if(!(t>=0&&t<=e.content.size))throw new RangeError("Position "+t+" out of range");for(var n=[],r=0,o=t,i=e;;){var s=i.content.findIndex(o),a=s.index,c=s.offset,l=o-c;if(n.push(i,a,r+c),!l)break;if((i=i.child(a)).isText)break;o=l-1,r+=c+1}return new ye(t,n,o)},ye.resolveCached=function(e,t){for(var n=0;n<we.length;n++){var r=we[n];if(r.pos==t&&r.doc==e)return r}var o=we[ke]=ye.resolve(e,t);return ke=(ke+1)%xe,o},Object.defineProperties(ye.prototype,be);var we=[],ke=0,xe=12,Ce=function(e,t,n){this.$from=e,this.$to=t,this.depth=n},Se={start:{configurable:!0},end:{configurable:!0},parent:{configurable:!0},startIndex:{configurable:!0},endIndex:{configurable:!0}};Se.start.get=function(){return this.$from.before(this.depth+1)},Se.end.get=function(){return this.$to.after(this.depth+1)},Se.parent.get=function(){return this.$from.node(this.depth)},Se.startIndex.get=function(){return this.$from.index(this.depth)},Se.endIndex.get=function(){return this.$to.indexAfter(this.depth)},Object.defineProperties(Ce.prototype,Se);var Me=Object.create(null),Oe=function(e,t,n,r){this.type=e,this.attrs=t,this.content=n||X.empty,this.marks=r||re.none},Ae={nodeSize:{configurable:!0},childCount:{configurable:!0},textContent:{configurable:!0},firstChild:{configurable:!0},lastChild:{configurable:!0},isBlock:{configurable:!0},isTextblock:{configurable:!0},inlineContent:{configurable:!0},isInline:{configurable:!0},isText:{configurable:!0},isLeaf:{configurable:!0},isAtom:{configurable:!0}};Ae.nodeSize.get=function(){return this.isLeaf?1:2+this.content.size},Ae.childCount.get=function(){return this.content.childCount},Oe.prototype.child=function(e){return this.content.child(e)},Oe.prototype.maybeChild=function(e){return this.content.maybeChild(e)},Oe.prototype.forEach=function(e){this.content.forEach(e)},Oe.prototype.nodesBetween=function(e,t,n,r){void 0===r&&(r=0),this.content.nodesBetween(e,t,n,r,this)},Oe.prototype.descendants=function(e){this.nodesBetween(0,this.content.size,e)},Ae.textContent.get=function(){return this.textBetween(0,this.content.size,"")},Oe.prototype.textBetween=function(e,t,n,r){return this.content.textBetween(e,t,n,r)},Ae.firstChild.get=function(){return this.content.firstChild},Ae.lastChild.get=function(){return this.content.lastChild},Oe.prototype.eq=function(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)},Oe.prototype.sameMarkup=function(e){return this.hasMarkup(e.type,e.attrs,e.marks)},Oe.prototype.hasMarkup=function(e,t,n){return this.type==e&&ne(this.attrs,t||e.defaultAttrs||Me)&&re.sameSet(this.marks,n||re.none)},Oe.prototype.copy=function(e){return void 0===e&&(e=null),e==this.content?this:new this.constructor(this.type,this.attrs,e,this.marks)},Oe.prototype.mark=function(e){return e==this.marks?this:new this.constructor(this.type,this.attrs,this.content,e)},Oe.prototype.cut=function(e,t){return 0==e&&t==this.content.size?this:this.copy(this.content.cut(e,t))},Oe.prototype.slice=function(e,t,n){if(void 0===t&&(t=this.content.size),void 0===n&&(n=!1),e==t)return ie.empty;var r=this.resolve(e),o=this.resolve(t),i=n?0:r.sharedDepth(t),s=r.start(i),a=r.node(i).content.cut(r.pos-s,o.pos-s);return new ie(a,r.depth-i,o.depth-i)},Oe.prototype.replace=function(e,t,n){return le(this.resolve(e),this.resolve(t),n)},Oe.prototype.nodeAt=function(e){for(var t=this;;){var n=t.content.findIndex(e),r=n.index,o=n.offset;if(!(t=t.maybeChild(r)))return null;if(o==e||t.isText)return t;e-=o+1}},Oe.prototype.childAfter=function(e){var t=this.content.findIndex(e),n=t.index,r=t.offset;return{node:this.content.maybeChild(n),index:n,offset:r}},Oe.prototype.childBefore=function(e){if(0==e)return{node:null,index:0,offset:0};var t=this.content.findIndex(e),n=t.index,r=t.offset;if(r<e)return{node:this.content.child(n),index:n,offset:r};var o=this.content.child(n-1);return{node:o,index:n-1,offset:r-o.nodeSize}},Oe.prototype.resolve=function(e){return ye.resolveCached(this,e)},Oe.prototype.resolveNoCache=function(e){return ye.resolve(this,e)},Oe.prototype.rangeHasMark=function(e,t,n){var r=!1;return t>e&&this.nodesBetween(e,t,(function(e){return n.isInSet(e.marks)&&(r=!0),!r})),r},Ae.isBlock.get=function(){return this.type.isBlock},Ae.isTextblock.get=function(){return this.type.isTextblock},Ae.inlineContent.get=function(){return this.type.inlineContent},Ae.isInline.get=function(){return this.type.isInline},Ae.isText.get=function(){return this.type.isText},Ae.isLeaf.get=function(){return this.type.isLeaf},Ae.isAtom.get=function(){return this.type.isAtom},Oe.prototype.toString=function(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);var e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),Te(this.marks,e)},Oe.prototype.contentMatchAt=function(e){var t=this.type.contentMatch.matchFragment(this.content,0,e);if(!t)throw new Error("Called contentMatchAt on a node with invalid content");return t},Oe.prototype.canReplace=function(e,t,n,r,o){void 0===n&&(n=X.empty),void 0===r&&(r=0),void 0===o&&(o=n.childCount);var i=this.contentMatchAt(e).matchFragment(n,r,o),s=i&&i.matchFragment(this.content,t);if(!s||!s.validEnd)return!1;for(var a=r;a<o;a++)if(!this.type.allowsMarks(n.child(a).marks))return!1;return!0},Oe.prototype.canReplaceWith=function(e,t,n,r){if(r&&!this.type.allowsMarks(r))return!1;var o=this.contentMatchAt(e).matchType(n),i=o&&o.matchFragment(this.content,t);return!!i&&i.validEnd},Oe.prototype.canAppend=function(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)},Oe.prototype.check=function(){if(!this.type.validContent(this.content))throw new RangeError("Invalid content for node "+this.type.name+": "+this.content.toString().slice(0,50));for(var e=re.none,t=0;t<this.marks.length;t++)e=this.marks[t].addToSet(e);if(!re.sameSet(e,this.marks))throw new RangeError("Invalid collection of marks for node "+this.type.name+": "+this.marks.map((function(e){return e.type.name})));this.content.forEach((function(e){return e.check()}))},Oe.prototype.toJSON=function(){var e={type:this.type.name};for(var t in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map((function(e){return e.toJSON()}))),e},Oe.fromJSON=function(e,t){if(!t)throw new RangeError("Invalid input for Node.fromJSON");var n=null;if(t.marks){if(!Array.isArray(t.marks))throw new RangeError("Invalid mark data for Node.fromJSON");n=t.marks.map(e.markFromJSON)}if("text"==t.type){if("string"!=typeof t.text)throw new RangeError("Invalid text node in JSON");return e.text(t.text,n)}var r=X.fromJSON(e,t.content);return e.nodeType(t.type).create(t.attrs,r,n)},Object.defineProperties(Oe.prototype,Ae);var Ee=function(e){function t(t,n,r,o){if(e.call(this,t,n,null,o),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={textContent:{configurable:!0},nodeSize:{configurable:!0}};return t.prototype.toString=function(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):Te(this.marks,JSON.stringify(this.text))},n.textContent.get=function(){return this.text},t.prototype.textBetween=function(e,t){return this.text.slice(e,t)},n.nodeSize.get=function(){return this.text.length},t.prototype.mark=function(e){return e==this.marks?this:new t(this.type,this.attrs,this.text,e)},t.prototype.withText=function(e){return e==this.text?this:new t(this.type,this.attrs,e,this.marks)},t.prototype.cut=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=this.text.length),0==e&&t==this.text.length?this:this.withText(this.text.slice(e,t))},t.prototype.eq=function(e){return this.sameMarkup(e)&&this.text==e.text},t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return t.text=this.text,t},Object.defineProperties(t.prototype,n),t}(Oe);function Te(e,t){for(var n=e.length-1;n>=0;n--)t=e[n].type.name+"("+t+")";return t}var Ne=function(e){this.validEnd=e,this.next=[],this.wrapCache=[]},De={inlineContent:{configurable:!0},defaultType:{configurable:!0},edgeCount:{configurable:!0}};Ne.parse=function(e,t){var n=new Ie(e,t);if(null==n.next)return Ne.empty;var r=Fe(n);n.next&&n.err("Unexpected trailing text");var o=function(e){var t=Object.create(null);return n(Le(e,0));function n(r){var o=[];r.forEach((function(t){e[t].forEach((function(t){var n=t.term,r=t.to;if(n){var i=o.indexOf(n),s=i>-1&&o[i+1];Le(e,r).forEach((function(e){s||o.push(n,s=[]),-1==s.indexOf(e)&&s.push(e)}))}}))}));for(var i=t[r.join(",")]=new Ne(r.indexOf(e.length-1)>-1),s=0;s<o.length;s+=2){var a=o[s+1].sort(je);i.next.push(o[s],t[a.join(",")]||n(a))}return i}}(function(e){var t=[[]];return o(i(e,0),n()),t;function n(){return t.push([])-1}function r(e,n,r){var o={term:r,to:n};return t[e].push(o),o}function o(e,t){e.forEach((function(e){return e.to=t}))}function i(e,t){if("choice"==e.type)return e.exprs.reduce((function(e,n){return e.concat(i(n,t))}),[]);if("seq"==e.type)for(var s=0;;s++){var a=i(e.exprs[s],t);if(s==e.exprs.length-1)return a;o(a,t=n())}else{if("star"==e.type){var c=n();return r(t,c),o(i(e.expr,c),c),[r(c)]}if("plus"==e.type){var l=n();return o(i(e.expr,t),l),o(i(e.expr,l),l),[r(l)]}if("opt"==e.type)return[r(t)].concat(i(e.expr,t));if("range"==e.type){for(var u=t,f=0;f<e.min;f++){var d=n();o(i(e.expr,u),d),u=d}if(-1==e.max)o(i(e.expr,u),u);else for(var p=e.min;p<e.max;p++){var h=n();r(u,h),o(i(e.expr,u),h),u=h}return[r(u)]}if("name"==e.type)return[r(t,null,e.value)]}}}(r));return function(e,t){for(var n=0,r=[e];n<r.length;n++){for(var o=r[n],i=!o.validEnd,s=[],a=0;a<o.next.length;a+=2){var c=o.next[a],l=o.next[a+1];s.push(c.name),!i||c.isText||c.hasRequiredAttrs()||(i=!1),-1==r.indexOf(l)&&r.push(l)}i&&t.err("Only non-generatable nodes ("+s.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}(o,n),o},Ne.prototype.matchType=function(e){for(var t=0;t<this.next.length;t+=2)if(this.next[t]==e)return this.next[t+1];return null},Ne.prototype.matchFragment=function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=e.childCount);for(var r=this,o=t;r&&o<n;o++)r=r.matchType(e.child(o).type);return r},De.inlineContent.get=function(){var e=this.next[0];return!!e&&e.isInline},De.defaultType.get=function(){for(var e=0;e<this.next.length;e+=2){var t=this.next[e];if(!t.isText&&!t.hasRequiredAttrs())return t}},Ne.prototype.compatible=function(e){for(var t=0;t<this.next.length;t+=2)for(var n=0;n<e.next.length;n+=2)if(this.next[t]==e.next[n])return!0;return!1},Ne.prototype.fillBefore=function(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=0);var r=[this];return function o(i,s){var a=i.matchFragment(e,n);if(a&&(!t||a.validEnd))return X.from(s.map((function(e){return e.createAndFill()})));for(var c=0;c<i.next.length;c+=2){var l=i.next[c],u=i.next[c+1];if(!l.isText&&!l.hasRequiredAttrs()&&-1==r.indexOf(u)){r.push(u);var f=o(u,s.concat(l));if(f)return f}}}(this,[])},Ne.prototype.findWrapping=function(e){for(var t=0;t<this.wrapCache.length;t+=2)if(this.wrapCache[t]==e)return this.wrapCache[t+1];var n=this.computeWrapping(e);return this.wrapCache.push(e,n),n},Ne.prototype.computeWrapping=function(e){for(var t=Object.create(null),n=[{match:this,type:null,via:null}];n.length;){var r=n.shift(),o=r.match;if(o.matchType(e)){for(var i=[],s=r;s.type;s=s.via)i.push(s.type);return i.reverse()}for(var a=0;a<o.next.length;a+=2){var c=o.next[a];c.isLeaf||c.hasRequiredAttrs()||c.name in t||r.type&&!o.next[a+1].validEnd||(n.push({match:c.contentMatch,type:c,via:r}),t[c.name]=!0)}}},De.edgeCount.get=function(){return this.next.length>>1},Ne.prototype.edge=function(e){var t=e<<1;if(t>=this.next.length)throw new RangeError("There's no "+e+"th edge in this content match");return{type:this.next[t],next:this.next[t+1]}},Ne.prototype.toString=function(){var e=[];return function t(n){e.push(n);for(var r=1;r<n.next.length;r+=2)-1==e.indexOf(n.next[r])&&t(n.next[r])}(this),e.map((function(t,n){for(var r=n+(t.validEnd?"*":" ")+" ",o=0;o<t.next.length;o+=2)r+=(o?", ":"")+t.next[o].name+"->"+e.indexOf(t.next[o+1]);return r})).join("\n")},Object.defineProperties(Ne.prototype,De),Ne.empty=new Ne(!0);var Ie=function(e,t){this.string=e,this.nodeTypes=t,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),""==this.tokens[this.tokens.length-1]&&this.tokens.pop(),""==this.tokens[0]&&this.tokens.shift()},ze={next:{configurable:!0}};function Fe(e){var t=[];do{t.push(Re(e))}while(e.eat("|"));return 1==t.length?t[0]:{type:"choice",exprs:t}}function Re(e){var t=[];do{t.push($e(e))}while(e.next&&")"!=e.next&&"|"!=e.next);return 1==t.length?t[0]:{type:"seq",exprs:t}}function $e(e){for(var t=function(e){if(e.eat("(")){var t=Fe(e);return e.eat(")")||e.err("Missing closing paren"),t}if(!/\W/.test(e.next)){var n=function(e,t){var n=e.nodeTypes,r=n[t];if(r)return[r];var o=[];for(var i in n){var s=n[i];s.groups.indexOf(t)>-1&&o.push(s)}0==o.length&&e.err("No node type or group '"+t+"' found");return o}(e,e.next).map((function(t){return null==e.inline?e.inline=t.isInline:e.inline!=t.isInline&&e.err("Mixing inline and block content"),{type:"name",value:t}}));return e.pos++,1==n.length?n[0]:{type:"choice",exprs:n}}e.err("Unexpected token '"+e.next+"'")}(e);;)if(e.eat("+"))t={type:"plus",expr:t};else if(e.eat("*"))t={type:"star",expr:t};else if(e.eat("?"))t={type:"opt",expr:t};else{if(!e.eat("{"))break;t=Pe(e,t)}return t}function _e(e){/\D/.test(e.next)&&e.err("Expected number, got '"+e.next+"'");var t=Number(e.next);return e.pos++,t}function Pe(e,t){var n=_e(e),r=n;return e.eat(",")&&(r="}"!=e.next?_e(e):-1),e.eat("}")||e.err("Unclosed braced range"),{type:"range",min:n,max:r,expr:t}}function je(e,t){return t-e}function Le(e,t){var n=[];return function t(r){var o=e[r];if(1==o.length&&!o[0].term)return t(o[0].to);n.push(r);for(var i=0;i<o.length;i++){var s=o[i],a=s.term,c=s.to;a||-1!=n.indexOf(c)||t(c)}}(t),n.sort(je)}function Be(e){var t=Object.create(null);for(var n in e){var r=e[n];if(!r.hasDefault)return null;t[n]=r.default}return t}function Ve(e,t){var n=Object.create(null);for(var r in e){var o=t&&t[r];if(void 0===o){var i=e[r];if(!i.hasDefault)throw new RangeError("No value supplied for attribute "+r);o=i.default}n[r]=o}return n}function He(e){var t=Object.create(null);if(e)for(var n in e)t[n]=new Je(e[n]);return t}ze.next.get=function(){return this.tokens[this.pos]},Ie.prototype.eat=function(e){return this.next==e&&(this.pos++||!0)},Ie.prototype.err=function(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")},Object.defineProperties(Ie.prototype,ze);var We=function(e,t,n){this.name=e,this.schema=t,this.spec=n,this.groups=n.group?n.group.split(" "):[],this.attrs=He(n.attrs),this.defaultAttrs=Be(this.attrs),this.contentMatch=null,this.markSet=null,this.inlineContent=null,this.isBlock=!(n.inline||"text"==e),this.isText="text"==e},qe={isInline:{configurable:!0},isTextblock:{configurable:!0},isLeaf:{configurable:!0},isAtom:{configurable:!0}};qe.isInline.get=function(){return!this.isBlock},qe.isTextblock.get=function(){return this.isBlock&&this.inlineContent},qe.isLeaf.get=function(){return this.contentMatch==Ne.empty},qe.isAtom.get=function(){return this.isLeaf||this.spec.atom},We.prototype.hasRequiredAttrs=function(){for(var e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1},We.prototype.compatibleContent=function(e){return this==e||this.contentMatch.compatible(e.contentMatch)},We.prototype.computeAttrs=function(e){return!e&&this.defaultAttrs?this.defaultAttrs:Ve(this.attrs,e)},We.prototype.create=function(e,t,n){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new Oe(this,this.computeAttrs(e),X.from(t),re.setFrom(n))},We.prototype.createChecked=function(e,t,n){if(t=X.from(t),!this.validContent(t))throw new RangeError("Invalid content for node "+this.name);return new Oe(this,this.computeAttrs(e),t,re.setFrom(n))},We.prototype.createAndFill=function(e,t,n){if(e=this.computeAttrs(e),(t=X.from(t)).size){var r=this.contentMatch.fillBefore(t);if(!r)return null;t=r.append(t)}var o=this.contentMatch.matchFragment(t).fillBefore(X.empty,!0);return o?new Oe(this,e,t.append(o),re.setFrom(n)):null},We.prototype.validContent=function(e){var t=this.contentMatch.matchFragment(e);if(!t||!t.validEnd)return!1;for(var n=0;n<e.childCount;n++)if(!this.allowsMarks(e.child(n).marks))return!1;return!0},We.prototype.allowsMarkType=function(e){return null==this.markSet||this.markSet.indexOf(e)>-1},We.prototype.allowsMarks=function(e){if(null==this.markSet)return!0;for(var t=0;t<e.length;t++)if(!this.allowsMarkType(e[t].type))return!1;return!0},We.prototype.allowedMarks=function(e){if(null==this.markSet)return e;for(var t,n=0;n<e.length;n++)this.allowsMarkType(e[n].type)?t&&t.push(e[n]):t||(t=e.slice(0,n));return t?t.length?t:re.empty:e},We.compile=function(e,t){var n=Object.create(null);e.forEach((function(e,r){return n[e]=new We(e,t,r)}));var r=t.spec.topNode||"doc";if(!n[r])throw new RangeError("Schema is missing its top node type ('"+r+"')");if(!n.text)throw new RangeError("Every schema needs a 'text' type");for(var o in n.text.attrs)throw new RangeError("The text node type should not have attributes");return n},Object.defineProperties(We.prototype,qe);var Je=function(e){this.hasDefault=Object.prototype.hasOwnProperty.call(e,"default"),this.default=e.default},Ke={isRequired:{configurable:!0}};Ke.isRequired.get=function(){return!this.hasDefault},Object.defineProperties(Je.prototype,Ke);var Ue=function(e,t,n,r){this.name=e,this.schema=n,this.spec=r,this.attrs=He(r.attrs),this.rank=t,this.excluded=null;var o=Be(this.attrs);this.instance=o&&new re(this,o)};Ue.prototype.create=function(e){return!e&&this.instance?this.instance:new re(this,Ve(this.attrs,e))},Ue.compile=function(e,t){var n=Object.create(null),r=0;return e.forEach((function(e,o){return n[e]=new Ue(e,r++,t,o)})),n},Ue.prototype.removeFromSet=function(e){for(var t=0;t<e.length;t++)e[t].type==this&&(e=e.slice(0,t).concat(e.slice(t+1)),t--);return e},Ue.prototype.isInSet=function(e){for(var t=0;t<e.length;t++)if(e[t].type==this)return e[t]},Ue.prototype.excludes=function(e){return this.excluded.indexOf(e)>-1};var Ge=function(e){for(var t in this.spec={},e)this.spec[t]=e[t];this.spec.nodes=G.from(e.nodes),this.spec.marks=G.from(e.marks),this.nodes=We.compile(this.spec.nodes,this),this.marks=Ue.compile(this.spec.marks,this);var n=Object.create(null);for(var r in this.nodes){if(r in this.marks)throw new RangeError(r+" can not be both a node and a mark");var o=this.nodes[r],i=o.spec.content||"",s=o.spec.marks;o.contentMatch=n[i]||(n[i]=Ne.parse(i,this.nodes)),o.inlineContent=o.contentMatch.inlineContent,o.markSet="_"==s?null:s?Qe(this,s.split(" ")):""!=s&&o.inlineContent?null:[]}for(var a in this.marks){var c=this.marks[a],l=c.spec.excludes;c.excluded=null==l?[c]:""==l?[]:Qe(this,l.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached=Object.create(null),this.cached.wrappings=Object.create(null)};function Qe(e,t){for(var n=[],r=0;r<t.length;r++){var o=t[r],i=e.marks[o],s=i;if(i)n.push(i);else for(var a in e.marks){var c=e.marks[a];("_"==o||c.spec.group&&c.spec.group.split(" ").indexOf(o)>-1)&&n.push(s=c)}if(!s)throw new SyntaxError("Unknown mark type: '"+t[r]+"'")}return n}Ge.prototype.node=function(e,t,n,r){if("string"==typeof e)e=this.nodeType(e);else{if(!(e instanceof We))throw new RangeError("Invalid node type: "+e);if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}return e.createChecked(t,n,r)},Ge.prototype.text=function(e,t){var n=this.nodes.text;return new Ee(n,n.defaultAttrs,e,re.setFrom(t))},Ge.prototype.mark=function(e,t){return"string"==typeof e&&(e=this.marks[e]),e.create(t)},Ge.prototype.nodeFromJSON=function(e){return Oe.fromJSON(this,e)},Ge.prototype.markFromJSON=function(e){return re.fromJSON(this,e)},Ge.prototype.nodeType=function(e){var t=this.nodes[e];if(!t)throw new RangeError("Unknown node type: "+e);return t};var Ze=function(e,t){var n=this;this.schema=e,this.rules=t,this.tags=[],this.styles=[],t.forEach((function(e){e.tag?n.tags.push(e):e.style&&n.styles.push(e)})),this.normalizeLists=!this.tags.some((function(t){if(!/^(ul|ol)\b/.test(t.tag)||!t.node)return!1;var n=e.nodes[t.node];return n.contentMatch.matchType(n)}))};Ze.prototype.parse=function(e,t){void 0===t&&(t={});var n=new rt(this,t,!1);return n.addAll(e,null,t.from,t.to),n.finish()},Ze.prototype.parseSlice=function(e,t){void 0===t&&(t={});var n=new rt(this,t,!0);return n.addAll(e,null,t.from,t.to),ie.maxOpen(n.finish())},Ze.prototype.matchTag=function(e,t,n){for(var r=n?this.tags.indexOf(n)+1:0;r<this.tags.length;r++){var o=this.tags[r];if(it(e,o.tag)&&(void 0===o.namespace||e.namespaceURI==o.namespace)&&(!o.context||t.matchesContext(o.context))){if(o.getAttrs){var i=o.getAttrs(e);if(!1===i)continue;o.attrs=i}return o}}},Ze.prototype.matchStyle=function(e,t,n,r){for(var o=r?this.styles.indexOf(r)+1:0;o<this.styles.length;o++){var i=this.styles[o];if(!(0!=i.style.indexOf(e)||i.context&&!n.matchesContext(i.context)||i.style.length>e.length&&(61!=i.style.charCodeAt(e.length)||i.style.slice(e.length+1)!=t))){if(i.getAttrs){var s=i.getAttrs(t);if(!1===s)continue;i.attrs=s}return i}}},Ze.schemaRules=function(e){var t=[];function n(e){for(var n=null==e.priority?50:e.priority,r=0;r<t.length;r++){var o=t[r];if((null==o.priority?50:o.priority)<n)break}t.splice(r,0,e)}var r=function(t){var r=e.marks[t].spec.parseDOM;r&&r.forEach((function(e){n(e=st(e)),e.mark=t}))};for(var o in e.marks)r(o);var i;for(var s in e.nodes)i=void 0,(i=e.nodes[s].spec.parseDOM)&&i.forEach((function(e){n(e=st(e)),e.node=s}));return t},Ze.fromSchema=function(e){return e.cached.domParser||(e.cached.domParser=new Ze(e,Ze.schemaRules(e)))};var Xe={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},Ye={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},et={ol:!0,ul:!0};function tt(e){return(e?1:0)|("full"===e?2:0)}var nt=function(e,t,n,r,o,i,s){this.type=e,this.attrs=t,this.solid=o,this.match=i||(4&s?null:e.contentMatch),this.options=s,this.content=[],this.marks=n,this.activeMarks=re.none,this.pendingMarks=r,this.stashMarks=[]};nt.prototype.findWrapping=function(e){if(!this.match){if(!this.type)return[];var t=this.type.contentMatch.fillBefore(X.from(e));if(!t){var n,r=this.type.contentMatch;return(n=r.findWrapping(e.type))?(this.match=r,n):null}this.match=this.type.contentMatch.matchFragment(t)}return this.match.findWrapping(e.type)},nt.prototype.finish=function(e){if(!(1&this.options)){var t,n=this.content[this.content.length-1];n&&n.isText&&(t=/[ \t\r\n\u000c]+$/.exec(n.text))&&(n.text.length==t[0].length?this.content.pop():this.content[this.content.length-1]=n.withText(n.text.slice(0,n.text.length-t[0].length)))}var r=X.from(this.content);return!e&&this.match&&(r=r.append(this.match.fillBefore(X.empty,!0))),this.type?this.type.create(this.attrs,r,this.marks):r},nt.prototype.popFromStashMark=function(e){for(var t=this.stashMarks.length-1;t>=0;t--)if(e.eq(this.stashMarks[t]))return this.stashMarks.splice(t,1)[0]},nt.prototype.applyPending=function(e){for(var t=0,n=this.pendingMarks;t<n.length;t++){var r=n[t];(this.type?this.type.allowsMarkType(r.type):at(r.type,e))&&!r.isInSet(this.activeMarks)&&(this.activeMarks=r.addToSet(this.activeMarks),this.pendingMarks=r.removeFromSet(this.pendingMarks))}},nt.prototype.inlineContext=function(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!Xe.hasOwnProperty(e.parentNode.nodeName.toLowerCase())};var rt=function(e,t,n){this.parser=e,this.options=t,this.isOpen=n;var r,o=t.topNode,i=tt(t.preserveWhitespace)|(n?4:0);r=o?new nt(o.type,o.attrs,re.none,re.none,!0,t.topMatch||o.type.contentMatch,i):new nt(n?null:e.schema.topNodeType,null,re.none,re.none,!0,null,i),this.nodes=[r],this.open=0,this.find=t.findPositions,this.needsBlock=!1},ot={top:{configurable:!0},currentPos:{configurable:!0}};function it(e,t){return(e.matches||e.msMatchesSelector||e.webkitMatchesSelector||e.mozMatchesSelector).call(e,t)}function st(e){var t={};for(var n in e)t[n]=e[n];return t}function at(e,t){var n=t.schema.nodes,r=function(r){var o=n[r];if(o.allowsMarkType(e)){var i=[],s=function(e){i.push(e);for(var n=0;n<e.edgeCount;n++){var r=e.edge(n),o=r.type,a=r.next;if(o==t)return!0;if(i.indexOf(a)<0&&s(a))return!0}};return s(o.contentMatch)?{v:!0}:void 0}};for(var o in n){var i=r(o);if(i)return i.v}}ot.top.get=function(){return this.nodes[this.open]},rt.prototype.addDOM=function(e){if(3==e.nodeType)this.addTextNode(e);else if(1==e.nodeType){var t=e.getAttribute("style"),n=t?this.readStyles(function(e){var t,n=/\s*([\w-]+)\s*:\s*([^;]+)/g,r=[];for(;t=n.exec(e);)r.push(t[1],t[2].trim());return r}(t)):null,r=this.top;if(null!=n)for(var o=0;o<n.length;o++)this.addPendingMark(n[o]);if(this.addElement(e),null!=n)for(var i=0;i<n.length;i++)this.removePendingMark(n[i],r)}},rt.prototype.addTextNode=function(e){var t=e.nodeValue,n=this.top;if(2&n.options||n.inlineContext(e)||/[^ \t\r\n\u000c]/.test(t)){if(1&n.options)t=2&n.options?t.replace(/\r\n?/g,"\n"):t.replace(/\r?\n|\r/g," ");else if(t=t.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(t)&&this.open==this.nodes.length-1){var r=n.content[n.content.length-1],o=e.previousSibling;(!r||o&&"BR"==o.nodeName||r.isText&&/[ \t\r\n\u000c]$/.test(r.text))&&(t=t.slice(1))}t&&this.insertNode(this.parser.schema.text(t)),this.findInText(e)}else this.findInside(e)},rt.prototype.addElement=function(e,t){var n,r=e.nodeName.toLowerCase();et.hasOwnProperty(r)&&this.parser.normalizeLists&&function(e){for(var t=e.firstChild,n=null;t;t=t.nextSibling){var r=1==t.nodeType?t.nodeName.toLowerCase():null;r&&et.hasOwnProperty(r)&&n?(n.appendChild(t),t=n):"li"==r?n=t:r&&(n=null)}}(e);var o=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(n=this.parser.matchTag(e,this,t));if(o?o.ignore:Ye.hasOwnProperty(r))this.findInside(e),this.ignoreFallback(e);else if(!o||o.skip||o.closeParent){o&&o.closeParent?this.open=Math.max(0,this.open-1):o&&o.skip.nodeType&&(e=o.skip);var i,s=this.top,a=this.needsBlock;if(Xe.hasOwnProperty(r))i=!0,s.type||(this.needsBlock=!0);else if(!e.firstChild)return void this.leafFallback(e);this.addAll(e),i&&this.sync(s),this.needsBlock=a}else this.addElementByRule(e,o,!1===o.consuming?n:null)},rt.prototype.leafFallback=function(e){"BR"==e.nodeName&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode("\n"))},rt.prototype.ignoreFallback=function(e){"BR"!=e.nodeName||this.top.type&&this.top.type.inlineContent||this.findPlace(this.parser.schema.text("-"))},rt.prototype.readStyles=function(e){var t=re.none;e:for(var n=0;n<e.length;n+=2)for(var r=null;;){var o=this.parser.matchStyle(e[n],e[n+1],this,r);if(!o)continue e;if(o.ignore)return null;if(t=this.parser.schema.marks[o.mark].create(o.attrs).addToSet(t),!1!==o.consuming)break;r=o}return t},rt.prototype.addElementByRule=function(e,t,n){var r,o,i,s=this;t.node?(o=this.parser.schema.nodes[t.node]).isLeaf?this.insertNode(o.create(t.attrs))||this.leafFallback(e):r=this.enter(o,t.attrs,t.preserveWhitespace):(i=this.parser.schema.marks[t.mark].create(t.attrs),this.addPendingMark(i));var a=this.top;if(o&&o.isLeaf)this.findInside(e);else if(n)this.addElement(e,n);else if(t.getContent)this.findInside(e),t.getContent(e,this.parser.schema).forEach((function(e){return s.insertNode(e)}));else{var c=t.contentElement;"string"==typeof c?c=e.querySelector(c):"function"==typeof c&&(c=c(e)),c||(c=e),this.findAround(e,c,!0),this.addAll(c,r)}r&&(this.sync(a),this.open--),i&&this.removePendingMark(i,a)},rt.prototype.addAll=function(e,t,n,r){for(var o=n||0,i=n?e.childNodes[n]:e.firstChild,s=null==r?null:e.childNodes[r];i!=s;i=i.nextSibling,++o)this.findAtPoint(e,o),this.addDOM(i),t&&Xe.hasOwnProperty(i.nodeName.toLowerCase())&&this.sync(t);this.findAtPoint(e,o)},rt.prototype.findPlace=function(e){for(var t,n,r=this.open;r>=0;r--){var o=this.nodes[r],i=o.findWrapping(e);if(i&&(!t||t.length>i.length)&&(t=i,n=o,!i.length))break;if(o.solid)break}if(!t)return!1;this.sync(n);for(var s=0;s<t.length;s++)this.enterInner(t[s],null,!1);return!0},rt.prototype.insertNode=function(e){if(e.isInline&&this.needsBlock&&!this.top.type){var t=this.textblockFromContext();t&&this.enterInner(t)}if(this.findPlace(e)){this.closeExtra();var n=this.top;n.applyPending(e.type),n.match&&(n.match=n.match.matchType(e.type));for(var r=n.activeMarks,o=0;o<e.marks.length;o++)n.type&&!n.type.allowsMarkType(e.marks[o].type)||(r=e.marks[o].addToSet(r));return n.content.push(e.mark(r)),!0}return!1},rt.prototype.enter=function(e,t,n){var r=this.findPlace(e.create(t));return r&&this.enterInner(e,t,!0,n),r},rt.prototype.enterInner=function(e,t,n,r){this.closeExtra();var o=this.top;o.applyPending(e),o.match=o.match&&o.match.matchType(e,t);var i=null==r?-5&o.options:tt(r);4&o.options&&0==o.content.length&&(i|=4),this.nodes.push(new nt(e,t,o.activeMarks,o.pendingMarks,n,null,i)),this.open++},rt.prototype.closeExtra=function(e){var t=this.nodes.length-1;if(t>this.open){for(;t>this.open;t--)this.nodes[t-1].content.push(this.nodes[t].finish(e));this.nodes.length=this.open+1}},rt.prototype.finish=function(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)},rt.prototype.sync=function(e){for(var t=this.open;t>=0;t--)if(this.nodes[t]==e)return void(this.open=t)},ot.currentPos.get=function(){this.closeExtra();for(var e=0,t=this.open;t>=0;t--){for(var n=this.nodes[t].content,r=n.length-1;r>=0;r--)e+=n[r].nodeSize;t&&e++}return e},rt.prototype.findAtPoint=function(e,t){if(this.find)for(var n=0;n<this.find.length;n++)this.find[n].node==e&&this.find[n].offset==t&&(this.find[n].pos=this.currentPos)},rt.prototype.findInside=function(e){if(this.find)for(var t=0;t<this.find.length;t++)null==this.find[t].pos&&1==e.nodeType&&e.contains(this.find[t].node)&&(this.find[t].pos=this.currentPos)},rt.prototype.findAround=function(e,t,n){if(e!=t&&this.find)for(var r=0;r<this.find.length;r++){if(null==this.find[r].pos&&1==e.nodeType&&e.contains(this.find[r].node))t.compareDocumentPosition(this.find[r].node)&(n?2:4)&&(this.find[r].pos=this.currentPos)}},rt.prototype.findInText=function(e){if(this.find)for(var t=0;t<this.find.length;t++)this.find[t].node==e&&(this.find[t].pos=this.currentPos-(e.nodeValue.length-this.find[t].offset))},rt.prototype.matchesContext=function(e){var t=this;if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);var n=e.split("/"),r=this.options.context,o=!(this.isOpen||r&&r.parent.type!=this.nodes[0].type),i=-(r?r.depth+1:0)+(o?0:1),s=function(e,a){for(;e>=0;e--){var c=n[e];if(""==c){if(e==n.length-1||0==e)continue;for(;a>=i;a--)if(s(e-1,a))return!0;return!1}var l=a>0||0==a&&o?t.nodes[a].type:r&&a>=i?r.node(a-i).type:null;if(!l||l.name!=c&&-1==l.groups.indexOf(c))return!1;a--}return!0};return s(n.length-1,this.open)},rt.prototype.textblockFromContext=function(){var e=this.options.context;if(e)for(var t=e.depth;t>=0;t--){var n=e.node(t).contentMatchAt(e.indexAfter(t)).defaultType;if(n&&n.isTextblock&&n.defaultAttrs)return n}for(var r in this.parser.schema.nodes){var o=this.parser.schema.nodes[r];if(o.isTextblock&&o.defaultAttrs)return o}},rt.prototype.addPendingMark=function(e){var t=function(e,t){for(var n=0;n<t.length;n++)if(e.eq(t[n]))return t[n]}(e,this.top.pendingMarks);t&&this.top.stashMarks.push(t),this.top.pendingMarks=e.addToSet(this.top.pendingMarks)},rt.prototype.removePendingMark=function(e,t){for(var n=this.open;n>=0;n--){var r=this.nodes[n];if(r.pendingMarks.lastIndexOf(e)>-1)r.pendingMarks=e.removeFromSet(r.pendingMarks);else{r.activeMarks=e.removeFromSet(r.activeMarks);var o=r.popFromStashMark(e);o&&r.type&&r.type.allowsMarkType(o.type)&&(r.activeMarks=o.addToSet(r.activeMarks))}if(r==t)break}},Object.defineProperties(rt.prototype,ot);var ct=function(e,t){this.nodes=e||{},this.marks=t||{}};function lt(e){var t={};for(var n in e){var r=e[n].spec.toDOM;r&&(t[n]=r)}return t}function ut(e){return e.document||window.document}ct.prototype.serializeFragment=function(e,t,n){var r=this;void 0===t&&(t={}),n||(n=ut(t).createDocumentFragment());var o=n,i=null;return e.forEach((function(e){if(i||e.marks.length){i||(i=[]);for(var n=0,s=0;n<i.length&&s<e.marks.length;){var a=e.marks[s];if(r.marks[a.type.name]){if(!a.eq(i[n])||!1===a.type.spec.spanning)break;n+=2,s++}else s++}for(;n<i.length;)o=i.pop(),i.pop();for(;s<e.marks.length;){var c=e.marks[s++],l=r.serializeMark(c,e.isInline,t);l&&(i.push(c,o),o.appendChild(l.dom),o=l.contentDOM||l.dom)}}o.appendChild(r.serializeNodeInner(e,t))})),n},ct.prototype.serializeNodeInner=function(e,t){void 0===t&&(t={});var n=ct.renderSpec(ut(t),this.nodes[e.type.name](e)),r=n.dom,o=n.contentDOM;if(o){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");t.onContent?t.onContent(e,o,t):this.serializeFragment(e.content,t,o)}return r},ct.prototype.serializeNode=function(e,t){void 0===t&&(t={});for(var n=this.serializeNodeInner(e,t),r=e.marks.length-1;r>=0;r--){var o=this.serializeMark(e.marks[r],e.isInline,t);o&&((o.contentDOM||o.dom).appendChild(n),n=o.dom)}return n},ct.prototype.serializeMark=function(e,t,n){void 0===n&&(n={});var r=this.marks[e.type.name];return r&&ct.renderSpec(ut(n),r(e,t))},ct.renderSpec=function(e,t,n){if(void 0===n&&(n=null),"string"==typeof t)return{dom:e.createTextNode(t)};if(null!=t.nodeType)return{dom:t};if(t.dom&&null!=t.dom.nodeType)return t;var r=t[0],o=r.indexOf(" ");o>0&&(n=r.slice(0,o),r=r.slice(o+1));var i=null,s=n?e.createElementNS(n,r):e.createElement(r),a=t[1],c=1;if(a&&"object"==typeof a&&null==a.nodeType&&!Array.isArray(a))for(var l in c=2,a)if(null!=a[l]){var u=l.indexOf(" ");u>0?s.setAttributeNS(l.slice(0,u),l.slice(u+1),a[l]):s.setAttribute(l,a[l])}for(var f=c;f<t.length;f++){var d=t[f];if(0===d){if(f<t.length-1||f>c)throw new RangeError("Content hole must be the only child of its parent node");return{dom:s,contentDOM:s}}var p=ct.renderSpec(e,d,n),h=p.dom,m=p.contentDOM;if(s.appendChild(h),m){if(i)throw new RangeError("Multiple content holes");i=m}}return{dom:s,contentDOM:i}},ct.fromSchema=function(e){return e.cached.domSerializer||(e.cached.domSerializer=new ct(this.nodesFromSchema(e),this.marksFromSchema(e)))},ct.nodesFromSchema=function(e){var t=lt(e.nodes);return t.text||(t.text=function(e){return e.text}),t},ct.marksFromSchema=function(e){return lt(e.marks)};var ft=Math.pow(2,16);function dt(e){return 65535&e}var pt=function(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=null),this.pos=e,this.deleted=t,this.recover=n},ht=function(e,t){void 0===t&&(t=!1),this.ranges=e,this.inverted=t};ht.prototype.recover=function(e){var t=0,n=dt(e);if(!this.inverted)for(var r=0;r<n;r++)t+=this.ranges[3*r+2]-this.ranges[3*r+1];return this.ranges[3*n]+t+function(e){return(e-(65535&e))/ft}(e)},ht.prototype.mapResult=function(e,t){return void 0===t&&(t=1),this._map(e,t,!1)},ht.prototype.map=function(e,t){return void 0===t&&(t=1),this._map(e,t,!0)},ht.prototype._map=function(e,t,n){for(var r=0,o=this.inverted?2:1,i=this.inverted?1:2,s=0;s<this.ranges.length;s+=3){var a=this.ranges[s]-(this.inverted?r:0);if(a>e)break;var c=this.ranges[s+o],l=this.ranges[s+i],u=a+c;if(e<=u){var f=a+r+((c?e==a?-1:e==u?1:t:t)<0?0:l);if(n)return f;var d=e==(t<0?a:u)?null:s/3+(e-a)*ft;return new pt(f,t<0?e!=a:e!=u,d)}r+=l-c}return n?e+r:new pt(e+r)},ht.prototype.touches=function(e,t){for(var n=0,r=dt(t),o=this.inverted?2:1,i=this.inverted?1:2,s=0;s<this.ranges.length;s+=3){var a=this.ranges[s]-(this.inverted?n:0);if(a>e)break;var c=this.ranges[s+o];if(e<=a+c&&s==3*r)return!0;n+=this.ranges[s+i]-c}return!1},ht.prototype.forEach=function(e){for(var t=this.inverted?2:1,n=this.inverted?1:2,r=0,o=0;r<this.ranges.length;r+=3){var i=this.ranges[r],s=i-(this.inverted?o:0),a=i+(this.inverted?0:o),c=this.ranges[r+t],l=this.ranges[r+n];e(s,s+c,a,a+l),o+=l-c}},ht.prototype.invert=function(){return new ht(this.ranges,!this.inverted)},ht.prototype.toString=function(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)},ht.offset=function(e){return 0==e?ht.empty:new ht(e<0?[0,-e,0]:[0,0,e])},ht.empty=new ht([]);var mt=function(e,t,n,r){this.maps=e||[],this.from=n||0,this.to=null==r?this.maps.length:r,this.mirror=t};function gt(e){var t=Error.call(this,e);return t.__proto__=gt.prototype,t}mt.prototype.slice=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=this.maps.length),new mt(this.maps,this.mirror,e,t)},mt.prototype.copy=function(){return new mt(this.maps.slice(),this.mirror&&this.mirror.slice(),this.from,this.to)},mt.prototype.appendMap=function(e,t){this.to=this.maps.push(e),null!=t&&this.setMirror(this.maps.length-1,t)},mt.prototype.appendMapping=function(e){for(var t=0,n=this.maps.length;t<e.maps.length;t++){var r=e.getMirror(t);this.appendMap(e.maps[t],null!=r&&r<t?n+r:null)}},mt.prototype.getMirror=function(e){if(this.mirror)for(var t=0;t<this.mirror.length;t++)if(this.mirror[t]==e)return this.mirror[t+(t%2?-1:1)]},mt.prototype.setMirror=function(e,t){this.mirror||(this.mirror=[]),this.mirror.push(e,t)},mt.prototype.appendMappingInverted=function(e){for(var t=e.maps.length-1,n=this.maps.length+e.maps.length;t>=0;t--){var r=e.getMirror(t);this.appendMap(e.maps[t].invert(),null!=r&&r>t?n-r-1:null)}},mt.prototype.invert=function(){var e=new mt;return e.appendMappingInverted(this),e},mt.prototype.map=function(e,t){if(void 0===t&&(t=1),this.mirror)return this._map(e,t,!0);for(var n=this.from;n<this.to;n++)e=this.maps[n].map(e,t);return e},mt.prototype.mapResult=function(e,t){return void 0===t&&(t=1),this._map(e,t,!1)},mt.prototype._map=function(e,t,n){for(var r=!1,o=this.from;o<this.to;o++){var i=this.maps[o].mapResult(e,t);if(null!=i.recover){var s=this.getMirror(o);if(null!=s&&s>o&&s<this.to){o=s,e=this.maps[s].recover(i.recover);continue}}i.deleted&&(r=!0),e=i.pos}return n?e:new pt(e,r)},gt.prototype=Object.create(Error.prototype),gt.prototype.constructor=gt,gt.prototype.name="TransformError";var vt=function(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new mt},yt={before:{configurable:!0},docChanged:{configurable:!0}};function bt(){throw new Error("Override me")}yt.before.get=function(){return this.docs.length?this.docs[0]:this.doc},vt.prototype.step=function(e){var t=this.maybeStep(e);if(t.failed)throw new gt(t.failed);return this},vt.prototype.maybeStep=function(e){var t=e.apply(this.doc);return t.failed||this.addStep(e,t.doc),t},yt.docChanged.get=function(){return this.steps.length>0},vt.prototype.addStep=function(e,t){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=t},Object.defineProperties(vt.prototype,yt);var wt=Object.create(null),kt=function(){};kt.prototype.apply=function(e){return bt()},kt.prototype.getMap=function(){return ht.empty},kt.prototype.invert=function(e){return bt()},kt.prototype.map=function(e){return bt()},kt.prototype.merge=function(e){return null},kt.prototype.toJSON=function(){return bt()},kt.fromJSON=function(e,t){if(!t||!t.stepType)throw new RangeError("Invalid input for Step.fromJSON");var n=wt[t.stepType];if(!n)throw new RangeError("No step type "+t.stepType+" defined");return n.fromJSON(e,t)},kt.jsonID=function(e,t){if(e in wt)throw new RangeError("Duplicate use of step JSON ID "+e);return wt[e]=t,t.prototype.jsonID=e,t};var xt=function(e,t){this.doc=e,this.failed=t};xt.ok=function(e){return new xt(e,null)},xt.fail=function(e){return new xt(null,e)},xt.fromReplace=function(e,t,n,r){try{return xt.ok(e.replace(t,n,r))}catch(o){if(o instanceof oe)return xt.fail(o.message);throw o}};var Ct=function(e){function t(t,n,r,o){e.call(this),this.from=t,this.to=n,this.slice=r,this.structure=!!o}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.apply=function(e){return this.structure&&Mt(e,this.from,this.to)?xt.fail("Structure replace would overwrite content"):xt.fromReplace(e,this.from,this.to,this.slice)},t.prototype.getMap=function(){return new ht([this.from,this.to-this.from,this.slice.size])},t.prototype.invert=function(e){return new t(this.from,this.from+this.slice.size,e.slice(this.from,this.to))},t.prototype.map=function(e){var n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deleted&&r.deleted?null:new t(n.pos,Math.max(n.pos,r.pos),this.slice)},t.prototype.merge=function(e){if(!(e instanceof t)||e.structure||this.structure)return null;if(this.from+this.slice.size!=e.from||this.slice.openEnd||e.slice.openStart){if(e.to!=this.from||this.slice.openStart||e.slice.openEnd)return null;var n=this.slice.size+e.slice.size==0?ie.empty:new ie(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new t(e.from,this.to,n,this.structure)}var r=this.slice.size+e.slice.size==0?ie.empty:new ie(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new t(this.from,this.to+(e.to-e.from),r,this.structure)},t.prototype.toJSON=function(){var e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e},t.fromJSON=function(e,n){if("number"!=typeof n.from||"number"!=typeof n.to)throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new t(n.from,n.to,ie.fromJSON(e,n.slice),!!n.structure)},t}(kt);kt.jsonID("replace",Ct);var St=function(e){function t(t,n,r,o,i,s,a){e.call(this),this.from=t,this.to=n,this.gapFrom=r,this.gapTo=o,this.slice=i,this.insert=s,this.structure=!!a}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.apply=function(e){if(this.structure&&(Mt(e,this.from,this.gapFrom)||Mt(e,this.gapTo,this.to)))return xt.fail("Structure gap-replace would overwrite content");var t=e.slice(this.gapFrom,this.gapTo);if(t.openStart||t.openEnd)return xt.fail("Gap is not a flat range");var n=this.slice.insertAt(this.insert,t.content);return n?xt.fromReplace(e,this.from,this.to,n):xt.fail("Content does not fit in gap")},t.prototype.getMap=function(){return new ht([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])},t.prototype.invert=function(e){var n=this.gapTo-this.gapFrom;return new t(this.from,this.from+this.slice.size+n,this.from+this.insert,this.from+this.insert+n,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)},t.prototype.map=function(e){var n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1),o=e.map(this.gapFrom,-1),i=e.map(this.gapTo,1);return n.deleted&&r.deleted||o<n.pos||i>r.pos?null:new t(n.pos,r.pos,o,i,this.slice,this.insert,this.structure)},t.prototype.toJSON=function(){var e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e},t.fromJSON=function(e,n){if("number"!=typeof n.from||"number"!=typeof n.to||"number"!=typeof n.gapFrom||"number"!=typeof n.gapTo||"number"!=typeof n.insert)throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new t(n.from,n.to,n.gapFrom,n.gapTo,ie.fromJSON(e,n.slice),n.insert,!!n.structure)},t}(kt);function Mt(e,t,n){for(var r=e.resolve(t),o=n-t,i=r.depth;o>0&&i>0&&r.indexAfter(i)==r.node(i).childCount;)i--,o--;if(o>0)for(var s=r.node(i).maybeChild(r.indexAfter(i));o>0;){if(!s||s.isLeaf)return!0;s=s.firstChild,o--}return!1}function Ot(e,t,n){return(0==t||e.canReplace(t,e.childCount))&&(n==e.childCount||e.canReplace(0,n))}function At(e){for(var t=e.parent.content.cutByIndex(e.startIndex,e.endIndex),n=e.depth;;--n){var r=e.$from.node(n),o=e.$from.index(n),i=e.$to.indexAfter(n);if(n<e.depth&&r.canReplace(o,i,t))return n;if(0==n||r.type.spec.isolating||!Ot(r,o,i))break}}function Et(e,t,n,r){void 0===r&&(r=e);var o=function(e,t){var n=e.parent,r=e.startIndex,o=e.endIndex,i=n.contentMatchAt(r).findWrapping(t);if(!i)return null;var s=i.length?i[0]:t;return n.canReplaceWith(r,o,s)?i:null}(e,t),i=o&&function(e,t){var n=e.parent,r=e.startIndex,o=e.endIndex,i=n.child(r),s=t.contentMatch.findWrapping(i.type);if(!s)return null;for(var a=(s.length?s[s.length-1]:t).contentMatch,c=r;a&&c<o;c++)a=a.matchType(n.child(c).type);if(!a||!a.validEnd)return null;return s}(r,t);return i?o.map(Tt).concat({type:t,attrs:n}).concat(i.map(Tt)):null}function Tt(e){return{type:e,attrs:null}}function Nt(e,t,n,r){void 0===n&&(n=1);var o=e.resolve(t),i=o.depth-n,s=r&&r[r.length-1]||o.parent;if(i<0||o.parent.type.spec.isolating||!o.parent.canReplace(o.index(),o.parent.childCount)||!s.type.validContent(o.parent.content.cutByIndex(o.index(),o.parent.childCount)))return!1;for(var a=o.depth-1,c=n-2;a>i;a--,c--){var l=o.node(a),u=o.index(a);if(l.type.spec.isolating)return!1;var f=l.content.cutByIndex(u,l.childCount),d=r&&r[c]||l;if(d!=l&&(f=f.replaceChild(0,d.type.create(d.attrs))),!l.canReplace(u+1,l.childCount)||!d.type.validContent(f))return!1}var p=o.indexAfter(i),h=r&&r[0];return o.node(i).canReplaceWith(p,p,h?h.type:o.node(i+1).type)}function Dt(e,t){var n,r,o=e.resolve(t),i=o.index();return n=o.nodeBefore,r=o.nodeAfter,n&&r&&!n.isLeaf&&n.canAppend(r)&&o.parent.canReplace(i,i+1)}function It(e,t,n){for(var r=[],o=0;o<e.childCount;o++){var i=e.child(o);i.content.size&&(i=i.copy(It(i.content,t,i))),i.isInline&&(i=t(i,n,o)),r.push(i)}return X.fromArray(r)}kt.jsonID("replaceAround",St),vt.prototype.lift=function(e,t){for(var n=e.$from,r=e.$to,o=e.depth,i=n.before(o+1),s=r.after(o+1),a=i,c=s,l=X.empty,u=0,f=o,d=!1;f>t;f--)d||n.index(f)>0?(d=!0,l=X.from(n.node(f).copy(l)),u++):a--;for(var p=X.empty,h=0,m=o,g=!1;m>t;m--)g||r.after(m+1)<r.end(m)?(g=!0,p=X.from(r.node(m).copy(p)),h++):c++;return this.step(new St(a,c,i,s,new ie(l.append(p),u,h),l.size-u,!0))},vt.prototype.wrap=function(e,t){for(var n=X.empty,r=t.length-1;r>=0;r--)n=X.from(t[r].type.create(t[r].attrs,n));var o=e.start,i=e.end;return this.step(new St(o,i,o,i,new ie(n,0,0),t.length,!0))},vt.prototype.setBlockType=function(e,t,n,r){var o=this;if(void 0===t&&(t=e),!n.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");var i=this.steps.length;return this.doc.nodesBetween(e,t,(function(e,t){if(e.isTextblock&&!e.hasMarkup(n,r)&&function(e,t,n){var r=e.resolve(t),o=r.index();return r.parent.canReplaceWith(o,o+1,n)}(o.doc,o.mapping.slice(i).map(t),n)){o.clearIncompatible(o.mapping.slice(i).map(t,1),n);var s=o.mapping.slice(i),a=s.map(t,1),c=s.map(t+e.nodeSize,1);return o.step(new St(a,c,a+1,c-1,new ie(X.from(n.create(r,null,e.marks)),0,0),1,!0)),!1}})),this},vt.prototype.setNodeMarkup=function(e,t,n,r){var o=this.doc.nodeAt(e);if(!o)throw new RangeError("No node at given position");t||(t=o.type);var i=t.create(n,null,r||o.marks);if(o.isLeaf)return this.replaceWith(e,e+o.nodeSize,i);if(!t.validContent(o.content))throw new RangeError("Invalid content for node type "+t.name);return this.step(new St(e,e+o.nodeSize,e+1,e+o.nodeSize-1,new ie(X.from(i),0,0),1,!0))},vt.prototype.split=function(e,t,n){void 0===t&&(t=1);for(var r=this.doc.resolve(e),o=X.empty,i=X.empty,s=r.depth,a=r.depth-t,c=t-1;s>a;s--,c--){o=X.from(r.node(s).copy(o));var l=n&&n[c];i=X.from(l?l.type.create(l.attrs,i):r.node(s).copy(i))}return this.step(new Ct(e,e,new ie(o.append(i),t,t),!0))},vt.prototype.join=function(e,t){void 0===t&&(t=1);var n=new Ct(e-t,e+t,ie.empty,!0);return this.step(n)};var zt=function(e){function t(t,n,r){e.call(this),this.from=t,this.to=n,this.mark=r}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.apply=function(e){var t=this,n=e.slice(this.from,this.to),r=e.resolve(this.from),o=r.node(r.sharedDepth(this.to)),i=new ie(It(n.content,(function(e,n){return e.isAtom&&n.type.allowsMarkType(t.mark.type)?e.mark(t.mark.addToSet(e.marks)):e}),o),n.openStart,n.openEnd);return xt.fromReplace(e,this.from,this.to,i)},t.prototype.invert=function(){return new Ft(this.from,this.to,this.mark)},t.prototype.map=function(e){var n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deleted&&r.deleted||n.pos>=r.pos?null:new t(n.pos,r.pos,this.mark)},t.prototype.merge=function(e){if(e instanceof t&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from)return new t(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark)},t.prototype.toJSON=function(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}},t.fromJSON=function(e,n){if("number"!=typeof n.from||"number"!=typeof n.to)throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new t(n.from,n.to,e.markFromJSON(n.mark))},t}(kt);kt.jsonID("addMark",zt);var Ft=function(e){function t(t,n,r){e.call(this),this.from=t,this.to=n,this.mark=r}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.apply=function(e){var t=this,n=e.slice(this.from,this.to),r=new ie(It(n.content,(function(e){return e.mark(t.mark.removeFromSet(e.marks))})),n.openStart,n.openEnd);return xt.fromReplace(e,this.from,this.to,r)},t.prototype.invert=function(){return new zt(this.from,this.to,this.mark)},t.prototype.map=function(e){var n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deleted&&r.deleted||n.pos>=r.pos?null:new t(n.pos,r.pos,this.mark)},t.prototype.merge=function(e){if(e instanceof t&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from)return new t(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark)},t.prototype.toJSON=function(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}},t.fromJSON=function(e,n){if("number"!=typeof n.from||"number"!=typeof n.to)throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new t(n.from,n.to,e.markFromJSON(n.mark))},t}(kt);function Rt(e,t,n){return!n.openStart&&!n.openEnd&&e.start()==t.start()&&e.parent.canReplace(e.index(),t.index(),n.content)}kt.jsonID("removeMark",Ft),vt.prototype.addMark=function(e,t,n){var r=this,o=[],i=[],s=null,a=null;return this.doc.nodesBetween(e,t,(function(r,c,l){if(r.isInline){var u=r.marks;if(!n.isInSet(u)&&l.type.allowsMarkType(n.type)){for(var f=Math.max(c,e),d=Math.min(c+r.nodeSize,t),p=n.addToSet(u),h=0;h<u.length;h++)u[h].isInSet(p)||(s&&s.to==f&&s.mark.eq(u[h])?s.to=d:o.push(s=new Ft(f,d,u[h])));a&&a.to==f?a.to=d:i.push(a=new zt(f,d,n))}}})),o.forEach((function(e){return r.step(e)})),i.forEach((function(e){return r.step(e)})),this},vt.prototype.removeMark=function(e,t,n){var r=this;void 0===n&&(n=null);var o=[],i=0;return this.doc.nodesBetween(e,t,(function(r,s){if(r.isInline){i++;var a=null;if(n instanceof Ue)for(var c,l=r.marks;c=n.isInSet(l);)(a||(a=[])).push(c),l=c.removeFromSet(l);else n?n.isInSet(r.marks)&&(a=[n]):a=r.marks;if(a&&a.length)for(var u=Math.min(s+r.nodeSize,t),f=0;f<a.length;f++){for(var d=a[f],p=void 0,h=0;h<o.length;h++){var m=o[h];m.step==i-1&&d.eq(o[h].style)&&(p=m)}p?(p.to=u,p.step=i):o.push({style:d,from:Math.max(s,e),to:u,step:i})}}})),o.forEach((function(e){return r.step(new Ft(e.from,e.to,e.style))})),this},vt.prototype.clearIncompatible=function(e,t,n){void 0===n&&(n=t.contentMatch);for(var r=this.doc.nodeAt(e),o=[],i=e+1,s=0;s<r.childCount;s++){var a=r.child(s),c=i+a.nodeSize,l=n.matchType(a.type,a.attrs);if(l){n=l;for(var u=0;u<a.marks.length;u++)t.allowsMarkType(a.marks[u].type)||this.step(new Ft(i,c,a.marks[u]))}else o.push(new Ct(i,c,ie.empty));i=c}if(!n.validEnd){var f=n.fillBefore(X.empty,!0);this.replace(i,i,new ie(f,0,0))}for(var d=o.length-1;d>=0;d--)this.step(o[d]);return this},vt.prototype.replace=function(e,t,n){void 0===t&&(t=e),void 0===n&&(n=ie.empty);var r=function(e,t,n,r){if(void 0===n&&(n=t),void 0===r&&(r=ie.empty),t==n&&!r.size)return null;var o=e.resolve(t),i=e.resolve(n);return Rt(o,i,r)?new Ct(t,n,r):new $t(o,i,r).fit()}(this.doc,e,t,n);return r&&this.step(r),this},vt.prototype.replaceWith=function(e,t,n){return this.replace(e,t,new ie(X.from(n),0,0))},vt.prototype.delete=function(e,t){return this.replace(e,t,ie.empty)},vt.prototype.insert=function(e,t){return this.replaceWith(e,e,t)};var $t=function(e,t,n){this.$to=t,this.$from=e,this.unplaced=n,this.frontier=[];for(var r=0;r<=e.depth;r++){var o=e.node(r);this.frontier.push({type:o.type,match:o.contentMatchAt(e.indexAfter(r))})}this.placed=X.empty;for(var i=e.depth;i>0;i--)this.placed=X.from(e.node(i).copy(this.placed))},_t={depth:{configurable:!0}};function Pt(e,t,n){return 0==t?e.cutByIndex(n):e.replaceChild(0,e.firstChild.copy(Pt(e.firstChild.content,t-1,n)))}function jt(e,t,n){return 0==t?e.append(n):e.replaceChild(e.childCount-1,e.lastChild.copy(jt(e.lastChild.content,t-1,n)))}function Lt(e,t){for(var n=0;n<t;n++)e=e.firstChild.content;return e}function Bt(e,t,n){if(t<=0)return e;var r=e.content;return t>1&&(r=r.replaceChild(0,Bt(r.firstChild,t-1,1==r.childCount?n-1:0))),t>0&&(r=e.type.contentMatch.fillBefore(r).append(r),n<=0&&(r=r.append(e.type.contentMatch.matchFragment(r).fillBefore(X.empty,!0)))),e.copy(r)}function Vt(e,t,n,r,o){var i=e.node(t),s=o?e.indexAfter(t):e.index(t);if(s==i.childCount&&!n.compatibleContent(i.type))return null;var a=r.fillBefore(i.content,!0,s);return a&&!function(e,t,n){for(var r=n;r<t.childCount;r++)if(!e.allowsMarks(t.child(r).marks))return!0;return!1}(n,i.content,s)?a:null}function Ht(e,t,n,r,o){if(t<n){var i=e.firstChild;e=e.replaceChild(0,i.copy(Ht(i.content,t+1,n,r,i)))}if(t>r){var s=o.contentMatchAt(0),a=s.fillBefore(e).append(e);e=a.append(s.matchFragment(a).fillBefore(X.empty,!0))}return e}function Wt(e,t){for(var n=[],r=Math.min(e.depth,t.depth);r>=0;r--){var o=e.start(r);if(o<e.pos-(e.depth-r)||t.end(r)>t.pos+(t.depth-r)||e.node(r).type.spec.isolating||t.node(r).type.spec.isolating)break;(o==t.start(r)||r==e.depth&&r==t.depth&&e.parent.inlineContent&&t.parent.inlineContent&&r&&t.start(r-1)==o-1)&&n.push(r)}return n}_t.depth.get=function(){return this.frontier.length-1},$t.prototype.fit=function(){for(;this.unplaced.size;){var e=this.findFittable();e?this.placeNodes(e):this.openMore()||this.dropNode()}var t=this.mustMoveInline(),n=this.placed.size-this.depth-this.$from.depth,r=this.$from,o=this.close(t<0?this.$to:r.doc.resolve(t));if(!o)return null;for(var i=this.placed,s=r.depth,a=o.depth;s&&a&&1==i.childCount;)i=i.firstChild.content,s--,a--;var c=new ie(i,s,a);return t>-1?new St(r.pos,t,this.$to.pos,this.$to.end(),c,n):c.size||r.pos!=this.$to.pos?new Ct(r.pos,o.pos,c):void 0},$t.prototype.findFittable=function(){for(var e=1;e<=2;e++)for(var t=this.unplaced.openStart;t>=0;t--)for(var n=void 0,r=(t?(n=Lt(this.unplaced.content,t-1).firstChild).content:this.unplaced.content).firstChild,o=this.depth;o>=0;o--){var i=this.frontier[o],s=i.type,a=i.match,c=void 0,l=void 0;if(1==e&&(r?a.matchType(r.type)||(l=a.fillBefore(X.from(r),!1)):s.compatibleContent(n.type)))return{sliceDepth:t,frontierDepth:o,parent:n,inject:l};if(2==e&&r&&(c=a.findWrapping(r.type)))return{sliceDepth:t,frontierDepth:o,parent:n,wrap:c};if(n&&a.matchType(n.type))break}},$t.prototype.openMore=function(){var e=this.unplaced,t=e.content,n=e.openStart,r=e.openEnd,o=Lt(t,n);return!(!o.childCount||o.firstChild.isLeaf)&&(this.unplaced=new ie(t,n+1,Math.max(r,o.size+n>=t.size-r?n+1:0)),!0)},$t.prototype.dropNode=function(){var e=this.unplaced,t=e.content,n=e.openStart,r=e.openEnd,o=Lt(t,n);if(o.childCount<=1&&n>0){var i=t.size-n<=n+o.size;this.unplaced=new ie(Pt(t,n-1,1),n-1,i?n-1:r)}else this.unplaced=new ie(Pt(t,n,1),n,r)},$t.prototype.placeNodes=function(e){for(var t=e.sliceDepth,n=e.frontierDepth,r=e.parent,o=e.inject,i=e.wrap;this.depth>n;)this.closeFrontierNode();if(i)for(var s=0;s<i.length;s++)this.openFrontierNode(i[s]);var a=this.unplaced,c=r?r.content:a.content,l=a.openStart-t,u=0,f=[],d=this.frontier[n],p=d.match,h=d.type;if(o){for(var m=0;m<o.childCount;m++)f.push(o.child(m));p=p.matchFragment(o)}for(var g=c.size+t-(a.content.size-a.openEnd);u<c.childCount;){var v=c.child(u),y=p.matchType(v.type);if(!y)break;(++u>1||0==l||v.content.size)&&(p=y,f.push(Bt(v.mark(h.allowedMarks(v.marks)),1==u?l:0,u==c.childCount?g:-1)))}var b=u==c.childCount;b||(g=-1),this.placed=jt(this.placed,n,X.from(f)),this.frontier[n].match=p,b&&g<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(var w=0,k=c;w<g;w++){var x=k.lastChild;this.frontier.push({type:x.type,match:x.contentMatchAt(x.childCount)}),k=x.content}this.unplaced=b?0==t?ie.empty:new ie(Pt(a.content,t-1,1),t-1,g<0?a.openEnd:t-1):new ie(Pt(a.content,t,u),a.openStart,a.openEnd)},$t.prototype.mustMoveInline=function(){if(!this.$to.parent.isTextblock||this.$to.end()==this.$to.pos)return-1;var e,t=this.frontier[this.depth];if(!t.type.isTextblock||!Vt(this.$to,this.$to.depth,t.type,t.match,!1)||this.$to.depth==this.depth&&(e=this.findCloseLevel(this.$to))&&e.depth==this.depth)return-1;for(var n=this.$to.depth,r=this.$to.after(n);n>1&&r==this.$to.end(--n);)++r;return r},$t.prototype.findCloseLevel=function(e){e:for(var t=Math.min(this.depth,e.depth);t>=0;t--){var n=this.frontier[t],r=n.match,o=n.type,i=t<e.depth&&e.end(t+1)==e.pos+(e.depth-(t+1)),s=Vt(e,t,o,r,i);if(s){for(var a=t-1;a>=0;a--){var c=this.frontier[a],l=c.match,u=Vt(e,a,c.type,l,!0);if(!u||u.childCount)continue e}return{depth:t,fit:s,move:i?e.doc.resolve(e.after(t+1)):e}}}},$t.prototype.close=function(e){var t=this.findCloseLevel(e);if(!t)return null;for(;this.depth>t.depth;)this.closeFrontierNode();t.fit.childCount&&(this.placed=jt(this.placed,t.depth,t.fit)),e=t.move;for(var n=t.depth+1;n<=e.depth;n++){var r=e.node(n),o=r.type.contentMatch.fillBefore(r.content,!0,e.index(n));this.openFrontierNode(r.type,r.attrs,o)}return e},$t.prototype.openFrontierNode=function(e,t,n){var r=this.frontier[this.depth];r.match=r.match.matchType(e),this.placed=jt(this.placed,this.depth,X.from(e.create(t,n))),this.frontier.push({type:e,match:e.contentMatch})},$t.prototype.closeFrontierNode=function(){var e=this.frontier.pop().match.fillBefore(X.empty,!0);e.childCount&&(this.placed=jt(this.placed,this.frontier.length,e))},Object.defineProperties($t.prototype,_t),vt.prototype.replaceRange=function(e,t,n){if(!n.size)return this.deleteRange(e,t);var r=this.doc.resolve(e),o=this.doc.resolve(t);if(Rt(r,o,n))return this.step(new Ct(e,t,n));var i=Wt(r,this.doc.resolve(t));0==i[i.length-1]&&i.pop();var s=-(r.depth+1);i.unshift(s);for(var a=r.depth,c=r.pos-1;a>0;a--,c--){var l=r.node(a).type.spec;if(l.defining||l.isolating)break;i.indexOf(a)>-1?s=a:r.before(a)==c&&i.splice(1,0,-a)}for(var u=i.indexOf(s),f=[],d=n.openStart,p=n.content,h=0;;h++){var m=p.firstChild;if(f.push(m),h==n.openStart)break;p=m.content}d>0&&f[d-1].type.spec.defining&&r.node(u).type!=f[d-1].type?d-=1:d>=2&&f[d-1].isTextblock&&f[d-2].type.spec.defining&&r.node(u).type!=f[d-2].type&&(d-=2);for(var g=n.openStart;g>=0;g--){var v=(g+d+1)%(n.openStart+1),y=f[v];if(y)for(var b=0;b<i.length;b++){var w=i[(b+u)%i.length],k=!0;w<0&&(k=!1,w=-w);var x=r.node(w-1),C=r.index(w-1);if(x.canReplaceWith(C,C,y.type,y.marks))return this.replace(r.before(w),k?o.after(w):t,new ie(Ht(n.content,0,n.openStart,v),v,n.openEnd))}}for(var S=this.steps.length,M=i.length-1;M>=0&&(this.replace(e,t,n),!(this.steps.length>S));M--){var O=i[M];O<0||(e=r.before(O),t=o.after(O))}return this},vt.prototype.replaceRangeWith=function(e,t,n){if(!n.isInline&&e==t&&this.doc.resolve(e).parent.content.size){var r=function(e,t,n){var r=e.resolve(t);if(r.parent.canReplaceWith(r.index(),r.index(),n))return t;if(0==r.parentOffset)for(var o=r.depth-1;o>=0;o--){var i=r.index(o);if(r.node(o).canReplaceWith(i,i,n))return r.before(o+1);if(i>0)return null}if(r.parentOffset==r.parent.content.size)for(var s=r.depth-1;s>=0;s--){var a=r.indexAfter(s);if(r.node(s).canReplaceWith(a,a,n))return r.after(s+1);if(a<r.node(s).childCount)return null}}(this.doc,e,n.type);null!=r&&(e=t=r)}return this.replaceRange(e,t,new ie(X.from(n),0,0))},vt.prototype.deleteRange=function(e,t){for(var n=this.doc.resolve(e),r=this.doc.resolve(t),o=Wt(n,r),i=0;i<o.length;i++){var s=o[i],a=i==o.length-1;if(a&&0==s||n.node(s).type.contentMatch.validEnd)return this.delete(n.start(s),r.end(s));if(s>0&&(a||n.node(s-1).canReplace(n.index(s-1),r.indexAfter(s-1))))return this.delete(n.before(s),r.after(s))}for(var c=1;c<=n.depth&&c<=r.depth;c++)if(e-n.start(c)==n.depth-c&&t>n.end(c)&&r.end(c)-t!=r.depth-c)return this.delete(n.before(c),t);return this.delete(e,t)};var qt=Object.create(null),Jt=function(e,t,n){this.ranges=n||[new Ut(e.min(t),e.max(t))],this.$anchor=e,this.$head=t},Kt={anchor:{configurable:!0},head:{configurable:!0},from:{configurable:!0},to:{configurable:!0},$from:{configurable:!0},$to:{configurable:!0},empty:{configurable:!0}};Kt.anchor.get=function(){return this.$anchor.pos},Kt.head.get=function(){return this.$head.pos},Kt.from.get=function(){return this.$from.pos},Kt.to.get=function(){return this.$to.pos},Kt.$from.get=function(){return this.ranges[0].$from},Kt.$to.get=function(){return this.ranges[0].$to},Kt.empty.get=function(){for(var e=this.ranges,t=0;t<e.length;t++)if(e[t].$from.pos!=e[t].$to.pos)return!1;return!0},Jt.prototype.content=function(){return this.$from.node(0).slice(this.from,this.to,!0)},Jt.prototype.replace=function(e,t){void 0===t&&(t=ie.empty);for(var n=t.content.lastChild,r=null,o=0;o<t.openEnd;o++)r=n,n=n.lastChild;for(var i=e.steps.length,s=this.ranges,a=0;a<s.length;a++){var c=s[a],l=c.$from,u=c.$to,f=e.mapping.slice(i);e.replaceRange(f.map(l.pos),f.map(u.pos),a?ie.empty:t),0==a&&nn(e,i,(n?n.isInline:r&&r.isTextblock)?-1:1)}},Jt.prototype.replaceWith=function(e,t){for(var n=e.steps.length,r=this.ranges,o=0;o<r.length;o++){var i=r[o],s=i.$from,a=i.$to,c=e.mapping.slice(n),l=c.map(s.pos),u=c.map(a.pos);o?e.deleteRange(l,u):(e.replaceRangeWith(l,u,t),nn(e,n,t.isInline?-1:1))}},Jt.findFrom=function(e,t,n){var r=e.parent.inlineContent?new Gt(e):tn(e.node(0),e.parent,e.pos,e.index(),t,n);if(r)return r;for(var o=e.depth-1;o>=0;o--){var i=t<0?tn(e.node(0),e.node(o),e.before(o+1),e.index(o),t,n):tn(e.node(0),e.node(o),e.after(o+1),e.index(o)+1,t,n);if(i)return i}},Jt.near=function(e,t){return void 0===t&&(t=1),this.findFrom(e,t)||this.findFrom(e,-t)||new Yt(e.node(0))},Jt.atStart=function(e){return tn(e,e,0,0,1)||new Yt(e)},Jt.atEnd=function(e){return tn(e,e,e.content.size,e.childCount,-1)||new Yt(e)},Jt.fromJSON=function(e,t){if(!t||!t.type)throw new RangeError("Invalid input for Selection.fromJSON");var n=qt[t.type];if(!n)throw new RangeError("No selection type "+t.type+" defined");return n.fromJSON(e,t)},Jt.jsonID=function(e,t){if(e in qt)throw new RangeError("Duplicate use of selection JSON ID "+e);return qt[e]=t,t.prototype.jsonID=e,t},Jt.prototype.getBookmark=function(){return Gt.between(this.$anchor,this.$head).getBookmark()},Object.defineProperties(Jt.prototype,Kt),Jt.prototype.visible=!0;var Ut=function(e,t){this.$from=e,this.$to=t},Gt=function(e){function t(t,n){void 0===n&&(n=t),e.call(this,t,n)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={$cursor:{configurable:!0}};return n.$cursor.get=function(){return this.$anchor.pos==this.$head.pos?this.$head:null},t.prototype.map=function(n,r){var o=n.resolve(r.map(this.head));if(!o.parent.inlineContent)return e.near(o);var i=n.resolve(r.map(this.anchor));return new t(i.parent.inlineContent?i:o,o)},t.prototype.replace=function(t,n){if(void 0===n&&(n=ie.empty),e.prototype.replace.call(this,t,n),n==ie.empty){var r=this.$from.marksAcross(this.$to);r&&t.ensureMarks(r)}},t.prototype.eq=function(e){return e instanceof t&&e.anchor==this.anchor&&e.head==this.head},t.prototype.getBookmark=function(){return new Qt(this.anchor,this.head)},t.prototype.toJSON=function(){return{type:"text",anchor:this.anchor,head:this.head}},t.fromJSON=function(e,n){if("number"!=typeof n.anchor||"number"!=typeof n.head)throw new RangeError("Invalid input for TextSelection.fromJSON");return new t(e.resolve(n.anchor),e.resolve(n.head))},t.create=function(e,t,n){void 0===n&&(n=t);var r=e.resolve(t);return new this(r,n==t?r:e.resolve(n))},t.between=function(n,r,o){var i=n.pos-r.pos;if(o&&!i||(o=i>=0?1:-1),!r.parent.inlineContent){var s=e.findFrom(r,o,!0)||e.findFrom(r,-o,!0);if(!s)return e.near(r,o);r=s.$head}return n.parent.inlineContent||(0==i||(n=(e.findFrom(n,-o,!0)||e.findFrom(n,o,!0)).$anchor).pos<r.pos!=i<0)&&(n=r),new t(n,r)},Object.defineProperties(t.prototype,n),t}(Jt);Jt.jsonID("text",Gt);var Qt=function(e,t){this.anchor=e,this.head=t};Qt.prototype.map=function(e){return new Qt(e.map(this.anchor),e.map(this.head))},Qt.prototype.resolve=function(e){return Gt.between(e.resolve(this.anchor),e.resolve(this.head))};var Zt=function(e){function t(t){var n=t.nodeAfter,r=t.node(0).resolve(t.pos+n.nodeSize);e.call(this,t,r),this.node=n}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.map=function(n,r){var o=r.mapResult(this.anchor),i=o.deleted,s=o.pos,a=n.resolve(s);return i?e.near(a):new t(a)},t.prototype.content=function(){return new ie(X.from(this.node),0,0)},t.prototype.eq=function(e){return e instanceof t&&e.anchor==this.anchor},t.prototype.toJSON=function(){return{type:"node",anchor:this.anchor}},t.prototype.getBookmark=function(){return new Xt(this.anchor)},t.fromJSON=function(e,n){if("number"!=typeof n.anchor)throw new RangeError("Invalid input for NodeSelection.fromJSON");return new t(e.resolve(n.anchor))},t.create=function(e,t){return new this(e.resolve(t))},t.isSelectable=function(e){return!e.isText&&!1!==e.type.spec.selectable},t}(Jt);Zt.prototype.visible=!1,Jt.jsonID("node",Zt);var Xt=function(e){this.anchor=e};Xt.prototype.map=function(e){var t=e.mapResult(this.anchor),n=t.deleted,r=t.pos;return n?new Qt(r,r):new Xt(r)},Xt.prototype.resolve=function(e){var t=e.resolve(this.anchor),n=t.nodeAfter;return n&&Zt.isSelectable(n)?new Zt(t):Jt.near(t)};var Yt=function(e){function t(t){e.call(this,t.resolve(0),t.resolve(t.content.size))}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.replace=function(t,n){if(void 0===n&&(n=ie.empty),n==ie.empty){t.delete(0,t.doc.content.size);var r=e.atStart(t.doc);r.eq(t.selection)||t.setSelection(r)}else e.prototype.replace.call(this,t,n)},t.prototype.toJSON=function(){return{type:"all"}},t.fromJSON=function(e){return new t(e)},t.prototype.map=function(e){return new t(e)},t.prototype.eq=function(e){return e instanceof t},t.prototype.getBookmark=function(){return en},t}(Jt);Jt.jsonID("all",Yt);var en={map:function(){return this},resolve:function(e){return new Yt(e)}};function tn(e,t,n,r,o,i){if(t.inlineContent)return Gt.create(e,n);for(var s=r-(o>0?0:1);o>0?s<t.childCount:s>=0;s+=o){var a=t.child(s);if(a.isAtom){if(!i&&Zt.isSelectable(a))return Zt.create(e,n-(o<0?a.nodeSize:0))}else{var c=tn(e,a,n+o,o<0?a.childCount:0,o,i);if(c)return c}n+=a.nodeSize*o}}function nn(e,t,n){var r=e.steps.length-1;if(!(r<t)){var o,i=e.steps[r];if(i instanceof Ct||i instanceof St)e.mapping.maps[r].forEach((function(e,t,n,r){null==o&&(o=r)})),e.setSelection(Jt.near(e.doc.resolve(o),n))}}var rn=function(e){function t(t){e.call(this,t.doc),this.time=Date.now(),this.curSelection=t.selection,this.curSelectionFor=0,this.storedMarks=t.storedMarks,this.updated=0,this.meta=Object.create(null)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={selection:{configurable:!0},selectionSet:{configurable:!0},storedMarksSet:{configurable:!0},isGeneric:{configurable:!0},scrolledIntoView:{configurable:!0}};return n.selection.get=function(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection},t.prototype.setSelection=function(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=-3&(1|this.updated),this.storedMarks=null,this},n.selectionSet.get=function(){return(1&this.updated)>0},t.prototype.setStoredMarks=function(e){return this.storedMarks=e,this.updated|=2,this},t.prototype.ensureMarks=function(e){return re.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this},t.prototype.addStoredMark=function(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))},t.prototype.removeStoredMark=function(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))},n.storedMarksSet.get=function(){return(2&this.updated)>0},t.prototype.addStep=function(t,n){e.prototype.addStep.call(this,t,n),this.updated=-3&this.updated,this.storedMarks=null},t.prototype.setTime=function(e){return this.time=e,this},t.prototype.replaceSelection=function(e){return this.selection.replace(this,e),this},t.prototype.replaceSelectionWith=function(e,t){var n=this.selection;return!1!==t&&(e=e.mark(this.storedMarks||(n.empty?n.$from.marks():n.$from.marksAcross(n.$to)||re.none))),n.replaceWith(this,e),this},t.prototype.deleteSelection=function(){return this.selection.replace(this),this},t.prototype.insertText=function(e,t,n){void 0===n&&(n=t);var r=this.doc.type.schema;if(null==t)return e?this.replaceSelectionWith(r.text(e),!0):this.deleteSelection();if(!e)return this.deleteRange(t,n);var o=this.storedMarks;if(!o){var i=this.doc.resolve(t);o=n==t?i.marks():i.marksAcross(this.doc.resolve(n))}return this.replaceRangeWith(t,n,r.text(e,o)),this.selection.empty||this.setSelection(Jt.near(this.selection.$to)),this},t.prototype.setMeta=function(e,t){return this.meta["string"==typeof e?e:e.key]=t,this},t.prototype.getMeta=function(e){return this.meta["string"==typeof e?e:e.key]},n.isGeneric.get=function(){for(var e in this.meta)return!1;return!0},t.prototype.scrollIntoView=function(){return this.updated|=4,this},n.scrolledIntoView.get=function(){return(4&this.updated)>0},Object.defineProperties(t.prototype,n),t}(vt);function on(e,t){return t&&e?e.bind(t):e}var sn=function(e,t,n){this.name=e,this.init=on(t.init,n),this.apply=on(t.apply,n)},an=[new sn("doc",{init:function(e){return e.doc||e.schema.topNodeType.createAndFill()},apply:function(e){return e.doc}}),new sn("selection",{init:function(e,t){return e.selection||Jt.atStart(t.doc)},apply:function(e){return e.selection}}),new sn("storedMarks",{init:function(e){return e.storedMarks||null},apply:function(e,t,n,r){return r.selection.$cursor?e.storedMarks:null}}),new sn("scrollToSelection",{init:function(){return 0},apply:function(e,t){return e.scrolledIntoView?t+1:t}})],cn=function(e,t){var n=this;this.schema=e,this.fields=an.concat(),this.plugins=[],this.pluginsByKey=Object.create(null),t&&t.forEach((function(e){if(n.pluginsByKey[e.key])throw new RangeError("Adding different instances of a keyed plugin ("+e.key+")");n.plugins.push(e),n.pluginsByKey[e.key]=e,e.spec.state&&n.fields.push(new sn(e.key,e.spec.state,e))}))},ln=function(e){this.config=e},un={schema:{configurable:!0},plugins:{configurable:!0},tr:{configurable:!0}};un.schema.get=function(){return this.config.schema},un.plugins.get=function(){return this.config.plugins},ln.prototype.apply=function(e){return this.applyTransaction(e).state},ln.prototype.filterTransaction=function(e,t){void 0===t&&(t=-1);for(var n=0;n<this.config.plugins.length;n++)if(n!=t){var r=this.config.plugins[n];if(r.spec.filterTransaction&&!r.spec.filterTransaction.call(r,e,this))return!1}return!0},ln.prototype.applyTransaction=function(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};for(var t=[e],n=this.applyInner(e),r=null;;){for(var o=!1,i=0;i<this.config.plugins.length;i++){var s=this.config.plugins[i];if(s.spec.appendTransaction){var a=r?r[i].n:0,c=r?r[i].state:this,l=a<t.length&&s.spec.appendTransaction.call(s,a?t.slice(a):t,c,n);if(l&&n.filterTransaction(l,i)){if(l.setMeta("appendedTransaction",e),!r){r=[];for(var u=0;u<this.config.plugins.length;u++)r.push(u<i?{state:n,n:t.length}:{state:this,n:0})}t.push(l),n=n.applyInner(l),o=!0}r&&(r[i]={state:n,n:t.length})}}if(!o)return{state:n,transactions:t}}},ln.prototype.applyInner=function(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");for(var t=new ln(this.config),n=this.config.fields,r=0;r<n.length;r++){var o=n[r];t[o.name]=o.apply(e,this[o.name],this,t)}for(var i=0;i<fn.length;i++)fn[i](this,e,t);return t},un.tr.get=function(){return new rn(this)},ln.create=function(e){for(var t=new cn(e.doc?e.doc.type.schema:e.schema,e.plugins),n=new ln(t),r=0;r<t.fields.length;r++)n[t.fields[r].name]=t.fields[r].init(e,n);return n},ln.prototype.reconfigure=function(e){for(var t=new cn(this.schema,e.plugins),n=t.fields,r=new ln(t),o=0;o<n.length;o++){var i=n[o].name;r[i]=this.hasOwnProperty(i)?this[i]:n[o].init(e,r)}return r},ln.prototype.toJSON=function(e){var t={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(t.storedMarks=this.storedMarks.map((function(e){return e.toJSON()}))),e&&"object"==typeof e)for(var n in e){if("doc"==n||"selection"==n)throw new RangeError("The JSON fields `doc` and `selection` are reserved");var r=e[n],o=r.spec.state;o&&o.toJSON&&(t[n]=o.toJSON.call(r,this[r.key]))}return t},ln.fromJSON=function(e,t,n){if(!t)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");var r=new cn(e.schema,e.plugins),o=new ln(r);return r.fields.forEach((function(r){if("doc"==r.name)o.doc=Oe.fromJSON(e.schema,t.doc);else if("selection"==r.name)o.selection=Jt.fromJSON(o.doc,t.selection);else if("storedMarks"==r.name)t.storedMarks&&(o.storedMarks=t.storedMarks.map(e.schema.markFromJSON));else{if(n)for(var i in n){var s=n[i],a=s.spec.state;if(s.key==r.name&&a&&a.fromJSON&&Object.prototype.hasOwnProperty.call(t,i))return void(o[r.name]=a.fromJSON.call(s,e,t[i],o))}o[r.name]=r.init(e,o)}})),o},ln.addApplyListener=function(e){fn.push(e)},ln.removeApplyListener=function(e){var t=fn.indexOf(e);t>-1&&fn.splice(t,1)},Object.defineProperties(ln.prototype,un);var fn=[];function dn(e,t,n){for(var r in e){var o=e[r];o instanceof Function?o=o.bind(t):"handleDOMEvents"==r&&(o=dn(o,t,{})),n[r]=o}return n}var pn=function(e){this.props={},e.props&&dn(e.props,this,this.props),this.spec=e,this.key=e.key?e.key.key:mn("plugin")};pn.prototype.getState=function(e){return e[this.key]};var hn=Object.create(null);function mn(e){return e in hn?e+"$"+ ++hn[e]:(hn[e]=0,e+"$")}var gn=function(e){void 0===e&&(e="key"),this.key=mn(e)};function vn(e,t){return!e.selection.empty&&(t&&t(e.tr.deleteSelection().scrollIntoView()),!0)}function yn(e,t,n){for(;e;e="start"==t?e.firstChild:e.lastChild){if(e.isTextblock)return!0;if(n&&1!=e.childCount)return!1}return!1}function bn(e){if(!e.parent.type.spec.isolating)for(var t=e.depth-1;t>=0;t--){if(e.index(t)>0)return e.doc.resolve(e.before(t+1));if(e.node(t).type.spec.isolating)break}return null}function wn(e){if(!e.parent.type.spec.isolating)for(var t=e.depth-1;t>=0;t--){var n=e.node(t);if(e.index(t)+1<n.childCount)return e.doc.resolve(e.after(t+1));if(n.type.spec.isolating)break}return null}function kn(e){for(var t=0;t<e.edgeCount;t++){var n=e.edge(t).type;if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}function xn(e,t,n){var r,o,i=t.nodeBefore,s=t.nodeAfter;if(i.type.spec.isolating||s.type.spec.isolating)return!1;if(function(e,t,n){var r=t.nodeBefore,o=t.nodeAfter,i=t.index();return!(!(r&&o&&r.type.compatibleContent(o.type))||(!r.content.size&&t.parent.canReplace(i-1,i)?(n&&n(e.tr.delete(t.pos-r.nodeSize,t.pos).scrollIntoView()),0):!t.parent.canReplace(i,i+1)||!o.isTextblock&&!Dt(e.doc,t.pos)||(n&&n(e.tr.clearIncompatible(t.pos,r.type,r.contentMatchAt(r.childCount)).join(t.pos).scrollIntoView()),0)))}(e,t,n))return!0;var a=t.parent.canReplace(t.index(),t.index()+1);if(a&&(r=(o=i.contentMatchAt(i.childCount)).findWrapping(s.type))&&o.matchType(r[0]||s.type).validEnd){if(n){for(var c=t.pos+s.nodeSize,l=X.empty,u=r.length-1;u>=0;u--)l=X.from(r[u].create(null,l));l=X.from(i.copy(l));var f=e.tr.step(new St(t.pos-1,c,t.pos,c,new ie(l,1,0),r.length,!0)),d=c+2*r.length;Dt(f.doc,d)&&f.join(d),n(f.scrollIntoView())}return!0}var p=Jt.findFrom(t,1),h=p&&p.$from.blockRange(p.$to),m=h&&At(h);if(null!=m&&m>=t.depth)return n&&n(e.tr.lift(h,m).scrollIntoView()),!0;if(a&&yn(s,"start",!0)&&yn(i,"end")){for(var g=i,v=[];v.push(g),!g.isTextblock;)g=g.lastChild;for(var y=s,b=1;!y.isTextblock;y=y.firstChild)b++;if(g.canReplace(g.childCount,g.childCount,y.content)){if(n){for(var w=X.empty,k=v.length-1;k>=0;k--)w=X.from(v[k].copy(w));n(e.tr.step(new St(t.pos-v.length,t.pos+s.nodeSize,t.pos+b,t.pos+s.nodeSize-b,new ie(w,v.length,0),0,!0)).scrollIntoView())}return!0}}return!1}function Cn(e,t){return function(n,r){var o=n.selection,i=o.$from,s=o.$to,a=i.blockRange(s),c=a&&Et(a,e,t);return!!c&&(r&&r(n.tr.wrap(a,c).scrollIntoView()),!0)}}function Sn(e,t){return function(n,r){var o=n.selection,i=o.from,s=o.to,a=!1;return n.doc.nodesBetween(i,s,(function(r,o){if(a)return!1;if(r.isTextblock&&!r.hasMarkup(e,t))if(r.type==e)a=!0;else{var i=n.doc.resolve(o),s=i.index();a=i.parent.canReplaceWith(s,s+1,e)}})),!!a&&(r&&r(n.tr.setBlockType(i,s,e,t).scrollIntoView()),!0)}}function Mn(e,t){return function(n,r){var o=n.selection,i=o.empty,s=o.$cursor,a=o.ranges;if(i&&!s||!function(e,t,n){for(var r=function(r){var o=t[r],i=o.$from,s=o.$to,a=0==i.depth&&e.type.allowsMarkType(n);if(e.nodesBetween(i.pos,s.pos,(function(e){if(a)return!1;a=e.inlineContent&&e.type.allowsMarkType(n)})),a)return{v:!0}},o=0;o<t.length;o++){var i=r(o);if(i)return i.v}return!1}(n.doc,a,e))return!1;if(r)if(s)e.isInSet(n.storedMarks||s.marks())?r(n.tr.removeStoredMark(e)):r(n.tr.addStoredMark(e.create(t)));else{for(var c=!1,l=n.tr,u=0;!c&&u<a.length;u++){var f=a[u],d=f.$from,p=f.$to;c=n.doc.rangeHasMark(d.pos,p.pos,e)}for(var h=0;h<a.length;h++){var m=a[h],g=m.$from,v=m.$to;if(c)l.removeMark(g.pos,v.pos,e);else{var y=g.pos,b=v.pos,w=g.nodeAfter,k=v.nodeBefore,x=w&&w.isText?/^\s*/.exec(w.text)[0].length:0,C=k&&k.isText?/\s*$/.exec(k.text)[0].length:0;y+x<b&&(y+=x,b-=C),l.addMark(y,b,e.create(t))}}r(l.scrollIntoView())}return!0}}function On(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return function(t,n,r){for(var o=0;o<e.length;o++)if(e[o](t,n,r))return!0;return!1}}gn.prototype.get=function(e){return e.config.pluginsByKey[this.key]},gn.prototype.getState=function(e){return e[this.key]};var An=On(vn,(function(e,t,n){var r=e.selection.$cursor;if(!r||(n?!n.endOfTextblock("backward",e):r.parentOffset>0))return!1;var o=bn(r);if(!o){var i=r.blockRange(),s=i&&At(i);return null!=s&&(t&&t(e.tr.lift(i,s).scrollIntoView()),!0)}var a=o.nodeBefore;if(!a.type.spec.isolating&&xn(e,o,t))return!0;if(0==r.parent.content.size&&(yn(a,"end")||Zt.isSelectable(a))){if(t){var c=e.tr.deleteRange(r.before(),r.after());c.setSelection(yn(a,"end")?Jt.findFrom(c.doc.resolve(c.mapping.map(o.pos,-1)),-1):Zt.create(c.doc,o.pos-a.nodeSize)),t(c.scrollIntoView())}return!0}return!(!a.isAtom||o.depth!=r.depth-1)&&(t&&t(e.tr.delete(o.pos-a.nodeSize,o.pos).scrollIntoView()),!0)}),(function(e,t,n){var r=e.selection,o=r.$head,i=o;if(!r.empty)return!1;if(o.parent.isTextblock){if(n?!n.endOfTextblock("backward",e):o.parentOffset>0)return!1;i=bn(o)}var s=i&&i.nodeBefore;return!(!s||!Zt.isSelectable(s))&&(t&&t(e.tr.setSelection(Zt.create(e.doc,i.pos-s.nodeSize)).scrollIntoView()),!0)})),En=On(vn,(function(e,t,n){var r=e.selection.$cursor;if(!r||(n?!n.endOfTextblock("forward",e):r.parentOffset<r.parent.content.size))return!1;var o=wn(r);if(!o)return!1;var i=o.nodeAfter;if(xn(e,o,t))return!0;if(0==r.parent.content.size&&(yn(i,"start")||Zt.isSelectable(i))){if(t){var s=e.tr.deleteRange(r.before(),r.after());s.setSelection(yn(i,"start")?Jt.findFrom(s.doc.resolve(s.mapping.map(o.pos)),1):Zt.create(s.doc,s.mapping.map(o.pos))),t(s.scrollIntoView())}return!0}return!(!i.isAtom||o.depth!=r.depth-1)&&(t&&t(e.tr.delete(o.pos,o.pos+i.nodeSize).scrollIntoView()),!0)}),(function(e,t,n){var r=e.selection,o=r.$head,i=o;if(!r.empty)return!1;if(o.parent.isTextblock){if(n?!n.endOfTextblock("forward",e):o.parentOffset<o.parent.content.size)return!1;i=wn(o)}var s=i&&i.nodeAfter;return!(!s||!Zt.isSelectable(s))&&(t&&t(e.tr.setSelection(Zt.create(e.doc,i.pos)).scrollIntoView()),!0)})),Tn={Enter:On((function(e,t){var n=e.selection,r=n.$head,o=n.$anchor;return!(!r.parent.type.spec.code||!r.sameParent(o))&&(t&&t(e.tr.insertText("\n").scrollIntoView()),!0)}),(function(e,t){var n=e.selection,r=n.$from,o=n.$to;if(n instanceof Yt||r.parent.inlineContent||o.parent.inlineContent)return!1;var i=kn(o.parent.contentMatchAt(o.indexAfter()));if(!i||!i.isTextblock)return!1;if(t){var s=(!r.parentOffset&&o.index()<o.parent.childCount?r:o).pos,a=e.tr.insert(s,i.createAndFill());a.setSelection(Gt.create(a.doc,s+1)),t(a.scrollIntoView())}return!0}),(function(e,t){var n=e.selection.$cursor;if(!n||n.parent.content.size)return!1;if(n.depth>1&&n.after()!=n.end(-1)){var r=n.before();if(Nt(e.doc,r))return t&&t(e.tr.split(r).scrollIntoView()),!0}var o=n.blockRange(),i=o&&At(o);return null!=i&&(t&&t(e.tr.lift(o,i).scrollIntoView()),!0)}),(function(e,t){var n=e.selection,r=n.$from,o=n.$to;if(e.selection instanceof Zt&&e.selection.node.isBlock)return!(!r.parentOffset||!Nt(e.doc,r.pos))&&(t&&t(e.tr.split(r.pos).scrollIntoView()),!0);if(!r.parent.isBlock)return!1;if(t){var i=o.parentOffset==o.parent.content.size,s=e.tr;(e.selection instanceof Gt||e.selection instanceof Yt)&&s.deleteSelection();var a=0==r.depth?null:kn(r.node(-1).contentMatchAt(r.indexAfter(-1))),c=i&&a?[{type:a}]:null,l=Nt(s.doc,s.mapping.map(r.pos),1,c);if(c||l||!Nt(s.doc,s.mapping.map(r.pos),1,a&&[{type:a}])||(c=[{type:a}],l=!0),l&&(s.split(s.mapping.map(r.pos),1,c),!i&&!r.parentOffset&&r.parent.type!=a)){var u=s.mapping.map(r.before()),f=s.doc.resolve(u);r.node(-1).canReplaceWith(f.index(),f.index()+1,a)&&s.setNodeMarkup(s.mapping.map(r.before()),a)}t(s.scrollIntoView())}return!0})),"Mod-Enter":function(e,t){var n=e.selection,r=n.$head,o=n.$anchor;if(!r.parent.type.spec.code||!r.sameParent(o))return!1;var i=r.node(-1),s=r.indexAfter(-1),a=kn(i.contentMatchAt(s));if(!i.canReplaceWith(s,s,a))return!1;if(t){var c=r.after(),l=e.tr.replaceWith(c,c,a.createAndFill());l.setSelection(Jt.near(l.doc.resolve(c),1)),t(l.scrollIntoView())}return!0},Backspace:An,"Mod-Backspace":An,"Shift-Backspace":An,Delete:En,"Mod-Delete":En,"Mod-a":function(e,t){return t&&t(e.tr.setSelection(new Yt(e.doc))),!0}},Nn={"Ctrl-h":Tn.Backspace,"Alt-Backspace":Tn["Mod-Backspace"],"Ctrl-d":Tn.Delete,"Ctrl-Alt-Backspace":Tn["Mod-Delete"],"Alt-Delete":Tn["Mod-Delete"],"Alt-d":Tn["Mod-Delete"]};for(var Dn in Tn)Nn[Dn]=Tn[Dn];for(var In=("undefined"!=typeof navigator?/Mac|iP(hone|[oa]d)/.test(navigator.platform):"undefined"!=typeof os&&"darwin"==os.platform())?Nn:Tn,zn={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",229:"q"},Fn={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"',229:"Q"},Rn="undefined"!=typeof navigator&&/Chrome\/(\d+)/.exec(navigator.userAgent),$n="undefined"!=typeof navigator&&/Apple Computer/.test(navigator.vendor),_n="undefined"!=typeof navigator&&/Gecko\/\d+/.test(navigator.userAgent),Pn="undefined"!=typeof navigator&&/Mac/.test(navigator.platform),jn="undefined"!=typeof navigator&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),Ln=Rn&&(Pn||+Rn[1]<57)||_n&&Pn,Bn=0;Bn<10;Bn++)zn[48+Bn]=zn[96+Bn]=String(Bn);for(Bn=1;Bn<=24;Bn++)zn[Bn+111]="F"+Bn;for(Bn=65;Bn<=90;Bn++)zn[Bn]=String.fromCharCode(Bn+32),Fn[Bn]=String.fromCharCode(Bn);for(var Vn in zn)Fn.hasOwnProperty(Vn)||(Fn[Vn]=zn[Vn]);var Hn="undefined"!=typeof navigator&&/Mac|iP(hone|[oa]d)/.test(navigator.platform);function Wn(e){var t,n,r,o,i=e.split(/-(?!$)/),s=i[i.length-1];"Space"==s&&(s=" ");for(var a=0;a<i.length-1;a++){var c=i[a];if(/^(cmd|meta|m)$/i.test(c))o=!0;else if(/^a(lt)?$/i.test(c))t=!0;else if(/^(c|ctrl|control)$/i.test(c))n=!0;else if(/^s(hift)?$/i.test(c))r=!0;else{if(!/^mod$/i.test(c))throw new Error("Unrecognized modifier name: "+c);Hn?o=!0:n=!0}}return t&&(s="Alt-"+s),n&&(s="Ctrl-"+s),o&&(s="Meta-"+s),r&&(s="Shift-"+s),s}function qn(e,t,n){return t.altKey&&(e="Alt-"+e),t.ctrlKey&&(e="Ctrl-"+e),t.metaKey&&(e="Meta-"+e),!1!==n&&t.shiftKey&&(e="Shift-"+e),e}function Jn(e){return new pn({props:{handleKeyDown:Kn(e)}})}function Kn(e){var t=function(e){var t=Object.create(null);for(var n in e)t[Wn(n)]=e[n];return t}(e);return function(e,n){var r,o=function(e){var t=!(Ln&&(e.ctrlKey||e.altKey||e.metaKey)||($n||jn)&&e.shiftKey&&e.key&&1==e.key.length)&&e.key||(e.shiftKey?Fn:zn)[e.keyCode]||e.key||"Unidentified";return"Esc"==t&&(t="Escape"),"Del"==t&&(t="Delete"),"Left"==t&&(t="ArrowLeft"),"Up"==t&&(t="ArrowUp"),"Right"==t&&(t="ArrowRight"),"Down"==t&&(t="ArrowDown"),t}(n),i=1==o.length&&" "!=o,s=t[qn(o,n,!i)];if(s&&s(e.state,e.dispatch,e))return!0;if(i&&(n.shiftKey||n.altKey||n.metaKey||o.charCodeAt(0)>127)&&(r=zn[n.keyCode])&&r!=o){var a=t[qn(r,n,!0)];if(a&&a(e.state,e.dispatch,e))return!0}else if(i&&n.shiftKey){var c=t[qn(o,n,!0)];if(c&&c(e.state,e.dispatch,e))return!0}return!1}}var Un={};if("undefined"!=typeof navigator&&"undefined"!=typeof document){var Gn=/Edge\/(\d+)/.exec(navigator.userAgent),Qn=/MSIE \d/.test(navigator.userAgent),Zn=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),Xn=Un.ie=!!(Qn||Zn||Gn);Un.ie_version=Qn?document.documentMode||6:Zn?+Zn[1]:Gn?+Gn[1]:null,Un.gecko=!Xn&&/gecko\/(\d+)/i.test(navigator.userAgent),Un.gecko_version=Un.gecko&&+(/Firefox\/(\d+)/.exec(navigator.userAgent)||[0,0])[1];var Yn=!Xn&&/Chrome\/(\d+)/.exec(navigator.userAgent);Un.chrome=!!Yn,Un.chrome_version=Yn&&+Yn[1],Un.safari=!Xn&&/Apple Computer/.test(navigator.vendor),Un.ios=Un.safari&&(/Mobile\/\w+/.test(navigator.userAgent)||navigator.maxTouchPoints>2),Un.mac=Un.ios||/Mac/.test(navigator.platform),Un.android=/Android \d/.test(navigator.userAgent),Un.webkit="webkitFontSmoothing"in document.documentElement.style,Un.webkit_version=Un.webkit&&+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]}var er=function(e){for(var t=0;;t++)if(!(e=e.previousSibling))return t},tr=function(e){var t=e.assignedSlot||e.parentNode;return t&&11==t.nodeType?t.host:t},nr=null,rr=function(e,t,n){var r=nr||(nr=document.createRange());return r.setEnd(e,null==n?e.nodeValue.length:n),r.setStart(e,t||0),r},or=function(e,t,n,r){return n&&(sr(e,t,n,r,-1)||sr(e,t,n,r,1))},ir=/^(img|br|input|textarea|hr)$/i;function sr(e,t,n,r,o){for(;;){if(e==n&&t==r)return!0;if(t==(o<0?0:ar(e))){var i=e.parentNode;if(1!=i.nodeType||cr(e)||ir.test(e.nodeName)||"false"==e.contentEditable)return!1;t=er(e)+(o<0?0:1),e=i}else{if(1!=e.nodeType)return!1;if("false"==(e=e.childNodes[t+(o<0?-1:0)]).contentEditable)return!1;t=o<0?ar(e):0}}}function ar(e){return 3==e.nodeType?e.nodeValue.length:e.childNodes.length}function cr(e){for(var t,n=e;n&&!(t=n.pmViewDesc);n=n.parentNode);return t&&t.node&&t.node.isBlock&&(t.dom==e||t.contentDOM==e)}var lr=function(e){var t=e.isCollapsed;return t&&Un.chrome&&e.rangeCount&&!e.getRangeAt(0).collapsed&&(t=!1),t};function ur(e,t){var n=document.createEvent("Event");return n.initEvent("keydown",!0,!0),n.keyCode=e,n.key=n.code=t,n}function fr(e){return{left:0,right:e.documentElement.clientWidth,top:0,bottom:e.documentElement.clientHeight}}function dr(e,t){return"number"==typeof e?e:e[t]}function pr(e){var t=e.getBoundingClientRect(),n=t.width/e.offsetWidth||1,r=t.height/e.offsetHeight||1;return{left:t.left,right:t.left+e.clientWidth*n,top:t.top,bottom:t.top+e.clientHeight*r}}function hr(e,t,n){for(var r=e.someProp("scrollThreshold")||0,o=e.someProp("scrollMargin")||5,i=e.dom.ownerDocument,s=n||e.dom;s;s=tr(s))if(1==s.nodeType){var a=s==i.body||1!=s.nodeType,c=a?fr(i):pr(s),l=0,u=0;if(t.top<c.top+dr(r,"top")?u=-(c.top-t.top+dr(o,"top")):t.bottom>c.bottom-dr(r,"bottom")&&(u=t.bottom-c.bottom+dr(o,"bottom")),t.left<c.left+dr(r,"left")?l=-(c.left-t.left+dr(o,"left")):t.right>c.right-dr(r,"right")&&(l=t.right-c.right+dr(o,"right")),l||u)if(a)i.defaultView.scrollBy(l,u);else{var f=s.scrollLeft,d=s.scrollTop;u&&(s.scrollTop+=u),l&&(s.scrollLeft+=l);var p=s.scrollLeft-f,h=s.scrollTop-d;t={left:t.left-p,top:t.top-h,right:t.right-p,bottom:t.bottom-h}}if(a)break}}function mr(e){for(var t=[],n=e.ownerDocument;e&&(t.push({dom:e,top:e.scrollTop,left:e.scrollLeft}),e!=n);e=tr(e));return t}function gr(e,t){for(var n=0;n<e.length;n++){var r=e[n],o=r.dom,i=r.top,s=r.left;o.scrollTop!=i+t&&(o.scrollTop=i+t),o.scrollLeft!=s&&(o.scrollLeft=s)}}var vr=null;function yr(e,t){for(var n,r,o=2e8,i=0,s=t.top,a=t.top,c=e.firstChild,l=0;c;c=c.nextSibling,l++){var u=void 0;if(1==c.nodeType)u=c.getClientRects();else{if(3!=c.nodeType)continue;u=rr(c).getClientRects()}for(var f=0;f<u.length;f++){var d=u[f];if(d.top<=s&&d.bottom>=a){s=Math.max(d.bottom,s),a=Math.min(d.top,a);var p=d.left>t.left?d.left-t.left:d.right<t.left?t.left-d.right:0;if(p<o){n=c,o=p,r=p&&3==n.nodeType?{left:d.right<t.left?d.right:d.left,top:t.top}:t,1==c.nodeType&&p&&(i=l+(t.left>=(d.left+d.right)/2?1:0));continue}}!n&&(t.left>=d.right&&t.top>=d.top||t.left>=d.left&&t.top>=d.bottom)&&(i=l+1)}}return n&&3==n.nodeType?function(e,t){for(var n=e.nodeValue.length,r=document.createRange(),o=0;o<n;o++){r.setEnd(e,o+1),r.setStart(e,o);var i=xr(r,1);if(i.top!=i.bottom&&br(t,i))return{node:e,offset:o+(t.left>=(i.left+i.right)/2?1:0)}}return{node:e,offset:0}}(n,r):!n||o&&1==n.nodeType?{node:e,offset:i}:yr(n,r)}function br(e,t){return e.left>=t.left-1&&e.left<=t.right+1&&e.top>=t.top-1&&e.top<=t.bottom+1}function wr(e,t,n){var r=e.childNodes.length;if(r&&n.top<n.bottom)for(var o=Math.max(0,Math.min(r-1,Math.floor(r*(t.top-n.top)/(n.bottom-n.top))-2)),i=o;;){var s=e.childNodes[i];if(1==s.nodeType)for(var a=s.getClientRects(),c=0;c<a.length;c++){var l=a[c];if(br(t,l))return wr(s,t,l)}if((i=(i+1)%r)==o)break}return e}function kr(e,t){var n,r,o,i,s=e.dom.ownerDocument;if(s.caretPositionFromPoint)try{var a=s.caretPositionFromPoint(t.left,t.top);a&&(o=(n=a).offsetNode,i=n.offset)}catch(g){}if(!o&&s.caretRangeFromPoint){var c=s.caretRangeFromPoint(t.left,t.top);c&&(o=(r=c).startContainer,i=r.startOffset)}var l,u=(e.root.elementFromPoint?e.root:s).elementFromPoint(t.left,t.top+1);if(!u||!e.dom.contains(1!=u.nodeType?u.parentNode:u)){var f=e.dom.getBoundingClientRect();if(!br(t,f))return null;if(!(u=wr(e.dom,t,f)))return null}if(Un.safari)for(var d=u;o&&d;d=tr(d))d.draggable&&(o=i=null);if(u=function(e,t){var n=e.parentNode;return n&&/^li$/i.test(n.nodeName)&&t.left<e.getBoundingClientRect().left?n:e}(u,t),o){if(Un.gecko&&1==o.nodeType&&(i=Math.min(i,o.childNodes.length))<o.childNodes.length){var p,h=o.childNodes[i];"IMG"==h.nodeName&&(p=h.getBoundingClientRect()).right<=t.left&&p.bottom>t.top&&i++}o==e.dom&&i==o.childNodes.length-1&&1==o.lastChild.nodeType&&t.top>o.lastChild.getBoundingClientRect().bottom?l=e.state.doc.content.size:0!=i&&1==o.nodeType&&"BR"==o.childNodes[i-1].nodeName||(l=function(e,t,n,r){for(var o=-1,i=t;i!=e.dom;){var s=e.docView.nearestDesc(i,!0);if(!s)return null;if(s.node.isBlock&&s.parent){var a=s.dom.getBoundingClientRect();if(a.left>r.left||a.top>r.top)o=s.posBefore;else{if(!(a.right<r.left||a.bottom<r.top))break;o=s.posAfter}}i=s.dom.parentNode}return o>-1?o:e.docView.posFromDOM(t,n)}(e,o,i,t))}null==l&&(l=function(e,t,n){var r=yr(t,n),o=r.node,i=r.offset,s=-1;if(1==o.nodeType&&!o.firstChild){var a=o.getBoundingClientRect();s=a.left!=a.right&&n.left>(a.left+a.right)/2?1:-1}return e.docView.posFromDOM(o,i,s)}(e,u,t));var m=e.docView.nearestDesc(u,!0);return{pos:l,inside:m?m.posAtStart-m.border:-1}}function xr(e,t){var n=e.getClientRects();return n.length?n[t<0?0:n.length-1]:e.getBoundingClientRect()}var Cr=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function Sr(e,t,n){var r=e.docView.domFromPos(t,n<0?-1:1),o=r.node,i=r.offset,s=Un.webkit||Un.gecko;if(3==o.nodeType){if(!s||!Cr.test(o.nodeValue)&&(n<0?i:i!=o.nodeValue.length)){var a=i,c=i,l=n<0?1:-1;return n<0&&!i?(c++,l=-1):n>=0&&i==o.nodeValue.length?(a--,l=1):n<0?a--:c++,Mr(xr(rr(o,a,c),l),l<0)}var u=xr(rr(o,i,i),n);if(Un.gecko&&i&&/\s/.test(o.nodeValue[i-1])&&i<o.nodeValue.length){var f=xr(rr(o,i-1,i-1),-1);if(f.top==u.top){var d=xr(rr(o,i,i+1),-1);if(d.top!=u.top)return Mr(d,d.left<f.left)}}return u}if(!e.state.doc.resolve(t).parent.inlineContent){if(i&&(n<0||i==ar(o))){var p=o.childNodes[i-1];if(1==p.nodeType)return Or(p.getBoundingClientRect(),!1)}if(i<ar(o)){var h=o.childNodes[i];if(1==h.nodeType)return Or(h.getBoundingClientRect(),!0)}return Or(o.getBoundingClientRect(),n>=0)}if(i&&(n<0||i==ar(o))){var m=o.childNodes[i-1],g=3==m.nodeType?rr(m,ar(m)-(s?0:1)):1!=m.nodeType||"BR"==m.nodeName&&m.nextSibling?null:m;if(g)return Mr(xr(g,1),!1)}if(i<ar(o)){for(var v=o.childNodes[i];v.pmViewDesc&&v.pmViewDesc.ignoreForCoords;)v=v.nextSibling;var y=v?3==v.nodeType?rr(v,0,s?0:1):1==v.nodeType?v:null:null;if(y)return Mr(xr(y,-1),!0)}return Mr(xr(3==o.nodeType?rr(o):o,-n),n>=0)}function Mr(e,t){if(0==e.width)return e;var n=t?e.left:e.right;return{top:e.top,bottom:e.bottom,left:n,right:n}}function Or(e,t){if(0==e.height)return e;var n=t?e.top:e.bottom;return{top:n,bottom:n,left:e.left,right:e.right}}function Ar(e,t,n){var r=e.state,o=e.root.activeElement;r!=t&&e.updateState(t),o!=e.dom&&e.focus();try{return n()}finally{r!=t&&e.updateState(r),o!=e.dom&&o&&o.focus()}}var Er=/[\u0590-\u08ac]/;var Tr=null,Nr=null,Dr=!1;function Ir(e,t,n){return Tr==t&&Nr==n?Dr:(Tr=t,Nr=n,Dr="up"==n||"down"==n?function(e,t,n){var r=t.selection,o="up"==n?r.$from:r.$to;return Ar(e,t,(function(){for(var t=e.docView.domFromPos(o.pos,"up"==n?-1:1).node;;){var r=e.docView.nearestDesc(t,!0);if(!r)break;if(r.node.isBlock){t=r.dom;break}t=r.dom.parentNode}for(var i=Sr(e,o.pos,1),s=t.firstChild;s;s=s.nextSibling){var a=void 0;if(1==s.nodeType)a=s.getClientRects();else{if(3!=s.nodeType)continue;a=rr(s,0,s.nodeValue.length).getClientRects()}for(var c=0;c<a.length;c++){var l=a[c];if(l.bottom>l.top+1&&("up"==n?i.top-l.top>2*(l.bottom-i.top):l.bottom-i.bottom>2*(i.bottom-l.top)))return!1}}return!0}))}(e,t,n):function(e,t,n){var r=t.selection.$head;if(!r.parent.isTextblock)return!1;var o=r.parentOffset,i=!o,s=o==r.parent.content.size,a=e.root.getSelection();return Er.test(r.parent.textContent)&&a.modify?Ar(e,t,(function(){var t=a.getRangeAt(0),o=a.focusNode,i=a.focusOffset,s=a.caretBidiLevel;a.modify("move",n,"character");var c=!(r.depth?e.docView.domAfterPos(r.before()):e.dom).contains(1==a.focusNode.nodeType?a.focusNode:a.focusNode.parentNode)||o==a.focusNode&&i==a.focusOffset;return a.removeAllRanges(),a.addRange(t),null!=s&&(a.caretBidiLevel=s),c})):"left"==n||"backward"==n?i:s}(e,t,n))}var zr=function(e,t,n,r){this.parent=e,this.children=t,this.dom=n,n.pmViewDesc=this,this.contentDOM=r,this.dirty=0},Fr={size:{configurable:!0},border:{configurable:!0},posBefore:{configurable:!0},posAtStart:{configurable:!0},posAfter:{configurable:!0},posAtEnd:{configurable:!0},contentLost:{configurable:!0},domAtom:{configurable:!0},ignoreForCoords:{configurable:!0}};zr.prototype.matchesWidget=function(){return!1},zr.prototype.matchesMark=function(){return!1},zr.prototype.matchesNode=function(){return!1},zr.prototype.matchesHack=function(e){return!1},zr.prototype.parseRule=function(){return null},zr.prototype.stopEvent=function(){return!1},Fr.size.get=function(){for(var e=0,t=0;t<this.children.length;t++)e+=this.children[t].size;return e},Fr.border.get=function(){return 0},zr.prototype.destroy=function(){this.parent=null,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=null);for(var e=0;e<this.children.length;e++)this.children[e].destroy()},zr.prototype.posBeforeChild=function(e){for(var t=0,n=this.posAtStart;t<this.children.length;t++){var r=this.children[t];if(r==e)return n;n+=r.size}},Fr.posBefore.get=function(){return this.parent.posBeforeChild(this)},Fr.posAtStart.get=function(){return this.parent?this.parent.posBeforeChild(this)+this.border:0},Fr.posAfter.get=function(){return this.posBefore+this.size},Fr.posAtEnd.get=function(){return this.posAtStart+this.size-2*this.border},zr.prototype.localPosFromDOM=function(e,t,n){if(this.contentDOM&&this.contentDOM.contains(1==e.nodeType?e:e.parentNode)){if(n<0){var r,o;if(e==this.contentDOM)r=e.childNodes[t-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;r=e.previousSibling}for(;r&&(!(o=r.pmViewDesc)||o.parent!=this);)r=r.previousSibling;return r?this.posBeforeChild(o)+o.size:this.posAtStart}var i,s;if(e==this.contentDOM)i=e.childNodes[t];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;i=e.nextSibling}for(;i&&(!(s=i.pmViewDesc)||s.parent!=this);)i=i.nextSibling;return i?this.posBeforeChild(s):this.posAtEnd}var a;if(e==this.dom&&this.contentDOM)a=t>er(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))a=2&e.compareDocumentPosition(this.contentDOM);else if(this.dom.firstChild){if(0==t)for(var c=e;;c=c.parentNode){if(c==this.dom){a=!1;break}if(c.parentNode.firstChild!=c)break}if(null==a&&t==e.childNodes.length)for(var l=e;;l=l.parentNode){if(l==this.dom){a=!0;break}if(l.parentNode.lastChild!=l)break}}return(null==a?n>0:a)?this.posAtEnd:this.posAtStart},zr.prototype.nearestDesc=function(e,t){for(var n=!0,r=e;r;r=r.parentNode){var o=this.getDesc(r);if(o&&(!t||o.node)){if(!n||!o.nodeDOM||(1==o.nodeDOM.nodeType?o.nodeDOM.contains(1==e.nodeType?e:e.parentNode):o.nodeDOM==e))return o;n=!1}}},zr.prototype.getDesc=function(e){for(var t=e.pmViewDesc,n=t;n;n=n.parent)if(n==this)return t},zr.prototype.posFromDOM=function(e,t,n){for(var r=e;r;r=r.parentNode){var o=this.getDesc(r);if(o)return o.localPosFromDOM(e,t,n)}return-1},zr.prototype.descAt=function(e){for(var t=0,n=0;t<this.children.length;t++){var r=this.children[t],o=n+r.size;if(n==e&&o!=n){for(;!r.border&&r.children.length;)r=r.children[0];return r}if(e<o)return r.descAt(e-n-r.border);n=o}},zr.prototype.domFromPos=function(e,t){if(!this.contentDOM)return{node:this.dom,offset:0};for(var n=0,r=0,o=0;n<this.children.length;n++){var i=this.children[n],s=o+i.size;if(s>e||i instanceof Vr){r=e-o;break}o=s}if(r)return this.children[n].domFromPos(r-this.children[n].border,t);for(var a=void 0;n&&!(a=this.children[n-1]).size&&a instanceof $r&&a.widget.type.side>=0;n--);if(t<=0){for(var c,l=!0;(c=n?this.children[n-1]:null)&&c.dom.parentNode!=this.contentDOM;n--,l=!1);return c&&t&&l&&!c.border&&!c.domAtom?c.domFromPos(c.size,t):{node:this.contentDOM,offset:c?er(c.dom)+1:0}}for(var u,f=!0;(u=n<this.children.length?this.children[n]:null)&&u.dom.parentNode!=this.contentDOM;n++,f=!1);return u&&f&&!u.border&&!u.domAtom?u.domFromPos(0,t):{node:this.contentDOM,offset:u?er(u.dom):this.contentDOM.childNodes.length}},zr.prototype.parseRange=function(e,t,n){if(void 0===n&&(n=0),0==this.children.length)return{node:this.contentDOM,from:e,to:t,fromOffset:0,toOffset:this.contentDOM.childNodes.length};for(var r=-1,o=-1,i=n,s=0;;s++){var a=this.children[s],c=i+a.size;if(-1==r&&e<=c){var l=i+a.border;if(e>=l&&t<=c-a.border&&a.node&&a.contentDOM&&this.contentDOM.contains(a.contentDOM))return a.parseRange(e,t,l);e=i;for(var u=s;u>0;u--){var f=this.children[u-1];if(f.size&&f.dom.parentNode==this.contentDOM&&!f.emptyChildAt(1)){r=er(f.dom)+1;break}e-=f.size}-1==r&&(r=0)}if(r>-1&&(c>t||s==this.children.length-1)){t=c;for(var d=s+1;d<this.children.length;d++){var p=this.children[d];if(p.size&&p.dom.parentNode==this.contentDOM&&!p.emptyChildAt(-1)){o=er(p.dom);break}t+=p.size}-1==o&&(o=this.contentDOM.childNodes.length);break}i=c}return{node:this.contentDOM,from:e,to:t,fromOffset:r,toOffset:o}},zr.prototype.emptyChildAt=function(e){if(this.border||!this.contentDOM||!this.children.length)return!1;var t=this.children[e<0?0:this.children.length-1];return 0==t.size||t.emptyChildAt(e)},zr.prototype.domAfterPos=function(e){var t=this.domFromPos(e,0),n=t.node,r=t.offset;if(1!=n.nodeType||r==n.childNodes.length)throw new RangeError("No node after pos "+e);return n.childNodes[r]},zr.prototype.setSelection=function(e,t,n,r){for(var o=Math.min(e,t),i=Math.max(e,t),s=0,a=0;s<this.children.length;s++){var c=this.children[s],l=a+c.size;if(o>a&&i<l)return c.setSelection(e-a-c.border,t-a-c.border,n,r);a=l}var u=this.domFromPos(e,e?-1:1),f=t==e?u:this.domFromPos(t,t?-1:1),d=n.getSelection(),p=!1;if((Un.gecko||Un.safari)&&e==t){var h=u.node,m=u.offset;if(3==h.nodeType){if((p=m&&"\n"==h.nodeValue[m-1])&&m==h.nodeValue.length)for(var g=h,v=void 0;g;g=g.parentNode){if(v=g.nextSibling){"BR"==v.nodeName&&(u=f={node:v.parentNode,offset:er(v)+1});break}var y=g.pmViewDesc;if(y&&y.node&&y.node.isBlock)break}}else{var b=h.childNodes[m-1];p=b&&("BR"==b.nodeName||"false"==b.contentEditable)}}if(Un.gecko&&d.focusNode&&d.focusNode!=f.node&&1==d.focusNode.nodeType){var w=d.focusNode.childNodes[d.focusOffset];w&&"false"==w.contentEditable&&(r=!0)}if(r||p&&Un.safari||!or(u.node,u.offset,d.anchorNode,d.anchorOffset)||!or(f.node,f.offset,d.focusNode,d.focusOffset)){var k=!1;if((d.extend||e==t)&&!p){d.collapse(u.node,u.offset);try{e!=t&&d.extend(f.node,f.offset),k=!0}catch(S){if(!(S instanceof DOMException))throw S}}if(!k){if(e>t){var x=u;u=f,f=x}var C=document.createRange();C.setEnd(f.node,f.offset),C.setStart(u.node,u.offset),d.removeAllRanges(),d.addRange(C)}}},zr.prototype.ignoreMutation=function(e){return!this.contentDOM&&"selection"!=e.type},Fr.contentLost.get=function(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)},zr.prototype.markDirty=function(e,t){for(var n=0,r=0;r<this.children.length;r++){var o=this.children[r],i=n+o.size;if(n==i?e<=i&&t>=n:e<i&&t>n){var s=n+o.border,a=i-o.border;if(e>=s&&t<=a)return this.dirty=e==n||t==i?2:1,void(e!=s||t!=a||!o.contentLost&&o.dom.parentNode==this.contentDOM?o.markDirty(e-s,t-s):o.dirty=3);o.dirty=o.dom==o.contentDOM&&o.dom.parentNode==this.contentDOM?2:3}n=i}this.dirty=2},zr.prototype.markParentsDirty=function(){for(var e=1,t=this.parent;t;t=t.parent,e++){var n=1==e?2:1;t.dirty<n&&(t.dirty=n)}},Fr.domAtom.get=function(){return!1},Fr.ignoreForCoords.get=function(){return!1},Object.defineProperties(zr.prototype,Fr);var Rr=[],$r=function(e){function t(t,n,r,o){var i,s=n.type.toDOM;if("function"==typeof s&&(s=s(r,(function(){return i?i.parent?i.parent.posBeforeChild(i):void 0:o}))),!n.type.spec.raw){if(1!=s.nodeType){var a=document.createElement("span");a.appendChild(s),s=a}s.contentEditable=!1,s.classList.add("ProseMirror-widget")}e.call(this,t,Rr,s,null),this.widget=n,i=this}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={domAtom:{configurable:!0}};return t.prototype.matchesWidget=function(e){return 0==this.dirty&&e.type.eq(this.widget.type)},t.prototype.parseRule=function(){return{ignore:!0}},t.prototype.stopEvent=function(e){var t=this.widget.spec.stopEvent;return!!t&&t(e)},t.prototype.ignoreMutation=function(e){return"selection"!=e.type||this.widget.spec.ignoreSelection},t.prototype.destroy=function(){this.widget.type.destroy(this.dom),e.prototype.destroy.call(this)},n.domAtom.get=function(){return!0},Object.defineProperties(t.prototype,n),t}(zr),_r=function(e){function t(t,n,r,o){e.call(this,t,Rr,n,null),this.textDOM=r,this.text=o}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={size:{configurable:!0}};return n.size.get=function(){return this.text.length},t.prototype.localPosFromDOM=function(e,t){return e!=this.textDOM?this.posAtStart+(t?this.size:0):this.posAtStart+t},t.prototype.domFromPos=function(e){return{node:this.textDOM,offset:e}},t.prototype.ignoreMutation=function(e){return"characterData"===e.type&&e.target.nodeValue==e.oldValue},Object.defineProperties(t.prototype,n),t}(zr),Pr=function(e){function t(t,n,r,o){e.call(this,t,[],r,o),this.mark=n}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.create=function(e,n,r,o){var i=o.nodeViews[n.type.name],s=i&&i(n,o,r);return s&&s.dom||(s=ct.renderSpec(document,n.type.spec.toDOM(n,r))),new t(e,n,s.dom,s.contentDOM||s.dom)},t.prototype.parseRule=function(){return{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}},t.prototype.matchesMark=function(e){return 3!=this.dirty&&this.mark.eq(e)},t.prototype.markDirty=function(t,n){if(e.prototype.markDirty.call(this,t,n),0!=this.dirty){for(var r=this.parent;!r.node;)r=r.parent;r.dirty<this.dirty&&(r.dirty=this.dirty),this.dirty=0}},t.prototype.slice=function(e,n,r){var o=t.create(this.parent,this.mark,!0,r),i=this.children,s=this.size;n<s&&(i=to(i,n,s,r)),e>0&&(i=to(i,0,e,r));for(var a=0;a<i.length;a++)i[a].parent=o;return o.children=i,o},t}(zr),jr=function(e){function t(t,n,r,o,i,s,a,c,l){e.call(this,t,n.isLeaf?Rr:[],i,s),this.nodeDOM=a,this.node=n,this.outerDeco=r,this.innerDeco=o,s&&this.updateChildren(c,l)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={size:{configurable:!0},border:{configurable:!0},domAtom:{configurable:!0}};return t.create=function(e,n,r,o,i,s){var a,c,l=i.nodeViews[n.type.name],u=l&&l(n,i,(function(){return c?c.parent?c.parent.posBeforeChild(c):void 0:s}),r,o),f=u&&u.dom,d=u&&u.contentDOM;if(n.isText)if(f){if(3!=f.nodeType)throw new RangeError("Text must be rendered as a DOM text node")}else f=document.createTextNode(n.text);else f||(f=(a=ct.renderSpec(document,n.type.spec.toDOM(n))).dom,d=a.contentDOM);d||n.isText||"BR"==f.nodeName||(f.hasAttribute("contenteditable")||(f.contentEditable=!1),n.type.spec.draggable&&(f.draggable=!0));var p=f;return f=Qr(f,r,n),u?c=new Hr(e,n,r,o,f,d,p,u,i,s+1):n.isText?new Br(e,n,r,o,f,p,i):new t(e,n,r,o,f,d,p,i,s+1)},t.prototype.parseRule=function(){var e=this;if(this.node.type.spec.reparseInView)return null;var t={node:this.node.type.name,attrs:this.node.attrs};return this.node.type.spec.code&&(t.preserveWhitespace="full"),this.contentDOM&&!this.contentLost?t.contentElement=this.contentDOM:t.getContent=function(){return e.contentDOM?X.empty:e.node.content},t},t.prototype.matchesNode=function(e,t,n){return 0==this.dirty&&e.eq(this.node)&&Zr(t,this.outerDeco)&&n.eq(this.innerDeco)},n.size.get=function(){return this.node.nodeSize},n.border.get=function(){return this.node.isLeaf?0:1},t.prototype.updateChildren=function(e,t){var n=this,r=this.node.inlineContent,o=t,i=e.composing&&this.localCompositionInfo(e,t),s=i&&i.pos>-1?i:null,a=i&&i.pos<0,c=new Yr(this,s&&s.node);!function(e,t,n,r){var o=t.locals(e),i=0;if(0==o.length){for(var s=0;s<e.childCount;s++){var a=e.child(s);r(a,o,t.forChild(i,a),s),i+=a.nodeSize}return}for(var c=0,l=[],u=null,f=0;;){if(c<o.length&&o[c].to==i){for(var d=o[c++],p=void 0;c<o.length&&o[c].to==i;)(p||(p=[d])).push(o[c++]);if(p){p.sort(eo);for(var h=0;h<p.length;h++)n(p[h],f,!!u)}else n(d,f,!!u)}var m=void 0,g=void 0;if(u)g=-1,m=u,u=null;else{if(!(f<e.childCount))break;g=f,m=e.child(f++)}for(var v=0;v<l.length;v++)l[v].to<=i&&l.splice(v--,1);for(;c<o.length&&o[c].from<=i&&o[c].to>i;)l.push(o[c++]);var y=i+m.nodeSize;if(m.isText){var b=y;c<o.length&&o[c].from<b&&(b=o[c].from);for(var w=0;w<l.length;w++)l[w].to<b&&(b=l[w].to);b<y&&(u=m.cut(b-i),m=m.cut(0,b-i),y=b,g=-1)}r(m,l.length?m.isInline&&!m.isLeaf?l.filter((function(e){return!e.inline})):l.slice():Rr,t.forChild(i,m),g),i=y}}(this.node,this.innerDeco,(function(t,i,s){t.spec.marks?c.syncToMarks(t.spec.marks,r,e):t.type.side>=0&&!s&&c.syncToMarks(i==n.node.childCount?re.none:n.node.child(i).marks,r,e),c.placeWidget(t,e,o)}),(function(t,n,s,l){var u;c.syncToMarks(t.marks,r,e),c.findNodeMatch(t,n,s,l)||a&&e.state.selection.from>o&&e.state.selection.to<o+t.nodeSize&&(u=c.findIndexWithChild(i.node))>-1&&c.updateNodeAt(t,n,s,u,e)||c.updateNextNode(t,n,s,e,l)||c.addNode(t,n,s,e,o),o+=t.nodeSize})),c.syncToMarks(Rr,r,e),this.node.isTextblock&&c.addTextblockHacks(),c.destroyRest(),(c.changed||2==this.dirty)&&(s&&this.protectLocalComposition(e,s),Wr(this.contentDOM,this.children,e),Un.ios&&function(e){if("UL"==e.nodeName||"OL"==e.nodeName){var t=e.style.cssText;e.style.cssText=t+"; list-style: square !important",window.getComputedStyle(e).listStyle,e.style.cssText=t}}(this.dom))},t.prototype.localCompositionInfo=function(e,t){var n=e.state.selection,r=n.from,o=n.to;if(!(!(e.state.selection instanceof Gt)||r<t||o>t+this.node.content.size)){var i=e.root.getSelection(),s=function(e,t){for(;;){if(3==e.nodeType)return e;if(1==e.nodeType&&t>0){if(e.childNodes.length>t&&3==e.childNodes[t].nodeType)return e.childNodes[t];t=ar(e=e.childNodes[t-1])}else{if(!(1==e.nodeType&&t<e.childNodes.length))return null;e=e.childNodes[t],t=0}}}(i.focusNode,i.focusOffset);if(s&&this.dom.contains(s.parentNode)){if(this.node.inlineContent){var a=s.nodeValue,c=function(e,t,n,r){for(var o=0,i=0;o<e.childCount&&i<=r;){var s=e.child(o++),a=i;if(i+=s.nodeSize,s.isText){for(var c=s.text;o<e.childCount;){var l=e.child(o++);if(i+=l.nodeSize,!l.isText)break;c+=l.text}if(i>=n){var u=c.lastIndexOf(t,r-a);if(u>=0&&u+t.length+a>=n)return a+u}}}return-1}(this.node.content,a,r-t,o-t);return c<0?null:{node:s,pos:c,text:a}}return{node:s,pos:-1}}}},t.prototype.protectLocalComposition=function(e,t){var n=t.node,r=t.pos,o=t.text;if(!this.getDesc(n)){for(var i=n;i.parentNode!=this.contentDOM;i=i.parentNode){for(;i.previousSibling;)i.parentNode.removeChild(i.previousSibling);for(;i.nextSibling;)i.parentNode.removeChild(i.nextSibling);i.pmViewDesc&&(i.pmViewDesc=null)}var s=new _r(this,i,n,o);e.compositionNodes.push(s),this.children=to(this.children,r,r+o.length,e,s)}},t.prototype.update=function(e,t,n,r){return!(3==this.dirty||!e.sameMarkup(this.node))&&(this.updateInner(e,t,n,r),!0)},t.prototype.updateInner=function(e,t,n,r){this.updateOuterDeco(t),this.node=e,this.innerDeco=n,this.contentDOM&&this.updateChildren(r,this.posAtStart),this.dirty=0},t.prototype.updateOuterDeco=function(e){if(!Zr(e,this.outerDeco)){var t=1!=this.nodeDOM.nodeType,n=this.dom;this.dom=Ur(this.dom,this.nodeDOM,Kr(this.outerDeco,this.node,t),Kr(e,this.node,t)),this.dom!=n&&(n.pmViewDesc=null,this.dom.pmViewDesc=this),this.outerDeco=e}},t.prototype.selectNode=function(){this.nodeDOM.classList.add("ProseMirror-selectednode"),!this.contentDOM&&this.node.type.spec.draggable||(this.dom.draggable=!0)},t.prototype.deselectNode=function(){this.nodeDOM.classList.remove("ProseMirror-selectednode"),!this.contentDOM&&this.node.type.spec.draggable||this.dom.removeAttribute("draggable")},n.domAtom.get=function(){return this.node.isAtom},Object.defineProperties(t.prototype,n),t}(zr);function Lr(e,t,n,r,o){return Qr(r,t,e),new jr(null,e,t,n,r,r,r,o,0)}var Br=function(e){function t(t,n,r,o,i,s,a){e.call(this,t,n,r,o,i,null,s,a)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={domAtom:{configurable:!0}};return t.prototype.parseRule=function(){for(var e=this.nodeDOM.parentNode;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}},t.prototype.update=function(e,t,n,r){return!(3==this.dirty||0!=this.dirty&&!this.inParent()||!e.sameMarkup(this.node))&&(this.updateOuterDeco(t),0==this.dirty&&e.text==this.node.text||e.text==this.nodeDOM.nodeValue||(this.nodeDOM.nodeValue=e.text,r.trackWrites==this.nodeDOM&&(r.trackWrites=null)),this.node=e,this.dirty=0,!0)},t.prototype.inParent=function(){for(var e=this.parent.contentDOM,t=this.nodeDOM;t;t=t.parentNode)if(t==e)return!0;return!1},t.prototype.domFromPos=function(e){return{node:this.nodeDOM,offset:e}},t.prototype.localPosFromDOM=function(t,n,r){return t==this.nodeDOM?this.posAtStart+Math.min(n,this.node.text.length):e.prototype.localPosFromDOM.call(this,t,n,r)},t.prototype.ignoreMutation=function(e){return"characterData"!=e.type&&"selection"!=e.type},t.prototype.slice=function(e,n,r){var o=this.node.cut(e,n),i=document.createTextNode(o.text);return new t(this.parent,o,this.outerDeco,this.innerDeco,i,i,r)},t.prototype.markDirty=function(t,n){e.prototype.markDirty.call(this,t,n),this.dom==this.nodeDOM||0!=t&&n!=this.nodeDOM.nodeValue.length||(this.dirty=3)},n.domAtom.get=function(){return!1},Object.defineProperties(t.prototype,n),t}(jr),Vr=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={domAtom:{configurable:!0},ignoreForCoords:{configurable:!0}};return t.prototype.parseRule=function(){return{ignore:!0}},t.prototype.matchesHack=function(e){return 0==this.dirty&&this.dom.nodeName==e},n.domAtom.get=function(){return!0},n.ignoreForCoords.get=function(){return"IMG"==this.dom.nodeName},Object.defineProperties(t.prototype,n),t}(zr),Hr=function(e){function t(t,n,r,o,i,s,a,c,l,u){e.call(this,t,n,r,o,i,s,a,l,u),this.spec=c}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.update=function(t,n,r,o){if(3==this.dirty)return!1;if(this.spec.update){var i=this.spec.update(t,n,r);return i&&this.updateInner(t,n,r,o),i}return!(!this.contentDOM&&!t.isLeaf)&&e.prototype.update.call(this,t,n,r,o)},t.prototype.selectNode=function(){this.spec.selectNode?this.spec.selectNode():e.prototype.selectNode.call(this)},t.prototype.deselectNode=function(){this.spec.deselectNode?this.spec.deselectNode():e.prototype.deselectNode.call(this)},t.prototype.setSelection=function(t,n,r,o){this.spec.setSelection?this.spec.setSelection(t,n,r):e.prototype.setSelection.call(this,t,n,r,o)},t.prototype.destroy=function(){this.spec.destroy&&this.spec.destroy(),e.prototype.destroy.call(this)},t.prototype.stopEvent=function(e){return!!this.spec.stopEvent&&this.spec.stopEvent(e)},t.prototype.ignoreMutation=function(t){return this.spec.ignoreMutation?this.spec.ignoreMutation(t):e.prototype.ignoreMutation.call(this,t)},t}(jr);function Wr(e,t,n){for(var r=e.firstChild,o=!1,i=0;i<t.length;i++){var s=t[i],a=s.dom;if(a.parentNode==e){for(;a!=r;)r=Xr(r),o=!0;r=r.nextSibling}else o=!0,e.insertBefore(a,r);if(s instanceof Pr){var c=r?r.previousSibling:e.lastChild;Wr(s.contentDOM,s.children,n),r=c?c.nextSibling:e.firstChild}}for(;r;)r=Xr(r),o=!0;o&&n.trackWrites==e&&(n.trackWrites=null)}function qr(e){e&&(this.nodeName=e)}qr.prototype=Object.create(null);var Jr=[new qr];function Kr(e,t,n){if(0==e.length)return Jr;for(var r=n?Jr[0]:new qr,o=[r],i=0;i<e.length;i++){var s=e[i].type.attrs;if(s)for(var a in s.nodeName&&o.push(r=new qr(s.nodeName)),s){var c=s[a];null!=c&&(n&&1==o.length&&o.push(r=new qr(t.isInline?"span":"div")),"class"==a?r.class=(r.class?r.class+" ":"")+c:"style"==a?r.style=(r.style?r.style+";":"")+c:"nodeName"!=a&&(r[a]=c))}}return o}function Ur(e,t,n,r){if(n==Jr&&r==Jr)return t;for(var o=t,i=0;i<r.length;i++){var s=r[i],a=n[i];if(i){var c=void 0;a&&a.nodeName==s.nodeName&&o!=e&&(c=o.parentNode)&&c.tagName.toLowerCase()==s.nodeName||((c=document.createElement(s.nodeName)).pmIsDeco=!0,c.appendChild(o),a=Jr[0]),o=c}Gr(o,a||Jr[0],s)}return o}function Gr(e,t,n){for(var r in t)"class"==r||"style"==r||"nodeName"==r||r in n||e.removeAttribute(r);for(var o in n)"class"!=o&&"style"!=o&&"nodeName"!=o&&n[o]!=t[o]&&e.setAttribute(o,n[o]);if(t.class!=n.class){for(var i=t.class?t.class.split(" ").filter(Boolean):Rr,s=n.class?n.class.split(" ").filter(Boolean):Rr,a=0;a<i.length;a++)-1==s.indexOf(i[a])&&e.classList.remove(i[a]);for(var c=0;c<s.length;c++)-1==i.indexOf(s[c])&&e.classList.add(s[c]);0==e.classList.length&&e.removeAttribute("class")}if(t.style!=n.style){if(t.style)for(var l,u=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g;l=u.exec(t.style);)e.style.removeProperty(l[1]);n.style&&(e.style.cssText+=n.style)}}function Qr(e,t,n){return Ur(e,e,Jr,Kr(t,n,1!=e.nodeType))}function Zr(e,t){if(e.length!=t.length)return!1;for(var n=0;n<e.length;n++)if(!e[n].type.eq(t[n].type))return!1;return!0}function Xr(e){var t=e.nextSibling;return e.parentNode.removeChild(e),t}var Yr=function(e,t){this.top=e,this.lock=t,this.index=0,this.stack=[],this.changed=!1,this.preMatch=function(e,t){var n=t,r=n.children.length,o=e.childCount,i=new Map,s=[];e:for(;o>0;){for(var a=void 0;;)if(r){var c=n.children[r-1];if(!(c instanceof Pr)){a=c,r--;break}n=c,r=c.children.length}else{if(n==t)break e;r=n.parent.children.indexOf(n),n=n.parent}var l=a.node;if(l){if(l!=e.child(o-1))break;--o,i.set(a,o),s.push(a)}}return{index:o,matched:i,matches:s.reverse()}}(e.node.content,e)};function eo(e,t){return e.type.side-t.type.side}function to(e,t,n,r,o){for(var i=[],s=0,a=0;s<e.length;s++){var c=e[s],l=a,u=a+=c.size;l>=n||u<=t?i.push(c):(l<t&&i.push(c.slice(0,t-l,r)),o&&(i.push(o),o=null),u>n&&i.push(c.slice(n-l,c.size,r)))}return i}function no(e,t){var n=e.root.getSelection(),r=e.state.doc;if(!n.focusNode)return null;var o=e.docView.nearestDesc(n.focusNode),i=o&&0==o.size,s=e.docView.posFromDOM(n.focusNode,n.focusOffset);if(s<0)return null;var a,c,l=r.resolve(s);if(lr(n)){for(a=l;o&&!o.node;)o=o.parent;if(o&&o.node.isAtom&&Zt.isSelectable(o.node)&&o.parent&&(!o.node.isInline||!function(e,t,n){for(var r=0==t,o=t==ar(e);r||o;){if(e==n)return!0;var i=er(e);if(!(e=e.parentNode))return!1;r=r&&0==i,o=o&&i==ar(e)}}(n.focusNode,n.focusOffset,o.dom))){var u=o.posBefore;c=new Zt(s==u?l:r.resolve(u))}}else{var f=e.docView.posFromDOM(n.anchorNode,n.anchorOffset);if(f<0)return null;a=r.resolve(f)}c||(c=fo(e,a,l,"pointer"==t||e.state.selection.head<l.pos&&!i?1:-1));return c}function ro(e){return e.editable?e.hasFocus():po(e)&&document.activeElement&&document.activeElement.contains(e.dom)}function oo(e,t){var n=e.state.selection;if(lo(e,n),ro(e)){if(!t&&e.mouseDown&&e.mouseDown.allowDefault)return e.mouseDown.delayedSelectionSync=!0,void e.domObserver.setCurSelection();if(e.domObserver.disconnectSelection(),e.cursorWrapper)!function(e){var t=e.root.getSelection(),n=document.createRange(),r=e.cursorWrapper.dom,o="IMG"==r.nodeName;o?n.setEnd(r.parentNode,er(r)+1):n.setEnd(r,0);n.collapse(!1),t.removeAllRanges(),t.addRange(n),!o&&!e.state.selection.visible&&Un.ie&&Un.ie_version<=11&&(r.disabled=!0,r.disabled=!1)}(e);else{var r,o,i=n.anchor,s=n.head;!io||n instanceof Gt||(n.$from.parent.inlineContent||(r=so(e,n.from)),n.empty||n.$from.parent.inlineContent||(o=so(e,n.to))),e.docView.setSelection(i,s,e.root,t),io&&(r&&co(r),o&&co(o)),n.visible?e.dom.classList.remove("ProseMirror-hideselection"):(e.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&function(e){var t=e.dom.ownerDocument;t.removeEventListener("selectionchange",e.hideSelectionGuard);var n=e.root.getSelection(),r=n.anchorNode,o=n.anchorOffset;t.addEventListener("selectionchange",e.hideSelectionGuard=function(){n.anchorNode==r&&n.anchorOffset==o||(t.removeEventListener("selectionchange",e.hideSelectionGuard),setTimeout((function(){ro(e)&&!e.state.selection.visible||e.dom.classList.remove("ProseMirror-hideselection")}),20))})}(e))}e.domObserver.setCurSelection(),e.domObserver.connectSelection()}}Yr.prototype.destroyBetween=function(e,t){if(e!=t){for(var n=e;n<t;n++)this.top.children[n].destroy();this.top.children.splice(e,t-e),this.changed=!0}},Yr.prototype.destroyRest=function(){this.destroyBetween(this.index,this.top.children.length)},Yr.prototype.syncToMarks=function(e,t,n){for(var r=0,o=this.stack.length>>1,i=Math.min(o,e.length);r<i&&(r==o-1?this.top:this.stack[r+1<<1]).matchesMark(e[r])&&!1!==e[r].type.spec.spanning;)r++;for(;r<o;)this.destroyRest(),this.top.dirty=0,this.index=this.stack.pop(),this.top=this.stack.pop(),o--;for(;o<e.length;){this.stack.push(this.top,this.index+1);for(var s=-1,a=this.index;a<Math.min(this.index+3,this.top.children.length);a++)if(this.top.children[a].matchesMark(e[o])){s=a;break}if(s>-1)s>this.index&&(this.changed=!0,this.destroyBetween(this.index,s)),this.top=this.top.children[this.index];else{var c=Pr.create(this.top,e[o],t,n);this.top.children.splice(this.index,0,c),this.top=c,this.changed=!0}this.index=0,o++}},Yr.prototype.findNodeMatch=function(e,t,n,r){var o,i=-1;if(r>=this.preMatch.index&&(o=this.preMatch.matches[r-this.preMatch.index]).parent==this.top&&o.matchesNode(e,t,n))i=this.top.children.indexOf(o,this.index);else for(var s=this.index,a=Math.min(this.top.children.length,s+5);s<a;s++){var c=this.top.children[s];if(c.matchesNode(e,t,n)&&!this.preMatch.matched.has(c)){i=s;break}}return!(i<0)&&(this.destroyBetween(this.index,i),this.index++,!0)},Yr.prototype.updateNodeAt=function(e,t,n,r,o){return!!this.top.children[r].update(e,t,n,o)&&(this.destroyBetween(this.index,r),this.index=r+1,!0)},Yr.prototype.findIndexWithChild=function(e){for(;;){var t=e.parentNode;if(!t)return-1;if(t==this.top.contentDOM){var n=e.pmViewDesc;if(n)for(var r=this.index;r<this.top.children.length;r++)if(this.top.children[r]==n)return r;return-1}e=t}},Yr.prototype.updateNextNode=function(e,t,n,r,o){for(var i=this.index;i<this.top.children.length;i++){var s=this.top.children[i];if(s instanceof jr){var a=this.preMatch.matched.get(s);if(null!=a&&a!=o)return!1;var c=s.dom;if(!(this.lock&&(c==this.lock||1==c.nodeType&&c.contains(this.lock.parentNode))&&!(e.isText&&s.node&&s.node.isText&&s.nodeDOM.nodeValue==e.text&&3!=s.dirty&&Zr(t,s.outerDeco)))&&s.update(e,t,n,r))return this.destroyBetween(this.index,i),s.dom!=c&&(this.changed=!0),this.index++,!0;break}}return!1},Yr.prototype.addNode=function(e,t,n,r,o){this.top.children.splice(this.index++,0,jr.create(this.top,e,t,n,r,o)),this.changed=!0},Yr.prototype.placeWidget=function(e,t,n){var r=this.index<this.top.children.length?this.top.children[this.index]:null;if(!r||!r.matchesWidget(e)||e!=r.widget&&r.widget.type.toDOM.parentNode){var o=new $r(this.top,e,t,n);this.top.children.splice(this.index++,0,o),this.changed=!0}else this.index++},Yr.prototype.addTextblockHacks=function(){for(var e=this.top.children[this.index-1];e instanceof Pr;)e=e.children[e.children.length-1];e&&e instanceof Br&&!/\n$/.test(e.node.text)||((Un.safari||Un.chrome)&&e&&"false"==e.dom.contentEditable&&this.addHackNode("IMG"),this.addHackNode("BR"))},Yr.prototype.addHackNode=function(e){if(this.index<this.top.children.length&&this.top.children[this.index].matchesHack(e))this.index++;else{var t=document.createElement(e);"IMG"==e&&(t.className="ProseMirror-separator"),"BR"==e&&(t.className="ProseMirror-trailingBreak"),this.top.children.splice(this.index++,0,new Vr(this.top,Rr,t,null)),this.changed=!0}};var io=Un.safari||Un.chrome&&Un.chrome_version<63;function so(e,t){var n=e.docView.domFromPos(t,0),r=n.node,o=n.offset,i=o<r.childNodes.length?r.childNodes[o]:null,s=o?r.childNodes[o-1]:null;if(Un.safari&&i&&"false"==i.contentEditable)return ao(i);if(!(i&&"false"!=i.contentEditable||s&&"false"!=s.contentEditable)){if(i)return ao(i);if(s)return ao(s)}}function ao(e){return e.contentEditable="true",Un.safari&&e.draggable&&(e.draggable=!1,e.wasDraggable=!0),e}function co(e){e.contentEditable="false",e.wasDraggable&&(e.draggable=!0,e.wasDraggable=null)}function lo(e,t){if(t instanceof Zt){var n=e.docView.descAt(t.from);n!=e.lastSelectedViewDesc&&(uo(e),n&&n.selectNode(),e.lastSelectedViewDesc=n)}else uo(e)}function uo(e){e.lastSelectedViewDesc&&(e.lastSelectedViewDesc.parent&&e.lastSelectedViewDesc.deselectNode(),e.lastSelectedViewDesc=null)}function fo(e,t,n,r){return e.someProp("createSelectionBetween",(function(r){return r(e,t,n)}))||Gt.between(t,n,r)}function po(e){var t=e.root.getSelection();if(!t.anchorNode)return!1;try{return e.dom.contains(3==t.anchorNode.nodeType?t.anchorNode.parentNode:t.anchorNode)&&(e.editable||e.dom.contains(3==t.focusNode.nodeType?t.focusNode.parentNode:t.focusNode))}catch(n){return!1}}function ho(e,t){var n=e.selection,r=n.$anchor,o=n.$head,i=t>0?r.max(o):r.min(o),s=i.parent.inlineContent?i.depth?e.doc.resolve(t>0?i.after():i.before()):null:i;return s&&Jt.findFrom(s,t)}function mo(e,t){return e.dispatch(e.state.tr.setSelection(t).scrollIntoView()),!0}function go(e,t,n){var r=e.state.selection;if(!(r instanceof Gt)){if(r instanceof Zt&&r.node.isInline)return mo(e,new Gt(t>0?r.$to:r.$from));var o=ho(e.state,t);return!!o&&mo(e,o)}if(!r.empty||n.indexOf("s")>-1)return!1;if(e.endOfTextblock(t>0?"right":"left")){var i=ho(e.state,t);return!!(i&&i instanceof Zt)&&mo(e,i)}if(!(Un.mac&&n.indexOf("m")>-1)){var s,a=r.$head,c=a.textOffset?null:t<0?a.nodeBefore:a.nodeAfter;if(!c||c.isText)return!1;var l=t<0?a.pos-c.nodeSize:a.pos;return!!(c.isAtom||(s=e.docView.descAt(l))&&!s.contentDOM)&&(Zt.isSelectable(c)?mo(e,new Zt(t<0?e.state.doc.resolve(a.pos-c.nodeSize):a)):!!Un.webkit&&mo(e,new Gt(e.state.doc.resolve(t<0?l:l+c.nodeSize))))}}function vo(e){return 3==e.nodeType?e.nodeValue.length:e.childNodes.length}function yo(e){var t=e.pmViewDesc;return t&&0==t.size&&(e.nextSibling||"BR"!=e.nodeName)}function bo(e){var t=e.root.getSelection(),n=t.focusNode,r=t.focusOffset;if(n){var o,i,s=!1;for(Un.gecko&&1==n.nodeType&&r<vo(n)&&yo(n.childNodes[r])&&(s=!0);;)if(r>0){if(1!=n.nodeType)break;var a=n.childNodes[r-1];if(yo(a))o=n,i=--r;else{if(3!=a.nodeType)break;r=(n=a).nodeValue.length}}else{if(ko(n))break;for(var c=n.previousSibling;c&&yo(c);)o=n.parentNode,i=er(c),c=c.previousSibling;if(c)r=vo(n=c);else{if((n=n.parentNode)==e.dom)break;r=0}}s?xo(e,t,n,r):o&&xo(e,t,o,i)}}function wo(e){var t=e.root.getSelection(),n=t.focusNode,r=t.focusOffset;if(n){for(var o,i,s=vo(n);;)if(r<s){if(1!=n.nodeType)break;if(!yo(n.childNodes[r]))break;o=n,i=++r}else{if(ko(n))break;for(var a=n.nextSibling;a&&yo(a);)o=a.parentNode,i=er(a)+1,a=a.nextSibling;if(a)r=0,s=vo(n=a);else{if((n=n.parentNode)==e.dom)break;r=s=0}}o&&xo(e,t,o,i)}}function ko(e){var t=e.pmViewDesc;return t&&t.node&&t.node.isBlock}function xo(e,t,n,r){if(lr(t)){var o=document.createRange();o.setEnd(n,r),o.setStart(n,r),t.removeAllRanges(),t.addRange(o)}else t.extend&&t.extend(n,r);e.domObserver.setCurSelection();var i=e.state;setTimeout((function(){e.state==i&&oo(e)}),50)}function Co(e,t,n){var r=e.state.selection;if(r instanceof Gt&&!r.empty||n.indexOf("s")>-1)return!1;if(Un.mac&&n.indexOf("m")>-1)return!1;var o=r.$from,i=r.$to;if(!o.parent.inlineContent||e.endOfTextblock(t<0?"up":"down")){var s=ho(e.state,t);if(s&&s instanceof Zt)return mo(e,s)}if(!o.parent.inlineContent){var a=t<0?o:i,c=r instanceof Yt?Jt.near(a,t):Jt.findFrom(a,t);return!!c&&mo(e,c)}return!1}function So(e,t){if(!(e.state.selection instanceof Gt))return!0;var n=e.state.selection,r=n.$head,o=n.$anchor,i=n.empty;if(!r.sameParent(o))return!0;if(!i)return!1;if(e.endOfTextblock(t>0?"forward":"backward"))return!0;var s=!r.textOffset&&(t<0?r.nodeBefore:r.nodeAfter);if(s&&!s.isText){var a=e.state.tr;return t<0?a.delete(r.pos-s.nodeSize,r.pos):a.delete(r.pos,r.pos+s.nodeSize),e.dispatch(a),!0}return!1}function Mo(e,t,n){e.domObserver.stop(),t.contentEditable=n,e.domObserver.start()}function Oo(e,t){var n=t.keyCode,r=function(e){var t="";return e.ctrlKey&&(t+="c"),e.metaKey&&(t+="m"),e.altKey&&(t+="a"),e.shiftKey&&(t+="s"),t}(t);return 8==n||Un.mac&&72==n&&"c"==r?So(e,-1)||bo(e):46==n||Un.mac&&68==n&&"c"==r?So(e,1)||wo(e):13==n||27==n||(37==n?go(e,-1,r)||bo(e):39==n?go(e,1,r)||wo(e):38==n?Co(e,-1,r)||bo(e):40==n?function(e){if(Un.safari&&!(e.state.selection.$head.parentOffset>0)){var t=e.root.getSelection(),n=t.focusNode,r=t.focusOffset;if(n&&1==n.nodeType&&0==r&&n.firstChild&&"false"==n.firstChild.contentEditable){var o=n.firstChild;Mo(e,o,!0),setTimeout((function(){return Mo(e,o,!1)}),20)}}}(e)||Co(e,1,r)||wo(e):r==(Un.mac?"m":"c")&&(66==n||73==n||89==n||90==n))}function Ao(e){var t=e.pmViewDesc;if(t)return t.parseRule();if("BR"==e.nodeName&&e.parentNode){if(Un.safari&&/^(ul|ol)$/i.test(e.parentNode.nodeName)){var n=document.createElement("div");return n.appendChild(document.createElement("li")),{skip:n}}if(e.parentNode.lastChild==e||Un.safari&&/^(tr|table)$/i.test(e.parentNode.nodeName))return{ignore:!0}}else if("IMG"==e.nodeName&&e.getAttribute("mark-placeholder"))return{ignore:!0}}function Eo(e,t,n,r,o){if(t<0){var i=e.lastSelectionTime>Date.now()-50?e.lastSelectionOrigin:null,s=no(e,i);if(s&&!e.state.selection.eq(s)){var a=e.state.tr.setSelection(s);"pointer"==i?a.setMeta("pointer",!0):"key"==i&&a.scrollIntoView(),e.dispatch(a)}}else{var c=e.state.doc.resolve(t),l=c.sharedDepth(n);t=c.before(l+1),n=e.state.doc.resolve(n).after(l+1);var u=e.state.selection,f=function(e,t,n){var r=e.docView.parseRange(t,n),o=r.node,i=r.fromOffset,s=r.toOffset,a=r.from,c=r.to,l=e.root.getSelection(),u=null,f=l.anchorNode;if(f&&e.dom.contains(1==f.nodeType?f:f.parentNode)&&(u=[{node:f,offset:l.anchorOffset}],lr(l)||u.push({node:l.focusNode,offset:l.focusOffset})),Un.chrome&&8===e.lastKeyCode)for(var d=s;d>i;d--){var p=o.childNodes[d-1],h=p.pmViewDesc;if("BR"==p.nodeName&&!h){s=d;break}if(!h||h.size)break}var m=e.state.doc,g=e.someProp("domParser")||Ze.fromSchema(e.state.schema),v=m.resolve(a),y=null,b=g.parse(o,{topNode:v.parent,topMatch:v.parent.contentMatchAt(v.index()),topOpen:!0,from:i,to:s,preserveWhitespace:!v.parent.type.spec.code||"full",editableContent:!0,findPositions:u,ruleFromNode:Ao,context:v});if(u&&null!=u[0].pos){var w=u[0].pos,k=u[1]&&u[1].pos;null==k&&(k=w),y={anchor:w+a,head:k+a}}return{doc:b,sel:y,from:a,to:c}}(e,t,n);if(Un.chrome&&e.cursorWrapper&&f.sel&&f.sel.anchor==e.cursorWrapper.deco.from){var d=e.cursorWrapper.deco.type.toDOM.nextSibling,p=d&&d.nodeValue?d.nodeValue.length:1;f.sel={anchor:f.sel.anchor+p,head:f.sel.anchor+p}}var h,m,g=e.state.doc,v=g.slice(f.from,f.to);8===e.lastKeyCode&&Date.now()-100<e.lastKeyCodeTime?(h=e.state.selection.to,m="end"):(h=e.state.selection.from,m="start"),e.lastKeyCode=null;var y=function(e,t,n,r,o){var i=e.findDiffStart(t,n);if(null==i)return null;var s=e.findDiffEnd(t,n+e.size,n+t.size),a=s.a,c=s.b;if("end"==o){r-=a+Math.max(0,i-Math.min(a,c))-i}if(a<i&&e.size<t.size){c=(i-=r<=i&&r>=a?i-r:0)+(c-a),a=i}else if(c<i){a=(i-=r<=i&&r>=c?i-r:0)+(a-c),c=i}return{start:i,endA:a,endB:c}}(v.content,f.doc.content,f.from,h,m);if(!y){if(!(r&&u instanceof Gt&&!u.empty&&u.$head.sameParent(u.$anchor))||e.composing||f.sel&&f.sel.anchor!=f.sel.head){if((Un.ios&&e.lastIOSEnter>Date.now()-225||Un.android)&&o.some((function(e){return"DIV"==e.nodeName||"P"==e.nodeName}))&&e.someProp("handleKeyDown",(function(t){return t(e,ur(13,"Enter"))})))return void(e.lastIOSEnter=0);if(f.sel){var b=To(e,e.state.doc,f.sel);b&&!b.eq(e.state.selection)&&e.dispatch(e.state.tr.setSelection(b))}return}y={start:u.from,endA:u.to,endB:u.to}}e.domChangeCount++,e.state.selection.from<e.state.selection.to&&y.start==y.endB&&e.state.selection instanceof Gt&&(y.start>e.state.selection.from&&y.start<=e.state.selection.from+2?y.start=e.state.selection.from:y.endA<e.state.selection.to&&y.endA>=e.state.selection.to-2&&(y.endB+=e.state.selection.to-y.endA,y.endA=e.state.selection.to)),Un.ie&&Un.ie_version<=11&&y.endB==y.start+1&&y.endA==y.start&&y.start>f.from&&" "==f.doc.textBetween(y.start-f.from-1,y.start-f.from+1)&&(y.start--,y.endA--,y.endB--);var w,k=f.doc.resolveNoCache(y.start-f.from),x=f.doc.resolveNoCache(y.endB-f.from),C=k.sameParent(x)&&k.parent.inlineContent;if((Un.ios&&e.lastIOSEnter>Date.now()-225&&(!C||o.some((function(e){return"DIV"==e.nodeName||"P"==e.nodeName})))||!C&&k.pos<f.doc.content.size&&(w=Jt.findFrom(f.doc.resolve(k.pos+1),1,!0))&&w.head==x.pos)&&e.someProp("handleKeyDown",(function(t){return t(e,ur(13,"Enter"))})))e.lastIOSEnter=0;else if(e.state.selection.anchor>y.start&&function(e,t,n,r,o){if(!r.parent.isTextblock||n-t<=o.pos-r.pos||No(r,!0,!1)<o.pos)return!1;var i=e.resolve(t);if(i.parentOffset<i.parent.content.size||!i.parent.isTextblock)return!1;var s=e.resolve(No(i,!0,!0));if(!s.parent.isTextblock||s.pos>n||No(s,!0,!1)<n)return!1;return r.parent.content.cut(r.parentOffset).eq(s.parent.content)}(g,y.start,y.endA,k,x)&&e.someProp("handleKeyDown",(function(t){return t(e,ur(8,"Backspace"))})))Un.android&&Un.chrome&&e.domObserver.suppressSelectionUpdates();else{Un.chrome&&Un.android&&y.toB==y.from&&(e.lastAndroidDelete=Date.now()),Un.android&&!C&&k.start()!=x.start()&&0==x.parentOffset&&k.depth==x.depth&&f.sel&&f.sel.anchor==f.sel.head&&f.sel.head==y.endA&&(y.endB-=2,x=f.doc.resolveNoCache(y.endB-f.from),setTimeout((function(){e.someProp("handleKeyDown",(function(t){return t(e,ur(13,"Enter"))}))}),20));var S,M,O,A,E=y.start,T=y.endA;if(C)if(k.pos==x.pos)Un.ie&&Un.ie_version<=11&&0==k.parentOffset&&(e.domObserver.suppressSelectionUpdates(),setTimeout((function(){return oo(e)}),20)),S=e.state.tr.delete(E,T),M=g.resolve(y.start).marksAcross(g.resolve(y.endA));else if(y.endA==y.endB&&(A=g.resolve(y.start))&&(O=function(e,t){for(var n,r,o,i=e.firstChild.marks,s=t.firstChild.marks,a=i,c=s,l=0;l<s.length;l++)a=s[l].removeFromSet(a);for(var u=0;u<i.length;u++)c=i[u].removeFromSet(c);if(1==a.length&&0==c.length)r=a[0],n="add",o=function(e){return e.mark(r.addToSet(e.marks))};else{if(0!=a.length||1!=c.length)return null;r=c[0],n="remove",o=function(e){return e.mark(r.removeFromSet(e.marks))}}for(var f=[],d=0;d<t.childCount;d++)f.push(o(t.child(d)));if(X.from(f).eq(e))return{mark:r,type:n}}(k.parent.content.cut(k.parentOffset,x.parentOffset),A.parent.content.cut(A.parentOffset,y.endA-A.start()))))S=e.state.tr,"add"==O.type?S.addMark(E,T,O.mark):S.removeMark(E,T,O.mark);else if(k.parent.child(k.index()).isText&&k.index()==x.index()-(x.textOffset?0:1)){var N=k.parent.textBetween(k.parentOffset,x.parentOffset);if(e.someProp("handleTextInput",(function(t){return t(e,E,T,N)})))return;S=e.state.tr.insertText(N,E,T)}if(S||(S=e.state.tr.replace(E,T,f.doc.slice(y.start-f.from,y.endB-f.from))),f.sel){var D=To(e,S.doc,f.sel);D&&!(Un.chrome&&Un.android&&e.composing&&D.empty&&(y.start!=y.endB||e.lastAndroidDelete<Date.now()-100)&&(D.head==E||D.head==S.mapping.map(T)-1)||Un.ie&&D.empty&&D.head==E)&&S.setSelection(D)}M&&S.ensureMarks(M),e.dispatch(S.scrollIntoView())}}}function To(e,t,n){return Math.max(n.anchor,n.head)>t.content.size?null:fo(e,t.resolve(n.anchor),t.resolve(n.head))}function No(e,t,n){for(var r=e.depth,o=t?e.end():e.pos;r>0&&(t||e.indexAfter(r)==e.node(r).childCount);)r--,o++,t=!1;if(n)for(var i=e.node(r).maybeChild(e.indexAfter(r));i&&!i.isLeaf;)i=i.firstChild,o++;return o}function Do(e,t){for(var n=[],r=t.content,o=t.openStart,i=t.openEnd;o>1&&i>1&&1==r.childCount&&1==r.firstChild.childCount;){o--,i--;var s=r.firstChild;n.push(s.type.name,s.attrs!=s.type.defaultAttrs?s.attrs:null),r=s.content}var a=e.someProp("clipboardSerializer")||ct.fromSchema(e.state.schema),c=Bo(),l=c.createElement("div");l.appendChild(a.serializeFragment(r,{document:c}));for(var u,f=l.firstChild;f&&1==f.nodeType&&(u=jo[f.nodeName.toLowerCase()]);){for(var d=u.length-1;d>=0;d--){for(var p=c.createElement(u[d]);l.firstChild;)p.appendChild(l.firstChild);l.appendChild(p),"tbody"!=u[d]&&(o++,i++)}f=l.firstChild}return f&&1==f.nodeType&&f.setAttribute("data-pm-slice",o+" "+i+" "+JSON.stringify(n)),{dom:l,text:e.someProp("clipboardTextSerializer",(function(e){return e(t)}))||t.content.textBetween(0,t.content.size,"\n\n")}}function Io(e,t,n,r,o){var i,s,a=o.parent.type.spec.code;if(!n&&!t)return null;var c=t&&(r||a||!n);if(c){if(e.someProp("transformPastedText",(function(e){t=e(t,a||r)})),a)return t?new ie(X.from(e.state.schema.text(t.replace(/\r\n?/g,"\n"))),0,0):ie.empty;var l=e.someProp("clipboardTextParser",(function(e){return e(t,o,r)}));if(l)s=l;else{var u=o.marks(),f=e.state.schema,d=ct.fromSchema(f);i=document.createElement("div"),t.split(/(?:\r\n?|\n)+/).forEach((function(e){var t=i.appendChild(document.createElement("p"));e&&t.appendChild(d.serializeNode(f.text(e,u)))}))}}else e.someProp("transformPastedHTML",(function(e){n=e(n)})),i=function(e){var t=/^(\s*<meta [^>]*>)*/.exec(e);t&&(e=e.slice(t[0].length));var n,r=Bo().createElement("div"),o=/<([a-z][^>\s]+)/i.exec(e);(n=o&&jo[o[1].toLowerCase()])&&(e=n.map((function(e){return"<"+e+">"})).join("")+e+n.map((function(e){return"</"+e+">"})).reverse().join(""));if(r.innerHTML=e,n)for(var i=0;i<n.length;i++)r=r.querySelector(n[i])||r;return r}(n),Un.webkit&&function(e){for(var t=e.querySelectorAll(Un.chrome?"span:not([class]):not([style])":"span.Apple-converted-space"),n=0;n<t.length;n++){var r=t[n];1==r.childNodes.length&&""==r.textContent&&r.parentNode&&r.parentNode.replaceChild(e.ownerDocument.createTextNode(" "),r)}}(i);var p=i&&i.querySelector("[data-pm-slice]"),h=p&&/^(\d+) (\d+) (.*)/.exec(p.getAttribute("data-pm-slice"));if(!s){var m=e.someProp("clipboardParser")||e.someProp("domParser")||Ze.fromSchema(e.state.schema);s=m.parseSlice(i,{preserveWhitespace:!(!c&&!h),context:o,ruleFromNode:function(e){if("BR"==e.nodeName&&!e.nextSibling&&e.parentNode&&!zo.test(e.parentNode.nodeName))return{ignore:!0}}})}if(h)s=function(e,t){if(!e.size)return e;var n,r=e.content.firstChild.type.schema;try{n=JSON.parse(t)}catch(l){return e}for(var o=e.content,i=e.openStart,s=e.openEnd,a=n.length-2;a>=0;a-=2){var c=r.nodes[n[a]];if(!c||c.hasRequiredAttrs())break;o=X.from(c.create(n[a+1],o)),i++,s++}return new ie(o,i,s)}(Po(s,+h[1],+h[2]),h[3]);else if((s=ie.maxOpen(function(e,t){if(e.childCount<2)return e;for(var n=function(n){var r=t.node(n).contentMatchAt(t.index(n)),o=void 0,i=[];if(e.forEach((function(e){if(i){var t,n=r.findWrapping(e.type);if(!n)return i=null;if(t=i.length&&o.length&&Ro(n,o,e,i[i.length-1],0))i[i.length-1]=t;else{i.length&&(i[i.length-1]=$o(i[i.length-1],o.length));var s=Fo(e,n);i.push(s),r=r.matchType(s.type,s.attrs),o=n}}})),i)return{v:X.from(i)}},r=t.depth;r>=0;r--){var o=n(r);if(o)return o.v}return e}(s.content,o),!0)).openStart||s.openEnd){for(var g=0,v=0,y=s.content.firstChild;g<s.openStart&&!y.type.spec.isolating;g++,y=y.firstChild);for(var b=s.content.lastChild;v<s.openEnd&&!b.type.spec.isolating;v++,b=b.lastChild);s=Po(s,g,v)}return e.someProp("transformPasted",(function(e){s=e(s)})),s}var zo=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function Fo(e,t,n){void 0===n&&(n=0);for(var r=t.length-1;r>=n;r--)e=t[r].create(null,X.from(e));return e}function Ro(e,t,n,r,o){if(o<e.length&&o<t.length&&e[o]==t[o]){var i=Ro(e,t,n,r.lastChild,o+1);if(i)return r.copy(r.content.replaceChild(r.childCount-1,i));if(r.contentMatchAt(r.childCount).matchType(o==e.length-1?n.type:e[o+1]))return r.copy(r.content.append(X.from(Fo(n,e,o+1))))}}function $o(e,t){if(0==t)return e;var n=e.content.replaceChild(e.childCount-1,$o(e.lastChild,t-1)),r=e.contentMatchAt(e.childCount).fillBefore(X.empty,!0);return e.copy(n.append(r))}function _o(e,t,n,r,o,i){var s=t<0?e.firstChild:e.lastChild,a=s.content;return o<r-1&&(a=_o(a,t,n,r,o+1,i)),o>=n&&(a=t<0?s.contentMatchAt(0).fillBefore(a,e.childCount>1||i<=o).append(a):a.append(s.contentMatchAt(s.childCount).fillBefore(X.empty,!0))),e.replaceChild(t<0?0:e.childCount-1,s.copy(a))}function Po(e,t,n){return t<e.openStart&&(e=new ie(_o(e.content,-1,t,e.openStart,0,e.openEnd),t,e.openEnd)),n<e.openEnd&&(e=new ie(_o(e.content,1,n,e.openEnd,0,0),e.openStart,n)),e}var jo={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]},Lo=null;function Bo(){return Lo||(Lo=document.implementation.createHTMLDocument("title"))}var Vo={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},Ho=Un.ie&&Un.ie_version<=11,Wo=function(){this.anchorNode=this.anchorOffset=this.focusNode=this.focusOffset=null};Wo.prototype.set=function(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset},Wo.prototype.eq=function(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset};var qo=function(e,t){var n=this;this.view=e,this.handleDOMChange=t,this.queue=[],this.flushingSoon=-1,this.observer=window.MutationObserver&&new window.MutationObserver((function(e){for(var t=0;t<e.length;t++)n.queue.push(e[t]);Un.ie&&Un.ie_version<=11&&e.some((function(e){return"childList"==e.type&&e.removedNodes.length||"characterData"==e.type&&e.oldValue.length>e.target.nodeValue.length}))?n.flushSoon():n.flush()})),this.currentSelection=new Wo,Ho&&(this.onCharData=function(e){n.queue.push({target:e.target,type:"characterData",oldValue:e.prevValue}),n.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.suppressingSelectionUpdates=!1};qo.prototype.flushSoon=function(){var e=this;this.flushingSoon<0&&(this.flushingSoon=window.setTimeout((function(){e.flushingSoon=-1,e.flush()}),20))},qo.prototype.forceFlush=function(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())},qo.prototype.start=function(){this.observer&&this.observer.observe(this.view.dom,Vo),Ho&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()},qo.prototype.stop=function(){var e=this;if(this.observer){var t=this.observer.takeRecords();if(t.length){for(var n=0;n<t.length;n++)this.queue.push(t[n]);window.setTimeout((function(){return e.flush()}),20)}this.observer.disconnect()}Ho&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()},qo.prototype.connectSelection=function(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)},qo.prototype.disconnectSelection=function(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)},qo.prototype.suppressSelectionUpdates=function(){var e=this;this.suppressingSelectionUpdates=!0,setTimeout((function(){return e.suppressingSelectionUpdates=!1}),50)},qo.prototype.onSelectionChange=function(){if((!(e=this.view).editable||e.root.activeElement==e.dom)&&po(e)){var e;if(this.suppressingSelectionUpdates)return oo(this.view);if(Un.ie&&Un.ie_version<=11&&!this.view.state.selection.empty){var t=this.view.root.getSelection();if(t.focusNode&&or(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset))return this.flushSoon()}this.flush()}},qo.prototype.setCurSelection=function(){this.currentSelection.set(this.view.root.getSelection())},qo.prototype.ignoreSelectionChange=function(e){if(0==e.rangeCount)return!0;var t=e.getRangeAt(0).commonAncestorContainer,n=this.view.docView.nearestDesc(t);return n&&n.ignoreMutation({type:"selection",target:3==t.nodeType?t.parentNode:t})?(this.setCurSelection(),!0):void 0},qo.prototype.flush=function(){if(this.view.docView&&!(this.flushingSoon>-1)){var e=this.observer?this.observer.takeRecords():[];this.queue.length&&(e=this.queue.concat(e),this.queue.length=0);var t=this.view.root.getSelection(),n=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(t)&&po(this.view)&&!this.ignoreSelectionChange(t),r=-1,o=-1,i=!1,s=[];if(this.view.editable)for(var a=0;a<e.length;a++){var c=this.registerMutation(e[a],s);c&&(r=r<0?c.from:Math.min(c.from,r),o=o<0?c.to:Math.max(c.to,o),c.typeOver&&(i=!0))}if(Un.gecko&&s.length>1){var l=s.filter((function(e){return"BR"==e.nodeName}));if(2==l.length){var u=l[0],f=l[1];u.parentNode&&u.parentNode.parentNode==f.parentNode?f.remove():u.remove()}}(r>-1||n)&&(r>-1&&(this.view.docView.markDirty(r,o),function(e){if(Jo)return;Jo=!0,"normal"==getComputedStyle(e.dom).whiteSpace&&console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package.")}(this.view)),this.handleDOMChange(r,o,i,s),this.view.docView.dirty?this.view.updateState(this.view.state):this.currentSelection.eq(t)||oo(this.view),this.currentSelection.set(t))}},qo.prototype.registerMutation=function(e,t){if(t.indexOf(e.target)>-1)return null;var n=this.view.docView.nearestDesc(e.target);if("attributes"==e.type&&(n==this.view.docView||"contenteditable"==e.attributeName||"style"==e.attributeName&&!e.oldValue&&!e.target.getAttribute("style")))return null;if(!n||n.ignoreMutation(e))return null;if("childList"==e.type){for(var r=0;r<e.addedNodes.length;r++)t.push(e.addedNodes[r]);if(n.contentDOM&&n.contentDOM!=n.dom&&!n.contentDOM.contains(e.target))return{from:n.posBefore,to:n.posAfter};var o=e.previousSibling,i=e.nextSibling;if(Un.ie&&Un.ie_version<=11&&e.addedNodes.length)for(var s=0;s<e.addedNodes.length;s++){var a=e.addedNodes[s],c=a.previousSibling,l=a.nextSibling;(!c||Array.prototype.indexOf.call(e.addedNodes,c)<0)&&(o=c),(!l||Array.prototype.indexOf.call(e.addedNodes,l)<0)&&(i=l)}var u=o&&o.parentNode==e.target?er(o)+1:0,f=n.localPosFromDOM(e.target,u,-1),d=i&&i.parentNode==e.target?er(i):e.target.childNodes.length;return{from:f,to:n.localPosFromDOM(e.target,d,1)}}return"attributes"==e.type?{from:n.posAtStart-n.border,to:n.posAtEnd+n.border}:{from:n.posAtStart,to:n.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}};var Jo=!1;var Ko={},Uo={};function Go(e,t){e.lastSelectionOrigin=t,e.lastSelectionTime=Date.now()}function Qo(e){e.someProp("handleDOMEvents",(function(t){for(var n in t)e.eventHandlers[n]||e.dom.addEventListener(n,e.eventHandlers[n]=function(t){return Zo(e,t)})}))}function Zo(e,t){return e.someProp("handleDOMEvents",(function(n){var r=n[t.type];return!!r&&(r(e,t)||t.defaultPrevented)}))}function Xo(e){return{left:e.clientX,top:e.clientY}}function Yo(e,t,n,r,o){if(-1==r)return!1;for(var i=e.state.doc.resolve(r),s=function(r){if(e.someProp(t,(function(t){return r>i.depth?t(e,n,i.nodeAfter,i.before(r),o,!0):t(e,n,i.node(r),i.before(r),o,!1)})))return{v:!0}},a=i.depth+1;a>0;a--){var c=s(a);if(c)return c.v}return!1}function ei(e,t,n){e.focused||e.focus();var r=e.state.tr.setSelection(t);"pointer"==n&&r.setMeta("pointer",!0),e.dispatch(r)}function ti(e,t,n,r,o){return Yo(e,"handleClickOn",t,n,r)||e.someProp("handleClick",(function(n){return n(e,t,r)}))||(o?function(e,t){if(-1==t)return!1;var n,r,o=e.state.selection;o instanceof Zt&&(n=o.node);for(var i=e.state.doc.resolve(t),s=i.depth+1;s>0;s--){var a=s>i.depth?i.nodeAfter:i.node(s);if(Zt.isSelectable(a)){r=n&&o.$from.depth>0&&s>=o.$from.depth&&i.before(o.$from.depth+1)==o.$from.pos?i.before(o.$from.depth):i.before(s);break}}return null!=r&&(ei(e,Zt.create(e.state.doc,r),"pointer"),!0)}(e,n):function(e,t){if(-1==t)return!1;var n=e.state.doc.resolve(t),r=n.nodeAfter;return!!(r&&r.isAtom&&Zt.isSelectable(r))&&(ei(e,new Zt(n),"pointer"),!0)}(e,n))}function ni(e,t,n,r){return Yo(e,"handleDoubleClickOn",t,n,r)||e.someProp("handleDoubleClick",(function(n){return n(e,t,r)}))}function ri(e,t,n,r){return Yo(e,"handleTripleClickOn",t,n,r)||e.someProp("handleTripleClick",(function(n){return n(e,t,r)}))||function(e,t,n){if(0!=n.button)return!1;var r=e.state.doc;if(-1==t)return!!r.inlineContent&&(ei(e,Gt.create(r,0,r.content.size),"pointer"),!0);for(var o=r.resolve(t),i=o.depth+1;i>0;i--){var s=i>o.depth?o.nodeAfter:o.node(i),a=o.before(i);if(s.inlineContent)ei(e,Gt.create(r,a+1,a+1+s.content.size),"pointer");else{if(!Zt.isSelectable(s))continue;ei(e,Zt.create(r,a),"pointer")}return!0}}(e,n,r)}function oi(e){return fi(e)}Uo.keydown=function(e,t){if(e.shiftKey=16==t.keyCode||t.shiftKey,!ai(e,t))if(229!=t.keyCode&&e.domObserver.forceFlush(),e.lastKeyCode=t.keyCode,e.lastKeyCodeTime=Date.now(),!Un.ios||13!=t.keyCode||t.ctrlKey||t.altKey||t.metaKey)e.someProp("handleKeyDown",(function(n){return n(e,t)}))||Oo(e,t)?t.preventDefault():Go(e,"key");else{var n=Date.now();e.lastIOSEnter=n,e.lastIOSEnterFallbackTimeout=setTimeout((function(){e.lastIOSEnter==n&&(e.someProp("handleKeyDown",(function(t){return t(e,ur(13,"Enter"))})),e.lastIOSEnter=0)}),200)}},Uo.keyup=function(e,t){16==t.keyCode&&(e.shiftKey=!1)},Uo.keypress=function(e,t){if(!(ai(e,t)||!t.charCode||t.ctrlKey&&!t.altKey||Un.mac&&t.metaKey))if(e.someProp("handleKeyPress",(function(n){return n(e,t)})))t.preventDefault();else{var n=e.state.selection;if(!(n instanceof Gt&&n.$from.sameParent(n.$to))){var r=String.fromCharCode(t.charCode);e.someProp("handleTextInput",(function(t){return t(e,n.$from.pos,n.$to.pos,r)}))||e.dispatch(e.state.tr.insertText(r).scrollIntoView()),t.preventDefault()}}};var ii=Un.mac?"metaKey":"ctrlKey";Ko.mousedown=function(e,t){e.shiftKey=t.shiftKey;var n=oi(e),r=Date.now(),o="singleClick";r-e.lastClick.time<500&&function(e,t){var n=t.x-e.clientX,r=t.y-e.clientY;return n*n+r*r<100}(t,e.lastClick)&&!t[ii]&&("singleClick"==e.lastClick.type?o="doubleClick":"doubleClick"==e.lastClick.type&&(o="tripleClick")),e.lastClick={time:r,x:t.clientX,y:t.clientY,type:o};var i=e.posAtCoords(Xo(t));i&&("singleClick"==o?(e.mouseDown&&e.mouseDown.done(),e.mouseDown=new si(e,i,t,n)):("doubleClick"==o?ni:ri)(e,i.pos,i.inside,t)?t.preventDefault():Go(e,"pointer"))};var si=function(e,t,n,r){var o,i,s=this;if(this.view=e,this.startDoc=e.state.doc,this.pos=t,this.event=n,this.flushed=r,this.selectNode=n[ii],this.allowDefault=n.shiftKey,this.delayedSelectionSync=!1,t.inside>-1)o=e.state.doc.nodeAt(t.inside),i=t.inside;else{var a=e.state.doc.resolve(t.pos);o=a.parent,i=a.depth?a.before():0}this.mightDrag=null;var c=r?null:n.target,l=c?e.docView.nearestDesc(c,!0):null;this.target=l?l.dom:null;var u=e.state.selection;(0==n.button&&o.type.spec.draggable&&!1!==o.type.spec.selectable||u instanceof Zt&&u.from<=i&&u.to>i)&&(this.mightDrag={node:o,pos:i,addAttr:this.target&&!this.target.draggable,setUneditable:this.target&&Un.gecko&&!this.target.hasAttribute("contentEditable")}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout((function(){s.view.mouseDown==s&&s.target.setAttribute("contentEditable","false")}),20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),Go(e,"pointer")};function ai(e,t){return!!e.composing||!!(Un.safari&&Math.abs(t.timeStamp-e.compositionEndedAt)<500)&&(e.compositionEndedAt=-2e8,!0)}si.prototype.done=function(){var e=this;this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout((function(){return oo(e.view)})),this.view.mouseDown=null},si.prototype.up=function(e){if(this.done(),this.view.dom.contains(3==e.target.nodeType?e.target.parentNode:e.target)){var t=this.pos;this.view.state.doc!=this.startDoc&&(t=this.view.posAtCoords(Xo(e))),this.allowDefault||!t?Go(this.view,"pointer"):ti(this.view,t.pos,t.inside,e,this.selectNode)?e.preventDefault():0==e.button&&(this.flushed||Un.safari&&this.mightDrag&&!this.mightDrag.node.isAtom||Un.chrome&&!(this.view.state.selection instanceof Gt)&&Math.min(Math.abs(t.pos-this.view.state.selection.from),Math.abs(t.pos-this.view.state.selection.to))<=2)?(ei(this.view,Jt.near(this.view.state.doc.resolve(t.pos)),"pointer"),e.preventDefault()):Go(this.view,"pointer")}},si.prototype.move=function(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0),Go(this.view,"pointer"),0==e.buttons&&this.done()},Ko.touchdown=function(e){oi(e),Go(e,"pointer")},Ko.contextmenu=function(e){return oi(e)};var ci=Un.android?5e3:-1;function li(e,t){clearTimeout(e.composingTimeout),t>-1&&(e.composingTimeout=setTimeout((function(){return fi(e)}),t))}function ui(e){var t;for(e.composing&&(e.composing=!1,e.compositionEndedAt=((t=document.createEvent("Event")).initEvent("event",!0,!0),t.timeStamp));e.compositionNodes.length>0;)e.compositionNodes.pop().markParentsDirty()}function fi(e,t){if(e.domObserver.forceFlush(),ui(e),t||e.docView.dirty){var n=no(e);return n&&!n.eq(e.state.selection)?e.dispatch(e.state.tr.setSelection(n)):e.updateState(e.state),!0}return!1}Uo.compositionstart=Uo.compositionupdate=function(e){if(!e.composing){e.domObserver.flush();var t=e.state,n=t.selection.$from;if(t.selection.empty&&(t.storedMarks||!n.textOffset&&n.parentOffset&&n.nodeBefore.marks.some((function(e){return!1===e.type.spec.inclusive}))))e.markCursor=e.state.storedMarks||n.marks(),fi(e,!0),e.markCursor=null;else if(fi(e),Un.gecko&&t.selection.empty&&n.parentOffset&&!n.textOffset&&n.nodeBefore.marks.length)for(var r=e.root.getSelection(),o=r.focusNode,i=r.focusOffset;o&&1==o.nodeType&&0!=i;){var s=i<0?o.lastChild:o.childNodes[i-1];if(!s)break;if(3==s.nodeType){r.collapse(s,s.nodeValue.length);break}o=s,i=-1}e.composing=!0}li(e,ci)},Uo.compositionend=function(e,t){e.composing&&(e.composing=!1,e.compositionEndedAt=t.timeStamp,li(e,20))};var di=Un.ie&&Un.ie_version<15||Un.ios&&Un.webkit_version<604;function pi(e,t,n,r){var o=Io(e,t,n,e.shiftKey,e.state.selection.$from);if(e.someProp("handlePaste",(function(t){return t(e,r,o||ie.empty)})))return!0;if(!o)return!1;var i=function(e){return 0==e.openStart&&0==e.openEnd&&1==e.content.childCount?e.content.firstChild:null}(o),s=i?e.state.tr.replaceSelectionWith(i,e.shiftKey):e.state.tr.replaceSelection(o);return e.dispatch(s.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}Ko.copy=Uo.cut=function(e,t){var n=e.state.selection,r="cut"==t.type;if(!n.empty){var o=di?null:t.clipboardData,i=Do(e,n.content()),s=i.dom,a=i.text;o?(t.preventDefault(),o.clearData(),o.setData("text/html",s.innerHTML),o.setData("text/plain",a)):function(e,t){if(e.dom.parentNode){var n=e.dom.parentNode.appendChild(document.createElement("div"));n.appendChild(t),n.style.cssText="position: fixed; left: -10000px; top: 10px";var r=getSelection(),o=document.createRange();o.selectNodeContents(t),e.dom.blur(),r.removeAllRanges(),r.addRange(o),setTimeout((function(){n.parentNode&&n.parentNode.removeChild(n),e.focus()}),50)}}(e,s),r&&e.dispatch(e.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))}},Uo.paste=function(e,t){var n=di?null:t.clipboardData;n&&pi(e,n.getData("text/plain"),n.getData("text/html"),t)?t.preventDefault():function(e,t){if(e.dom.parentNode){var n=e.shiftKey||e.state.selection.$from.parent.type.spec.code,r=e.dom.parentNode.appendChild(document.createElement(n?"textarea":"div"));n||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus(),setTimeout((function(){e.focus(),r.parentNode&&r.parentNode.removeChild(r),n?pi(e,r.value,null,t):pi(e,r.textContent,r.innerHTML,t)}),50)}}(e,t)};var hi=function(e,t){this.slice=e,this.move=t},mi=Un.mac?"altKey":"ctrlKey";for(var gi in Ko.dragstart=function(e,t){var n=e.mouseDown;if(n&&n.done(),t.dataTransfer){var r=e.state.selection,o=r.empty?null:e.posAtCoords(Xo(t));if(o&&o.pos>=r.from&&o.pos<=(r instanceof Zt?r.to-1:r.to));else if(n&&n.mightDrag)e.dispatch(e.state.tr.setSelection(Zt.create(e.state.doc,n.mightDrag.pos)));else if(t.target&&1==t.target.nodeType){var i=e.docView.nearestDesc(t.target,!0);i&&i.node.type.spec.draggable&&i!=e.docView&&e.dispatch(e.state.tr.setSelection(Zt.create(e.state.doc,i.posBefore)))}var s=e.state.selection.content(),a=Do(e,s),c=a.dom,l=a.text;t.dataTransfer.clearData(),t.dataTransfer.setData(di?"Text":"text/html",c.innerHTML),t.dataTransfer.effectAllowed="copyMove",di||t.dataTransfer.setData("text/plain",l),e.dragging=new hi(s,!t[mi])}},Ko.dragend=function(e){var t=e.dragging;window.setTimeout((function(){e.dragging==t&&(e.dragging=null)}),50)},Uo.dragover=Uo.dragenter=function(e,t){return t.preventDefault()},Uo.drop=function(e,t){var n=e.dragging;if(e.dragging=null,t.dataTransfer){var r=e.posAtCoords(Xo(t));if(r){var o=e.state.doc.resolve(r.pos);if(o){var i=n&&n.slice;i?e.someProp("transformPasted",(function(e){i=e(i)})):i=Io(e,t.dataTransfer.getData(di?"Text":"text/plain"),di?null:t.dataTransfer.getData("text/html"),!1,o);var s=n&&!t[mi];if(e.someProp("handleDrop",(function(n){return n(e,t,i||ie.empty,s)})))t.preventDefault();else if(i){t.preventDefault();var a=i?function(e,t,n){var r=e.resolve(t);if(!n.content.size)return t;for(var o=n.content,i=0;i<n.openStart;i++)o=o.firstChild.content;for(var s=1;s<=(0==n.openStart&&n.size?2:1);s++)for(var a=r.depth;a>=0;a--){var c=a==r.depth?0:r.pos<=(r.start(a+1)+r.end(a+1))/2?-1:1,l=r.index(a)+(c>0?1:0),u=r.node(a),f=!1;if(1==s)f=u.canReplace(l,l,o);else{var d=u.contentMatchAt(l).findWrapping(o.firstChild.type);f=d&&u.canReplaceWith(l,l,d[0])}if(f)return 0==c?r.pos:c<0?r.before(a+1):r.after(a+1)}return null}(e.state.doc,o.pos,i):o.pos;null==a&&(a=o.pos);var c=e.state.tr;s&&c.deleteSelection();var l=c.mapping.map(a),u=0==i.openStart&&0==i.openEnd&&1==i.content.childCount,f=c.doc;if(u?c.replaceRangeWith(l,l,i.content.firstChild):c.replaceRange(l,l,i),!c.doc.eq(f)){var d=c.doc.resolve(l);if(u&&Zt.isSelectable(i.content.firstChild)&&d.nodeAfter&&d.nodeAfter.sameMarkup(i.content.firstChild))c.setSelection(new Zt(d));else{var p=c.mapping.map(a);c.mapping.maps[c.mapping.maps.length-1].forEach((function(e,t,n,r){return p=r})),c.setSelection(fo(e,d,c.doc.resolve(p)))}e.focus(),e.dispatch(c.setMeta("uiEvent","drop"))}}}}}},Ko.focus=function(e){e.focused||(e.domObserver.stop(),e.dom.classList.add("ProseMirror-focused"),e.domObserver.start(),e.focused=!0,setTimeout((function(){e.docView&&e.hasFocus()&&!e.domObserver.currentSelection.eq(e.root.getSelection())&&oo(e)}),20))},Ko.blur=function(e,t){e.focused&&(e.domObserver.stop(),e.dom.classList.remove("ProseMirror-focused"),e.domObserver.start(),t.relatedTarget&&e.dom.contains(t.relatedTarget)&&e.domObserver.currentSelection.set({}),e.focused=!1)},Ko.beforeinput=function(e,t){if(Un.chrome&&Un.android&&"deleteContentBackward"==t.inputType){var n=e.domChangeCount;setTimeout((function(){if(e.domChangeCount==n&&(e.dom.blur(),e.focus(),!e.someProp("handleKeyDown",(function(t){return t(e,ur(8,"Backspace"))})))){var t=e.state.selection.$cursor;t&&t.pos>0&&e.dispatch(e.state.tr.delete(t.pos-1,t.pos).scrollIntoView())}}),50)}},Uo)Ko[gi]=Uo[gi];function vi(e,t){if(e==t)return!0;for(var n in e)if(e[n]!==t[n])return!1;for(var r in t)if(!(r in e))return!1;return!0}var yi=function(e,t){this.spec=t||Si,this.side=this.spec.side||0,this.toDOM=e};yi.prototype.map=function(e,t,n,r){var o=e.mapResult(t.from+r,this.side<0?-1:1),i=o.pos;return o.deleted?null:new ki(i-n,i-n,this)},yi.prototype.valid=function(){return!0},yi.prototype.eq=function(e){return this==e||e instanceof yi&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&vi(this.spec,e.spec))},yi.prototype.destroy=function(e){this.spec.destroy&&this.spec.destroy(e)};var bi=function(e,t){this.spec=t||Si,this.attrs=e};bi.prototype.map=function(e,t,n,r){var o=e.map(t.from+r,this.spec.inclusiveStart?-1:1)-n,i=e.map(t.to+r,this.spec.inclusiveEnd?1:-1)-n;return o>=i?null:new ki(o,i,this)},bi.prototype.valid=function(e,t){return t.from<t.to},bi.prototype.eq=function(e){return this==e||e instanceof bi&&vi(this.attrs,e.attrs)&&vi(this.spec,e.spec)},bi.is=function(e){return e.type instanceof bi};var wi=function(e,t){this.spec=t||Si,this.attrs=e};wi.prototype.map=function(e,t,n,r){var o=e.mapResult(t.from+r,1);if(o.deleted)return null;var i=e.mapResult(t.to+r,-1);return i.deleted||i.pos<=o.pos?null:new ki(o.pos-n,i.pos-n,this)},wi.prototype.valid=function(e,t){var n,r=e.content.findIndex(t.from),o=r.index,i=r.offset;return i==t.from&&!(n=e.child(o)).isText&&i+n.nodeSize==t.to},wi.prototype.eq=function(e){return this==e||e instanceof wi&&vi(this.attrs,e.attrs)&&vi(this.spec,e.spec)};var ki=function(e,t,n){this.from=e,this.to=t,this.type=n},xi={spec:{configurable:!0},inline:{configurable:!0}};ki.prototype.copy=function(e,t){return new ki(e,t,this.type)},ki.prototype.eq=function(e,t){return void 0===t&&(t=0),this.type.eq(e.type)&&this.from+t==e.from&&this.to+t==e.to},ki.prototype.map=function(e,t,n){return this.type.map(e,this,t,n)},ki.widget=function(e,t,n){return new ki(e,e,new yi(t,n))},ki.inline=function(e,t,n,r){return new ki(e,t,new bi(n,r))},ki.node=function(e,t,n,r){return new ki(e,t,new wi(n,r))},xi.spec.get=function(){return this.type.spec},xi.inline.get=function(){return this.type instanceof bi},Object.defineProperties(ki.prototype,xi);var Ci=[],Si={},Mi=function(e,t){this.local=e&&e.length?e:Ci,this.children=t&&t.length?t:Ci};Mi.create=function(e,t){return t.length?Di(t,e,0,Si):Oi},Mi.prototype.find=function(e,t,n){var r=[];return this.findInner(null==e?0:e,null==t?1e9:t,r,0,n),r},Mi.prototype.findInner=function(e,t,n,r,o){for(var i=0;i<this.local.length;i++){var s=this.local[i];s.from<=t&&s.to>=e&&(!o||o(s.spec))&&n.push(s.copy(s.from+r,s.to+r))}for(var a=0;a<this.children.length;a+=3)if(this.children[a]<t&&this.children[a+1]>e){var c=this.children[a]+1;this.children[a+2].findInner(e-c,t-c,n,r+c,o)}},Mi.prototype.map=function(e,t,n){return this==Oi||0==e.maps.length?this:this.mapInner(e,t,0,0,n||Si)},Mi.prototype.mapInner=function(e,t,n,r,o){for(var i,s=0;s<this.local.length;s++){var a=this.local[s].map(e,n,r);a&&a.type.valid(t,a)?(i||(i=[])).push(a):o.onRemove&&o.onRemove(this.local[s].spec)}return this.children.length?function(e,t,n,r,o,i,s){for(var a=e.slice(),c=function(e,t,n,r){for(var s=0;s<a.length;s+=3){var c=a[s+1],l=void 0;-1==c||e>c+i||(t>=a[s]+i?a[s+1]=-1:n>=o&&(l=r-n-(t-e))&&(a[s]+=l,a[s+1]+=l))}},l=0;l<n.maps.length;l++)n.maps[l].forEach(c);for(var u=!1,f=0;f<a.length;f+=3)if(-1==a[f+1]){var d=n.map(e[f]+i),p=d-o;if(p<0||p>=r.content.size){u=!0;continue}var h=n.map(e[f+1]+i,-1)-o,m=r.content.findIndex(p),g=m.index,v=m.offset,y=r.maybeChild(g);if(y&&v==p&&v+y.nodeSize==h){var b=a[f+2].mapInner(n,y,d+1,e[f]+i+1,s);b!=Oi?(a[f]=p,a[f+1]=h,a[f+2]=b):(a[f+1]=-2,u=!0)}else u=!0}if(u){var w=Di(function(e,t,n,r,o,i,s){function a(e,t){for(var i=0;i<e.local.length;i++){var c=e.local[i].map(r,o,t);c?n.push(c):s.onRemove&&s.onRemove(e.local[i].spec)}for(var l=0;l<e.children.length;l+=3)a(e.children[l+2],e.children[l]+t+1)}for(var c=0;c<e.length;c+=3)-1==e[c+1]&&a(e[c+2],t[c]+i+1);return n}(a,e,t||[],n,o,i,s),r,0,s);t=w.local;for(var k=0;k<a.length;k+=3)a[k+1]<0&&(a.splice(k,3),k-=3);for(var x=0,C=0;x<w.children.length;x+=3){for(var S=w.children[x];C<a.length&&a[C]<S;)C+=3;a.splice(C,0,w.children[x],w.children[x+1],w.children[x+2])}}return new Mi(t&&t.sort(Ii),a)}(this.children,i,e,t,n,r,o):i?new Mi(i.sort(Ii)):Oi},Mi.prototype.add=function(e,t){return t.length?this==Oi?Mi.create(e,t):this.addInner(e,t,0):this},Mi.prototype.addInner=function(e,t,n){var r,o=this,i=0;e.forEach((function(e,s){var a,c=s+n;if(a=Ti(t,e,c)){for(r||(r=o.children.slice());i<r.length&&r[i]<s;)i+=3;r[i]==s?r[i+2]=r[i+2].addInner(e,a,c+1):r.splice(i,0,s,s+e.nodeSize,Di(a,e,c+1,Si)),i+=3}}));for(var s=Ei(i?Ni(t):t,-n),a=0;a<s.length;a++)s[a].type.valid(e,s[a])||s.splice(a--,1);return new Mi(s.length?this.local.concat(s).sort(Ii):this.local,r||this.children)},Mi.prototype.remove=function(e){return 0==e.length||this==Oi?this:this.removeInner(e,0)},Mi.prototype.removeInner=function(e,t){for(var n=this.children,r=this.local,o=0;o<n.length;o+=3){for(var i=void 0,s=n[o]+t,a=n[o+1]+t,c=0,l=void 0;c<e.length;c++)(l=e[c])&&l.from>s&&l.to<a&&(e[c]=null,(i||(i=[])).push(l));if(i){n==this.children&&(n=this.children.slice());var u=n[o+2].removeInner(i,s+1);u!=Oi?n[o+2]=u:(n.splice(o,3),o-=3)}}if(r.length)for(var f=0,d=void 0;f<e.length;f++)if(d=e[f])for(var p=0;p<r.length;p++)r[p].eq(d,t)&&(r==this.local&&(r=this.local.slice()),r.splice(p--,1));return n==this.children&&r==this.local?this:r.length||n.length?new Mi(r,n):Oi},Mi.prototype.forChild=function(e,t){if(this==Oi)return this;if(t.isLeaf)return Mi.empty;for(var n,r,o=0;o<this.children.length;o+=3)if(this.children[o]>=e){this.children[o]==e&&(n=this.children[o+2]);break}for(var i=e+1,s=i+t.content.size,a=0;a<this.local.length;a++){var c=this.local[a];if(c.from<s&&c.to>i&&c.type instanceof bi){var l=Math.max(i,c.from)-i,u=Math.min(s,c.to)-i;l<u&&(r||(r=[])).push(c.copy(l,u))}}if(r){var f=new Mi(r.sort(Ii));return n?new Ai([f,n]):f}return n||Oi},Mi.prototype.eq=function(e){if(this==e)return!0;if(!(e instanceof Mi)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(var t=0;t<this.local.length;t++)if(!this.local[t].eq(e.local[t]))return!1;for(var n=0;n<this.children.length;n+=3)if(this.children[n]!=e.children[n]||this.children[n+1]!=e.children[n+1]||!this.children[n+2].eq(e.children[n+2]))return!1;return!0},Mi.prototype.locals=function(e){return zi(this.localsInner(e))},Mi.prototype.localsInner=function(e){if(this==Oi)return Ci;if(e.inlineContent||!this.local.some(bi.is))return this.local;for(var t=[],n=0;n<this.local.length;n++)this.local[n].type instanceof bi||t.push(this.local[n]);return t};var Oi=new Mi;Mi.empty=Oi,Mi.removeOverlap=zi;var Ai=function(e){this.members=e};function Ei(e,t){if(!t||!e.length)return e;for(var n=[],r=0;r<e.length;r++){var o=e[r];n.push(new ki(o.from+t,o.to+t,o.type))}return n}function Ti(e,t,n){if(t.isLeaf)return null;for(var r=n+t.nodeSize,o=null,i=0,s=void 0;i<e.length;i++)(s=e[i])&&s.from>n&&s.to<r&&((o||(o=[])).push(s),e[i]=null);return o}function Ni(e){for(var t=[],n=0;n<e.length;n++)null!=e[n]&&t.push(e[n]);return t}function Di(e,t,n,r){var o=[],i=!1;t.forEach((function(t,s){var a=Ti(e,t,s+n);if(a){i=!0;var c=Di(a,t,n+s+1,r);c!=Oi&&o.push(s,s+t.nodeSize,c)}}));for(var s=Ei(i?Ni(e):e,-n).sort(Ii),a=0;a<s.length;a++)s[a].type.valid(t,s[a])||(r.onRemove&&r.onRemove(s[a].spec),s.splice(a--,1));return s.length||o.length?new Mi(s,o):Oi}function Ii(e,t){return e.from-t.from||e.to-t.to}function zi(e){for(var t=e,n=0;n<t.length-1;n++){var r=t[n];if(r.from!=r.to)for(var o=n+1;o<t.length;o++){var i=t[o];if(i.from!=r.from){i.from<r.to&&(t==e&&(t=e.slice()),t[n]=r.copy(r.from,i.from),Fi(t,o,r.copy(i.from,r.to)));break}i.to!=r.to&&(t==e&&(t=e.slice()),t[o]=i.copy(i.from,r.to),Fi(t,o+1,i.copy(r.to,i.to)))}}return t}function Fi(e,t,n){for(;t<e.length&&Ii(n,e[t])>0;)t++;e.splice(t,0,n)}function Ri(e){var t=[];return e.someProp("decorations",(function(n){var r=n(e.state);r&&r!=Oi&&t.push(r)})),e.cursorWrapper&&t.push(Mi.create(e.state.doc,[e.cursorWrapper.deco])),Ai.from(t)}Ai.prototype.map=function(e,t){var n=this.members.map((function(n){return n.map(e,t,Si)}));return Ai.from(n)},Ai.prototype.forChild=function(e,t){if(t.isLeaf)return Mi.empty;for(var n=[],r=0;r<this.members.length;r++){var o=this.members[r].forChild(e,t);o!=Oi&&(o instanceof Ai?n=n.concat(o.members):n.push(o))}return Ai.from(n)},Ai.prototype.eq=function(e){if(!(e instanceof Ai)||e.members.length!=this.members.length)return!1;for(var t=0;t<this.members.length;t++)if(!this.members[t].eq(e.members[t]))return!1;return!0},Ai.prototype.locals=function(e){for(var t,n=!0,r=0;r<this.members.length;r++){var o=this.members[r].localsInner(e);if(o.length)if(t){n&&(t=t.slice(),n=!1);for(var i=0;i<o.length;i++)t.push(o[i])}else t=o}return t?zi(n?t:t.sort(Ii)):Ci},Ai.from=function(e){switch(e.length){case 0:return Oi;case 1:return e[0];default:return new Ai(e)}};var $i=function(e,t){this._props=t,this.state=t.state,this.directPlugins=t.plugins||[],this.directPlugins.forEach(Vi),this.dispatch=this.dispatch.bind(this),this._root=null,this.focused=!1,this.trackWrites=null,this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):e.apply?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=Li(this),this.markCursor=null,this.cursorWrapper=null,ji(this),this.nodeViews=Bi(this),this.docView=Lr(this.state.doc,Pi(this),Ri(this),this.dom,this),this.lastSelectedViewDesc=null,this.dragging=null,function(e){e.shiftKey=!1,e.mouseDown=null,e.lastKeyCode=null,e.lastKeyCodeTime=0,e.lastClick={time:0,x:0,y:0,type:""},e.lastSelectionOrigin=null,e.lastSelectionTime=0,e.lastIOSEnter=0,e.lastIOSEnterFallbackTimeout=null,e.lastAndroidDelete=0,e.composing=!1,e.composingTimeout=null,e.compositionNodes=[],e.compositionEndedAt=-2e8,e.domObserver=new qo(e,(function(t,n,r,o){return Eo(e,t,n,r,o)})),e.domObserver.start(),e.domChangeCount=0,e.eventHandlers=Object.create(null);var t=function(t){var n=Ko[t];e.dom.addEventListener(t,e.eventHandlers[t]=function(t){!function(e,t){if(!t.bubbles)return!0;if(t.defaultPrevented)return!1;for(var n=t.target;n!=e.dom;n=n.parentNode)if(!n||11==n.nodeType||n.pmViewDesc&&n.pmViewDesc.stopEvent(t))return!1;return!0}(e,t)||Zo(e,t)||!e.editable&&t.type in Uo||n(e,t)})};for(var n in Ko)t(n);Un.safari&&e.dom.addEventListener("input",(function(){return null})),Qo(e)}(this),this.prevDirectPlugins=[],this.pluginViews=[],this.updatePluginViews()},_i={props:{configurable:!0},root:{configurable:!0},isDestroyed:{configurable:!0}};function Pi(e){var t=Object.create(null);return t.class="ProseMirror",t.contenteditable=String(e.editable),t.translate="no",e.someProp("attributes",(function(n){if("function"==typeof n&&(n=n(e.state)),n)for(var r in n)"class"==r&&(t.class+=" "+n[r]),"style"==r?t.style=(t.style?t.style+";":"")+n[r]:t[r]||"contenteditable"==r||"nodeName"==r||(t[r]=String(n[r]))})),[ki.node(0,e.state.doc.content.size,t)]}function ji(e){if(e.markCursor){var t=document.createElement("img");t.className="ProseMirror-separator",t.setAttribute("mark-placeholder","true"),e.cursorWrapper={dom:t,deco:ki.widget(e.state.selection.head,t,{raw:!0,marks:e.markCursor})}}else e.cursorWrapper=null}function Li(e){return!e.someProp("editable",(function(t){return!1===t(e.state)}))}function Bi(e){var t={};return e.someProp("nodeViews",(function(e){for(var n in e)Object.prototype.hasOwnProperty.call(t,n)||(t[n]=e[n])})),t}function Vi(e){if(e.spec.state||e.spec.filterTransaction||e.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}_i.props.get=function(){if(this._props.state!=this.state){var e=this._props;for(var t in this._props={},e)this._props[t]=e[t];this._props.state=this.state}return this._props},$i.prototype.update=function(e){e.handleDOMEvents!=this._props.handleDOMEvents&&Qo(this),this._props=e,e.plugins&&(e.plugins.forEach(Vi),this.directPlugins=e.plugins),this.updateStateInner(e.state,!0)},$i.prototype.setProps=function(e){var t={};for(var n in this._props)t[n]=this._props[n];for(var r in t.state=this.state,e)t[r]=e[r];this.update(t)},$i.prototype.updateState=function(e){this.updateStateInner(e,this.state.plugins!=e.plugins)},$i.prototype.updateStateInner=function(e,t){var n=this,r=this.state,o=!1,i=!1;if(e.storedMarks&&this.composing&&(ui(this),i=!0),this.state=e,t){var s=Bi(this);(function(e,t){var n=0,r=0;for(var o in e){if(e[o]!=t[o])return!0;n++}for(var i in t)r++;return n!=r})(s,this.nodeViews)&&(this.nodeViews=s,o=!0),Qo(this)}this.editable=Li(this),ji(this);var a=Ri(this),c=Pi(this),l=t?"reset":e.scrollToSelection>r.scrollToSelection?"to selection":"preserve",u=o||!this.docView.matchesNode(e.doc,c,a);!u&&e.selection.eq(r.selection)||(i=!0);var f,d,p,h,m,g,v,y,b,w,k,x="preserve"==l&&i&&null==this.dom.style.overflowAnchor&&function(e){for(var t,n,r=e.dom.getBoundingClientRect(),o=Math.max(0,r.top),i=(r.left+r.right)/2,s=o+1;s<Math.min(innerHeight,r.bottom);s+=5){var a=e.root.elementFromPoint(i,s);if(a!=e.dom&&e.dom.contains(a)){var c=a.getBoundingClientRect();if(c.top>=o-20){t=a,n=c.top;break}}}return{refDOM:t,refTop:n,stack:mr(e.dom)}}(this);if(i){this.domObserver.stop();var C=u&&(Un.ie||Un.chrome)&&!this.composing&&!r.selection.empty&&!e.selection.empty&&(h=r.selection,m=e.selection,g=Math.min(h.$anchor.sharedDepth(h.head),m.$anchor.sharedDepth(m.head)),h.$anchor.start(g)!=m.$anchor.start(g));if(u){var S=Un.chrome?this.trackWrites=this.root.getSelection().focusNode:null;!o&&this.docView.update(e.doc,c,a,this)||(this.docView.updateOuterDeco([]),this.docView.destroy(),this.docView=Lr(e.doc,c,a,this.dom,this)),S&&!this.trackWrites&&(C=!0)}C||!(this.mouseDown&&this.domObserver.currentSelection.eq(this.root.getSelection())&&(f=this,d=f.docView.domFromPos(f.state.selection.anchor,0),p=f.root.getSelection(),or(d.node,d.offset,p.anchorNode,p.anchorOffset)))?oo(this,C):(lo(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}if(this.updatePluginViews(r),"reset"==l)this.dom.scrollTop=0;else if("to selection"==l){var M=this.root.getSelection().focusNode;this.someProp("handleScrollToSelection",(function(e){return e(n)}))||(e.selection instanceof Zt?hr(this,this.docView.domAfterPos(e.selection.from).getBoundingClientRect(),M):hr(this,this.coordsAtPos(e.selection.head,1),M))}else x&&(y=(v=x).refDOM,b=v.refTop,w=v.stack,k=y?y.getBoundingClientRect().top:0,gr(w,0==k?0:k-b))},$i.prototype.destroyPluginViews=function(){for(var e;e=this.pluginViews.pop();)e.destroy&&e.destroy()},$i.prototype.updatePluginViews=function(e){if(e&&e.plugins==this.state.plugins&&this.directPlugins==this.prevDirectPlugins)for(var t=0;t<this.pluginViews.length;t++){var n=this.pluginViews[t];n.update&&n.update(this,e)}else{this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(var r=0;r<this.directPlugins.length;r++){var o=this.directPlugins[r];o.spec.view&&this.pluginViews.push(o.spec.view(this))}for(var i=0;i<this.state.plugins.length;i++){var s=this.state.plugins[i];s.spec.view&&this.pluginViews.push(s.spec.view(this))}}},$i.prototype.someProp=function(e,t){var n,r=this._props&&this._props[e];if(null!=r&&(n=t?t(r):r))return n;for(var o=0;o<this.directPlugins.length;o++){var i=this.directPlugins[o].props[e];if(null!=i&&(n=t?t(i):i))return n}var s=this.state.plugins;if(s)for(var a=0;a<s.length;a++){var c=s[a].props[e];if(null!=c&&(n=t?t(c):c))return n}},$i.prototype.hasFocus=function(){return this.root.activeElement==this.dom},$i.prototype.focus=function(){this.domObserver.stop(),this.editable&&function(e){if(e.setActive)return e.setActive();if(vr)return e.focus(vr);var t=mr(e);e.focus(null==vr?{get preventScroll(){return vr={preventScroll:!0},!0}}:void 0),vr||(vr=!1,gr(t,0))}(this.dom),oo(this),this.domObserver.start()},_i.root.get=function(){var e=this._root;if(null==e)for(var t=this.dom.parentNode;t;t=t.parentNode)if(9==t.nodeType||11==t.nodeType&&t.host)return t.getSelection||(Object.getPrototypeOf(t).getSelection=function(){return document.getSelection()}),this._root=t;return e||document},$i.prototype.posAtCoords=function(e){return kr(this,e)},$i.prototype.coordsAtPos=function(e,t){return void 0===t&&(t=1),Sr(this,e,t)},$i.prototype.domAtPos=function(e,t){return void 0===t&&(t=0),this.docView.domFromPos(e,t)},$i.prototype.nodeDOM=function(e){var t=this.docView.descAt(e);return t?t.nodeDOM:null},$i.prototype.posAtDOM=function(e,t,n){void 0===n&&(n=-1);var r=this.docView.posFromDOM(e,t,n);if(null==r)throw new RangeError("DOM position not inside the editor");return r},$i.prototype.endOfTextblock=function(e,t){return Ir(this,t||this.state,e)},$i.prototype.destroy=function(){this.docView&&(!function(e){for(var t in e.domObserver.stop(),e.eventHandlers)e.dom.removeEventListener(t,e.eventHandlers[t]);clearTimeout(e.composingTimeout),clearTimeout(e.lastIOSEnterFallbackTimeout)}(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],Ri(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null)},_i.isDestroyed.get=function(){return null==this.docView},$i.prototype.dispatchEvent=function(e){return function(e,t){Zo(e,t)||!Ko[t.type]||!e.editable&&t.type in Uo||Ko[t.type](e,t)}(this,e)},$i.prototype.dispatch=function(e){var t=this._props.dispatchTransaction;t?t.call(this,e):this.updateState(this.state.apply(e))},Object.defineProperties($i.prototype,_i);var Hi=function(e){function t(t){e.call(this,t,t)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.map=function(n,r){var o=n.resolve(r.map(this.head));return t.valid(o)?new t(o):e.near(o)},t.prototype.content=function(){return ie.empty},t.prototype.eq=function(e){return e instanceof t&&e.head==this.head},t.prototype.toJSON=function(){return{type:"gapcursor",pos:this.head}},t.fromJSON=function(e,n){if("number"!=typeof n.pos)throw new RangeError("Invalid input for GapCursor.fromJSON");return new t(e.resolve(n.pos))},t.prototype.getBookmark=function(){return new Wi(this.anchor)},t.valid=function(e){var t=e.parent;if(t.isTextblock||!function(e){for(var t=e.depth;t>=0;t--){var n=e.index(t);if(0!=n)for(var r=e.node(t).child(n-1);;r=r.lastChild){if(0==r.childCount&&!r.inlineContent||r.isAtom||r.type.spec.isolating)return!0;if(r.inlineContent)return!1}}return!0}(e)||!function(e){for(var t=e.depth;t>=0;t--){var n=e.indexAfter(t),r=e.node(t);if(n!=r.childCount)for(var o=r.child(n);;o=o.firstChild){if(0==o.childCount&&!o.inlineContent||o.isAtom||o.type.spec.isolating)return!0;if(o.inlineContent)return!1}}return!0}(e))return!1;var n=t.type.spec.allowGapCursor;if(null!=n)return n;var r=t.contentMatchAt(e.index()).defaultType;return r&&r.isTextblock},t.findFrom=function(e,n,r){e:for(;;){if(!r&&t.valid(e))return e;for(var o=e.pos,i=null,s=e.depth;;s--){var a=e.node(s);if(n>0?e.indexAfter(s)<a.childCount:e.index(s)>0){i=a.child(n>0?e.indexAfter(s):e.index(s)-1);break}if(0==s)return null;o+=n;var c=e.doc.resolve(o);if(t.valid(c))return c}for(;;){var l=n>0?i.firstChild:i.lastChild;if(!l){if(i.isAtom&&!i.isText&&!Zt.isSelectable(i)){e=e.doc.resolve(o+i.nodeSize*n),r=!1;continue e}break}i=l,o+=n;var u=e.doc.resolve(o);if(t.valid(u))return u}return null}},t}(Jt);Hi.prototype.visible=!1,Jt.jsonID("gapcursor",Hi);var Wi=function(e){this.pos=e};function qi(e,t){var n="vert"==e?t>0?"down":"up":t>0?"right":"left";return function(e,r,o){var i=e.selection,s=t>0?i.$to:i.$from,a=i.empty;if(i instanceof Gt){if(!o.endOfTextblock(n)||0==s.depth)return!1;a=!1,s=e.doc.resolve(t>0?s.after():s.before())}var c=Hi.findFrom(s,t,a);return!!c&&(r&&r(e.tr.setSelection(new Hi(c))),!0)}}Wi.prototype.map=function(e){return new Wi(e.map(this.pos))},Wi.prototype.resolve=function(e){var t=e.resolve(this.pos);return Hi.valid(t)?new Hi(t):Jt.near(t)},Kn({ArrowLeft:qi("horiz",-1),ArrowRight:qi("horiz",1),ArrowUp:qi("vert",-1),ArrowDown:qi("vert",1)});var Ji=function(){};Ji.prototype.append=function(e){return e.length?(e=Ji.from(e),!this.length&&e||e.length<200&&this.leafAppend(e)||this.length<200&&e.leafPrepend(this)||this.appendInner(e)):this},Ji.prototype.prepend=function(e){return e.length?Ji.from(e).append(this):this},Ji.prototype.appendInner=function(e){return new Ui(this,e)},Ji.prototype.slice=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=this.length),e>=t?Ji.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,t))},Ji.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)},Ji.prototype.forEach=function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=this.length),t<=n?this.forEachInner(e,t,n,0):this.forEachInvertedInner(e,t,n,0)},Ji.prototype.map=function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=this.length);var r=[];return this.forEach((function(t,n){return r.push(e(t,n))}),t,n),r},Ji.from=function(e){return e instanceof Ji?e:e&&e.length?new Ki(e):Ji.empty};var Ki=function(e){function t(t){e.call(this),this.values=t}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={length:{configurable:!0},depth:{configurable:!0}};return t.prototype.flatten=function(){return this.values},t.prototype.sliceInner=function(e,n){return 0==e&&n==this.length?this:new t(this.values.slice(e,n))},t.prototype.getInner=function(e){return this.values[e]},t.prototype.forEachInner=function(e,t,n,r){for(var o=t;o<n;o++)if(!1===e(this.values[o],r+o))return!1},t.prototype.forEachInvertedInner=function(e,t,n,r){for(var o=t-1;o>=n;o--)if(!1===e(this.values[o],r+o))return!1},t.prototype.leafAppend=function(e){if(this.length+e.length<=200)return new t(this.values.concat(e.flatten()))},t.prototype.leafPrepend=function(e){if(this.length+e.length<=200)return new t(e.flatten().concat(this.values))},n.length.get=function(){return this.values.length},n.depth.get=function(){return 0},Object.defineProperties(t.prototype,n),t}(Ji);Ji.empty=new Ki([]);var Ui=function(e){function t(t,n){e.call(this),this.left=t,this.right=n,this.length=t.length+n.length,this.depth=Math.max(t.depth,n.depth)+1}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},t.prototype.getInner=function(e){return e<this.left.length?this.left.get(e):this.right.get(e-this.left.length)},t.prototype.forEachInner=function(e,t,n,r){var o=this.left.length;return!(t<o&&!1===this.left.forEachInner(e,t,Math.min(n,o),r))&&(!(n>o&&!1===this.right.forEachInner(e,Math.max(t-o,0),Math.min(this.length,n)-o,r+o))&&void 0)},t.prototype.forEachInvertedInner=function(e,t,n,r){var o=this.left.length;return!(t>o&&!1===this.right.forEachInvertedInner(e,t-o,Math.max(n,o)-o,r+o))&&(!(n<o&&!1===this.left.forEachInvertedInner(e,Math.min(t,o),n,r))&&void 0)},t.prototype.sliceInner=function(e,t){if(0==e&&t==this.length)return this;var n=this.left.length;return t<=n?this.left.slice(e,t):e>=n?this.right.slice(e-n,t-n):this.left.slice(e,n).append(this.right.slice(0,t-n))},t.prototype.leafAppend=function(e){var n=this.right.leafAppend(e);if(n)return new t(this.left,n)},t.prototype.leafPrepend=function(e){var n=this.left.leafPrepend(e);if(n)return new t(n,this.right)},t.prototype.appendInner=function(e){return this.left.depth>=Math.max(this.right.depth,e.depth)+1?new t(this.left,new t(this.right,e)):new t(this,e)},t}(Ji),Gi=Ji,Qi=function(e,t){this.items=e,this.eventCount=t};Qi.prototype.popEvent=function(e,t){var n=this;if(0==this.eventCount)return null;for(var r,o,i=this.items.length;;i--){if(this.items.get(i-1).selection){--i;break}}t&&(r=this.remapping(i,this.items.length),o=r.maps.length);var s,a,c=e.tr,l=[],u=[];return this.items.forEach((function(e,t){if(!e.step)return r||(r=n.remapping(i,t+1),o=r.maps.length),o--,void u.push(e);if(r){u.push(new Zi(e.map));var f,d=e.step.map(r.slice(o));d&&c.maybeStep(d).doc&&(f=c.mapping.maps[c.mapping.maps.length-1],l.push(new Zi(f,null,null,l.length+u.length))),o--,f&&r.appendMap(f,o)}else c.maybeStep(e.step);return e.selection?(s=r?e.selection.map(r.slice(o)):e.selection,a=new Qi(n.items.slice(0,i).append(u.reverse().concat(l)),n.eventCount-1),!1):void 0}),this.items.length,0),{remaining:a,transform:c,selection:s}},Qi.prototype.addTransform=function(e,t,n,r){for(var o=[],i=this.eventCount,s=this.items,a=!r&&s.length?s.get(s.length-1):null,c=0;c<e.steps.length;c++){var l,u=e.steps[c].invert(e.docs[c]),f=new Zi(e.mapping.maps[c],u,t);(l=a&&a.merge(f))&&(f=l,c?o.pop():s=s.slice(0,s.length-1)),o.push(f),t&&(i++,t=null),r||(a=f)}var d,p,h,m=i-n.depth;return m>Yi&&(p=m,(d=s).forEach((function(e,t){if(e.selection&&0==p--)return h=t,!1})),s=d.slice(h),i-=m),new Qi(s.append(o),i)},Qi.prototype.remapping=function(e,t){var n=new mt;return this.items.forEach((function(t,r){var o=null!=t.mirrorOffset&&r-t.mirrorOffset>=e?n.maps.length-t.mirrorOffset:null;n.appendMap(t.map,o)}),e,t),n},Qi.prototype.addMaps=function(e){return 0==this.eventCount?this:new Qi(this.items.append(e.map((function(e){return new Zi(e)}))),this.eventCount)},Qi.prototype.rebased=function(e,t){if(!this.eventCount)return this;var n=[],r=Math.max(0,this.items.length-t),o=e.mapping,i=e.steps.length,s=this.eventCount;this.items.forEach((function(e){e.selection&&s--}),r);var a=t;this.items.forEach((function(t){var r=o.getMirror(--a);if(null!=r){i=Math.min(i,r);var c=o.maps[r];if(t.step){var l=e.steps[r].invert(e.docs[r]),u=t.selection&&t.selection.map(o.slice(a+1,r));u&&s++,n.push(new Zi(c,l,u))}else n.push(new Zi(c))}}),r);for(var c=[],l=t;l<i;l++)c.push(new Zi(o.maps[l]));var u=this.items.slice(0,r).append(c).append(n),f=new Qi(u,s);return f.emptyItemCount()>500&&(f=f.compress(this.items.length-n.length)),f},Qi.prototype.emptyItemCount=function(){var e=0;return this.items.forEach((function(t){t.step||e++})),e},Qi.prototype.compress=function(e){void 0===e&&(e=this.items.length);var t=this.remapping(0,e),n=t.maps.length,r=[],o=0;return this.items.forEach((function(i,s){if(s>=e)r.push(i),i.selection&&o++;else if(i.step){var a=i.step.map(t.slice(n)),c=a&&a.getMap();if(n--,c&&t.appendMap(c,n),a){var l=i.selection&&i.selection.map(t.slice(n));l&&o++;var u,f=new Zi(c.invert(),a,l),d=r.length-1;(u=r.length&&r[d].merge(f))?r[d]=u:r.push(f)}}else i.map&&n--}),this.items.length,0),new Qi(Gi.from(r.reverse()),o)},Qi.empty=new Qi(Gi.empty,0);var Zi=function(e,t,n,r){this.map=e,this.step=t,this.selection=n,this.mirrorOffset=r};Zi.prototype.merge=function(e){if(this.step&&e.step&&!e.selection){var t=e.step.merge(this.step);if(t)return new Zi(t.getMap().invert(),t,this.selection)}};var Xi=function(e,t,n,r){this.done=e,this.undone=t,this.prevRanges=n,this.prevTime=r},Yi=20;function es(e){var t=[];return e.forEach((function(e,n,r,o){return t.push(r,o)})),t}function ts(e,t){if(!e)return null;for(var n=[],r=0;r<e.length;r+=2){var o=t.map(e[r],1),i=t.map(e[r+1],-1);o<=i&&n.push(o,i)}return n}function ns(e,t,n,r){var o=ss(t),i=as.get(t).spec.config,s=(r?e.undone:e.done).popEvent(t,o);if(s){var a=s.selection.resolve(s.transform.doc),c=(r?e.done:e.undone).addTransform(s.transform,t.selection.getBookmark(),i,o),l=new Xi(r?c:s.remaining,r?s.remaining:c,null,0);n(s.transform.setSelection(a).setMeta(as,{redo:r,historyState:l}).scrollIntoView())}}var rs=!1,is=null;function ss(e){var t=e.plugins;if(is!=t){rs=!1,is=t;for(var n=0;n<t.length;n++)if(t[n].spec.historyPreserveItems){rs=!0;break}}return rs}var as=new gn("history"),cs=new gn("closeHistory");function ls(e){return e={depth:e&&e.depth||100,newGroupDelay:e&&e.newGroupDelay||500},new pn({key:as,state:{init:function(){return new Xi(Qi.empty,Qi.empty,null,0)},apply:function(t,n,r){return function(e,t,n,r){var o,i=n.getMeta(as);if(i)return i.historyState;n.getMeta(cs)&&(e=new Xi(e.done,e.undone,null,0));var s=n.getMeta("appendedTransaction");if(0==n.steps.length)return e;if(s&&s.getMeta(as))return s.getMeta(as).redo?new Xi(e.done.addTransform(n,null,r,ss(t)),e.undone,es(n.mapping.maps[n.steps.length-1]),e.prevTime):new Xi(e.done,e.undone.addTransform(n,null,r,ss(t)),null,e.prevTime);if(!1===n.getMeta("addToHistory")||s&&!1===s.getMeta("addToHistory"))return(o=n.getMeta("rebased"))?new Xi(e.done.rebased(n,o),e.undone.rebased(n,o),ts(e.prevRanges,n.mapping),e.prevTime):new Xi(e.done.addMaps(n.mapping.maps),e.undone.addMaps(n.mapping.maps),ts(e.prevRanges,n.mapping),e.prevTime);var a=0==e.prevTime||!s&&(e.prevTime<(n.time||0)-r.newGroupDelay||!function(e,t){if(!t)return!1;if(!e.docChanged)return!0;var n=!1;return e.mapping.maps[0].forEach((function(e,r){for(var o=0;o<t.length;o+=2)e<=t[o+1]&&r>=t[o]&&(n=!0)})),n}(n,e.prevRanges)),c=s?ts(e.prevRanges,n.mapping):es(n.mapping.maps[n.steps.length-1]);return new Xi(e.done.addTransform(n,a?t.selection.getBookmark():null,r,ss(t)),Qi.empty,c,n.time)}(n,r,t,e)}},config:e,props:{handleDOMEvents:{beforeinput:function(e,t){var n="historyUndo"==t.inputType?us(e.state,e.dispatch):"historyRedo"==t.inputType&&fs(e.state,e.dispatch);return n&&t.preventDefault(),n}}}})}function us(e,t){var n=as.getState(e);return!(!n||0==n.done.eventCount)&&(t&&ns(n,e,t,!1),!0)}function fs(e,t){var n=as.getState(e);return!(!n||0==n.undone.eventCount)&&(t&&ns(n,e,t,!0),!0)}var ds=function(e,t){var n;this.match=e,this.handler="string"==typeof t?(n=t,function(e,t,r,o){var i=n;if(t[1]){var s=t[0].lastIndexOf(t[1]);i+=t[0].slice(s+t[1].length);var a=(r+=s)-o;a>0&&(i=t[0].slice(s-a,s)+i,r=o)}return e.tr.insertText(i,r,o)}):t};var ps,hs;function ms(e){var t=e.rules,n=new pn({state:{init:function(){return null},apply:function(e,t){var n=e.getMeta(this);return n||(e.selectionSet||e.docChanged?null:t)}},props:{handleTextInput:function(e,r,o,i){return gs(e,r,o,i,t,n)},handleDOMEvents:{compositionend:function(e){setTimeout((function(){var r=e.state.selection.$cursor;r&&gs(e,r.pos,r.pos,"",t,n)}))}}},isInputRules:!0});return n}function gs(e,t,n,r,o,i){if(e.composing)return!1;var s=e.state,a=s.doc.resolve(t);if(a.parent.type.spec.code)return!1;for(var c=a.parent.textBetween(Math.max(0,a.parentOffset-500),a.parentOffset,null,"")+r,l=0;l<o.length;l++){var u=o[l].match.exec(c),f=u&&o[l].handler(s,u,t-(u[0].length-r.length),n);if(f)return e.dispatch(f.setMeta(i,{transform:f,from:t,to:n,text:r})),!0}return!1}function vs(e,t,n,r){return new ds(e,(function(e,o,i,s){var a=n instanceof Function?n(o):n,c=e.tr.delete(i,s),l=c.doc.resolve(i).blockRange(),u=l&&Et(l,t,a);if(!u)return null;c.wrap(l,u);var f=c.doc.resolve(i-1).nodeBefore;return f&&f.type==t&&Dt(c.doc,i-1)&&(!r||r(o,f))&&c.join(i-1),c}))}function ys(e,t,n){return new ds(e,(function(e,r,o,i){var s=e.doc.resolve(o),a=n instanceof Function?n(r):n;return s.node(-1).canReplaceWith(s.index(-1),s.indexAfter(-1),t)?e.tr.delete(o,i).setBlockType(o,o,t,a):null}))}function bs(e){return function(t,n){var r=t.selection,o=r.$from,i=r.$to,s=r.node;if(s&&s.isBlock||o.depth<2||!o.sameParent(i))return!1;var a=o.node(-1);if(a.type!=e)return!1;if(0==o.parent.content.size&&o.node(-1).childCount==o.indexAfter(-1)){if(2==o.depth||o.node(-3).type!=e||o.index(-2)!=o.node(-2).childCount-1)return!1;if(n){for(var c=X.empty,l=o.index(-1)?1:o.index(-2)?2:3,u=o.depth-l;u>=o.depth-3;u--)c=X.from(o.node(u).copy(c));var f=o.indexAfter(-1)<o.node(-2).childCount?1:o.indexAfter(-2)<o.node(-3).childCount?2:3;c=c.append(X.from(e.createAndFill()));var d=o.before(o.depth-(l-1)),p=t.tr.replace(d,o.after(-f),new ie(c,4-l,0)),h=-1;p.doc.nodesBetween(d,p.doc.content.size,(function(e,t){if(h>-1)return!1;e.isTextblock&&0==e.content.size&&(h=t+1)})),h>-1&&p.setSelection(t.selection.constructor.near(p.doc.resolve(h))),n(p.scrollIntoView())}return!0}var m=i.pos==o.end()?a.contentMatchAt(0).defaultType:null,g=t.tr.delete(o.pos,i.pos),v=m&&[null,{type:m}];return!!Nt(g.doc,o.pos,2,v)&&(n&&n(g.split(o.pos,2,v).scrollIntoView()),!0)}}function ws(e){return function(t,n){var r=t.selection,o=r.$from,i=r.$to,s=o.blockRange(i,(function(t){return t.childCount&&t.firstChild.type==e}));return!!s&&(!n||(o.node(s.depth-1).type==e?function(e,t,n,r){var o=e.tr,i=r.end,s=r.$to.end(r.depth);i<s&&(o.step(new St(i-1,s,i,s,new ie(X.from(n.create(null,r.parent.copy())),1,0),1,!0)),r=new Ce(o.doc.resolve(r.$from.pos),o.doc.resolve(s),r.depth));return t(o.lift(r,At(r)).scrollIntoView()),!0}(t,n,e,s):function(e,t,n){for(var r=e.tr,o=n.parent,i=n.end,s=n.endIndex-1,a=n.startIndex;s>a;s--)i-=o.child(s).nodeSize,r.delete(i-1,i+1);var c=r.doc.resolve(n.start),l=c.nodeAfter;if(r.mapping.map(n.end)!=n.start+c.nodeAfter.nodeSize)return!1;var u=0==n.startIndex,f=n.endIndex==o.childCount,d=c.node(-1),p=c.index(-1);if(!d.canReplace(p+(u?0:1),p+1,l.content.append(f?X.empty:X.from(o))))return!1;var h=c.pos,m=h+l.nodeSize;return r.step(new St(h-(u?1:0),m+(f?1:0),h+1,m-1,new ie((u?X.empty:X.from(o.copy(X.empty))).append(f?X.empty:X.from(o.copy(X.empty))),u?0:1,f?0:1),u?0:1)),t(r.scrollIntoView()),!0}(t,n,s)))}}function ks(e){return function(t,n){var r=t.selection,o=r.$from,i=r.$to,s=o.blockRange(i,(function(t){return t.childCount&&t.firstChild.type==e}));if(!s)return!1;var a=s.startIndex;if(0==a)return!1;var c=s.parent,l=c.child(a-1);if(l.type!=e)return!1;if(n){var u=l.lastChild&&l.lastChild.type==c.type,f=X.from(u?e.create():null),d=new ie(X.from(e.create(null,X.from(c.type.create(null,f)))),u?3:1,0),p=s.start,h=s.end;n(t.tr.step(new St(p-(u?3:1),h,p,h,d,1,!0)).scrollIntoView())}return!0}}if(new ds(/--$/,""),new ds(/\.\.\.$/,""),new ds(/(?:^|[\s\{\[\(\<'"\u2018\u201C])(")$/,""),new ds(/"$/,""),new ds(/(?:^|[\s\{\[\(\<'"\u2018\u201C])(')$/,""),new ds(/'$/,""),"undefined"!=typeof WeakMap){var xs=new WeakMap;ps=function(e){return xs.get(e)},hs=function(e,t){return xs.set(e,t),t}}else{var Cs=[],Ss=0;ps=function(e){for(var t=0;t<Cs.length;t+=2)if(Cs[t]==e)return Cs[t+1]},hs=function(e,t){return 10==Ss&&(Ss=0),Cs[Ss++]=e,Cs[Ss++]=t}}var Ms=function(e,t,n,r){this.left=e,this.top=t,this.right=n,this.bottom=r},Os=function(e,t,n,r){this.width=e,this.height=t,this.map=n,this.problems=r};function As(e){if(e.colwidth)return e.colwidth.slice();for(var t=[],n=0;n<e.colspan;n++)t.push(0);return t}function Es(e,t){var n=e.getAttribute("data-colwidth"),r=n&&/^\d+(,\d+)*$/.test(n)?n.split(",").map((function(e){return Number(e)})):null,o=Number(e.getAttribute("colspan")||1),i={colspan:o,rowspan:Number(e.getAttribute("rowspan")||1),colwidth:r&&r.length==o?r:null};for(var s in t){var a=t[s].getFromDOM,c=a&&a(e);null!=c&&(i[s]=c)}return i}function Ts(e,t){var n={};for(var r in 1!=e.attrs.colspan&&(n.colspan=e.attrs.colspan),1!=e.attrs.rowspan&&(n.rowspan=e.attrs.rowspan),e.attrs.colwidth&&(n["data-colwidth"]=e.attrs.colwidth.join(",")),t){var o=t[r].setDOMAttr;o&&o(e.attrs[r],n)}return n}function Ns(e){var t=e.cached.tableNodeTypes;if(!t)for(var n in t=e.cached.tableNodeTypes={},e.nodes){var r=e.nodes[n],o=r.spec.tableRole;o&&(t[o]=r)}return t}Os.prototype.findCell=function(e){for(var t=0;t<this.map.length;t++){var n=this.map[t];if(n==e){for(var r=t%this.width,o=t/this.width|0,i=r+1,s=o+1,a=1;i<this.width&&this.map[t+a]==n;a++)i++;for(var c=1;s<this.height&&this.map[t+this.width*c]==n;c++)s++;return new Ms(r,o,i,s)}}throw new RangeError("No cell with offset "+e+" found")},Os.prototype.colCount=function(e){for(var t=0;t<this.map.length;t++)if(this.map[t]==e)return t%this.width;throw new RangeError("No cell with offset "+e+" found")},Os.prototype.nextCell=function(e,t,n){var r=this.findCell(e),o=r.left,i=r.right,s=r.top,a=r.bottom;return"horiz"==t?(n<0?0==o:i==this.width)?null:this.map[s*this.width+(n<0?o-1:i)]:(n<0?0==s:a==this.height)?null:this.map[o+this.width*(n<0?s-1:a)]},Os.prototype.rectBetween=function(e,t){var n=this.findCell(e),r=n.left,o=n.right,i=n.top,s=n.bottom,a=this.findCell(t),c=a.left,l=a.right,u=a.top,f=a.bottom;return new Ms(Math.min(r,c),Math.min(i,u),Math.max(o,l),Math.max(s,f))},Os.prototype.cellsInRect=function(e){for(var t=[],n={},r=e.top;r<e.bottom;r++)for(var o=e.left;o<e.right;o++){var i=r*this.width+o,s=this.map[i];n[s]||(n[s]=!0,o==e.left&&o&&this.map[i-1]==s||r==e.top&&r&&this.map[i-this.width]==s||t.push(s))}return t},Os.prototype.positionAt=function(e,t,n){for(var r=0,o=0;;r++){var i=o+n.child(r).nodeSize;if(r==e){for(var s=t+e*this.width,a=(e+1)*this.width;s<a&&this.map[s]<o;)s++;return s==a?i-1:this.map[s]}o=i}},Os.get=function(e){return ps(e)||hs(e,function(e){if("table"!=e.type.spec.tableRole)throw new RangeError("Not a table node: "+e.type.name);for(var t=function(e){for(var t=-1,n=!1,r=0;r<e.childCount;r++){var o=e.child(r),i=0;if(n)for(var s=0;s<r;s++)for(var a=e.child(s),c=0;c<a.childCount;c++){var l=a.child(c);s+l.attrs.rowspan>r&&(i+=l.attrs.colspan)}for(var u=0;u<o.childCount;u++){var f=o.child(u);i+=f.attrs.colspan,f.attrs.rowspan>1&&(n=!0)}-1==t?t=i:t!=i&&(t=Math.max(t,i))}return t}(e),n=e.childCount,r=[],o=0,i=null,s=[],a=0,c=t*n;a<c;a++)r[a]=0;for(var l=0,u=0;l<n;l++){var f=e.child(l);u++;for(var d=0;;d++){for(;o<r.length&&0!=r[o];)o++;if(d==f.childCount)break;for(var p=f.child(d),h=p.attrs,m=h.colspan,g=h.rowspan,v=h.colwidth,y=0;y<g;y++){if(y+l>=n){(i||(i=[])).push({type:"overlong_rowspan",pos:u,n:g-y});break}for(var b=o+y*t,w=0;w<m;w++){0==r[b+w]?r[b+w]=u:(i||(i=[])).push({type:"collision",row:l,pos:u,n:m-w});var k=v&&v[w];if(k){var x=(b+w)%t*2,C=s[x];null==C||C!=k&&1==s[x+1]?(s[x]=k,s[x+1]=1):C==k&&s[x+1]++}}}o+=m,u+=p.nodeSize}for(var S=(l+1)*t,M=0;o<S;)0==r[o++]&&M++;M&&(i||(i=[])).push({type:"missing",row:l,n:M}),u++}for(var O=new Os(t,n,r,i),A=!1,E=0;!A&&E<s.length;E+=2)null!=s[E]&&s[E+1]<n&&(A=!0);A&&function(e,t,n){e.problems||(e.problems=[]);for(var r=0,o={};r<e.map.length;r++){var i=e.map[r];if(!o[i]){o[i]=!0;for(var s=n.nodeAt(i),a=null,c=0;c<s.attrs.colspan;c++){var l=t[2*((r+c)%e.width)];null==l||s.attrs.colwidth&&s.attrs.colwidth[c]==l||((a||(a=As(s.attrs)))[c]=l)}a&&e.problems.unshift({type:"colwidth mismatch",pos:i,colwidth:a})}}}(O,s,e);return O}(e))};var Ds=new gn("selectingCells");function Is(e){for(var t=e.depth-1;t>0;t--)if("row"==e.node(t).type.spec.tableRole)return e.node(0).resolve(e.before(t+1));return null}function zs(e){for(var t=e.selection.$head,n=t.depth;n>0;n--)if("row"==t.node(n).type.spec.tableRole)return!0;return!1}function Fs(e){var t=e.selection;return t.$anchorCell?t.$anchorCell.pos>t.$headCell.pos?t.$anchorCell:t.$headCell:t.node&&"cell"==t.node.type.spec.tableRole?t.$anchor:Is(t.$head)||function(e){for(var t=e.nodeAfter,n=e.pos;t;t=t.firstChild,n++){var r=t.type.spec.tableRole;if("cell"==r||"header_cell"==r)return e.doc.resolve(n)}for(var o=e.nodeBefore,i=e.pos;o;o=o.lastChild,i--){var s=o.type.spec.tableRole;if("cell"==s||"header_cell"==s)return e.doc.resolve(i-o.nodeSize)}}(t.$head)}function Rs(e){return"row"==e.parent.type.spec.tableRole&&e.nodeAfter}function $s(e,t){return e.depth==t.depth&&e.pos>=t.start(-1)&&e.pos<=t.end(-1)}function _s(e,t,n){var r=e.start(-1),o=Os.get(e.node(-1)).nextCell(e.pos-r,t,n);return null==o?null:e.node(0).resolve(r+o)}function Ps(e,t,n){var r={};for(var o in e)r[o]=e[o];return r[t]=n,r}function js(e,t,n){void 0===n&&(n=1);var r=Ps(e,"colspan",e.colspan-n);return r.colwidth&&(r.colwidth=r.colwidth.slice(),r.colwidth.splice(t,n),r.colwidth.some((function(e){return e>0}))||(r.colwidth=null)),r}function Ls(e,t,n){void 0===n&&(n=1);var r=Ps(e,"colspan",e.colspan+n);if(r.colwidth){r.colwidth=r.colwidth.slice();for(var o=0;o<n;o++)r.colwidth.splice(t,0,0)}return r}var Bs=function(e){function t(t,n){void 0===n&&(n=t);var r=t.node(-1),o=Os.get(r),i=t.start(-1),s=o.rectBetween(t.pos-i,n.pos-i),a=t.node(0),c=o.cellsInRect(s).filter((function(e){return e!=n.pos-i}));c.unshift(n.pos-i);var l=c.map((function(e){var t=r.nodeAt(e),n=e+i+1;return new Ut(a.resolve(n),a.resolve(n+t.content.size))}));e.call(this,l[0].$from,l[0].$to,l),this.$anchorCell=t,this.$headCell=n}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.map=function(e,n){var r=e.resolve(n.map(this.$anchorCell.pos)),o=e.resolve(n.map(this.$headCell.pos));if(Rs(r)&&Rs(o)&&$s(r,o)){var i=this.$anchorCell.node(-1)!=r.node(-1);return i&&this.isRowSelection()?t.rowSelection(r,o):i&&this.isColSelection()?t.colSelection(r,o):new t(r,o)}return Gt.between(r,o)},t.prototype.content=function(){for(var e=this.$anchorCell.node(-1),t=Os.get(e),n=this.$anchorCell.start(-1),r=t.rectBetween(this.$anchorCell.pos-n,this.$headCell.pos-n),o={},i=[],s=r.top;s<r.bottom;s++){for(var a=[],c=s*t.width+r.left,l=r.left;l<r.right;l++,c++){var u=t.map[c];if(!o[u]){o[u]=!0;var f=t.findCell(u),d=e.nodeAt(u),p=r.left-f.left,h=f.right-r.right;if(p>0||h>0){var m=d.attrs;p>0&&(m=js(m,0,p)),h>0&&(m=js(m,m.colspan-h,h)),d=f.left<r.left?d.type.createAndFill(m):d.type.create(m,d.content)}if(f.top<r.top||f.bottom>r.bottom){var g=Ps(d.attrs,"rowspan",Math.min(f.bottom,r.bottom)-Math.max(f.top,r.top));d=f.top<r.top?d.type.createAndFill(g):d.type.create(g,d.content)}a.push(d)}}i.push(e.child(s).copy(X.from(a)))}var v=this.isColSelection()&&this.isRowSelection()?e:i;return new ie(X.from(v),1,1)},t.prototype.replace=function(t,n){void 0===n&&(n=ie.empty);for(var r=t.steps.length,o=this.ranges,i=0;i<o.length;i++){var s=o[i],a=s.$from,c=s.$to,l=t.mapping.slice(r);t.replace(l.map(a.pos),l.map(c.pos),i?ie.empty:n)}var u=e.findFrom(t.doc.resolve(t.mapping.slice(r).map(this.to)),-1);u&&t.setSelection(u)},t.prototype.replaceWith=function(e,t){this.replace(e,new ie(X.from(t),0,0))},t.prototype.forEachCell=function(e){for(var t=this.$anchorCell.node(-1),n=Os.get(t),r=this.$anchorCell.start(-1),o=n.cellsInRect(n.rectBetween(this.$anchorCell.pos-r,this.$headCell.pos-r)),i=0;i<o.length;i++)e(t.nodeAt(o[i]),r+o[i])},t.prototype.isColSelection=function(){var e=this.$anchorCell.index(-1),t=this.$headCell.index(-1);if(Math.min(e,t)>0)return!1;var n=e+this.$anchorCell.nodeAfter.attrs.rowspan,r=t+this.$headCell.nodeAfter.attrs.rowspan;return Math.max(n,r)==this.$headCell.node(-1).childCount},t.colSelection=function(e,n){void 0===n&&(n=e);var r=Os.get(e.node(-1)),o=e.start(-1),i=r.findCell(e.pos-o),s=r.findCell(n.pos-o),a=e.node(0);return i.top<=s.top?(i.top>0&&(e=a.resolve(o+r.map[i.left])),s.bottom<r.height&&(n=a.resolve(o+r.map[r.width*(r.height-1)+s.right-1]))):(s.top>0&&(n=a.resolve(o+r.map[s.left])),i.bottom<r.height&&(e=a.resolve(o+r.map[r.width*(r.height-1)+i.right-1]))),new t(e,n)},t.prototype.isRowSelection=function(){var e=Os.get(this.$anchorCell.node(-1)),t=this.$anchorCell.start(-1),n=e.colCount(this.$anchorCell.pos-t),r=e.colCount(this.$headCell.pos-t);if(Math.min(n,r)>0)return!1;var o=n+this.$anchorCell.nodeAfter.attrs.colspan,i=r+this.$headCell.nodeAfter.attrs.colspan;return Math.max(o,i)==e.width},t.prototype.eq=function(e){return e instanceof t&&e.$anchorCell.pos==this.$anchorCell.pos&&e.$headCell.pos==this.$headCell.pos},t.rowSelection=function(e,n){void 0===n&&(n=e);var r=Os.get(e.node(-1)),o=e.start(-1),i=r.findCell(e.pos-o),s=r.findCell(n.pos-o),a=e.node(0);return i.left<=s.left?(i.left>0&&(e=a.resolve(o+r.map[i.top*r.width])),s.right<r.width&&(n=a.resolve(o+r.map[r.width*(s.top+1)-1]))):(s.left>0&&(n=a.resolve(o+r.map[s.top*r.width])),i.right<r.width&&(e=a.resolve(o+r.map[r.width*(i.top+1)-1]))),new t(e,n)},t.prototype.toJSON=function(){return{type:"cell",anchor:this.$anchorCell.pos,head:this.$headCell.pos}},t.fromJSON=function(e,n){return new t(e.resolve(n.anchor),e.resolve(n.head))},t.create=function(e,n,r){return void 0===r&&(r=n),new t(e.resolve(n),e.resolve(r))},t.prototype.getBookmark=function(){return new Vs(this.$anchorCell.pos,this.$headCell.pos)},t}(Jt);Bs.prototype.visible=!1,Jt.jsonID("cell",Bs);var Vs=function(e,t){this.anchor=e,this.head=t};function Hs(e){if(!(e.selection instanceof Bs))return null;var t=[];return e.selection.forEachCell((function(e,n){t.push(ki.node(n,n+e.nodeSize,{class:"selectedCell"}))})),Mi.create(e.doc,t)}function Ws(e){if(!e.size)return null;for(var t=e.content,n=e.openStart,r=e.openEnd;1==t.childCount&&(n>0&&r>0||"table"==t.firstChild.type.spec.tableRole);)n--,r--,t=t.firstChild.content;var o=t.firstChild,i=o.type.spec.tableRole,s=o.type.schema,a=[];if("row"==i)for(var c=0;c<t.childCount;c++){var l=t.child(c).content,u=c?0:Math.max(0,n-1),f=c<t.childCount-1?0:Math.max(0,r-1);(u||f)&&(l=qs(Ns(s).row,new ie(l,u,f)).content),a.push(l)}else{if("cell"!=i&&"header_cell"!=i)return null;a.push(n||r?qs(Ns(s).row,new ie(t,n,r)).content:t)}return function(e,t){for(var n=[],r=0;r<t.length;r++)for(var o=t[r],i=o.childCount-1;i>=0;i--)for(var s=o.child(i).attrs,a=s.rowspan,c=s.colspan,l=r;l<r+a;l++)n[l]=(n[l]||0)+c;for(var u=0,f=0;f<n.length;f++)u=Math.max(u,n[f]);for(var d=0;d<n.length;d++)if(d>=t.length&&t.push(X.empty),n[d]<u){for(var p=Ns(e).cell.createAndFill(),h=[],m=n[d];m<u;m++)h.push(p);t[d]=t[d].append(X.from(h))}return{height:t.length,width:u,rows:t}}(s,a)}function qs(e,t){var n=e.createAndFill();return new vt(n).replace(0,n.content.size,t).doc}function Js(e,t,n,r,o,i,s,a){if(0==s||s==t.height)return!1;for(var c=!1,l=o;l<i;l++){var u=s*t.width+l,f=t.map[u];if(t.map[u-t.width]==f){c=!0;var d=n.nodeAt(f),p=t.findCell(f),h=p.top,m=p.left;e.setNodeMarkup(e.mapping.slice(a).map(f+r),null,Ps(d.attrs,"rowspan",s-h)),e.insert(e.mapping.slice(a).map(t.positionAt(s,m,n)),d.type.createAndFill(Ps(d.attrs,"rowspan",h+d.attrs.rowspan-s))),l+=d.attrs.colspan-1}}return c}function Ks(e,t,n,r,o,i,s,a){if(0==s||s==t.width)return!1;for(var c=!1,l=o;l<i;l++){var u=l*t.width+s,f=t.map[u];if(t.map[u-1]==f){c=!0;var d=n.nodeAt(f),p=t.colCount(f),h=e.mapping.slice(a).map(f+r);e.setNodeMarkup(h,null,js(d.attrs,s-p,d.attrs.colspan-(s-p))),e.insert(h+d.nodeSize,d.type.createAndFill(js(d.attrs,0,s-p))),l+=d.attrs.rowspan-1}}return c}function Us(e,t,n,r,o){var i=n?e.doc.nodeAt(n-1):e.doc,s=Os.get(i),a=r.top,c=r.left,l=c+o.width,u=a+o.height,f=e.tr,d=0;function p(){i=n?f.doc.nodeAt(n-1):f.doc,s=Os.get(i),d=f.mapping.maps.length}(function(e,t,n,r,o,i,s){var a,c,l=Ns(e.doc.type.schema);if(o>t.width)for(var u=0,f=0;u<t.height;u++){var d=n.child(u);f+=d.nodeSize;var p=[],h=void 0;h=null==d.lastChild||d.lastChild.type==l.cell?a||(a=l.cell.createAndFill()):c||(c=l.header_cell.createAndFill());for(var m=t.width;m<o;m++)p.push(h);e.insert(e.mapping.slice(s).map(f-1+r),p)}if(i>t.height){for(var g=[],v=0,y=(t.height-1)*t.width;v<Math.max(t.width,o);v++){var b=!(v>=t.width)&&n.nodeAt(t.map[y+v]).type==l.header_cell;g.push(b?c||(c=l.header_cell.createAndFill()):a||(a=l.cell.createAndFill()))}for(var w=l.row.create(null,X.from(g)),k=[],x=t.height;x<i;x++)k.push(w);e.insert(e.mapping.slice(s).map(r+n.nodeSize-2),k)}return!(!a&&!c)})(f,s,i,n,l,u,d)&&p(),Js(f,s,i,n,c,l,a,d)&&p(),Js(f,s,i,n,c,l,u,d)&&p(),Ks(f,s,i,n,a,u,c,d)&&p(),Ks(f,s,i,n,a,u,l,d)&&p();for(var h=a;h<u;h++){var m=s.positionAt(h,c,i),g=s.positionAt(h,l,i);f.replace(f.mapping.slice(d).map(m+n),f.mapping.slice(d).map(g+n),new ie(o.rows[h-a],0,0))}p(),f.setSelection(new Bs(f.doc.resolve(n+s.positionAt(a,c,i)),f.doc.resolve(n+s.positionAt(u-1,l-1,i)))),t(f)}Vs.prototype.map=function(e){return new Vs(e.map(this.anchor),e.map(this.head))},Vs.prototype.resolve=function(e){var t=e.resolve(this.anchor),n=e.resolve(this.head);return"row"==t.parent.type.spec.tableRole&&"row"==n.parent.type.spec.tableRole&&t.index()<t.parent.childCount&&n.index()<n.parent.childCount&&$s(t,n)?new Bs(t,n):Jt.near(n,1)};var Gs=Kn({ArrowLeft:Zs("horiz",-1),ArrowRight:Zs("horiz",1),ArrowUp:Zs("vert",-1),ArrowDown:Zs("vert",1),"Shift-ArrowLeft":Xs("horiz",-1),"Shift-ArrowRight":Xs("horiz",1),"Shift-ArrowUp":Xs("vert",-1),"Shift-ArrowDown":Xs("vert",1),Backspace:Ys,"Mod-Backspace":Ys,Delete:Ys,"Mod-Delete":Ys});function Qs(e,t,n){return!n.eq(e.selection)&&(t&&t(e.tr.setSelection(n).scrollIntoView()),!0)}function Zs(e,t){return function(n,r,o){var i=n.selection;if(i instanceof Bs)return Qs(n,r,Jt.near(i.$headCell,t));if("horiz"!=e&&!i.empty)return!1;var s=ra(o,e,t);if(null==s)return!1;if("horiz"==e)return Qs(n,r,Jt.near(n.doc.resolve(i.head+t),t));var a,c=n.doc.resolve(s),l=_s(c,e,t);return a=l?Jt.near(l,1):t<0?Jt.near(n.doc.resolve(c.before(-1)),-1):Jt.near(n.doc.resolve(c.after(-1)),1),Qs(n,r,a)}}function Xs(e,t){return function(n,r,o){var i=n.selection;if(!(i instanceof Bs)){var s=ra(o,e,t);if(null==s)return!1;i=new Bs(n.doc.resolve(s))}var a=_s(i.$headCell,e,t);return!!a&&Qs(n,r,new Bs(i.$anchorCell,a))}}function Ys(e,t){var n=e.selection;if(!(n instanceof Bs))return!1;if(t){var r=e.tr,o=Ns(e.schema).cell.createAndFill().content;n.forEachCell((function(e,t){e.content.eq(o)||r.replace(r.mapping.map(t+1),r.mapping.map(t+e.nodeSize-1),new ie(o,0,0))})),r.docChanged&&t(r)}return!0}function ea(e,t){var n=Is(e.state.doc.resolve(t));return!!n&&(e.dispatch(e.state.tr.setSelection(new Bs(n))),!0)}function ta(e,t,n){if(!zs(e.state))return!1;var r=Ws(n),o=e.state.selection;if(o instanceof Bs){r||(r={width:1,height:1,rows:[X.from(qs(Ns(e.state.schema).cell,n))]});var i=o.$anchorCell.node(-1),s=o.$anchorCell.start(-1),a=Os.get(i).rectBetween(o.$anchorCell.pos-s,o.$headCell.pos-s);return r=function(e,t,n){var r=e.width,o=e.height,i=e.rows;if(r!=t){for(var s=[],a=[],c=0;c<i.length;c++){for(var l=i[c],u=[],f=s[c]||0,d=0;f<t;d++){var p=l.child(d%l.childCount);f+p.attrs.colspan>t&&(p=p.type.create(js(p.attrs,p.attrs.colspan,f+p.attrs.colspan-t),p.content)),u.push(p),f+=p.attrs.colspan;for(var h=1;h<p.attrs.rowspan;h++)s[c+h]=(s[c+h]||0)+p.attrs.colspan}a.push(X.from(u))}i=a,r=t}if(o!=n){for(var m=[],g=0,v=0;g<n;g++,v++){for(var y=[],b=i[v%o],w=0;w<b.childCount;w++){var k=b.child(w);g+k.attrs.rowspan>n&&(k=k.type.create(Ps(k.attrs,"rowspan",Math.max(1,n-k.attrs.rowspan)),k.content)),y.push(k)}m.push(X.from(y))}i=m,o=n}return{width:r,height:o,rows:i}}(r,a.right-a.left,a.bottom-a.top),Us(e.state,e.dispatch,s,a,r),!0}if(r){var c=Fs(e.state),l=c.start(-1);return Us(e.state,e.dispatch,l,Os.get(c.node(-1)).findCell(c.pos-l),r),!0}return!1}function na(e,t){if(!t.ctrlKey&&!t.metaKey){var n,r=oa(e,t.target);if(t.shiftKey&&e.state.selection instanceof Bs)o(e.state.selection.$anchorCell,t),t.preventDefault();else if(t.shiftKey&&r&&null!=(n=Is(e.state.selection.$anchor))&&ia(e,t).pos!=n.pos)o(n,t),t.preventDefault();else if(!r)return;e.root.addEventListener("mouseup",i),e.root.addEventListener("dragstart",i),e.root.addEventListener("mousemove",s)}function o(t,n){var r=ia(e,n),o=null==Ds.getState(e.state);if(!r||!$s(t,r)){if(!o)return;r=t}var i=new Bs(t,r);if(o||!e.state.selection.eq(i)){var s=e.state.tr.setSelection(i);o&&s.setMeta(Ds,t.pos),e.dispatch(s)}}function i(){e.root.removeEventListener("mouseup",i),e.root.removeEventListener("dragstart",i),e.root.removeEventListener("mousemove",s),null!=Ds.getState(e.state)&&e.dispatch(e.state.tr.setMeta(Ds,-1))}function s(n){var s,a=Ds.getState(e.state);if(null!=a)s=e.state.doc.resolve(a);else if(oa(e,n.target)!=r&&!(s=ia(e,t)))return i();s&&o(s,n)}}function ra(e,t,n){if(!(e.state.selection instanceof Gt))return null;for(var r=e.state.selection.$head,o=r.depth-1;o>=0;o--){var i=r.node(o);if((n<0?r.index(o):r.indexAfter(o))!=(n<0?0:i.childCount))return null;if("cell"==i.type.spec.tableRole||"header_cell"==i.type.spec.tableRole){var s=r.before(o),a="vert"==t?n>0?"down":"up":n>0?"right":"left";return e.endOfTextblock(a)?s:null}}return null}function oa(e,t){for(;t&&t!=e.dom;t=t.parentNode)if("TD"==t.nodeName||"TH"==t.nodeName)return t}function ia(e,t){var n=e.posAtCoords({left:t.clientX,top:t.clientY});return n&&n?Is(e.state.doc.resolve(n.pos)):null}var sa=new gn("fix-tables");function aa(e,t,n,r){var o=e.childCount,i=t.childCount;e:for(var s=0,a=0;s<i;s++){for(var c=t.child(s),l=a,u=Math.min(o,s+3);l<u;l++)if(e.child(l)==c){a=l+1,n+=c.nodeSize;continue e}r(c,n),a<o&&e.child(a).sameMarkup(c)?aa(e.child(a),c,n+1,r):c.nodesBetween(0,c.content.size,r,n+1),n+=c.nodeSize}}function ca(e,t){var n,r=function(t,r){"table"==t.type.spec.tableRole&&(n=function(e,t,n,r){var o=Os.get(t);if(!o.problems)return r;r||(r=e.tr);for(var i,s,a=[],c=0;c<o.height;c++)a.push(0);for(var l=0;l<o.problems.length;l++){var u=o.problems[l];if("collision"==u.type){for(var f=t.nodeAt(u.pos),d=0;d<f.attrs.rowspan;d++)a[u.row+d]+=u.n;r.setNodeMarkup(r.mapping.map(n+1+u.pos),null,js(f.attrs,f.attrs.colspan-u.n,u.n))}else if("missing"==u.type)a[u.row]+=u.n;else if("overlong_rowspan"==u.type){var p=t.nodeAt(u.pos);r.setNodeMarkup(r.mapping.map(n+1+u.pos),null,Ps(p.attrs,"rowspan",p.attrs.rowspan-u.n))}else if("colwidth mismatch"==u.type){var h=t.nodeAt(u.pos);r.setNodeMarkup(r.mapping.map(n+1+u.pos),null,Ps(h.attrs,"colwidth",u.colwidth))}}for(var m=0;m<a.length;m++)a[m]&&(null==i&&(i=m),s=m);for(var g=0,v=n+1;g<o.height;g++){var y=t.child(g),b=v+y.nodeSize,w=a[g];if(w>0){var k="cell";y.firstChild&&(k=y.firstChild.type.spec.tableRole);for(var x=[],C=0;C<w;C++)x.push(Ns(e.schema)[k].createAndFill());var S=0!=g&&i!=g-1||s!=g?b-1:v+1;r.insert(r.mapping.map(S),x)}v=b}return r.setMeta(sa,{fixTables:!0})}(e,t,r,n))};return t?t.doc!=e.doc&&aa(t.doc,e.doc,0,r):e.doc.descendants(r),n}function la(e){var t,n=e.selection,r=Fs(e),o=r.node(-1),i=r.start(-1),s=Os.get(o);return(t=n instanceof Bs?s.rectBetween(n.$anchorCell.pos-i,n.$headCell.pos-i):s.findCell(r.pos-i)).tableStart=i,t.map=s,t.table=o,t}function ua(e,t,n){var r=t.map,o=t.tableStart,i=t.table,s=n>0?-1:0;(function(e,t,n){for(var r=Ns(t.type.schema).header_cell,o=0;o<e.height;o++)if(t.nodeAt(e.map[n+o*e.width]).type!=r)return!1;return!0})(r,i,n+s)&&(s=0==n||n==r.width?null:0);for(var a=0;a<r.height;a++){var c=a*r.width+n;if(n>0&&n<r.width&&r.map[c-1]==r.map[c]){var l=r.map[c],u=i.nodeAt(l);e.setNodeMarkup(e.mapping.map(o+l),null,Ls(u.attrs,n-r.colCount(l))),a+=u.attrs.rowspan-1}else{var f=null==s?Ns(i.type.schema).cell:i.nodeAt(r.map[c+s]).type,d=r.positionAt(a,n,i);e.insert(e.mapping.map(o+d),f.createAndFill())}}return e}function fa(e,t){if(!zs(e))return!1;if(t){var n=la(e);t(ua(e.tr,n,n.left))}return!0}function da(e,t){if(!zs(e))return!1;if(t){var n=la(e);t(ua(e.tr,n,n.right))}return!0}function pa(e,t,n){for(var r=t.map,o=t.table,i=t.tableStart,s=e.mapping.maps.length,a=0;a<r.height;){var c=a*r.width+n,l=r.map[c],u=o.nodeAt(l);if(n>0&&r.map[c-1]==l||n<r.width-1&&r.map[c+1]==l)e.setNodeMarkup(e.mapping.slice(s).map(i+l),null,js(u.attrs,n-r.colCount(l)));else{var f=e.mapping.slice(s).map(i+l);e.delete(f,f+u.nodeSize)}a+=u.attrs.rowspan}}function ha(e,t){if(!zs(e))return!1;if(t){var n=la(e),r=e.tr;if(0==n.left&&n.right==n.map.width)return!1;for(var o=n.right-1;pa(r,n,o),o!=n.left;o--)n.table=n.tableStart?r.doc.nodeAt(n.tableStart-1):r.doc,n.map=Os.get(n.table);t(r)}return!0}function ma(e,t,n){for(var r=t.map,o=t.table,i=t.tableStart,s=0,a=0;a<n;a++)s+=o.child(a).nodeSize;var c=s+o.child(n).nodeSize,l=e.mapping.maps.length;e.delete(s+i,c+i);for(var u=0,f=n*r.width;u<r.width;u++,f++){var d=r.map[f];if(n>0&&d==r.map[f-r.width]){var p=o.nodeAt(d).attrs;e.setNodeMarkup(e.mapping.slice(l).map(d+i),null,Ps(p,"rowspan",p.rowspan-1)),u+=p.colspan-1}else if(n<r.width&&d==r.map[f+r.width]){var h=o.nodeAt(d),m=h.type.create(Ps(h.attrs,"rowspan",h.attrs.rowspan-1),h.content),g=r.positionAt(n+1,u,o);e.insert(e.mapping.slice(l).map(i+g),m),u+=h.attrs.colspan-1}}}function ga(e,t){if(!zs(e))return!1;if(t){var n=la(e),r=e.tr;if(0==n.top&&n.bottom==n.map.height)return!1;for(var o=n.bottom-1;ma(r,n,o),o!=n.top;o--)n.table=n.tableStart?r.doc.nodeAt(n.tableStart-1):r.doc,n.map=Os.get(n.table);t(r)}return!0}function va(e,t){return function(n,r){if(!zs(n))return!1;var o=Fs(n);if(o.nodeAfter.attrs[e]===t)return!1;if(r){var i=n.tr;n.selection instanceof Bs?n.selection.forEachCell((function(n,r){n.attrs[e]!==t&&i.setNodeMarkup(r,null,Ps(n.attrs,e,t))})):i.setNodeMarkup(o.pos,null,Ps(o.nodeAfter.attrs,e,t)),r(i)}return!0}}function ya(e,t,n){for(var r=t.map.cellsInRect({left:0,top:0,right:"row"==e?t.map.width:1,bottom:"column"==e?t.map.height:1}),o=0;o<r.length;o++){var i=t.table.nodeAt(r[o]);if(i&&i.type!==n.header_cell)return!1}return!0}function ba(e,t){return(t=t||{useDeprecatedLogic:!1}).useDeprecatedLogic?function(e){return function(t,n){if(!zs(t))return!1;if(n){for(var r=Ns(t.schema),o=la(t),i=t.tr,s=o.map.cellsInRect("column"==e?new Ms(o.left,0,o.right,o.map.height):"row"==e?new Ms(0,o.top,o.map.width,o.bottom):o),a=s.map((function(e){return o.table.nodeAt(e)})),c=0;c<s.length;c++)a[c].type==r.header_cell&&i.setNodeMarkup(o.tableStart+s[c],r.cell,a[c].attrs);if(0==i.steps.length)for(var l=0;l<s.length;l++)i.setNodeMarkup(o.tableStart+s[l],r.header_cell,a[l].attrs);n(i)}return!0}}(e):function(t,n){if(!zs(t))return!1;if(n){var r=Ns(t.schema),o=la(t),i=t.tr,s=ya("row",o,r),a=ya("column",o,r),c=("column"===e?s:"row"===e&&a)?1:0,l="column"==e?new Ms(0,c,1,o.map.height):"row"==e?new Ms(c,0,o.map.width,1):o,u="column"==e?a?r.cell:r.header_cell:"row"==e?s?r.cell:r.header_cell:r.cell;o.map.cellsInRect(l).forEach((function(e){var t=e+o.tableStart,n=i.doc.nodeAt(t);n&&i.setNodeMarkup(t,u,n.attrs)})),n(i)}return!0}}function wa(e){return function(t,n){if(!zs(t))return!1;var r=function(e,t){if(t<0){var n=e.nodeBefore;if(n)return e.pos-n.nodeSize;for(var r=e.index(-1)-1,o=e.before();r>=0;r--){var i=e.node(-1).child(r);if(i.childCount)return o-1-i.lastChild.nodeSize;o-=i.nodeSize}}else{if(e.index()<e.parent.childCount-1)return e.pos+e.nodeAfter.nodeSize;for(var s=e.node(-1),a=e.indexAfter(-1),c=e.after();a<s.childCount;a++){var l=s.child(a);if(l.childCount)return c+1;c+=l.nodeSize}}}(Fs(t),e);if(null!=r){if(n){var o=t.doc.resolve(r);n(t.tr.setSelection(Gt.between(o,(i=o,i.node(0).resolve(i.pos+i.nodeAfter.nodeSize)))).scrollIntoView())}var i;return!0}}}function ka(e,t){for(var n=e.selection.$anchor,r=n.depth;r>0;r--){if("table"==n.node(r).type.spec.tableRole)return t&&t(e.tr.delete(n.before(r),n.after(r)).scrollIntoView()),!0}return!1}ba("row",{useDeprecatedLogic:!0}),ba("column",{useDeprecatedLogic:!0}),ba("cell",{useDeprecatedLogic:!0});var xa=function(e,t){this.node=e,this.cellMinWidth=t,this.dom=document.createElement("div"),this.dom.className="tableWrapper",this.table=this.dom.appendChild(document.createElement("table")),this.colgroup=this.table.appendChild(document.createElement("colgroup")),Ca(e,this.colgroup,this.table,t),this.contentDOM=this.table.appendChild(document.createElement("tbody"))};function Ca(e,t,n,r,o,i){for(var s=0,a=!0,c=t.firstChild,l=e.firstChild,u=0,f=0;u<l.childCount;u++)for(var d=l.child(u).attrs,p=d.colspan,h=d.colwidth,m=0;m<p;m++,f++){var g=o==f?i:h&&h[m],v=g?g+"px":"";s+=g||r,g||(a=!1),c?(c.style.width!=v&&(c.style.width=v),c=c.nextSibling):t.appendChild(document.createElement("col")).style.width=v}for(;c;){var y=c.nextSibling;c.parentNode.removeChild(c),c=y}a?(n.style.width=s+"px",n.style.minWidth=""):(n.style.width="",n.style.minWidth=s+"px")}xa.prototype.update=function(e){return e.type==this.node.type&&(this.node=e,Ca(e,this.colgroup,this.table,this.cellMinWidth),!0)},xa.prototype.ignoreMutation=function(e){return"attributes"==e.type&&(e.target==this.table||this.colgroup.contains(e.target))};var Sa=new gn("tableColumnResizing");function Ma(e){void 0===e&&(e={});var t=e.handleWidth;void 0===t&&(t=5);var n=e.cellMinWidth;void 0===n&&(n=25);var r=e.View;void 0===r&&(r=xa);var o=e.lastColumnResizable;return void 0===o&&(o=!0),new pn({key:Sa,state:{init:function(e,t){return this.spec.props.nodeViews[Ns(t.schema).table.name]=function(e,t){return new r(e,n,t)},new Oa(-1,!1)},apply:function(e,t){return t.apply(e)}},props:{attributes:function(e){return Sa.getState(e).activeHandle>-1?{class:"resize-cursor"}:null},handleDOMEvents:{mousemove:function(e,n){!function(e,t,n,r,o){var i=Sa.getState(e.state);if(!i.dragging){var s=function(e){for(;e&&"TD"!=e.nodeName&&"TH"!=e.nodeName;)e=e.classList.contains("ProseMirror")?null:e.parentNode;return e}(t.target),a=-1;if(s){var c=s.getBoundingClientRect(),l=c.left,u=c.right;t.clientX-l<=n?a=Aa(e,t,"left"):u-t.clientX<=n&&(a=Aa(e,t,"right"))}if(a!=i.activeHandle){if(!o&&-1!==a){var f=e.state.doc.resolve(a),d=f.node(-1),p=Os.get(d),h=f.start(-1);if(p.colCount(f.pos-h)+f.nodeAfter.attrs.colspan-1==p.width-1)return}Ta(e,a)}}}(e,n,t,0,o)},mouseleave:function(e){!function(e){var t=Sa.getState(e.state);t.activeHandle>-1&&!t.dragging&&Ta(e,-1)}(e)},mousedown:function(e,t){!function(e,t,n){var r=Sa.getState(e.state);if(-1==r.activeHandle||r.dragging)return!1;var o=e.state.doc.nodeAt(r.activeHandle),i=function(e,t,n){var r=n.colspan,o=n.colwidth,i=o&&o[o.length-1];if(i)return i;var s=e.domAtPos(t),a=s.node.childNodes[s.offset].offsetWidth,c=r;if(o)for(var l=0;l<r;l++)o[l]&&(a-=o[l],c--);return a/c}(e,r.activeHandle,o.attrs);function s(t){window.removeEventListener("mouseup",s),window.removeEventListener("mousemove",a);var r=Sa.getState(e.state);r.dragging&&(!function(e,t,n){for(var r=e.state.doc.resolve(t),o=r.node(-1),i=Os.get(o),s=r.start(-1),a=i.colCount(r.pos-s)+r.nodeAfter.attrs.colspan-1,c=e.state.tr,l=0;l<i.height;l++){var u=l*i.width+a;if(!l||i.map[u]!=i.map[u-i.width]){var f=i.map[u],d=o.nodeAt(f).attrs,p=1==d.colspan?0:a-i.colCount(f);if(!d.colwidth||d.colwidth[p]!=n){var h=d.colwidth?d.colwidth.slice():Na(d.colspan);h[p]=n,c.setNodeMarkup(s+f,null,Ps(d,"colwidth",h))}}}c.docChanged&&e.dispatch(c)}(e,r.activeHandle,Ea(r.dragging,t,n)),e.dispatch(e.state.tr.setMeta(Sa,{setDragging:null})))}function a(t){if(!t.which)return s(t);var r=Sa.getState(e.state),o=Ea(r.dragging,t,n);!function(e,t,n,r){var o=e.state.doc.resolve(t),i=o.node(-1),s=o.start(-1),a=Os.get(i).colCount(o.pos-s)+o.nodeAfter.attrs.colspan-1,c=e.domAtPos(o.start(-1)).node;for(;"TABLE"!=c.nodeName;)c=c.parentNode;Ca(i,c.firstChild,c,r,a,n)}(e,r.activeHandle,o,n)}e.dispatch(e.state.tr.setMeta(Sa,{setDragging:{startX:t.clientX,startWidth:i}})),window.addEventListener("mouseup",s),window.addEventListener("mousemove",a),t.preventDefault()}(e,t,n)}},decorations:function(e){var t=Sa.getState(e);if(t.activeHandle>-1)return function(e,t){for(var n=[],r=e.doc.resolve(t),o=r.node(-1),i=Os.get(o),s=r.start(-1),a=i.colCount(r.pos-s)+r.nodeAfter.attrs.colspan,c=0;c<i.height;c++){var l=a+c*i.width-1;if(!(a!=i.width&&i.map[l]==i.map[l+1]||0!=c&&i.map[l-1]==i.map[l-1-i.width])){var u=i.map[l],f=s+u+o.nodeAt(u).nodeSize-1,d=document.createElement("div");d.className="column-resize-handle",n.push(ki.widget(f,d))}}return Mi.create(e.doc,n)}(e,t.activeHandle)},nodeViews:{}}})}var Oa=function(e,t){this.activeHandle=e,this.dragging=t};function Aa(e,t,n){var r=e.posAtCoords({left:t.clientX,top:t.clientY});if(!r)return-1;var o=r.pos,i=Is(e.state.doc.resolve(o));if(!i)return-1;if("right"==n)return i.pos;var s=Os.get(i.node(-1)),a=i.start(-1),c=s.map.indexOf(i.pos-a);return c%s.width==0?-1:a+s.map[c-1]}function Ea(e,t,n){var r=t.clientX-e.startX;return Math.max(n,e.startWidth+r)}function Ta(e,t){e.dispatch(e.state.tr.setMeta(Sa,{setHandle:t}))}function Na(e){for(var t=[],n=0;n<e;n++)t.push(0);return t}function Da(e){void 0===e&&(e={});var t=e.allowTableNodeSelection;return void 0===t&&(t=!1),new pn({key:Ds,state:{init:function(){return null},apply:function(e,t){var n=e.getMeta(Ds);if(null!=n)return-1==n?null:n;if(null==t||!e.docChanged)return t;var r=e.mapping.mapResult(t),o=r.deleted,i=r.pos;return o?null:i}},props:{decorations:Hs,handleDOMEvents:{mousedown:na},createSelectionBetween:function(e){if(null!=Ds.getState(e.state))return e.state.selection},handleTripleClick:ea,handleKeyDown:Gs,handlePaste:ta},appendTransaction:function(e,n,r){return function(e,t,n){var r,o,i=(t||e).selection,s=(t||e).doc;if(i instanceof Zt&&(o=i.node.type.spec.tableRole)){if("cell"==o||"header_cell"==o)r=Bs.create(s,i.from);else if("row"==o){var a=s.resolve(i.from+1);r=Bs.rowSelection(a,a)}else if(!n){var c=Os.get(i.node),l=i.from+1,u=l+c.map[c.width*c.height-1];r=Bs.create(s,l+1,u)}}else i instanceof Gt&&function(e){var t=e.$from,n=e.$to;if(t.pos==n.pos||t.pos<t.pos-6)return!1;for(var r=t.pos,o=n.pos,i=t.depth;i>=0&&!(t.after(i+1)<t.end(i));i--,r++);for(var s=n.depth;s>=0&&!(n.before(s+1)>n.start(s));s--,o--);return r==o&&/row|table/.test(t.node(i).type.spec.tableRole)}(i)?r=Gt.create(s,i.from):i instanceof Gt&&function(e){for(var t,n,r=e.$from,o=e.$to,i=r.depth;i>0;i--){var s=r.node(i);if("cell"===s.type.spec.tableRole||"header_cell"===s.type.spec.tableRole){t=s;break}}for(var a=o.depth;a>0;a--){var c=o.node(a);if("cell"===c.type.spec.tableRole||"header_cell"===c.type.spec.tableRole){n=c;break}}return t!==n&&0===o.parentOffset}(i)&&(r=Gt.create(s,i.$from.start(),i.$from.end()));return r&&(t||(t=e.tr)).setSelection(r),t}(r,ca(r,n),t)}})}function Ia(e,t){return new ds(e,((e,n,r,o)=>{const{tr:i}=e,s=n.length;let a=r,c=o;if(n[s-1]){const l=n[0],u=n[s-1],f=n[s-2],d=r+l.indexOf(f),p=d+f.length-1,h=d+f.lastIndexOf(u),m=h+u.length;if(function(e,t,n){let r=[];return n.doc.nodesBetween(e,t,((e,t)=>{r=[...r,...e.marks.map((n=>({start:t,end:t+e.nodeSize,mark:n})))]})),r}(r,o,e).filter((e=>e.mark.type.excludes(t))).filter((e=>e.end>d)).length)return null;m<p&&i.delete(m,p),h>d&&i.delete(d,h),a=d,c=a+u.length}return i.addMark(a,c,t.create()),i.removeStoredMark(t),i}))}Oa.prototype.apply=function(e){var t=this,n=e.getMeta(Sa);if(n&&null!=n.setHandle)return new Oa(n.setHandle,null);if(n&&void 0!==n.setDragging)return new Oa(t.activeHandle,n.setDragging);if(t.activeHandle>-1&&e.docChanged){var r=e.mapping.map(t.activeHandle,-1);Rs(e.doc.resolve(r))||(r=null),t=new Oa(r,t.dragging)}return t};const za=(e,t,n)=>{var r;const o=e.state,{from:i}=o.selection,{node:s}=e.domAtPos(i),a=s instanceof Text?s.parentElement:s;if(!(a instanceof HTMLElement))throw new Error;const c=a.getBoundingClientRect(),l=t.getBoundingClientRect(),u=null==(r=t.parentElement)?void 0:r.getBoundingClientRect();if(!u)throw new Error;const[f,d]=n(c,l,u);t.style.top=f+"px",t.style.left=d+"px"},Fa=(e,t,n)=>{var r;const o=e.state,{from:i,to:s}=o.selection,a=e.coordsAtPos(i),c=e.coordsAtPos(s),l=t.getBoundingClientRect(),u=null==(r=t.parentElement)?void 0:r.getBoundingClientRect();if(!u)throw new Error;const[f,d]=n(a,c,l,u);t.style.top=f+"px",t.style.left=d+"px"},Ra=e=>Object.assign(Object.create(e),e).setTime(Date.now()),$a=e=>(t,n)=>((e,t=!0)=>{const n=[];return e.descendants(((e,r)=>{if(n.push({node:e,pos:r}),!t)return!1})),n})(t,n).filter((t=>e(t.node))),_a=e=>t=>(e=>t=>{for(let n=t.depth;n>0;n--){const r=t.node(n);if(e(r))return{pos:n>0?t.before(n):0,start:t.start(n),depth:n,node:r}}})(e)(t.$from),Pa=(e,t)=>{if(!(e instanceof Zt))return;const{node:n,$from:r}=e;return((e,t)=>Array.isArray(e)&&e.indexOf(t.type)>-1||t.type===e)(t,n)?{node:n,pos:r.pos,start:r.start(r.depth),depth:r.depth}:void 0};function ja(e){if(e)throw e}
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var La=function(e){return null!=e&&null!=e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)},Ba=Object.prototype.hasOwnProperty,Va=Object.prototype.toString,Ha=Object.defineProperty,Wa=Object.getOwnPropertyDescriptor,qa=function(e){return"function"==typeof Array.isArray?Array.isArray(e):"[object Array]"===Va.call(e)},Ja=function(e){if(!e||"[object Object]"!==Va.call(e))return!1;var t,n=Ba.call(e,"constructor"),r=e.constructor&&e.constructor.prototype&&Ba.call(e.constructor.prototype,"isPrototypeOf");if(e.constructor&&!n&&!r)return!1;for(t in e);return void 0===t||Ba.call(e,t)},Ka=function(e,t){Ha&&"__proto__"===t.name?Ha(e,t.name,{enumerable:!0,configurable:!0,value:t.newValue,writable:!0}):e[t.name]=t.newValue},Ua=function(e,t){if("__proto__"===t){if(!Ba.call(e,t))return;if(Wa)return Wa(e,t).value}return e[t]},Ga=function e(){var t,n,r,o,i,s,a=arguments[0],c=1,l=arguments.length,u=!1;for("boolean"==typeof a&&(u=a,a=arguments[1]||{},c=2),(null==a||"object"!=typeof a&&"function"!=typeof a)&&(a={});c<l;++c)if(null!=(t=arguments[c]))for(n in t)r=Ua(a,n),a!==(o=Ua(t,n))&&(u&&o&&(Ja(o)||(i=qa(o)))?(i?(i=!1,s=r&&qa(r)?r:[]):s=r&&Ja(r)?r:{},Ka(a,{name:n,newValue:e(u,s,o)})):void 0!==o&&Ka(a,{name:n,newValue:o}));return a};function Qa(e){if("[object Object]"!==Object.prototype.toString.call(e))return!1;const t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}function Za(){const e=[],t={run:function(...t){let n=-1;const r=t.pop();if("function"!=typeof r)throw new TypeError("Expected function as last argument, not "+r);!function o(i,...s){const a=e[++n];let c=-1;if(i)r(i);else{for(;++c<t.length;)null!==s[c]&&void 0!==s[c]||(s[c]=t[c]);t=s,a?function(e,t){let n;return r;function r(...t){const r=e.length>t.length;let a;r&&t.push(o);try{a=e(...t)}catch(i){const t=i;if(r&&n)throw t;return o(t)}r||(a instanceof Promise?a.then(s,o):a instanceof Error?o(a):s(a))}function o(e,...r){n||(n=!0,t(e,...r))}function s(e){o(null,e)}}(a,o)(...s):r(null,...s)}}(null,...t)},use:function(n){if("function"!=typeof n)throw new TypeError("Expected `middelware` to be a function, not "+n);return e.push(n),t}};return t}var Xa={}.hasOwnProperty;function Ya(e){return e&&"object"==typeof e?Xa.call(e,"position")||Xa.call(e,"type")?tc(e.position):Xa.call(e,"start")||Xa.call(e,"end")?tc(e):Xa.call(e,"line")||Xa.call(e,"column")?ec(e):"":""}function ec(e){return nc(e&&e.line)+":"+nc(e&&e.column)}function tc(e){return ec(e&&e.start)+"-"+ec(e&&e.end)}function nc(e){return e&&"number"==typeof e?e:1}class rc extends Error{constructor(e,t,n){var r,o=[null,null],i={start:{line:null,column:null},end:{line:null,column:null}};super(),"string"==typeof t&&(n=t,t=null),"string"==typeof n&&(-1===(r=n.indexOf(":"))?o[1]=n:(o[0]=n.slice(0,r),o[1]=n.slice(r+1))),t&&("type"in t||"position"in t?t.position&&(i=t.position):"start"in t||"end"in t?i=t:("line"in t||"column"in t)&&(i.start=t)),this.name=Ya(t)||"1:1",this.message="object"==typeof e?e.message:e,this.stack="object"==typeof e?e.stack:"",this.reason=this.message,this.line=i.start.line,this.column=i.start.column,this.source=o[0],this.ruleId=o[1],this.position=i,this.file,this.fatal,this.url,this.note}}rc.prototype.file="",rc.prototype.name="",rc.prototype.reason="",rc.prototype.message="",rc.prototype.stack="",rc.prototype.fatal=null,rc.prototype.column=null,rc.prototype.line=null,rc.prototype.source=null,rc.prototype.ruleId=null,rc.prototype.position=null;const oc={basename:function(e,t){if(void 0!==t&&"string"!=typeof t)throw new TypeError('"ext" argument must be a string');ic(e);let n,r=0,o=-1,i=e.length;if(void 0===t||0===t.length||t.length>e.length){for(;i--;)if(47===e.charCodeAt(i)){if(n){r=i+1;break}}else o<0&&(n=!0,o=i+1);return o<0?"":e.slice(r,o)}if(t===e)return"";let s=-1,a=t.length-1;for(;i--;)if(47===e.charCodeAt(i)){if(n){r=i+1;break}}else s<0&&(n=!0,s=i+1),a>-1&&(e.charCodeAt(i)===t.charCodeAt(a--)?a<0&&(o=i):(a=-1,o=s));r===o?o=s:o<0&&(o=e.length);return e.slice(r,o)},dirname:function(e){if(ic(e),0===e.length)return".";let t,n=-1,r=e.length;for(;--r;)if(47===e.charCodeAt(r)){if(t){n=r;break}}else t||(t=!0);return n<0?47===e.charCodeAt(0)?"/":".":1===n&&47===e.charCodeAt(0)?"//":e.slice(0,n)},extname:function(e){ic(e);let t,n=e.length,r=-1,o=0,i=-1,s=0;for(;n--;){const a=e.charCodeAt(n);if(47!==a)r<0&&(t=!0,r=n+1),46===a?i<0?i=n:1!==s&&(s=1):i>-1&&(s=-1);else if(t){o=n+1;break}}if(i<0||r<0||0===s||1===s&&i===r-1&&i===o+1)return"";return e.slice(i,r)},join:function(...e){let t,n=-1;for(;++n<e.length;)ic(e[n]),e[n]&&(t=void 0===t?e[n]:t+"/"+e[n]);return void 0===t?".":function(e){ic(e);const t=47===e.charCodeAt(0);let n=function(e,t){let n,r,o="",i=0,s=-1,a=0,c=-1;for(;++c<=e.length;){if(c<e.length)n=e.charCodeAt(c);else{if(47===n)break;n=47}if(47===n){if(s===c-1||1===a);else if(s!==c-1&&2===a){if(o.length<2||2!==i||46!==o.charCodeAt(o.length-1)||46!==o.charCodeAt(o.length-2))if(o.length>2){if(r=o.lastIndexOf("/"),r!==o.length-1){r<0?(o="",i=0):(o=o.slice(0,r),i=o.length-1-o.lastIndexOf("/")),s=c,a=0;continue}}else if(o.length>0){o="",i=0,s=c,a=0;continue}t&&(o=o.length>0?o+"/..":"..",i=2)}else o.length>0?o+="/"+e.slice(s+1,c):o=e.slice(s+1,c),i=c-s-1;s=c,a=0}else 46===n&&a>-1?a++:a=-1}return o}(e,!t);0!==n.length||t||(n=".");n.length>0&&47===e.charCodeAt(e.length-1)&&(n+="/");return t?"/"+n:n}(t)},sep:"/"};function ic(e){if("string"!=typeof e)throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}const sc={cwd:function(){return"/"}};function ac(e){return null!==e&&"object"==typeof e&&e.href&&e.origin}function cc(e){if("string"==typeof e)e=new URL(e);else if(!ac(e)){const t=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+e+"`");throw t.code="ERR_INVALID_ARG_TYPE",t}if("file:"!==e.protocol){const e=new TypeError("The URL must be of scheme file");throw e.code="ERR_INVALID_URL_SCHEME",e}return function(e){if(""!==e.hostname){const e=new TypeError('File URL host must be "localhost" or empty on darwin');throw e.code="ERR_INVALID_FILE_URL_HOST",e}const t=e.pathname;let n=-1;for(;++n<t.length;)if(37===t.charCodeAt(n)&&50===t.charCodeAt(n+1)){const e=t.charCodeAt(n+2);if(70===e||102===e){const e=new TypeError("File URL path must not include encoded / characters");throw e.code="ERR_INVALID_FILE_URL_PATH",e}}return decodeURIComponent(t)}(e)}const lc=["history","path","basename","stem","extname","dirname"];class uc{constructor(e){let t;t=e?"string"==typeof e||La(e)?{value:e}:ac(e)?{path:e}:e:{},this.data={},this.messages=[],this.history=[],this.cwd=sc.cwd(),this.value,this.stored,this.result,this.map;let n,r=-1;for(;++r<lc.length;){const e=lc[r];e in t&&void 0!==t[e]&&(this[e]="history"===e?[...t[e]]:t[e])}for(n in t)lc.includes(n)||(this[n]=t[n])}get path(){return this.history[this.history.length-1]}set path(e){ac(e)&&(e=cc(e)),dc(e,"path"),this.path!==e&&this.history.push(e)}get dirname(){return"string"==typeof this.path?oc.dirname(this.path):void 0}set dirname(e){pc(this.basename,"dirname"),this.path=oc.join(e||"",this.basename)}get basename(){return"string"==typeof this.path?oc.basename(this.path):void 0}set basename(e){dc(e,"basename"),fc(e,"basename"),this.path=oc.join(this.dirname||"",e)}get extname(){return"string"==typeof this.path?oc.extname(this.path):void 0}set extname(e){if(fc(e,"extname"),pc(this.dirname,"extname"),e){if(46!==e.charCodeAt(0))throw new Error("`extname` must start with `.`");if(e.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=oc.join(this.dirname,this.stem+(e||""))}get stem(){return"string"==typeof this.path?oc.basename(this.path,this.extname):void 0}set stem(e){dc(e,"stem"),fc(e,"stem"),this.path=oc.join(this.dirname||"",e+(this.extname||""))}toString(e){return(this.value||"").toString(e)}message(e,t,n){const r=new rc(e,t,n);return this.path&&(r.name=this.path+":"+r.name,r.file=this.path),r.fatal=!1,this.messages.push(r),r}info(e,t,n){const r=this.message(e,t,n);return r.fatal=null,r}fail(e,t,n){const r=this.message(e,t,n);throw r.fatal=!0,r}}function fc(e,t){if(e&&e.includes(oc.sep))throw new Error("`"+t+"` cannot be a path: did not expect `"+oc.sep+"`")}function dc(e,t){if(!e)throw new Error("`"+t+"` cannot be empty")}function pc(e,t){if(!e)throw new Error("Setting `"+t+"` requires `path` to be set too")}const hc=function e(){const t=Za(),n=[];let r,o={},i=-1;return s.data=function(e,t){if("string"==typeof e)return 2===arguments.length?(bc("data",r),o[e]=t,s):mc.call(o,e)&&o[e]||null;if(e)return bc("data",r),o=e,s;return o},s.Parser=void 0,s.Compiler=void 0,s.freeze=function(){if(r)return s;for(;++i<n.length;){const[e,...r]=n[i];if(!1===r[0])continue;!0===r[0]&&(r[1]=void 0);const o=e.call(s,...r);"function"==typeof o&&t.use(o)}return r=!0,i=Number.POSITIVE_INFINITY,s},s.attachers=n,s.use=function(e,...t){let i;if(bc("use",r),null==e);else if("function"==typeof e)u(e,...t);else{if("object"!=typeof e)throw new TypeError("Expected usable value, not `"+e+"`");Array.isArray(e)?l(e):c(e)}i&&(o.settings=Object.assign(o.settings||{},i));return s;function a(e){if("function"==typeof e)u(e);else{if("object"!=typeof e)throw new TypeError("Expected usable value, not `"+e+"`");if(Array.isArray(e)){const[t,...n]=e;u(t,...n)}else c(e)}}function c(e){l(e.plugins),e.settings&&(i=Object.assign(i||{},e.settings))}function l(e){let t=-1;if(null==e);else{if(!Array.isArray(e))throw new TypeError("Expected a list of plugins, not `"+e+"`");for(;++t<e.length;){a(e[t])}}}function u(e,t){let r,o=-1;for(;++o<n.length;)if(n[o][0]===e){r=n[o];break}r?(Qa(r[1])&&Qa(t)&&(t=Ga(!0,r[1],t)),r[1]=t):n.push([...arguments])}},s.parse=function(e){s.freeze();const t=xc(e),n=s.Parser;if(vc("parse",n),gc(n,"parse"))return new n(String(t),t).parse();return n(String(t),t)},s.stringify=function(e,t){s.freeze();const n=xc(t),r=s.Compiler;if(yc("stringify",r),wc(e),gc(r,"compile"))return new r(e,n).compile();return r(e,n)},s.run=function(e,n,r){wc(e),s.freeze(),r||"function"!=typeof n||(r=n,n=void 0);if(!r)return new Promise(o);function o(o,i){function s(t,n,s){n=n||e,t?i(t):o?o(n):r(null,n,s)}t.run(e,xc(n),s)}o(null,r)},s.runSync=function(e,t){let n,r;return s.run(e,t,o),kc("runSync","run",r),n;function o(e,t){ja(e),n=t,r=!0}},s.process=function(e,t){if(s.freeze(),vc("process",s.Parser),yc("process",s.Compiler),!t)return new Promise(n);function n(n,r){const o=xc(e);function i(e,o){e||!o?r(e):n?n(o):t(null,o)}s.run(s.parse(o),o,((e,t,n)=>{if(!e&&t&&n){const o=s.stringify(t,n);null==o||("string"==typeof(r=o)||La(r)?n.value=o:n.result=o),i(e,n)}else i(e);var r}))}n(null,t)},s.processSync=function(e){let t;s.freeze(),vc("processSync",s.Parser),yc("processSync",s.Compiler);const n=xc(e);return s.process(n,r),kc("processSync","process",t),n;function r(e){t=!0,ja(e)}},s;function s(){const t=e();let r=-1;for(;++r<n.length;)t.use(...n[r]);return t.data(Ga(!0,{},o)),t}}().freeze(),mc={}.hasOwnProperty;function gc(e,t){return"function"==typeof e&&e.prototype&&(function(e){let t;for(t in e)if(mc.call(e,t))return!0;return!1}(e.prototype)||t in e.prototype)}function vc(e,t){if("function"!=typeof t)throw new TypeError("Cannot `"+e+"` without `Parser`")}function yc(e,t){if("function"!=typeof t)throw new TypeError("Cannot `"+e+"` without `Compiler`")}function bc(e,t){if(t)throw new Error("Cannot call `"+e+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function wc(e){if(!Qa(e)||"string"!=typeof e.type)throw new TypeError("Expected node, got `"+e+"`")}function kc(e,t,n){if(!n)throw new Error("`"+e+"` finished async. Use `"+t+"` instead")}function xc(e){return function(e){return Boolean(e&&"object"==typeof e&&"message"in e&&"messages"in e)}(e)?e:new uc(e)}function Cc(e,t){var{includeImageAlt:n=!0}=t||{};return Sc(e,n)}function Sc(e,t){return e&&"object"==typeof e&&(e.value||(t?e.alt:"")||"children"in e&&Mc(e.children,t)||Array.isArray(e)&&Mc(e,t))||""}function Mc(e,t){for(var n=[],r=-1;++r<e.length;)n[r]=Sc(e[r],t);return n.join("")}function Oc(e,t,n,r){const o=e.length;let i,s=0;if(t=t<0?-t>o?0:o+t:t>o?o:t,n=n>0?n:0,r.length<1e4)i=Array.from(r),i.unshift(t,n),[].splice.apply(e,i);else for(n&&[].splice.apply(e,[t,n]);s<r.length;)i=r.slice(s,s+1e4),i.unshift(t,0),[].splice.apply(e,i),s+=1e4,t+=1e4}function Ac(e,t){return e.length>0?(Oc(e,e.length,0,t),e):t}const Ec={}.hasOwnProperty;function Tc(e){const t={};let n=-1;for(;++n<e.length;)Nc(t,e[n]);return t}function Nc(e,t){let n;for(n in t){const r=(Ec.call(e,n)?e[n]:void 0)||(e[n]={}),o=t[n];let i;for(i in o){Ec.call(r,i)||(r[i]=[]);const e=o[i];Dc(r[i],Array.isArray(e)?e:e?[e]:[])}}}function Dc(e,t){let n=-1;const r=[];for(;++n<t.length;)("after"===t[n].add?e:r).push(t[n]);Oc(e,0,0,r)}const Ic=Wc(/[A-Za-z]/),zc=Wc(/\d/),Fc=Wc(/[\dA-Fa-f]/),Rc=Wc(/[\dA-Za-z]/),$c=Wc(/[!-/:-@[-`{-~]/),_c=Wc(/[#-'*+\--9=?A-Z^-~]/);function Pc(e){return null!==e&&(e<32||127===e)}function jc(e){return null!==e&&(e<0||32===e)}function Lc(e){return null!==e&&e<-2}function Bc(e){return-2===e||-1===e||32===e}const Vc=Wc(/\s/),Hc=Wc(/[!-/:-@[-`{-~\u00A1\u00A7\u00AB\u00B6\u00B7\u00BB\u00BF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061E\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C77\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4F\u2E52\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]/);function Wc(e){return function(t){return null!==t&&e.test(String.fromCharCode(t))}}function qc(e,t,n,r){const o=r?r-1:Number.POSITIVE_INFINITY;let i=0;return function(r){if(Bc(r))return e.enter(n),s(r);return t(r)};function s(r){return Bc(r)&&i++<o?(e.consume(r),s):(e.exit(n),t(r))}}const Jc={tokenize:function(e){const t=e.attempt(this.parser.constructs.contentInitial,(function(n){if(null===n)return void e.consume(n);return e.enter("lineEnding"),e.consume(n),e.exit("lineEnding"),qc(e,t,"linePrefix")}),(function(t){return e.enter("paragraph"),r(t)}));let n;return t;function r(t){const r=e.enter("chunkText",{contentType:"text",previous:n});return n&&(n.next=r),n=r,o(t)}function o(t){return null===t?(e.exit("chunkText"),e.exit("paragraph"),void e.consume(t)):Lc(t)?(e.consume(t),e.exit("chunkText"),r):(e.consume(t),o)}}};const Kc={tokenize:function(e){const t=this,n=[];let r,o,i,s=0;return a;function a(r){if(s<n.length){const o=n[s];return t.containerState=o[1],e.attempt(o[0].continuation,c,l)(r)}return l(r)}function c(e){if(s++,t.containerState._closeFlow){t.containerState._closeFlow=void 0,r&&y();const n=t.events.length;let o,i=n;for(;i--;)if("exit"===t.events[i][0]&&"chunkFlow"===t.events[i][1].type){o=t.events[i][1].end;break}v(s);let a=n;for(;a<t.events.length;)t.events[a][1].end=Object.assign({},o),a++;return Oc(t.events,i+1,0,t.events.slice(n)),t.events.length=a,l(e)}return a(e)}function l(o){if(s===n.length){if(!r)return d(o);if(r.currentConstruct&&r.currentConstruct.concrete)return h(o);t.interrupt=Boolean(r.currentConstruct&&!r._gfmTableDynamicInterruptHack)}return t.containerState={},e.check(Uc,u,f)(o)}function u(e){return r&&y(),v(s),d(e)}function f(e){return t.parser.lazy[t.now().line]=s!==n.length,i=t.now().offset,h(e)}function d(n){return t.containerState={},e.attempt(Uc,p,h)(n)}function p(e){return s++,n.push([t.currentConstruct,t.containerState]),d(e)}function h(n){return null===n?(r&&y(),v(0),void e.consume(n)):(r=r||t.parser.flow(t.now()),e.enter("chunkFlow",{contentType:"flow",previous:o,_tokenizer:r}),m(n))}function m(n){return null===n?(g(e.exit("chunkFlow"),!0),v(0),void e.consume(n)):Lc(n)?(e.consume(n),g(e.exit("chunkFlow")),s=0,t.interrupt=void 0,a):(e.consume(n),m)}function g(e,n){const a=t.sliceStream(e);if(n&&a.push(null),e.previous=o,o&&(o.next=e),o=e,r.defineSkip(e.start),r.write(a),t.parser.lazy[e.start.line]){let e=r.events.length;for(;e--;)if(r.events[e][1].start.offset<i&&(!r.events[e][1].end||r.events[e][1].end.offset>i))return;const n=t.events.length;let o,a,c=n;for(;c--;)if("exit"===t.events[c][0]&&"chunkFlow"===t.events[c][1].type){if(o){a=t.events[c][1].end;break}o=!0}for(v(s),e=n;e<t.events.length;)t.events[e][1].end=Object.assign({},a),e++;Oc(t.events,c+1,0,t.events.slice(n)),t.events.length=e}}function v(r){let o=n.length;for(;o-- >r;){const r=n[o];t.containerState=r[1],r[0].exit.call(t,e)}n.length=r}function y(){r.write([null]),o=void 0,r=void 0,t.containerState._closeFlow=void 0}}},Uc={tokenize:function(e,t,n){return qc(e,e.attempt(this.parser.constructs.document,t,n),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}};function Gc(e){return null===e||jc(e)||Vc(e)?1:Hc(e)?2:void 0}function Qc(e,t,n){const r=[];let o=-1;for(;++o<e.length;){const i=e[o].resolveAll;i&&!r.includes(i)&&(t=i(t,n),r.push(i))}return t}const Zc={name:"attention",tokenize:function(e,t){const n=this.parser.constructs.attentionMarkers.null,r=this.previous,o=Gc(r);let i;return function(t){return e.enter("attentionSequence"),i=t,s(t)};function s(a){if(a===i)return e.consume(a),s;const c=e.exit("attentionSequence"),l=Gc(a),u=!l||2===l&&o||n.includes(a),f=!o||2===o&&l||n.includes(r);return c._open=Boolean(42===i?u:u&&(o||!f)),c._close=Boolean(42===i?f:f&&(l||!u)),t(a)}},resolveAll:function(e,t){let n,r,o,i,s,a,c,l,u=-1;for(;++u<e.length;)if("enter"===e[u][0]&&"attentionSequence"===e[u][1].type&&e[u][1]._close)for(n=u;n--;)if("exit"===e[n][0]&&"attentionSequence"===e[n][1].type&&e[n][1]._open&&t.sliceSerialize(e[n][1]).charCodeAt(0)===t.sliceSerialize(e[u][1]).charCodeAt(0)){if((e[n][1]._close||e[u][1]._open)&&(e[u][1].end.offset-e[u][1].start.offset)%3&&!((e[n][1].end.offset-e[n][1].start.offset+e[u][1].end.offset-e[u][1].start.offset)%3))continue;a=e[n][1].end.offset-e[n][1].start.offset>1&&e[u][1].end.offset-e[u][1].start.offset>1?2:1;const f=Object.assign({},e[n][1].end),d=Object.assign({},e[u][1].start);Xc(f,-a),Xc(d,a),i={type:a>1?"strongSequence":"emphasisSequence",start:f,end:Object.assign({},e[n][1].end)},s={type:a>1?"strongSequence":"emphasisSequence",start:Object.assign({},e[u][1].start),end:d},o={type:a>1?"strongText":"emphasisText",start:Object.assign({},e[n][1].end),end:Object.assign({},e[u][1].start)},r={type:a>1?"strong":"emphasis",start:Object.assign({},i.start),end:Object.assign({},s.end)},e[n][1].end=Object.assign({},i.start),e[u][1].start=Object.assign({},s.end),c=[],e[n][1].end.offset-e[n][1].start.offset&&(c=Ac(c,[["enter",e[n][1],t],["exit",e[n][1],t]])),c=Ac(c,[["enter",r,t],["enter",i,t],["exit",i,t],["enter",o,t]]),c=Ac(c,Qc(t.parser.constructs.insideSpan.null,e.slice(n+1,u),t)),c=Ac(c,[["exit",o,t],["enter",s,t],["exit",s,t],["exit",r,t]]),e[u][1].end.offset-e[u][1].start.offset?(l=2,c=Ac(c,[["enter",e[u][1],t],["exit",e[u][1],t]])):l=0,Oc(e,n-1,u-n+3,c),u=n+c.length-l-2;break}u=-1;for(;++u<e.length;)"attentionSequence"===e[u][1].type&&(e[u][1].type="data");return e}};function Xc(e,t){e.column+=t,e.offset+=t,e._bufferIndex+=t}const Yc={name:"autolink",tokenize:function(e,t,n){let r=1;return function(t){return e.enter("autolink"),e.enter("autolinkMarker"),e.consume(t),e.exit("autolinkMarker"),e.enter("autolinkProtocol"),o};function o(t){return Ic(t)?(e.consume(t),i):_c(t)?c(t):n(t)}function i(e){return 43===e||45===e||46===e||Rc(e)?s(e):c(e)}function s(t){return 58===t?(e.consume(t),a):(43===t||45===t||46===t||Rc(t))&&r++<32?(e.consume(t),s):c(t)}function a(t){return 62===t?(e.exit("autolinkProtocol"),d(t)):null===t||32===t||60===t||Pc(t)?n(t):(e.consume(t),a)}function c(t){return 64===t?(e.consume(t),r=0,l):_c(t)?(e.consume(t),c):n(t)}function l(e){return Rc(e)?u(e):n(e)}function u(t){return 46===t?(e.consume(t),r=0,l):62===t?(e.exit("autolinkProtocol").type="autolinkEmail",d(t)):f(t)}function f(t){return(45===t||Rc(t))&&r++<63?(e.consume(t),45===t?f:u):n(t)}function d(n){return e.enter("autolinkMarker"),e.consume(n),e.exit("autolinkMarker"),e.exit("autolink"),t}}};const el={tokenize:function(e,t,n){return qc(e,(function(e){return null===e||Lc(e)?t(e):n(e)}),"linePrefix")},partial:!0};const tl={name:"blockQuote",tokenize:function(e,t,n){const r=this;return function(t){if(62===t){const n=r.containerState;return n.open||(e.enter("blockQuote",{_container:!0}),n.open=!0),e.enter("blockQuotePrefix"),e.enter("blockQuoteMarker"),e.consume(t),e.exit("blockQuoteMarker"),o}return n(t)};function o(n){return Bc(n)?(e.enter("blockQuotePrefixWhitespace"),e.consume(n),e.exit("blockQuotePrefixWhitespace"),e.exit("blockQuotePrefix"),t):(e.exit("blockQuotePrefix"),t(n))}},continuation:{tokenize:function(e,t,n){return qc(e,e.attempt(tl,t,n),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}},exit:function(e){e.exit("blockQuote")}};const nl={name:"characterEscape",tokenize:function(e,t,n){return function(t){return e.enter("characterEscape"),e.enter("escapeMarker"),e.consume(t),e.exit("escapeMarker"),r};function r(r){return $c(r)?(e.enter("characterEscapeValue"),e.consume(r),e.exit("characterEscapeValue"),e.exit("characterEscape"),t):n(r)}}};const rl=document.createElement("i");function ol(e){const t="&"+e+";";rl.innerHTML=t;const n=rl.textContent;return(59!==n.charCodeAt(n.length-1)||"semi"===e)&&(n!==t&&n)}const il={name:"characterReference",tokenize:function(e,t,n){const r=this;let o,i,s=0;return function(t){return e.enter("characterReference"),e.enter("characterReferenceMarker"),e.consume(t),e.exit("characterReferenceMarker"),a};function a(t){return 35===t?(e.enter("characterReferenceMarkerNumeric"),e.consume(t),e.exit("characterReferenceMarkerNumeric"),c):(e.enter("characterReferenceValue"),o=31,i=Rc,l(t))}function c(t){return 88===t||120===t?(e.enter("characterReferenceMarkerHexadecimal"),e.consume(t),e.exit("characterReferenceMarkerHexadecimal"),e.enter("characterReferenceValue"),o=6,i=Fc,l):(e.enter("characterReferenceValue"),o=7,i=zc,l(t))}function l(a){let c;return 59===a&&s?(c=e.exit("characterReferenceValue"),i!==Rc||ol(r.sliceSerialize(c))?(e.enter("characterReferenceMarker"),e.consume(a),e.exit("characterReferenceMarker"),e.exit("characterReference"),t):n(a)):i(a)&&s++<o?(e.consume(a),l):n(a)}}};const sl={name:"codeFenced",tokenize:function(e,t,n){const r=this,o={tokenize:function(e,t,n){let r=0;return qc(e,o,"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4);function o(t){return e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),i(t)}function i(t){return t===c?(e.consume(t),r++,i):r<l?n(t):(e.exit("codeFencedFenceSequence"),qc(e,s,"whitespace")(t))}function s(r){return null===r||Lc(r)?(e.exit("codeFencedFence"),t(r)):n(r)}},partial:!0},i={tokenize:function(e,t,n){const r=this;return o;function o(t){return e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),i}function i(e){return r.parser.lazy[r.now().line]?n(e):t(e)}},partial:!0},s=this.events[this.events.length-1],a=s&&"linePrefix"===s[1].type?s[2].sliceSerialize(s[1],!0).length:0;let c,l=0;return function(t){return e.enter("codeFenced"),e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),c=t,u(t)};function u(t){return t===c?(e.consume(t),l++,u):(e.exit("codeFencedFenceSequence"),l<3?n(t):qc(e,f,"whitespace")(t))}function f(t){return null===t||Lc(t)?m(t):(e.enter("codeFencedFenceInfo"),e.enter("chunkString",{contentType:"string"}),d(t))}function d(t){return null===t||jc(t)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),qc(e,p,"whitespace")(t)):96===t&&t===c?n(t):(e.consume(t),d)}function p(t){return null===t||Lc(t)?m(t):(e.enter("codeFencedFenceMeta"),e.enter("chunkString",{contentType:"string"}),h(t))}function h(t){return null===t||Lc(t)?(e.exit("chunkString"),e.exit("codeFencedFenceMeta"),m(t)):96===t&&t===c?n(t):(e.consume(t),h)}function m(n){return e.exit("codeFencedFence"),r.interrupt?t(n):g(n)}function g(t){return null===t?y(t):Lc(t)?e.attempt(i,e.attempt(o,y,a?qc(e,g,"linePrefix",a+1):g),y)(t):(e.enter("codeFlowValue"),v(t))}function v(t){return null===t||Lc(t)?(e.exit("codeFlowValue"),g(t)):(e.consume(t),v)}function y(n){return e.exit("codeFenced"),t(n)}},concrete:!0};const al={name:"codeIndented",tokenize:function(e,t,n){const r=this;return function(t){return e.enter("codeIndented"),qc(e,o,"linePrefix",5)(t)};function o(e){const t=r.events[r.events.length-1];return t&&"linePrefix"===t[1].type&&t[2].sliceSerialize(t[1],!0).length>=4?i(e):n(e)}function i(t){return null===t?a(t):Lc(t)?e.attempt(cl,i,a)(t):(e.enter("codeFlowValue"),s(t))}function s(t){return null===t||Lc(t)?(e.exit("codeFlowValue"),i(t)):(e.consume(t),s)}function a(n){return e.exit("codeIndented"),t(n)}}},cl={tokenize:function(e,t,n){const r=this;return o;function o(t){return r.parser.lazy[r.now().line]?n(t):Lc(t)?(e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),o):qc(e,i,"linePrefix",5)(t)}function i(e){const i=r.events[r.events.length-1];return i&&"linePrefix"===i[1].type&&i[2].sliceSerialize(i[1],!0).length>=4?t(e):Lc(e)?o(e):n(e)}},partial:!0};const ll={name:"codeText",tokenize:function(e,t,n){let r,o,i=0;return function(t){return e.enter("codeText"),e.enter("codeTextSequence"),s(t)};function s(t){return 96===t?(e.consume(t),i++,s):(e.exit("codeTextSequence"),a(t))}function a(t){return null===t?n(t):96===t?(o=e.enter("codeTextSequence"),r=0,l(t)):32===t?(e.enter("space"),e.consume(t),e.exit("space"),a):Lc(t)?(e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),a):(e.enter("codeTextData"),c(t))}function c(t){return null===t||32===t||96===t||Lc(t)?(e.exit("codeTextData"),a(t)):(e.consume(t),c)}function l(n){return 96===n?(e.consume(n),r++,l):r===i?(e.exit("codeTextSequence"),e.exit("codeText"),t(n)):(o.type="codeTextData",c(n))}},resolve:function(e){let t,n,r=e.length-4,o=3;if(!("lineEnding"!==e[o][1].type&&"space"!==e[o][1].type||"lineEnding"!==e[r][1].type&&"space"!==e[r][1].type))for(t=o;++t<r;)if("codeTextData"===e[t][1].type){e[o][1].type="codeTextPadding",e[r][1].type="codeTextPadding",o+=2,r-=2;break}t=o-1,r++;for(;++t<=r;)void 0===n?t!==r&&"lineEnding"!==e[t][1].type&&(n=t):t!==r&&"lineEnding"!==e[t][1].type||(e[n][1].type="codeTextData",t!==n+2&&(e[n][1].end=e[t-1][1].end,e.splice(n+2,t-n-2),r-=t-n-2,t=n+2),n=void 0);return e},previous:function(e){return 96!==e||"characterEscape"===this.events[this.events.length-1][1].type}};function ul(e){const t={};let n,r,o,i,s,a,c,l=-1;for(;++l<e.length;){for(;l in t;)l=t[l];if(n=e[l],l&&"chunkFlow"===n[1].type&&"listItemPrefix"===e[l-1][1].type&&(a=n[1]._tokenizer.events,o=0,o<a.length&&"lineEndingBlank"===a[o][1].type&&(o+=2),o<a.length&&"content"===a[o][1].type))for(;++o<a.length&&"content"!==a[o][1].type;)"chunkText"===a[o][1].type&&(a[o][1]._isInFirstContentOfListItem=!0,o++);if("enter"===n[0])n[1].contentType&&(Object.assign(t,fl(e,l)),l=t[l],c=!0);else if(n[1]._container){for(o=l,r=void 0;o--&&(i=e[o],"lineEnding"===i[1].type||"lineEndingBlank"===i[1].type);)"enter"===i[0]&&(r&&(e[r][1].type="lineEndingBlank"),i[1].type="lineEnding",r=o);r&&(n[1].end=Object.assign({},e[r][1].start),s=e.slice(r,l),s.unshift(n),Oc(e,r,l-r+1,s))}}return!c}function fl(e,t){const n=e[t][1],r=e[t][2];let o=t-1;const i=[],s=n._tokenizer||r.parser[n.contentType](n.start),a=s.events,c=[],l={};let u,f,d=-1,p=n,h=0,m=0;const g=[m];for(;p;){for(;e[++o][1]!==p;);i.push(o),p._tokenizer||(u=r.sliceStream(p),p.next||u.push(null),f&&s.defineSkip(p.start),p._isInFirstContentOfListItem&&(s._gfmTasklistFirstContentOfListItem=!0),s.write(u),p._isInFirstContentOfListItem&&(s._gfmTasklistFirstContentOfListItem=void 0)),f=p,p=p.next}for(p=n;++d<a.length;)"exit"===a[d][0]&&"enter"===a[d-1][0]&&a[d][1].type===a[d-1][1].type&&a[d][1].start.line!==a[d][1].end.line&&(m=d+1,g.push(m),p._tokenizer=void 0,p.previous=void 0,p=p.next);for(s.events=[],p?(p._tokenizer=void 0,p.previous=void 0):g.pop(),d=g.length;d--;){const t=a.slice(g[d],g[d+1]),n=i.pop();c.unshift([n,n+t.length-1]),Oc(e,n,2,t)}for(d=-1;++d<c.length;)l[h+c[d][0]]=h+c[d][1],h+=c[d][1]-c[d][0]-1;return l}const dl={tokenize:function(e,t){let n;return function(t){return e.enter("content"),n=e.enter("chunkContent",{contentType:"content"}),r(t)};function r(t){return null===t?o(t):Lc(t)?e.check(pl,i,o)(t):(e.consume(t),r)}function o(n){return e.exit("chunkContent"),e.exit("content"),t(n)}function i(t){return e.consume(t),e.exit("chunkContent"),n.next=e.enter("chunkContent",{contentType:"content",previous:n}),n=n.next,r}},resolve:function(e){return ul(e),e}},pl={tokenize:function(e,t,n){const r=this;return function(t){return e.exit("chunkContent"),e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),qc(e,o,"linePrefix")};function o(o){if(null===o||Lc(o))return n(o);const i=r.events[r.events.length-1];return!r.parser.constructs.disable.null.includes("codeIndented")&&i&&"linePrefix"===i[1].type&&i[2].sliceSerialize(i[1],!0).length>=4?t(o):e.interrupt(r.parser.constructs.flow,n,t)(o)}},partial:!0};function hl(e,t,n,r,o,i,s,a,c){const l=c||Number.POSITIVE_INFINITY;let u=0;return function(t){if(60===t)return e.enter(r),e.enter(o),e.enter(i),e.consume(t),e.exit(i),f;if(null===t||41===t||Pc(t))return n(t);return e.enter(r),e.enter(s),e.enter(a),e.enter("chunkString",{contentType:"string"}),h(t)};function f(n){return 62===n?(e.enter(i),e.consume(n),e.exit(i),e.exit(o),e.exit(r),t):(e.enter(a),e.enter("chunkString",{contentType:"string"}),d(n))}function d(t){return 62===t?(e.exit("chunkString"),e.exit(a),f(t)):null===t||60===t||Lc(t)?n(t):(e.consume(t),92===t?p:d)}function p(t){return 60===t||62===t||92===t?(e.consume(t),d):d(t)}function h(o){return 40===o?++u>l?n(o):(e.consume(o),h):41===o?u--?(e.consume(o),h):(e.exit("chunkString"),e.exit(a),e.exit(s),e.exit(r),t(o)):null===o||jc(o)?u?n(o):(e.exit("chunkString"),e.exit(a),e.exit(s),e.exit(r),t(o)):Pc(o)?n(o):(e.consume(o),92===o?m:h)}function m(t){return 40===t||41===t||92===t?(e.consume(t),h):h(t)}}function ml(e,t,n,r,o,i){const s=this;let a,c=0;return function(t){return e.enter(r),e.enter(o),e.consume(t),e.exit(o),e.enter(i),l};function l(f){return null===f||91===f||93===f&&!a||94===f&&!c&&"_hiddenFootnoteSupport"in s.parser.constructs||c>999?n(f):93===f?(e.exit(i),e.enter(o),e.consume(f),e.exit(o),e.exit(r),t):Lc(f)?(e.enter("lineEnding"),e.consume(f),e.exit("lineEnding"),l):(e.enter("chunkString",{contentType:"string"}),u(f))}function u(t){return null===t||91===t||93===t||Lc(t)||c++>999?(e.exit("chunkString"),l(t)):(e.consume(t),a=a||!Bc(t),92===t?f:u)}function f(t){return 91===t||92===t||93===t?(e.consume(t),c++,u):u(t)}}function gl(e,t,n,r,o,i){let s;return function(t){return e.enter(r),e.enter(o),e.consume(t),e.exit(o),s=40===t?41:t,a};function a(n){return n===s?(e.enter(o),e.consume(n),e.exit(o),e.exit(r),t):(e.enter(i),c(n))}function c(t){return t===s?(e.exit(i),a(s)):null===t?n(t):Lc(t)?(e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),qc(e,c,"linePrefix")):(e.enter("chunkString",{contentType:"string"}),l(t))}function l(t){return t===s||null===t||Lc(t)?(e.exit("chunkString"),c(t)):(e.consume(t),92===t?u:l)}function u(t){return t===s||92===t?(e.consume(t),l):l(t)}}function vl(e,t){let n;return function r(o){if(Lc(o))return e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),n=!0,r;if(Bc(o))return qc(e,r,n?"linePrefix":"lineSuffix")(o);return t(o)}}function yl(e){return e.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const bl={name:"definition",tokenize:function(e,t,n){const r=this;let o;return function(t){return e.enter("definition"),ml.call(r,e,i,n,"definitionLabel","definitionLabelMarker","definitionLabelString")(t)};function i(t){return o=yl(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)),58===t?(e.enter("definitionMarker"),e.consume(t),e.exit("definitionMarker"),vl(e,hl(e,e.attempt(wl,qc(e,s,"whitespace"),qc(e,s,"whitespace")),n,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString"))):n(t)}function s(i){return null===i||Lc(i)?(e.exit("definition"),r.parser.defined.includes(o)||r.parser.defined.push(o),t(i)):n(i)}}},wl={tokenize:function(e,t,n){return function(t){return jc(t)?vl(e,r)(t):n(t)};function r(t){return 34===t||39===t||40===t?gl(e,qc(e,o,"whitespace"),n,"definitionTitle","definitionTitleMarker","definitionTitleString")(t):n(t)}function o(e){return null===e||Lc(e)?t(e):n(e)}},partial:!0};const kl={name:"hardBreakEscape",tokenize:function(e,t,n){return function(t){return e.enter("hardBreakEscape"),e.enter("escapeMarker"),e.consume(t),r};function r(r){return Lc(r)?(e.exit("escapeMarker"),e.exit("hardBreakEscape"),t(r)):n(r)}}};const xl={name:"headingAtx",tokenize:function(e,t,n){const r=this;let o=0;return function(t){return e.enter("atxHeading"),e.enter("atxHeadingSequence"),i(t)};function i(a){return 35===a&&o++<6?(e.consume(a),i):null===a||jc(a)?(e.exit("atxHeadingSequence"),r.interrupt?t(a):s(a)):n(a)}function s(n){return 35===n?(e.enter("atxHeadingSequence"),a(n)):null===n||Lc(n)?(e.exit("atxHeading"),t(n)):Bc(n)?qc(e,s,"whitespace")(n):(e.enter("atxHeadingText"),c(n))}function a(t){return 35===t?(e.consume(t),a):(e.exit("atxHeadingSequence"),s(t))}function c(t){return null===t||35===t||jc(t)?(e.exit("atxHeadingText"),s(t)):(e.consume(t),c)}},resolve:function(e,t){let n,r,o=e.length-2,i=3;"whitespace"===e[i][1].type&&(i+=2);o-2>i&&"whitespace"===e[o][1].type&&(o-=2);"atxHeadingSequence"===e[o][1].type&&(i===o-1||o-4>i&&"whitespace"===e[o-2][1].type)&&(o-=i+1===o?2:4);o>i&&(n={type:"atxHeadingText",start:e[i][1].start,end:e[o][1].end},r={type:"chunkText",start:e[i][1].start,end:e[o][1].end,contentType:"text"},Oc(e,i,o-i+1,[["enter",n,t],["enter",r,t],["exit",r,t],["exit",n,t]]));return e}};const Cl=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","section","source","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],Sl=["pre","script","style","textarea"],Ml={name:"htmlFlow",tokenize:function(e,t,n){const r=this;let o,i,s,a,c;return function(t){return e.enter("htmlFlow"),e.enter("htmlFlowData"),e.consume(t),l};function l(a){return 33===a?(e.consume(a),u):47===a?(e.consume(a),p):63===a?(e.consume(a),o=3,r.interrupt?t:F):Ic(a)?(e.consume(a),s=String.fromCharCode(a),i=!0,h):n(a)}function u(i){return 45===i?(e.consume(i),o=2,f):91===i?(e.consume(i),o=5,s="CDATA[",a=0,d):Ic(i)?(e.consume(i),o=4,r.interrupt?t:F):n(i)}function f(o){return 45===o?(e.consume(o),r.interrupt?t:F):n(o)}function d(o){return o===s.charCodeAt(a++)?(e.consume(o),a===s.length?r.interrupt?t:O:d):n(o)}function p(t){return Ic(t)?(e.consume(t),s=String.fromCharCode(t),h):n(t)}function h(a){return null===a||47===a||62===a||jc(a)?47!==a&&i&&Sl.includes(s.toLowerCase())?(o=1,r.interrupt?t(a):O(a)):Cl.includes(s.toLowerCase())?(o=6,47===a?(e.consume(a),m):r.interrupt?t(a):O(a)):(o=7,r.interrupt&&!r.parser.lazy[r.now().line]?n(a):i?v(a):g(a)):45===a||Rc(a)?(e.consume(a),s+=String.fromCharCode(a),h):n(a)}function m(o){return 62===o?(e.consume(o),r.interrupt?t:O):n(o)}function g(t){return Bc(t)?(e.consume(t),g):S(t)}function v(t){return 47===t?(e.consume(t),S):58===t||95===t||Ic(t)?(e.consume(t),y):Bc(t)?(e.consume(t),v):S(t)}function y(t){return 45===t||46===t||58===t||95===t||Rc(t)?(e.consume(t),y):b(t)}function b(t){return 61===t?(e.consume(t),w):Bc(t)?(e.consume(t),b):v(t)}function w(t){return null===t||60===t||61===t||62===t||96===t?n(t):34===t||39===t?(e.consume(t),c=t,k):Bc(t)?(e.consume(t),w):(c=null,x(t))}function k(t){return null===t||Lc(t)?n(t):t===c?(e.consume(t),C):(e.consume(t),k)}function x(t){return null===t||34===t||39===t||60===t||61===t||62===t||96===t||jc(t)?b(t):(e.consume(t),x)}function C(e){return 47===e||62===e||Bc(e)?v(e):n(e)}function S(t){return 62===t?(e.consume(t),M):n(t)}function M(t){return Bc(t)?(e.consume(t),M):null===t||Lc(t)?O(t):n(t)}function O(t){return 45===t&&2===o?(e.consume(t),N):60===t&&1===o?(e.consume(t),D):62===t&&4===o?(e.consume(t),R):63===t&&3===o?(e.consume(t),F):93===t&&5===o?(e.consume(t),z):!Lc(t)||6!==o&&7!==o?null===t||Lc(t)?A(t):(e.consume(t),O):e.check(Ol,R,A)(t)}function A(t){return e.exit("htmlFlowData"),E(t)}function E(t){return null===t?$(t):Lc(t)?e.attempt({tokenize:T,partial:!0},E,$)(t):(e.enter("htmlFlowData"),O(t))}function T(e,t,n){return function(t){return e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),o};function o(e){return r.parser.lazy[r.now().line]?n(e):t(e)}}function N(t){return 45===t?(e.consume(t),F):O(t)}function D(t){return 47===t?(e.consume(t),s="",I):O(t)}function I(t){return 62===t&&Sl.includes(s.toLowerCase())?(e.consume(t),R):Ic(t)&&s.length<8?(e.consume(t),s+=String.fromCharCode(t),I):O(t)}function z(t){return 93===t?(e.consume(t),F):O(t)}function F(t){return 62===t?(e.consume(t),R):45===t&&2===o?(e.consume(t),F):O(t)}function R(t){return null===t||Lc(t)?(e.exit("htmlFlowData"),$(t)):(e.consume(t),R)}function $(n){return e.exit("htmlFlow"),t(n)}},resolveTo:function(e){let t=e.length;for(;t--&&("enter"!==e[t][0]||"htmlFlow"!==e[t][1].type););t>1&&"linePrefix"===e[t-2][1].type&&(e[t][1].start=e[t-2][1].start,e[t+1][1].start=e[t-2][1].start,e.splice(t-2,2));return e},concrete:!0},Ol={tokenize:function(e,t,n){return function(r){return e.exit("htmlFlowData"),e.enter("lineEndingBlank"),e.consume(r),e.exit("lineEndingBlank"),e.attempt(el,t,n)}},partial:!0};const Al={name:"htmlText",tokenize:function(e,t,n){const r=this;let o,i,s,a;return function(t){return e.enter("htmlText"),e.enter("htmlTextData"),e.consume(t),c};function c(t){return 33===t?(e.consume(t),l):47===t?(e.consume(t),x):63===t?(e.consume(t),w):Ic(t)?(e.consume(t),M):n(t)}function l(t){return 45===t?(e.consume(t),u):91===t?(e.consume(t),i="CDATA[",s=0,m):Ic(t)?(e.consume(t),b):n(t)}function u(t){return 45===t?(e.consume(t),f):n(t)}function f(t){return null===t||62===t?n(t):45===t?(e.consume(t),d):p(t)}function d(e){return null===e||62===e?n(e):p(e)}function p(t){return null===t?n(t):45===t?(e.consume(t),h):Lc(t)?(a=p,z(t)):(e.consume(t),p)}function h(t){return 45===t?(e.consume(t),R):p(t)}function m(t){return t===i.charCodeAt(s++)?(e.consume(t),s===i.length?g:m):n(t)}function g(t){return null===t?n(t):93===t?(e.consume(t),v):Lc(t)?(a=g,z(t)):(e.consume(t),g)}function v(t){return 93===t?(e.consume(t),y):g(t)}function y(t){return 62===t?R(t):93===t?(e.consume(t),y):g(t)}function b(t){return null===t||62===t?R(t):Lc(t)?(a=b,z(t)):(e.consume(t),b)}function w(t){return null===t?n(t):63===t?(e.consume(t),k):Lc(t)?(a=w,z(t)):(e.consume(t),w)}function k(e){return 62===e?R(e):w(e)}function x(t){return Ic(t)?(e.consume(t),C):n(t)}function C(t){return 45===t||Rc(t)?(e.consume(t),C):S(t)}function S(t){return Lc(t)?(a=S,z(t)):Bc(t)?(e.consume(t),S):R(t)}function M(t){return 45===t||Rc(t)?(e.consume(t),M):47===t||62===t||jc(t)?O(t):n(t)}function O(t){return 47===t?(e.consume(t),R):58===t||95===t||Ic(t)?(e.consume(t),A):Lc(t)?(a=O,z(t)):Bc(t)?(e.consume(t),O):R(t)}function A(t){return 45===t||46===t||58===t||95===t||Rc(t)?(e.consume(t),A):E(t)}function E(t){return 61===t?(e.consume(t),T):Lc(t)?(a=E,z(t)):Bc(t)?(e.consume(t),E):O(t)}function T(t){return null===t||60===t||61===t||62===t||96===t?n(t):34===t||39===t?(e.consume(t),o=t,N):Lc(t)?(a=T,z(t)):Bc(t)?(e.consume(t),T):(e.consume(t),o=void 0,I)}function N(t){return t===o?(e.consume(t),D):null===t?n(t):Lc(t)?(a=N,z(t)):(e.consume(t),N)}function D(e){return 62===e||47===e||jc(e)?O(e):n(e)}function I(t){return null===t||34===t||39===t||60===t||61===t||96===t?n(t):62===t||jc(t)?O(t):(e.consume(t),I)}function z(t){return e.exit("htmlTextData"),e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),qc(e,F,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function F(t){return e.enter("htmlTextData"),a(t)}function R(r){return 62===r?(e.consume(r),e.exit("htmlTextData"),e.exit("htmlText"),t):n(r)}}};const El={name:"labelEnd",tokenize:function(e,t,n){const r=this;let o,i,s=r.events.length;for(;s--;)if(("labelImage"===r.events[s][1].type||"labelLink"===r.events[s][1].type)&&!r.events[s][1]._balanced){o=r.events[s][1];break}return function(t){if(!o)return n(t);return o._inactive?c(t):(i=r.parser.defined.includes(yl(r.sliceSerialize({start:o.end,end:r.now()}))),e.enter("labelEnd"),e.enter("labelMarker"),e.consume(t),e.exit("labelMarker"),e.exit("labelEnd"),a)};function a(n){return 40===n?e.attempt(Tl,t,i?t:c)(n):91===n?e.attempt(Nl,t,i?e.attempt(Dl,t,c):c)(n):i?t(n):c(n)}function c(e){return o._balanced=!0,n(e)}},resolveTo:function(e,t){let n,r,o,i,s=e.length,a=0;for(;s--;)if(n=e[s][1],r){if("link"===n.type||"labelLink"===n.type&&n._inactive)break;"enter"===e[s][0]&&"labelLink"===n.type&&(n._inactive=!0)}else if(o){if("enter"===e[s][0]&&("labelImage"===n.type||"labelLink"===n.type)&&!n._balanced&&(r=s,"labelLink"!==n.type)){a=2;break}}else"labelEnd"===n.type&&(o=s);const c={type:"labelLink"===e[r][1].type?"link":"image",start:Object.assign({},e[r][1].start),end:Object.assign({},e[e.length-1][1].end)},l={type:"label",start:Object.assign({},e[r][1].start),end:Object.assign({},e[o][1].end)},u={type:"labelText",start:Object.assign({},e[r+a+2][1].end),end:Object.assign({},e[o-2][1].start)};return i=[["enter",c,t],["enter",l,t]],i=Ac(i,e.slice(r+1,r+a+3)),i=Ac(i,[["enter",u,t]]),i=Ac(i,Qc(t.parser.constructs.insideSpan.null,e.slice(r+a+4,o-3),t)),i=Ac(i,[["exit",u,t],e[o-2],e[o-1],["exit",l,t]]),i=Ac(i,e.slice(o+1)),i=Ac(i,[["exit",c,t]]),Oc(e,r,e.length,i),e},resolveAll:function(e){let t,n=-1;for(;++n<e.length;)t=e[n][1],"labelImage"!==t.type&&"labelLink"!==t.type&&"labelEnd"!==t.type||(e.splice(n+1,"labelImage"===t.type?4:2),t.type="data",n++);return e}},Tl={tokenize:function(e,t,n){return function(t){return e.enter("resource"),e.enter("resourceMarker"),e.consume(t),e.exit("resourceMarker"),vl(e,r)};function r(t){return 41===t?s(t):hl(e,o,n,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(t)}function o(t){return jc(t)?vl(e,i)(t):s(t)}function i(t){return 34===t||39===t||40===t?gl(e,vl(e,s),n,"resourceTitle","resourceTitleMarker","resourceTitleString")(t):s(t)}function s(r){return 41===r?(e.enter("resourceMarker"),e.consume(r),e.exit("resourceMarker"),e.exit("resource"),t):n(r)}}},Nl={tokenize:function(e,t,n){const r=this;return function(t){return ml.call(r,e,o,n,"reference","referenceMarker","referenceString")(t)};function o(e){return r.parser.defined.includes(yl(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)))?t(e):n(e)}}},Dl={tokenize:function(e,t,n){return function(t){return e.enter("reference"),e.enter("referenceMarker"),e.consume(t),e.exit("referenceMarker"),r};function r(r){return 93===r?(e.enter("referenceMarker"),e.consume(r),e.exit("referenceMarker"),e.exit("reference"),t):n(r)}}};const Il={name:"labelStartImage",tokenize:function(e,t,n){const r=this;return function(t){return e.enter("labelImage"),e.enter("labelImageMarker"),e.consume(t),e.exit("labelImageMarker"),o};function o(t){return 91===t?(e.enter("labelMarker"),e.consume(t),e.exit("labelMarker"),e.exit("labelImage"),i):n(t)}function i(e){return 94===e&&"_hiddenFootnoteSupport"in r.parser.constructs?n(e):t(e)}},resolveAll:El.resolveAll};const zl={name:"labelStartLink",tokenize:function(e,t,n){const r=this;return function(t){return e.enter("labelLink"),e.enter("labelMarker"),e.consume(t),e.exit("labelMarker"),e.exit("labelLink"),o};function o(e){return 94===e&&"_hiddenFootnoteSupport"in r.parser.constructs?n(e):t(e)}},resolveAll:El.resolveAll};const Fl={name:"lineEnding",tokenize:function(e,t){return function(n){return e.enter("lineEnding"),e.consume(n),e.exit("lineEnding"),qc(e,t,"linePrefix")}}};const Rl={name:"thematicBreak",tokenize:function(e,t,n){let r,o=0;return function(t){return e.enter("thematicBreak"),r=t,i(t)};function i(a){return a===r?(e.enter("thematicBreakSequence"),s(a)):Bc(a)?qc(e,i,"whitespace")(a):o<3||null!==a&&!Lc(a)?n(a):(e.exit("thematicBreak"),t(a))}function s(t){return t===r?(e.consume(t),o++,s):(e.exit("thematicBreakSequence"),i(t))}}};const $l={name:"list",tokenize:function(e,t,n){const r=this,o=r.events[r.events.length-1];let i=o&&"linePrefix"===o[1].type?o[2].sliceSerialize(o[1],!0).length:0,s=0;return function(t){const o=r.containerState.type||(42===t||43===t||45===t?"listUnordered":"listOrdered");if("listUnordered"===o?!r.containerState.marker||t===r.containerState.marker:zc(t)){if(r.containerState.type||(r.containerState.type=o,e.enter(o,{_container:!0})),"listUnordered"===o)return e.enter("listItemPrefix"),42===t||45===t?e.check(Rl,n,c)(t):c(t);if(!r.interrupt||49===t)return e.enter("listItemPrefix"),e.enter("listItemValue"),a(t)}return n(t)};function a(t){return zc(t)&&++s<10?(e.consume(t),a):(!r.interrupt||s<2)&&(r.containerState.marker?t===r.containerState.marker:41===t||46===t)?(e.exit("listItemValue"),c(t)):n(t)}function c(t){return e.enter("listItemMarker"),e.consume(t),e.exit("listItemMarker"),r.containerState.marker=r.containerState.marker||t,e.check(el,r.interrupt?n:l,e.attempt(_l,f,u))}function l(e){return r.containerState.initialBlankLine=!0,i++,f(e)}function u(t){return Bc(t)?(e.enter("listItemPrefixWhitespace"),e.consume(t),e.exit("listItemPrefixWhitespace"),f):n(t)}function f(n){return r.containerState.size=i+r.sliceSerialize(e.exit("listItemPrefix"),!0).length,t(n)}},continuation:{tokenize:function(e,t,n){const r=this;return r.containerState._closeFlow=void 0,e.check(el,(function(n){return r.containerState.furtherBlankLines=r.containerState.furtherBlankLines||r.containerState.initialBlankLine,qc(e,t,"listItemIndent",r.containerState.size+1)(n)}),(function(n){if(r.containerState.furtherBlankLines||!Bc(n))return r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,o(n);return r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,e.attempt(Pl,t,o)(n)}));function o(o){return r.containerState._closeFlow=!0,r.interrupt=void 0,qc(e,e.attempt($l,t,n),"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(o)}}},exit:function(e){e.exit(this.containerState.type)}},_l={tokenize:function(e,t,n){const r=this;return qc(e,(function(e){const o=r.events[r.events.length-1];return!Bc(e)&&o&&"listItemPrefixWhitespace"===o[1].type?t(e):n(e)}),"listItemPrefixWhitespace",r.parser.constructs.disable.null.includes("codeIndented")?void 0:5)},partial:!0},Pl={tokenize:function(e,t,n){const r=this;return qc(e,(function(e){const o=r.events[r.events.length-1];return o&&"listItemIndent"===o[1].type&&o[2].sliceSerialize(o[1],!0).length===r.containerState.size?t(e):n(e)}),"listItemIndent",r.containerState.size+1)},partial:!0};const jl={name:"setextUnderline",tokenize:function(e,t,n){const r=this;let o,i,s=r.events.length;for(;s--;)if("lineEnding"!==r.events[s][1].type&&"linePrefix"!==r.events[s][1].type&&"content"!==r.events[s][1].type){i="paragraph"===r.events[s][1].type;break}return function(t){if(!r.parser.lazy[r.now().line]&&(r.interrupt||i))return e.enter("setextHeadingLine"),e.enter("setextHeadingLineSequence"),o=t,a(t);return n(t)};function a(t){return t===o?(e.consume(t),a):(e.exit("setextHeadingLineSequence"),qc(e,c,"lineSuffix")(t))}function c(r){return null===r||Lc(r)?(e.exit("setextHeadingLine"),t(r)):n(r)}},resolveTo:function(e,t){let n,r,o,i=e.length;for(;i--;)if("enter"===e[i][0]){if("content"===e[i][1].type){n=i;break}"paragraph"===e[i][1].type&&(r=i)}else"content"===e[i][1].type&&e.splice(i,1),o||"definition"!==e[i][1].type||(o=i);const s={type:"setextHeading",start:Object.assign({},e[r][1].start),end:Object.assign({},e[e.length-1][1].end)};e[r][1].type="setextHeadingText",o?(e.splice(r,0,["enter",s,t]),e.splice(o+1,0,["exit",e[n][1],t]),e[n][1].end=Object.assign({},e[o][1].end)):e[n][1]=s;return e.push(["exit",s,t]),e}};const Ll={tokenize:function(e){const t=this,n=e.attempt(el,(function(r){if(null===r)return void e.consume(r);return e.enter("lineEndingBlank"),e.consume(r),e.exit("lineEndingBlank"),t.currentConstruct=void 0,n}),e.attempt(this.parser.constructs.flowInitial,r,qc(e,e.attempt(this.parser.constructs.flow,r,e.attempt(dl,r)),"linePrefix")));return n;function r(r){if(null!==r)return e.enter("lineEnding"),e.consume(r),e.exit("lineEnding"),t.currentConstruct=void 0,n;e.consume(r)}}};const Bl={resolveAll:ql()},Vl=Wl("string"),Hl=Wl("text");function Wl(e){return{tokenize:function(t){const n=this,r=this.parser.constructs[e],o=t.attempt(r,i,s);return i;function i(e){return c(e)?o(e):s(e)}function s(e){if(null!==e)return t.enter("data"),t.consume(e),a;t.consume(e)}function a(e){return c(e)?(t.exit("data"),o(e)):(t.consume(e),a)}function c(e){if(null===e)return!0;const t=r[e];let o=-1;if(t)for(;++o<t.length;){const e=t[o];if(!e.previous||e.previous.call(n,n.previous))return!0}return!1}},resolveAll:ql("text"===e?Jl:void 0)}}function ql(e){return function(t,n){let r,o=-1;for(;++o<=t.length;)void 0===r?t[o]&&"data"===t[o][1].type&&(r=o,o++):t[o]&&"data"===t[o][1].type||(o!==r+2&&(t[r][1].end=t[o-1][1].end,t.splice(r+2,o-r-2),o=r+2),r=void 0);return e?e(t,n):t}}function Jl(e,t){let n=0;for(;++n<=e.length;)if((n===e.length||"lineEnding"===e[n][1].type)&&"data"===e[n-1][1].type){const r=e[n-1][1],o=t.sliceStream(r);let i,s=o.length,a=-1,c=0;for(;s--;){const e=o[s];if("string"==typeof e){for(a=e.length;32===e.charCodeAt(a-1);)c++,a--;if(a)break;a=-1}else if(-2===e)i=!0,c++;else if(-1!==e){s++;break}}if(c){const o={type:n===e.length||i||c<2?"lineSuffix":"hardBreakTrailing",start:{line:r.end.line,column:r.end.column-c,offset:r.end.offset-c,_index:r.start._index+s,_bufferIndex:s?a:r.start._bufferIndex+a},end:Object.assign({},r.end)};r.end=Object.assign({},o.start),r.start.offset===r.end.offset?Object.assign(r,o):(e.splice(n,0,["enter",o,t],["exit",o,t]),n+=2)}n++}return e}function Kl(e,t,n){let r=Object.assign(n?Object.assign({},n):{line:1,column:1,offset:0},{_index:0,_bufferIndex:-1});const o={},i=[];let s=[],a=[];const c={consume:function(e){Lc(e)?(r.line++,r.column=1,r.offset+=-3===e?2:1,y()):-1!==e&&(r.column++,r.offset++);r._bufferIndex<0?r._index++:(r._bufferIndex++,r._bufferIndex===s[r._index].length&&(r._bufferIndex=-1,r._index++));l.previous=e},enter:function(e,t){const n=t||{};return n.type=e,n.start=d(),l.events.push(["enter",n,l]),a.push(n),n},exit:function(e){const t=a.pop();return t.end=d(),l.events.push(["exit",t,l]),t},attempt:g((function(e,t){v(e,t.from)})),check:g(m),interrupt:g(m,{interrupt:!0})},l={previous:null,code:null,containerState:{},events:[],parser:e,sliceStream:f,sliceSerialize:function(e,t){return function(e,t){let n=-1;const r=[];let o;for(;++n<e.length;){const i=e[n];let s;if("string"==typeof i)s=i;else switch(i){case-5:s="\r";break;case-4:s="\n";break;case-3:s="\r\n";break;case-2:s=t?" ":"\t";break;case-1:if(!t&&o)continue;s=" ";break;default:s=String.fromCharCode(i)}o=-2===i,r.push(s)}return r.join("")}(f(e),t)},now:d,defineSkip:function(e){o[e.line]=e.column,y()},write:function(e){if(s=Ac(s,e),p(),null!==s[s.length-1])return[];return v(t,0),l.events=Qc(i,l.events,l),l.events}};let u=t.tokenize.call(l,c);return t.resolveAll&&i.push(t),l;function f(e){return function(e,t){const n=t.start._index,r=t.start._bufferIndex,o=t.end._index,i=t.end._bufferIndex;let s;n===o?s=[e[n].slice(r,i)]:(s=e.slice(n,o),r>-1&&(s[0]=s[0].slice(r)),i>0&&s.push(e[o].slice(0,i)));return s}(s,e)}function d(){return Object.assign({},r)}function p(){let e;for(;r._index<s.length;){const t=s[r._index];if("string"==typeof t)for(e=r._index,r._bufferIndex<0&&(r._bufferIndex=0);r._index===e&&r._bufferIndex<t.length;)h(t.charCodeAt(r._bufferIndex));else h(t)}}function h(e){u=u(e)}function m(e,t){t.restore()}function g(e,t){return function(n,o,i){let s,u,f,p;return Array.isArray(n)?h(n):"tokenize"in n?h([n]):function(e){return t;function t(t){const n=null!==t&&e[t],r=null!==t&&e.null;return h([...Array.isArray(n)?n:n?[n]:[],...Array.isArray(r)?r:r?[r]:[]])(t)}}(n);function h(e){return s=e,u=0,0===e.length?i:m(e[u])}function m(e){return function(n){p=function(){const e=d(),t=l.previous,n=l.currentConstruct,o=l.events.length,i=Array.from(a);return{restore:s,from:o};function s(){r=e,l.previous=t,l.currentConstruct=n,l.events.length=o,a=i,y()}}(),f=e,e.partial||(l.currentConstruct=e);if(e.name&&l.parser.constructs.disable.null.includes(e.name))return v();return e.tokenize.call(t?Object.assign(Object.create(l),t):l,c,g,v)(n)}}function g(t){return e(f,p),o}function v(e){return p.restore(),++u<s.length?m(s[u]):i}}}function v(e,t){e.resolveAll&&!i.includes(e)&&i.push(e),e.resolve&&Oc(l.events,t,l.events.length-t,e.resolve(l.events.slice(t),l)),e.resolveTo&&(l.events=e.resolveTo(l.events,l))}function y(){r.line in o&&r.column<2&&(r.column=o[r.line],r.offset+=o[r.line]-1)}}const Ul={42:$l,43:$l,45:$l,48:$l,49:$l,50:$l,51:$l,52:$l,53:$l,54:$l,55:$l,56:$l,57:$l,62:tl},Gl={91:bl},Ql={[-2]:al,[-1]:al,32:al},Zl={35:xl,42:Rl,45:[jl,Rl],60:Ml,61:jl,95:Rl,96:sl,126:sl},Xl={38:il,92:nl},Yl={[-5]:Fl,[-4]:Fl,[-3]:Fl,33:Il,38:il,42:Zc,60:[Yc,Al],91:zl,92:[kl,nl],93:El,95:Zc,96:ll},eu={null:[Zc,Bl]};var tu=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",document:Ul,contentInitial:Gl,flowInitial:Ql,flow:Zl,string:Xl,text:Yl,insideSpan:eu,attentionMarkers:{null:[42,95]},disable:{null:[]}});const nu=/[\0\t\n\r]/g;function ru(e,t){const n=Number.parseInt(e,t);return n<9||11===n||n>13&&n<32||n>126&&n<160||n>55295&&n<57344||n>64975&&n<65008||65535==(65535&n)||65534==(65535&n)||n>1114111?"":String.fromCharCode(n)}const ou=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function iu(e){return e.replace(ou,su)}function su(e,t,n){if(t)return t;if(35===n.charCodeAt(0)){const e=n.charCodeAt(1),t=120===e||88===e;return ru(n.slice(t?2:1),t?16:10)}return ol(n)||e}const au={}.hasOwnProperty,cu=function(e,t,n){return"string"!=typeof t&&(n=t,t=void 0),function(e={}){const t=lu({transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:c(re),autolinkProtocol:E,autolinkEmail:E,atxHeading:c(Y),blockQuote:c(U),characterEscape:E,characterReference:E,codeFenced:c(G),codeFencedFenceInfo:l,codeFencedFenceMeta:l,codeIndented:c(G,l),codeText:c(Q,l),codeTextData:E,data:E,codeFlowValue:E,definition:c(Z),definitionDestinationString:l,definitionLabelString:l,definitionTitleString:l,emphasis:c(X),hardBreakEscape:c(ee),hardBreakTrailing:c(ee),htmlFlow:c(te,l),htmlFlowData:E,htmlText:c(te,l),htmlTextData:E,image:c(ne),label:l,link:c(re),listItem:c(ie),listItemValue:m,listOrdered:c(oe,h),listUnordered:c(oe),paragraph:c(se),reference:V,referenceString:l,resourceDestinationString:l,resourceTitleString:l,setextHeading:c(Y),strong:c(ae),thematicBreak:c(le)},exit:{atxHeading:f(),atxHeadingSequence:S,autolink:f(),autolinkEmail:K,autolinkProtocol:J,blockQuote:f(),characterEscapeValue:T,characterReferenceMarkerHexadecimal:W,characterReferenceMarkerNumeric:W,characterReferenceValue:q,codeFenced:f(b),codeFencedFence:y,codeFencedFenceInfo:g,codeFencedFenceMeta:v,codeFlowValue:T,codeIndented:f(w),codeText:f(F),codeTextData:T,data:T,definition:f(),definitionDestinationString:C,definitionLabelString:k,definitionTitleString:x,emphasis:f(),hardBreakEscape:f(D),hardBreakTrailing:f(D),htmlFlow:f(I),htmlFlowData:T,htmlText:f(z),htmlTextData:T,image:f($),label:P,labelText:_,lineEnding:N,link:f(R),listItem:f(),listOrdered:f(),listUnordered:f(),paragraph:f(),referenceString:H,resourceDestinationString:j,resourceTitleString:L,resource:B,setextHeading:f(A),setextHeadingLineSequence:O,setextHeadingText:M,strong:f(),thematicBreak:f()}},e.mdastExtensions||[]),n={};return r;function r(e){let n={type:"root",children:[]};const r=[],c=[],f={stack:[n],tokenStack:r,config:t,enter:u,exit:d,buffer:l,resume:p,setData:i,getData:s};let h=-1;for(;++h<e.length;)if("listOrdered"===e[h][1].type||"listUnordered"===e[h][1].type)if("enter"===e[h][0])c.push(h);else{h=o(e,c.pop(),h)}for(h=-1;++h<e.length;){const n=t[e[h][0]];au.call(n,e[h][1].type)&&n[e[h][1].type].call(Object.assign({sliceSerialize:e[h][2].sliceSerialize},f),e[h][1])}if(r.length>0){const e=r[r.length-1];(e[1]||fu).call(f,void 0,e[0])}for(n.position={start:a(e.length>0?e[0][1].start:{line:1,column:1,offset:0}),end:a(e.length>0?e[e.length-2][1].end:{line:1,column:1,offset:0})},h=-1;++h<t.transforms.length;)n=t.transforms[h](n)||n;return n}function o(e,t,n){let r,o,i,s,a=t-1,c=-1,l=!1;for(;++a<=n;){const t=e[a];if("listUnordered"===t[1].type||"listOrdered"===t[1].type||"blockQuote"===t[1].type?("enter"===t[0]?c++:c--,s=void 0):"lineEndingBlank"===t[1].type?"enter"===t[0]&&(!r||s||c||i||(i=a),s=void 0):"linePrefix"===t[1].type||"listItemValue"===t[1].type||"listItemMarker"===t[1].type||"listItemPrefix"===t[1].type||"listItemPrefixWhitespace"===t[1].type||(s=void 0),!c&&"enter"===t[0]&&"listItemPrefix"===t[1].type||-1===c&&"exit"===t[0]&&("listUnordered"===t[1].type||"listOrdered"===t[1].type)){if(r){let s=a;for(o=void 0;s--;){const t=e[s];if("lineEnding"===t[1].type||"lineEndingBlank"===t[1].type){if("exit"===t[0])continue;o&&(e[o][1].type="lineEndingBlank",l=!0),t[1].type="lineEnding",o=s}else if("linePrefix"!==t[1].type&&"blockQuotePrefix"!==t[1].type&&"blockQuotePrefixWhitespace"!==t[1].type&&"blockQuoteMarker"!==t[1].type&&"listItemIndent"!==t[1].type)break}i&&(!o||i<o)&&(r._spread=!0),r.end=Object.assign({},o?e[o][1].start:t[1].end),e.splice(o||a,0,["exit",r,t[2]]),a++,n++}"listItemPrefix"===t[1].type&&(r={type:"listItem",_spread:!1,start:Object.assign({},t[1].start)},e.splice(a,0,["enter",r,t[2]]),a++,n++,i=void 0,s=!0)}}return e[t][1]._spread=l,n}function i(e,t){n[e]=t}function s(e){return n[e]}function a(e){return{line:e.line,column:e.column,offset:e.offset}}function c(e,t){return n;function n(n){u.call(this,e(n),n),t&&t.call(this,n)}}function l(){this.stack.push({type:"fragment",children:[]})}function u(e,t,n){return this.stack[this.stack.length-1].children.push(e),this.stack.push(e),this.tokenStack.push([t,n]),e.position={start:a(t.start)},e}function f(e){return t;function t(t){e&&e.call(this,t),d.call(this,t)}}function d(e,t){const n=this.stack.pop(),r=this.tokenStack.pop();if(!r)throw new Error("Cannot close `"+e.type+"` ("+Ya({start:e.start,end:e.end})+"): its not open");if(r[0].type!==e.type)if(t)t.call(this,e,r[0]);else{(r[1]||fu).call(this,e,r[0])}return n.position.end=a(e.end),n}function p(){return Cc(this.stack.pop())}function h(){i("expectingFirstListItemValue",!0)}function m(e){if(s("expectingFirstListItemValue")){this.stack[this.stack.length-2].start=Number.parseInt(this.sliceSerialize(e),10),i("expectingFirstListItemValue")}}function g(){const e=this.resume();this.stack[this.stack.length-1].lang=e}function v(){const e=this.resume();this.stack[this.stack.length-1].meta=e}function y(){s("flowCodeInside")||(this.buffer(),i("flowCodeInside",!0))}function b(){const e=this.resume();this.stack[this.stack.length-1].value=e.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),i("flowCodeInside")}function w(){const e=this.resume();this.stack[this.stack.length-1].value=e.replace(/(\r?\n|\r)$/g,"")}function k(e){const t=this.resume(),n=this.stack[this.stack.length-1];n.label=t,n.identifier=yl(this.sliceSerialize(e)).toLowerCase()}function x(){const e=this.resume();this.stack[this.stack.length-1].title=e}function C(){const e=this.resume();this.stack[this.stack.length-1].url=e}function S(e){const t=this.stack[this.stack.length-1];if(!t.depth){const n=this.sliceSerialize(e).length;t.depth=n}}function M(){i("setextHeadingSlurpLineEnding",!0)}function O(e){this.stack[this.stack.length-1].depth=61===this.sliceSerialize(e).charCodeAt(0)?1:2}function A(){i("setextHeadingSlurpLineEnding")}function E(e){const t=this.stack[this.stack.length-1];let n=t.children[t.children.length-1];n&&"text"===n.type||(n=ce(),n.position={start:a(e.start)},t.children.push(n)),this.stack.push(n)}function T(e){const t=this.stack.pop();t.value+=this.sliceSerialize(e),t.position.end=a(e.end)}function N(e){const n=this.stack[this.stack.length-1];if(s("atHardBreak")){return n.children[n.children.length-1].position.end=a(e.end),void i("atHardBreak")}!s("setextHeadingSlurpLineEnding")&&t.canContainEols.includes(n.type)&&(E.call(this,e),T.call(this,e))}function D(){i("atHardBreak",!0)}function I(){const e=this.resume();this.stack[this.stack.length-1].value=e}function z(){const e=this.resume();this.stack[this.stack.length-1].value=e}function F(){const e=this.resume();this.stack[this.stack.length-1].value=e}function R(){const e=this.stack[this.stack.length-1];s("inReference")?(e.type+="Reference",e.referenceType=s("referenceType")||"shortcut",delete e.url,delete e.title):(delete e.identifier,delete e.label),i("referenceType")}function $(){const e=this.stack[this.stack.length-1];s("inReference")?(e.type+="Reference",e.referenceType=s("referenceType")||"shortcut",delete e.url,delete e.title):(delete e.identifier,delete e.label),i("referenceType")}function _(e){const t=this.stack[this.stack.length-2],n=this.sliceSerialize(e);t.label=iu(n),t.identifier=yl(n).toLowerCase()}function P(){const e=this.stack[this.stack.length-1],t=this.resume(),n=this.stack[this.stack.length-1];i("inReference",!0),"link"===n.type?n.children=e.children:n.alt=t}function j(){const e=this.resume();this.stack[this.stack.length-1].url=e}function L(){const e=this.resume();this.stack[this.stack.length-1].title=e}function B(){i("inReference")}function V(){i("referenceType","collapsed")}function H(e){const t=this.resume(),n=this.stack[this.stack.length-1];n.label=t,n.identifier=yl(this.sliceSerialize(e)).toLowerCase(),i("referenceType","full")}function W(e){i("characterReferenceType",e.type)}function q(e){const t=this.sliceSerialize(e),n=s("characterReferenceType");let r;n?(r=ru(t,"characterReferenceMarkerNumeric"===n?10:16),i("characterReferenceType")):r=ol(t);const o=this.stack.pop();o.value+=r,o.position.end=a(e.end)}function J(e){T.call(this,e);this.stack[this.stack.length-1].url=this.sliceSerialize(e)}function K(e){T.call(this,e);this.stack[this.stack.length-1].url="mailto:"+this.sliceSerialize(e)}function U(){return{type:"blockquote",children:[]}}function G(){return{type:"code",lang:null,meta:null,value:""}}function Q(){return{type:"inlineCode",value:""}}function Z(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function X(){return{type:"emphasis",children:[]}}function Y(){return{type:"heading",depth:void 0,children:[]}}function ee(){return{type:"break"}}function te(){return{type:"html",value:""}}function ne(){return{type:"image",title:null,url:"",alt:null}}function re(){return{type:"link",title:null,url:"",children:[]}}function oe(e){return{type:"list",ordered:"listOrdered"===e.type,start:null,spread:e._spread,children:[]}}function ie(e){return{type:"listItem",spread:e._spread,checked:null,children:[]}}function se(){return{type:"paragraph",children:[]}}function ae(){return{type:"strong",children:[]}}function ce(){return{type:"text",value:""}}function le(){return{type:"thematicBreak"}}}(n)(function(e){for(;!ul(e););return e}(function(e={}){const t={defined:[],lazy:{},constructs:Tc([tu].concat(e.extensions||[])),content:n(Jc),document:n(Kc),flow:n(Ll),string:n(Vl),text:n(Hl)};return t;function n(e){return function(n){return Kl(t,e,n)}}}(n).document().write(function(){let e,t=1,n="",r=!0;return function(o,i,s){const a=[];let c,l,u,f,d;for(o=n+o.toString(i),u=0,n="",r&&(65279===o.charCodeAt(0)&&u++,r=void 0);u<o.length;){if(nu.lastIndex=u,c=nu.exec(o),f=c&&void 0!==c.index?c.index:o.length,d=o.charCodeAt(f),!c){n=o.slice(u);break}if(10===d&&u===f&&e)a.push(-3),e=void 0;else switch(e&&(a.push(-5),e=void 0),u<f&&(a.push(o.slice(u,f)),t+=f-u),d){case 0:a.push(65533),t++;break;case 9:for(l=4*Math.ceil(t/4),a.push(-2);t++<l;)a.push(-1);break;case 10:a.push(-4),t=1;break;default:e=!0,t=1}u=f+1}return s&&(e&&a.push(-5),n&&a.push(n),a.push(null)),a}}()(e,t,!0))))};function lu(e,t){let n=-1;for(;++n<t.length;){const r=t[n];Array.isArray(r)?lu(e,r):uu(e,r)}return e}function uu(e,t){let n;for(n in t)if(au.call(t,n)){const r="canContainEols"===n||"transforms"===n,o=(au.call(e,n)?e[n]:void 0)||(e[n]=r?[]:{}),i=t[n];i&&(r?e[n]=[...o,...i]:Object.assign(o,i))}}function fu(e,t){throw e?new Error("Cannot close `"+e.type+"` ("+Ya({start:e.start,end:e.end})+"): a different token (`"+t.type+"`, "+Ya({start:t.start,end:t.end})+") is open"):new Error("Cannot close document, a token (`"+t.type+"`, "+Ya({start:t.start,end:t.end})+") is still open")}var du={}.hasOwnProperty;function pu(e,t){let n,r=-1;if(t.extensions)for(;++r<t.extensions.length;)pu(e,t.extensions[r]);for(n in t)"extensions"===n||("unsafe"===n||"join"===n?e[n]=[...e[n]||[],...t[n]||[]]:"handlers"===n?e[n]=Object.assign(e[n],t[n]||{}):e.options[n]=t[n]);return e}function hu(e,t){const n=t.indexStack,r=e.children||[],o=[];let i=-1;for(n.push(-1);++i<r.length;){const a=r[i];n[n.length-1]=i,o.push(t.handle(a,e,t,{before:"\n",after:"\n"})),"list"!==a.type&&(t.bulletLastUsed=void 0),i<r.length-1&&o.push(s(a,r[i+1]))}return n.pop(),o.join("");function s(n,r){let o=t.join.length;for(;o--;){const i=t.join[o](n,r,e,t);if(!0===i||1===i)break;if("number"==typeof i)return"\n".repeat(1+i);if(!1===i)return"\n\n\x3c!----\x3e\n\n"}return"\n\n"}}const mu=/\r?\n|\r/g;function gu(e,t){const n=[];let r,o=0,i=0;for(;r=mu.exec(e);)s(e.slice(o,r.index)),n.push(r[0]),o=r.index+r[0].length,i++;return s(e.slice(o)),n.join("");function s(e){n.push(t(e,i,!e))}}function vu(e,t,n){return">"+(n?"":" ")+e}function yu(e,t){return bu(e,t.inConstruct,!0)&&!bu(e,t.notInConstruct,!1)}function bu(e,t,n){if(!t)return n;"string"==typeof t&&(t=[t]);let r=-1;for(;++r<t.length;)if(e.includes(t[r]))return!0;return!1}function wu(e,t,n,r){let o=-1;for(;++o<n.unsafe.length;)if("\n"===n.unsafe[o].character&&yu(n.stack,n.unsafe[o]))return/[ \t]/.test(r.before)?"":" ";return"\\\n"}function ku(e,t){return Boolean(!t.options.fences&&e.value&&!e.lang&&/[^ \r\n]/.test(e.value)&&!/^[\t ]*(?:[\r\n]|$)|(?:^|[\r\n])[\t ]*$/.test(e.value))}function xu(e){if(!e._compiled){const t=(e.atBreak?"[\\r\\n][\\t ]*":"")+(e.before?"(?:"+e.before+")":"");e._compiled=new RegExp((t?"("+t+")":"")+(/[|\\{}()[\]^$+*?.-]/.test(e.character)?"\\":"")+e.character+(e.after?"(?:"+e.after+")":""),"g")}return e._compiled}function Cu(e,t,n){const r=(n.before||"")+(t||"")+(n.after||""),o=[],i=[],s={};let a=-1;for(;++a<e.unsafe.length;){const t=e.unsafe[a];if(!yu(e.stack,t))continue;const n=xu(t);let i;for(;i=n.exec(r);){const e="before"in t||Boolean(t.atBreak),n="after"in t,r=i.index+(e?i[1].length:0);o.includes(r)?(s[r].before&&!e&&(s[r].before=!1),s[r].after&&!n&&(s[r].after=!1)):(o.push(r),s[r]={before:e,after:n})}}o.sort(Su);let c=n.before?n.before.length:0;const l=r.length-(n.after?n.after.length:0);for(a=-1;++a<o.length;){const e=o[a];e<c||e>=l||(e+1<l&&o[a+1]===e+1&&s[e].after&&!s[e+1].before&&!s[e+1].after||o[a-1]===e-1&&s[e].before&&!s[e-1].before&&!s[e-1].after||(c!==e&&i.push(Mu(r.slice(c,e),"\\")),c=e,!/[!-/:-@[-`{-~]/.test(r.charAt(e))||n.encode&&n.encode.includes(r.charAt(e))?(i.push("&#x"+r.charCodeAt(e).toString(16).toUpperCase()+";"),c++):i.push("\\")))}return i.push(Mu(r.slice(c,l),n.after)),i.join("")}function Su(e,t){return e-t}function Mu(e,t){const n=/\\(?=[!-/:-@[-`{-~])/g,r=[],o=[],i=e+t;let s,a=-1,c=0;for(;s=n.exec(i);)r.push(s.index);for(;++a<r.length;)c!==r[a]&&o.push(e.slice(c,r[a])),o.push("\\"),c=r[a];return o.push(e.slice(c)),o.join("")}function Ou(e,t,n){return(n?"":"    ")+e}function Au(e){return e.label||!e.identifier?e.label||"":iu(e.identifier)}function Eu(e){const t=e.options.quote||'"';if('"'!==t&&"'"!==t)throw new Error("Cannot serialize title with `"+t+"` for `options.quote`, expected `\"`, or `'`");return t}function Tu(e,t,n){const r=t.indexStack,o=e.children||[],i=[];let s=-1,a=n.before;for(r.push(-1);++s<o.length;){const c=o[s];let l;if(r[r.length-1]=s,s+1<o.length){let n=t.handle.handlers[o[s+1].type];n&&n.peek&&(n=n.peek),l=n?n(o[s+1],e,t,{before:"",after:""}).charAt(0):""}else l=n.after;i.length>0&&("\r"===a||"\n"===a)&&"html"===c.type&&(i[i.length-1]=i[i.length-1].replace(/(\r?\n|\r)$/," "),a=" "),i.push(t.handle(c,e,t,{before:a,after:l})),a=i[i.length-1].slice(-1)}return r.pop(),i.join("")}function Nu(e,t,n){const r=function(e){const t=e.options.emphasis||"*";if("*"!==t&&"_"!==t)throw new Error("Cannot serialize emphasis with `"+t+"` for `options.emphasis`, expected `*`, or `_`");return t}(n),o=n.enter("emphasis"),i=Tu(e,n,{before:r,after:r});return o(),r+i+r}Nu.peek=function(e,t,n){return n.options.emphasis||"*"};const Du=function(e){if(null==e)return zu;if("string"==typeof e)return function(e){return Iu(t);function t(t){return t&&t.type===e}}(e);if("object"==typeof e)return Array.isArray(e)?function(e){const t=[];let n=-1;for(;++n<e.length;)t[n]=Du(e[n]);return Iu(r);function r(...e){let n=-1;for(;++n<t.length;)if(t[n].call(this,...e))return!0;return!1}}(e):function(e){return Iu(t);function t(t){let n;for(n in e)if(t[n]!==e[n])return!1;return!0}}(e);if("function"==typeof e)return Iu(e);throw new Error("Expected function, string, or object as test")};function Iu(e){return function(...t){return Boolean(e.call(this,...t))}}function zu(){return!0}const Fu=function(e,t,n,r){"function"==typeof t&&"function"!=typeof n&&(r=n,n=t,t=null);const o=Du(t),i=r?-1:1;!function e(s,a,c){const l="object"==typeof s&&null!==s?s:{};let u;"string"==typeof l.type&&(u="string"==typeof l.tagName?l.tagName:"string"==typeof l.name?l.name:void 0,Object.defineProperty(f,"name",{value:"node ("+l.type+(u?"<"+u+">":"")+")"}));return f;function f(){let l,u,f,d=[];if((!t||o(s,a,c[c.length-1]||null))&&(d=function(e){if(Array.isArray(e))return e;if("number"==typeof e)return[true,e];return[e]}(n(s,c)),false===d[0]))return d;if(s.children&&"skip"!==d[0])for(u=(r?s.children.length:-1)+i,f=c.concat(s);u>-1&&u<s.children.length;){if(l=e(s.children[u],u,f)(),false===l[0])return l;u="number"==typeof l[1]?l[1]:u+i}return d}}(e,null,[])()};function Ru(e,t){let n=!1;var r,o,i;return"function"==typeof(r=e=>{if("value"in e&&/\r?\n|\r/.test(e.value)||"break"===e.type)return n=!0,!1})&&"function"!=typeof o&&(i=o,o=r,r=null),Fu(e,r,(function(e,t){const n=t[t.length-1];return o(e,n?n.children.indexOf(e):null,n)}),i),Boolean((!e.depth||e.depth<3)&&Cc(e)&&(t.options.setext||n))}function $u(e){return e.value||""}function _u(e,t,n){const r=Eu(n),o='"'===r?"Quote":"Apostrophe",i=n.enter("image");let s=n.enter("label"),a="!["+Cu(n,e.alt,{before:"[",after:"]"})+"](";return s(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(s=n.enter("destinationLiteral"),a+="<"+Cu(n,e.url,{before:"<",after:">"})+">"):(s=n.enter("destinationRaw"),a+=Cu(n,e.url,{before:"(",after:e.title?" ":")"})),s(),e.title&&(s=n.enter("title"+o),a+=" "+r+Cu(n,e.title,{before:r,after:r})+r,s()),a+=")",i(),a}function Pu(e,t,n){const r=e.referenceType,o=n.enter("imageReference");let i=n.enter("label");const s=Cu(n,e.alt,{before:"[",after:"]"});let a="!["+s+"]";i();const c=n.stack;n.stack=[],i=n.enter("reference");const l=Cu(n,Au(e),{before:"[",after:"]"});return i(),n.stack=c,o(),"full"!==r&&s&&s===l?"shortcut"!==r&&(a+="[]"):a+="["+l+"]",a}function ju(e,t,n){let r=e.value||"",o="`",i=-1;for(;new RegExp("(^|[^`])"+o+"([^`]|$)").test(r);)o+="`";for(/[^ \r\n]/.test(r)&&(/^[ \r\n]/.test(r)&&/[ \r\n]$/.test(r)||/^`|`$/.test(r))&&(r=" "+r+" ");++i<n.unsafe.length;){const e=n.unsafe[i],t=xu(e);let o;if(e.atBreak)for(;o=t.exec(r);){let e=o.index;10===r.charCodeAt(e)&&13===r.charCodeAt(e-1)&&e--,r=r.slice(0,e)+" "+r.slice(o.index+1)}}return o+r+o}function Lu(e,t){const n=Cc(e);return Boolean(!t.options.resourceLink&&e.url&&!e.title&&e.children&&1===e.children.length&&"text"===e.children[0].type&&(n===e.url||"mailto:"+n===e.url)&&/^[a-z][a-z+.-]+:/i.test(e.url)&&!/[\0- <>\u007F]/.test(e.url))}function Bu(e,t,n){const r=Eu(n),o='"'===r?"Quote":"Apostrophe";let i,s,a;if(Lu(e,n)){const t=n.stack;return n.stack=[],i=n.enter("autolink"),a="<"+Tu(e,n,{before:"<",after:">"})+">",i(),n.stack=t,a}return i=n.enter("link"),s=n.enter("label"),a="["+Tu(e,n,{before:"[",after:"]"})+"](",s(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(s=n.enter("destinationLiteral"),a+="<"+Cu(n,e.url,{before:"<",after:">"})+">"):(s=n.enter("destinationRaw"),a+=Cu(n,e.url,{before:"(",after:e.title?" ":")"})),s(),e.title&&(s=n.enter("title"+o),a+=" "+r+Cu(n,e.title,{before:r,after:r})+r,s()),a+=")",i(),a}function Vu(e,t,n){const r=e.referenceType,o=n.enter("linkReference");let i=n.enter("label");const s=Tu(e,n,{before:"[",after:"]"});let a="["+s+"]";i();const c=n.stack;n.stack=[],i=n.enter("reference");const l=Cu(n,Au(e),{before:"[",after:"]"});return i(),n.stack=c,o(),"full"!==r&&s&&s===l?"shortcut"!==r&&(a+="[]"):a+="["+l+"]",a}function Hu(e){const t=e.options.bullet||"*";if("*"!==t&&"+"!==t&&"-"!==t)throw new Error("Cannot serialize items with `"+t+"` for `options.bullet`, expected `*`, `+`, or `-`");return t}function Wu(e){const t=e.options.bulletOrdered||".";if("."!==t&&")"!==t)throw new Error("Cannot serialize items with `"+t+"` for `options.bulletOrdered`, expected `.` or `)`");return t}function qu(e){const t=e.options.rule||"*";if("*"!==t&&"-"!==t&&"_"!==t)throw new Error("Cannot serialize rules with `"+t+"` for `options.rule`, expected `*`, `-`, or `_`");return t}function Ju(e,t,n){const r=function(e){const t=e.options.listItemIndent||"tab";if(1===t||"1"===t)return"one";if("tab"!==t&&"one"!==t&&"mixed"!==t)throw new Error("Cannot serialize items with `"+t+"` for `options.listItemIndent`, expected `tab`, `one`, or `mixed`");return t}(n);let o=n.bulletCurrent||Hu(n);t&&"list"===t.type&&t.ordered&&(o=("number"==typeof t.start&&t.start>-1?t.start:1)+(!1===n.options.incrementListMarker?0:t.children.indexOf(e))+o);let i=o.length+1;("tab"===r||"mixed"===r&&(t&&"list"===t.type&&t.spread||e.spread))&&(i=4*Math.ceil(i/4));const s=n.enter("listItem"),a=gu(hu(e,n),(function(e,t,n){if(t)return(n?"":" ".repeat(i))+e;return(n?o:o+" ".repeat(i-o.length))+e}));return s(),a}function Ku(e,t,n){const r=function(e){const t=e.options.strong||"*";if("*"!==t&&"_"!==t)throw new Error("Cannot serialize strong with `"+t+"` for `options.strong`, expected `*`, or `_`");return t}(n),o=n.enter("strong"),i=Tu(e,n,{before:r,after:r});return o(),r+r+i+r+r}$u.peek=function(){return"<"},_u.peek=function(){return"!"},Pu.peek=function(){return"!"},ju.peek=function(){return"`"},Bu.peek=function(e,t,n){return Lu(e,n)?"<":"["},Vu.peek=function(){return"["},Ku.peek=function(e,t,n){return n.options.strong||"*"};const Uu={blockquote:function(e,t,n){const r=n.enter("blockquote"),o=gu(hu(e,n),vu);return r(),o},break:wu,code:function(e,t,n){const r=function(e){const t=e.options.fence||"`";if("`"!==t&&"~"!==t)throw new Error("Cannot serialize code with `"+t+"` for `options.fence`, expected `` ` `` or `~`");return t}(n),o=e.value||"",i="`"===r?"GraveAccent":"Tilde";let s,a;if(ku(e,n))a=n.enter("codeIndented"),s=gu(o,Ou);else{const t=r.repeat(Math.max(function(e,t){const n=String(e);let r=n.indexOf(t),o=r,i=0,s=0;if("string"!=typeof t||1!==t.length)throw new Error("Expected character");for(;-1!==r;)r===o?++i>s&&(s=i):i=1,o=r+1,r=n.indexOf(t,o);return s}(o,r)+1,3));let c;a=n.enter("codeFenced"),s=t,e.lang&&(c=n.enter("codeFencedLang"+i),s+=Cu(n,e.lang,{before:"`",after:" ",encode:["`"]}),c()),e.lang&&e.meta&&(c=n.enter("codeFencedMeta"+i),s+=" "+Cu(n,e.meta,{before:" ",after:"\n",encode:["`"]}),c()),s+="\n",o&&(s+=o+"\n"),s+=t}return a(),s},definition:function(e,t,n){const r=Eu(n),o='"'===r?"Quote":"Apostrophe",i=n.enter("definition");let s=n.enter("label"),a="["+Cu(n,Au(e),{before:"[",after:"]"})+"]: ";return s(),!e.url||/[\0- \u007F]/.test(e.url)?(s=n.enter("destinationLiteral"),a+="<"+Cu(n,e.url,{before:"<",after:">"})+">"):(s=n.enter("destinationRaw"),a+=Cu(n,e.url,{before:" ",after:" "})),s(),e.title&&(s=n.enter("title"+o),a+=" "+r+Cu(n,e.title,{before:r,after:r})+r,s()),i(),a},emphasis:Nu,hardBreak:wu,heading:function(e,t,n){const r=Math.max(Math.min(6,e.depth||1),1);if(Ru(e,n)){const t=n.enter("headingSetext"),o=n.enter("phrasing"),i=Tu(e,n,{before:"\n",after:"\n"});return o(),t(),i+"\n"+(1===r?"=":"-").repeat(i.length-(Math.max(i.lastIndexOf("\r"),i.lastIndexOf("\n"))+1))}const o="#".repeat(r),i=n.enter("headingAtx"),s=n.enter("phrasing");let a=Tu(e,n,{before:"# ",after:"\n"});return/^[\t ]/.test(a)&&(a="&#x"+a.charCodeAt(0).toString(16).toUpperCase()+";"+a.slice(1)),a=a?o+" "+a:o,n.options.closeAtx&&(a+=" "+o),s(),i(),a},html:$u,image:_u,imageReference:Pu,inlineCode:ju,link:Bu,linkReference:Vu,list:function(e,t,n){const r=n.enter("list"),o=n.bulletCurrent;let i=e.ordered?Wu(n):Hu(n);const s=e.ordered?function(e){const t=Wu(e),n=e.options.bulletOrderedOther;if(!n)return"."===t?")":".";if("."!==n&&")"!==n)throw new Error("Cannot serialize items with `"+n+"` for `options.bulletOrderedOther`, expected `*`, `+`, or `-`");if(n===t)throw new Error("Expected `bulletOrdered` (`"+t+"`) and `bulletOrderedOther` (`"+n+"`) to be different");return n}(n):function(e){const t=Hu(e),n=e.options.bulletOther;if(!n)return"*"===t?"-":"*";if("*"!==n&&"+"!==n&&"-"!==n)throw new Error("Cannot serialize items with `"+n+"` for `options.bulletOther`, expected `*`, `+`, or `-`");if(n===t)throw new Error("Expected `bullet` (`"+t+"`) and `bulletOther` (`"+n+"`) to be different");return n}(n),a=n.bulletLastUsed;let c=!1;if(t&&(e.ordered?n.options.bulletOrderedOther:n.options.bulletOther)&&a&&i===a&&(c=!0),!e.ordered){const t=e.children?e.children[0]:void 0;if("*"!==i&&"-"!==i||!t||t.children&&t.children[0]||"list"!==n.stack[n.stack.length-1]||"listItem"!==n.stack[n.stack.length-2]||"list"!==n.stack[n.stack.length-3]||"listItem"!==n.stack[n.stack.length-4]||0!==n.indexStack[n.indexStack.length-1]||0!==n.indexStack[n.indexStack.length-2]||0!==n.indexStack[n.indexStack.length-3]||(c=!0),qu(n)===i&&t){let t=-1;for(;++t<e.children.length;){const n=e.children[t];if(n&&"listItem"===n.type&&n.children&&n.children[0]&&"thematicBreak"===n.children[0].type){c=!0;break}}}}c&&(i=s),n.bulletCurrent=i;const l=hu(e,n);return n.bulletLastUsed=i,n.bulletCurrent=o,r(),l},listItem:Ju,paragraph:function(e,t,n){const r=n.enter("paragraph"),o=n.enter("phrasing"),i=Tu(e,n,{before:"\n",after:"\n"});return o(),r(),i},root:function(e,t,n){return hu(e,n)},strong:Ku,text:function(e,t,n,r){return Cu(n,e.value,r)},thematicBreak:function(e,t,n){const r=(qu(n)+(n.options.ruleSpaces?" ":"")).repeat(function(e){const t=e.options.ruleRepetition||3;if(t<3)throw new Error("Cannot serialize rules with repetition `"+t+"` for `options.ruleRepetition`, expected `3` or more");return t}(n));return n.options.ruleSpaces?r.slice(0,-1):r}},Gu=[function(e,t,n,r){if("code"===t.type&&ku(t,r)&&("list"===e.type||e.type===t.type&&ku(e,r)))return!1;if("list"===e.type&&e.type===t.type&&Boolean(e.ordered)===Boolean(t.ordered)&&!(e.ordered?r.options.bulletOrderedOther:r.options.bulletOther))return!1;if("spread"in n&&"boolean"==typeof n.spread){if("paragraph"===e.type&&(e.type===t.type||"definition"===t.type||"heading"===t.type&&Ru(t,r)))return;return n.spread?1:0}}];const Qu=["autolink","destinationLiteral","destinationRaw","reference","titleQuote","titleApostrophe"],Zu=[{character:"\t",after:"[\\r\\n]",inConstruct:"phrasing"},{character:"\t",before:"[\\r\\n]",inConstruct:"phrasing"},{character:"\t",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde"]},{character:"\r",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde","codeFencedMetaGraveAccent","codeFencedMetaTilde","destinationLiteral","headingAtx"]},{character:"\n",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde","codeFencedMetaGraveAccent","codeFencedMetaTilde","destinationLiteral","headingAtx"]},{character:" ",after:"[\\r\\n]",inConstruct:"phrasing"},{character:" ",before:"[\\r\\n]",inConstruct:"phrasing"},{character:" ",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde"]},{character:"!",after:"\\[",inConstruct:"phrasing",notInConstruct:Qu},{character:'"',inConstruct:"titleQuote"},{atBreak:!0,character:"#"},{character:"#",inConstruct:"headingAtx",after:"(?:[\r\n]|$)"},{character:"&",after:"[#A-Za-z]",inConstruct:"phrasing"},{character:"'",inConstruct:"titleApostrophe"},{character:"(",inConstruct:"destinationRaw"},{before:"\\]",character:"(",inConstruct:"phrasing",notInConstruct:Qu},{atBreak:!0,before:"\\d+",character:")"},{character:")",inConstruct:"destinationRaw"},{atBreak:!0,character:"*"},{character:"*",inConstruct:"phrasing",notInConstruct:Qu},{atBreak:!0,character:"+"},{atBreak:!0,character:"-"},{atBreak:!0,before:"\\d+",character:".",after:"(?:[ \t\r\n]|$)"},{atBreak:!0,character:"<",after:"[!/?A-Za-z]"},{character:"<",after:"[!/?A-Za-z]",inConstruct:"phrasing",notInConstruct:Qu},{character:"<",inConstruct:"destinationLiteral"},{atBreak:!0,character:"="},{atBreak:!0,character:">"},{character:">",inConstruct:"destinationLiteral"},{atBreak:!0,character:"["},{character:"[",inConstruct:"phrasing",notInConstruct:Qu},{character:"[",inConstruct:["label","reference"]},{character:"\\",after:"[\\r\\n]",inConstruct:"phrasing"},{character:"]",inConstruct:["label","reference"]},{atBreak:!0,character:"_"},{character:"_",inConstruct:"phrasing",notInConstruct:Qu},{atBreak:!0,character:"`"},{character:"`",inConstruct:["codeFencedLangGraveAccent","codeFencedMetaGraveAccent"]},{character:"`",inConstruct:"phrasing",notInConstruct:Qu},{atBreak:!0,character:"~"}];function Xu(e,t={}){const n={enter:function(e){return n.stack.push(e),function(){n.stack.pop()}},stack:[],unsafe:[],join:[],handlers:{},options:{},indexStack:[]};pu(n,{unsafe:Zu,join:Gu,handlers:Uu}),pu(n,t),n.options.tightDefinitions&&pu(n,{join:[tf]}),n.handle=function(e,t){var n=t||{};function r(t){var n=r.invalid,o=r.handlers;if(t&&du.call(t,e)&&(n=du.call(o,t[e])?o[t[e]]:r.unknown),n)return n.apply(this,arguments)}return r.handlers=n.handlers||{},r.invalid=n.invalid,r.unknown=n.unknown,r}("type",{invalid:Yu,unknown:ef,handlers:n.handlers});let r=n.handle(e,null,n,{before:"\n",after:"\n"});return r&&10!==r.charCodeAt(r.length-1)&&13!==r.charCodeAt(r.length-1)&&(r+="\n"),r}function Yu(e){throw new Error("Cannot handle value `"+e+"`, expected node")}function ef(e){throw new Error("Cannot handle unknown node `"+e.type+"`")}function tf(e,t){if("definition"===e.type&&e.type===t.type)return 0}const nf=hc().use((function(e){Object.assign(this,{Parser:t=>{const n=this.data("settings");return cu(t,Object.assign({},n,e,{extensions:this.data("micromarkExtensions")||[],mdastExtensions:this.data("fromMarkdownExtensions")||[]}))}})})).use((function(e){Object.assign(this,{Compiler:t=>{const n=this.data("settings");return Xu(t,Object.assign({},n,e,{extensions:this.data("toMarkdownExtensions")||[]}))}})})).freeze(),rf=K("ConfigReady"),of=K("InitReady"),sf=H([],"initTimer"),af=H({},"editor"),cf=H([],"inputRules"),lf=H([],"prosePlugins"),uf=H([],"remarkPlugins"),ff=H([],"nodeView"),df=H(nf(),"remark"),pf=()=>{const e=e=>e.elements.length,t=t=>t.elements[e(t)-1];return{size:e,top:t,push:e=>n=>{var r;null===(r=t(e))||void 0===r||r.push(n)},open:e=>t=>{e.elements.push(t)},close:e=>{const t=e.elements.pop();if(!t)throw O();return t}}},{size:hf,push:mf,top:gf,open:vf,close:yf}=pf(),bf=e=>e.isText,wf=e=>(t,n)=>vf(e)(((e,t,n)=>{const r={type:e,content:t,attrs:n,push:(...e)=>((e,t,...n)=>{e.content.push(t,...n)})(r,...e),pop:()=>(e=>e.content.pop())(r)};return r})(t,[],n)),kf=e=>(t,n,r)=>{const o=t.createAndFill(n,r,e.marks);if(!o)throw((...e)=>{const t=e.reduce(((e,t)=>{if(!t)return e;const n=e=>Array.isArray(e)?e.map((e=>n(e))).join(", "):e.toJSON?M(e.toJSON()):e.spec?M(e.spec):e.toString();return`${e}, ${n(t)}`}),"Create prosemirror node from remark failed in parser");return new Error(t)})(t,n,r);return mf(e)(o),o},xf=e=>()=>{e.marks=re.none;const t=yf(e);return kf(e)(t.type,t.attrs,t.content)},Cf=e=>(t,n)=>{const r=t.create(n);e.marks=r.addToSet(e.marks)},Sf=e=>t=>{e.marks=t.removeFromSet(e.marks)},Mf=e=>t=>{const n=gf(e);if(!n)throw O();const r=n.pop(),o=e.schema.text(t,e.marks);if(!r)return void n.push(o);const i=((e,t,n)=>{if(bf(t)&&bf(n)&&re.sameSet(t.marks,n.marks))return e.text(t.text+n.text,t.marks)})(e.schema,r,o);i?n.push(i):n.push(r,o)},Of=e=>()=>{let t=null;do{t=xf(e)()}while(hf(e));return t};var Af,Ef,Tf;class Nf{constructor(e,t,n){this.stack=e,this.schema=t,this.specMap=n,Af.add(this),this.run=(e,t)=>{const n=e.runSync(e.parse(t));return this.next(n),this},this.next=(e=[])=>([e].flat().forEach((e=>C(this,Af,"m",Tf).call(this,e))),this),this.toDoc=()=>this.stack.build(),this.injectRoot=(e,t,n)=>(this.stack.openNode(t,n),this.next(e.children),this),this.addText=(e="")=>(this.stack.addText(e),this),this.addNode=(...e)=>(this.stack.addNode(...e),this),this.openNode=(...e)=>(this.stack.openNode(...e),this),this.closeNode=(...e)=>(this.stack.closeNode(...e),this),this.openMark=(...e)=>(this.stack.openMark(...e),this),this.closeMark=(...e)=>(this.stack.closeMark(...e),this)}}Af=new WeakSet,Ef=function(e){const t=Object.values(this.specMap).find((t=>t.match(e)));if(!t)throw(e=>new Error(`Cannot match target parser for node: ${M(e)}.`))(e);return t},Tf=function(e){const{key:t,runner:n,is:r}=C(this,Af,"m",Ef).call(this,e);n(this,e,this.schema["node"===r?"nodes":"marks"][t])};const Df=(e,t,n)=>r=>{const o=new Nf((e=>{const t={marks:[],elements:[],schema:e};return{build:Of(t),openMark:Cf(t),closeMark:Sf(t),addText:Mf(t),openNode:wf(t),addNode:kf(t),closeNode:xf(t)}})(e),e,t);return o.run(n,r),o.toDoc()},If=K("schemaReady"),zf=H({},"schema"),Ff=H([],"schemaTimer"),Rf=H([],"nodes"),$f=H([],"marks"),_f=e=>(e.inject(zf).inject(Rf).inject($f).inject(Ff,[of]).record(If),e=>x(void 0,void 0,void 0,(function*(){yield e.waitTimers(Ff);const t=e.get(df),n=e.get(uf).reduce(((e,t)=>e.use(t)),t);e.set(df,n);const r=Object.fromEntries(e.get(Rf)),o=Object.fromEntries(e.get($f));e.set(zf,new Ge({nodes:r,marks:o})),e.done(If)}))),Pf=H((()=>null),"parser"),jf=H([],"parserTimer"),Lf=K("ParserReady"),Bf=e=>(e.inject(Pf).inject(jf,[If]).record(Lf),e=>x(void 0,void 0,void 0,(function*(){yield e.waitTimers(jf);const t=e.get(Rf),n=e.get($f),r=e.get(df),o=e.get(zf),i=[...t.map((([e,t])=>Object.assign({id:e},t))).map((e=>Object.assign(Object.assign({},e),{is:"node"}))),...n.map((([e,t])=>Object.assign({id:e},t))).map((e=>Object.assign(Object.assign({},e),{is:"mark"})))],s=Object.fromEntries(i.map((({id:e,parseMarkdown:t,is:n})=>[e,Object.assign(Object.assign({},t),{is:n,key:e})])));e.set(Pf,Df(o,s,r)),e.done(Lf)}))),Vf=(e,t,n,r={})=>{const o={type:e,children:t,props:r,value:n,push:(...e)=>((e,t,...n)=>{e.children||(e.children=[]),e.children.push(t,...n)})(o,...e),pop:()=>(e=>{var t;return null===(t=e.children)||void 0===t?void 0:t.pop()})(o)};return o},{size:Hf,push:Wf,open:qf,close:Jf}=pf(),Kf=e=>(t,n,r)=>qf(e)(Vf(t,[],n,r)),Uf=e=>(t,n,r,o)=>{const i=(e=>{const t=Object.assign(Object.assign({},e.props),{type:e.type});return e.children&&(t.children=e.children),e.value&&(t.value=e.value),t})(Vf(t,n,r,o));return Wf(e)(i),i},Gf=e=>()=>{const t=Jf(e);return Uf(e)(t.type,t.children,t.value,t.props)},Qf=e=>(t,n,r,o)=>{t.isInSet(e.marks)||(e.marks=t.addToSet(e.marks),Kf(e)(n,r,o))},Zf=e=>t=>t.isInSet(e.marks)?(e.marks=t.type.removeFromSet(e.marks),Gf(e)()):null,Xf=e=>()=>{let t=null;do{t=Gf(e)()}while(Hf(e));return t};var Yf,ed,td,nd,rd;class od{constructor(e,t,n){this.stack=e,this.schema=t,this.specMap=n,Yf.add(this),this.toString=e=>e.stringify(this.stack.build()),this.next=e=>{return t=e,Object.prototype.hasOwnProperty.call(t,"size")?(e.forEach((e=>{C(this,Yf,"m",rd).call(this,e)})),this):(C(this,Yf,"m",rd).call(this,e),this);var t},this.addNode=(...e)=>(this.stack.addNode(...e),this),this.openNode=(...e)=>(this.stack.openNode(...e),this),this.closeNode=(...e)=>(this.stack.closeNode(...e),this),this.withMark=(...e)=>(this.stack.openMark(...e),this)}run(e){return this.next(e),this}}Yf=new WeakSet,ed=function(e){const t=Object.entries(this.specMap).map((([e,t])=>Object.assign({key:e},t))).find((t=>t.match(e)));if(!t)throw(e=>new Error(`Cannot match target serializer for node: ${M(e)}.`))(e.type);return t},td=function(e){const{runner:t}=C(this,Yf,"m",ed).call(this,e);t(this,e)},nd=function(e,t){const{runner:n}=C(this,Yf,"m",ed).call(this,e);return n(this,e,t)},rd=function(e){const{marks:t}=e;t.every((t=>!C(this,Yf,"m",nd).call(this,t,e)))&&C(this,Yf,"m",td).call(this,e),t.forEach((e=>this.stack.closeMark(e)))};const id=(e,t,n)=>r=>{const o=new od((()=>{const e={marks:[],elements:[]};return{build:Xf(e),openMark:Qf(e),closeMark:Zf(e),openNode:Kf(e),addNode:Uf(e),closeNode:Gf(e)}})(),e,t);return o.run(r),o.toString(n)},sd=H((()=>""),"serializer"),ad=H([],"serializerTimer"),cd=K("SerializerReady"),ld=e=>(e.inject(sd).inject(ad,[If]).record(cd),e=>x(void 0,void 0,void 0,(function*(){yield e.waitTimers(ad);const t=e.get(Rf),n=e.get($f),r=e.get(df),o=e.get(zf),i=[...t,...n],s=Object.fromEntries(i.map((([e,t])=>[e,t.toMarkdown])));e.set(sd,id(o,s,r)),e.done(cd)}))),ud=H("","defaultValue"),fd=H({},"editorState"),dd=H({},"stateOptions"),pd=H([],"editorStateTimer"),hd=K("EditorStateReady"),md=(e,t,n)=>{if("string"==typeof e)return t(e);if("html"===e.type)return Ze.fromSchema(n).parse(e.dom);if("json"===e.type)return Oe.fromJSON(n,e.value);throw new Error(`Doc type error, unsupported type: ${M(e)}`)},gd=e=>(e.inject(ud).inject(fd).inject(dd).inject(pd,[Lf,cd,Ad]).record(hd),e=>x(void 0,void 0,void 0,(function*(){yield e.waitTimers(pd);const t=e.get(zf),n=e.get(Pf),r=e.get(cf),o=e.get(dd),i=e.get(lf),s=e.get(ud),a=md(s,n,t),c=ln.create(Object.assign({schema:t,doc:a,plugins:[...i,Jn(In),ms({rules:r})]},o));e.set(fd,c),e.done(hd)}))),vd=H({},"editorView"),yd=H({},"editorViewOptions"),bd=H(document.body,"root"),wd=H([],"editorViewTimer"),kd=K("EditorViewReady"),xd=e=>(e.inject(bd,document.body).inject(vd).inject(yd).inject(wd,[hd]).record(kd),e=>x(void 0,void 0,void 0,(function*(){yield e.waitTimers(wd);const t=e.get(fd),n=e.get(yd),r=Object.fromEntries(e.get(ff)),o=e.get(bd),i=o?(e=>{const t=document.createElement("div");return t.className="milkdown",e.appendChild(t),t})(o):void 0,s=new $i(i,Object.assign({state:t,nodeViews:r},n));var a;(a=s.dom).classList.add("editor"),a.setAttribute("role","textbox"),e.set(vd,s),e.done(kd)}))),Cd=(e,t)=>[e,t],Sd=H({},"commands"),Md=()=>H((()=>()=>!1),"cmdKey"),Od=H([],"commandsTimer"),Ad=K("CommandsReady"),Ed=e=>{const t=B(),n={create:(e,n)=>e(t.sliceMap,n),get:e=>t.getSlice(e).get(),call:()=>{throw new Error("You're trying to call a command before editor view initialized, make sure to get commandManager from ctx after editor view has been initialized")}};return e.inject(Sd,n).inject(Od,[If]).record(Ad),e=>x(void 0,void 0,void 0,(function*(){yield e.waitTimers(Od),e.done(Ad),yield e.wait(kd),e.update(Sd,(t=>Object.assign(Object.assign({},t),{call:(t,r)=>{const o=n.get(t)(r),i=e.get(vd);return o(i.state,i.dispatch,i)}})))}))};var Td=function(){function e(e){var t=this;this._insertTag=function(e){var n;n=0===t.tags.length?t.insertionPoint?t.insertionPoint.nextSibling:t.prepend?t.container.firstChild:t.before:t.tags[t.tags.length-1].nextSibling,t.container.insertBefore(e,n),t.tags.push(e)},this.isSpeedy=void 0===e.speedy||e.speedy,this.tags=[],this.ctr=0,this.nonce=e.nonce,this.key=e.key,this.container=e.container,this.prepend=e.prepend,this.insertionPoint=e.insertionPoint,this.before=null}var t=e.prototype;return t.hydrate=function(e){e.forEach(this._insertTag)},t.insert=function(e){this.ctr%(this.isSpeedy?65e3:1)==0&&this._insertTag(function(e){var t=document.createElement("style");return t.setAttribute("data-emotion",e.key),void 0!==e.nonce&&t.setAttribute("nonce",e.nonce),t.appendChild(document.createTextNode("")),t.setAttribute("data-s",""),t}(this));var t=this.tags[this.tags.length-1];if(this.isSpeedy){var n=function(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}(t);try{n.insertRule(e,n.cssRules.length)}catch(r){}}else t.appendChild(document.createTextNode(e));this.ctr++},t.flush=function(){this.tags.forEach((function(e){return e.parentNode&&e.parentNode.removeChild(e)})),this.tags=[],this.ctr=0},e}(),Nd="-ms-",Dd="-moz-",Id="-webkit-",zd=Math.abs,Fd=String.fromCharCode,Rd=Object.assign;function $d(e){return e.trim()}function _d(e,t,n){return e.replace(t,n)}function Pd(e,t){return e.indexOf(t)}function jd(e,t){return 0|e.charCodeAt(t)}function Ld(e,t,n){return e.slice(t,n)}function Bd(e){return e.length}function Vd(e){return e.length}function Hd(e,t){return t.push(e),e}var Wd=1,qd=1,Jd=0,Kd=0,Ud=0,Gd="";function Qd(e,t,n,r,o,i,s){return{value:e,root:t,parent:n,type:r,props:o,children:i,line:Wd,column:qd,length:s,return:""}}function Zd(e,t){return Rd(Qd("",null,null,"",null,null,0),e,{length:-e.length},t)}function Xd(){return Ud=Kd<Jd?jd(Gd,Kd++):0,qd++,10===Ud&&(qd=1,Wd++),Ud}function Yd(){return jd(Gd,Kd)}function ep(){return Kd}function tp(e,t){return Ld(Gd,e,t)}function np(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function rp(e){return Wd=qd=1,Jd=Bd(Gd=e),Kd=0,[]}function op(e){return Gd="",e}function ip(e){return $d(tp(Kd-1,cp(91===e?e+2:40===e?e+1:e)))}function sp(e){for(;(Ud=Yd())&&Ud<33;)Xd();return np(e)>2||np(Ud)>3?"":" "}function ap(e,t){for(;--t&&Xd()&&!(Ud<48||Ud>102||Ud>57&&Ud<65||Ud>70&&Ud<97););return tp(e,ep()+(t<6&&32==Yd()&&32==Xd()))}function cp(e){for(;Xd();)switch(Ud){case e:return Kd;case 34:case 39:34!==e&&39!==e&&cp(Ud);break;case 40:41===e&&cp(e);break;case 92:Xd()}return Kd}function lp(e,t){for(;Xd()&&e+Ud!==57&&(e+Ud!==84||47!==Yd()););return"/*"+tp(t,Kd-1)+"*"+Fd(47===e?e:Xd())}function up(e){for(;!np(Yd());)Xd();return tp(e,Kd)}function fp(e){return op(dp("",null,null,null,[""],e=rp(e),0,[0],e))}function dp(e,t,n,r,o,i,s,a,c){for(var l=0,u=0,f=s,d=0,p=0,h=0,m=1,g=1,v=1,y=0,b="",w=o,k=i,x=r,C=b;g;)switch(h=y,y=Xd()){case 40:if(108!=h&&58==C.charCodeAt(f-1)){-1!=Pd(C+=_d(ip(y),"&","&\f"),"&\f")&&(v=-1);break}case 34:case 39:case 91:C+=ip(y);break;case 9:case 10:case 13:case 32:C+=sp(h);break;case 92:C+=ap(ep()-1,7);continue;case 47:switch(Yd()){case 42:case 47:Hd(hp(lp(Xd(),ep()),t,n),c);break;default:C+="/"}break;case 123*m:a[l++]=Bd(C)*v;case 125*m:case 59:case 0:switch(y){case 0:case 125:g=0;case 59+u:p>0&&Bd(C)-f&&Hd(p>32?mp(C+";",r,n,f-1):mp(_d(C," ","")+";",r,n,f-2),c);break;case 59:C+=";";default:if(Hd(x=pp(C,t,n,l,u,o,a,b,w=[],k=[],f),i),123===y)if(0===u)dp(C,t,x,x,w,i,f,a,k);else switch(d){case 100:case 109:case 115:dp(e,x,x,r&&Hd(pp(e,x,x,0,0,o,a,b,o,w=[],f),k),o,k,f,a,r?w:k);break;default:dp(C,x,x,x,[""],k,0,a,k)}}l=u=p=0,m=v=1,b=C="",f=s;break;case 58:f=1+Bd(C),p=h;default:if(m<1)if(123==y)--m;else if(125==y&&0==m++&&125==(Ud=Kd>0?jd(Gd,--Kd):0,qd--,10===Ud&&(qd=1,Wd--),Ud))continue;switch(C+=Fd(y),y*m){case 38:v=u>0?1:(C+="\f",-1);break;case 44:a[l++]=(Bd(C)-1)*v,v=1;break;case 64:45===Yd()&&(C+=ip(Xd())),d=Yd(),u=f=Bd(b=C+=up(ep())),y++;break;case 45:45===h&&2==Bd(C)&&(m=0)}}return i}function pp(e,t,n,r,o,i,s,a,c,l,u){for(var f=o-1,d=0===o?i:[""],p=Vd(d),h=0,m=0,g=0;h<r;++h)for(var v=0,y=Ld(e,f+1,f=zd(m=s[h])),b=e;v<p;++v)(b=$d(m>0?d[v]+" "+y:_d(y,/&\f/g,d[v])))&&(c[g++]=b);return Qd(e,t,n,0===o?"rule":a,c,l,u)}function hp(e,t,n){return Qd(e,t,n,"comm",Fd(Ud),Ld(e,2,-2),0)}function mp(e,t,n,r){return Qd(e,t,n,"decl",Ld(e,0,r),Ld(e,r+1,-1),r)}function gp(e,t){switch(function(e,t){return(((t<<2^jd(e,0))<<2^jd(e,1))<<2^jd(e,2))<<2^jd(e,3)}(e,t)){case 5103:return Id+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Id+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return Id+e+Dd+e+Nd+e+e;case 6828:case 4268:return Id+e+Nd+e+e;case 6165:return Id+e+Nd+"flex-"+e+e;case 5187:return Id+e+_d(e,/(\w+).+(:[^]+)/,"-webkit-box-$1$2-ms-flex-$1$2")+e;case 5443:return Id+e+Nd+"flex-item-"+_d(e,/flex-|-self/,"")+e;case 4675:return Id+e+Nd+"flex-line-pack"+_d(e,/align-content|flex-|-self/,"")+e;case 5548:return Id+e+Nd+_d(e,"shrink","negative")+e;case 5292:return Id+e+Nd+_d(e,"basis","preferred-size")+e;case 6060:return Id+"box-"+_d(e,"-grow","")+Id+e+Nd+_d(e,"grow","positive")+e;case 4554:return Id+_d(e,/([^-])(transform)/g,"$1-webkit-$2")+e;case 6187:return _d(_d(_d(e,/(zoom-|grab)/,Id+"$1"),/(image-set)/,Id+"$1"),e,"")+e;case 5495:case 3959:return _d(e,/(image-set\([^]*)/,Id+"$1$`$1");case 4968:return _d(_d(e,/(.+:)(flex-)?(.*)/,"-webkit-box-pack:$3-ms-flex-pack:$3"),/s.+-b[^;]+/,"justify")+Id+e+e;case 4095:case 3583:case 4068:case 2532:return _d(e,/(.+)-inline(.+)/,Id+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Bd(e)-1-t>6)switch(jd(e,t+1)){case 109:if(45!==jd(e,t+4))break;case 102:return _d(e,/(.+:)(.+)-([^]+)/,"$1-webkit-$2-$3$1"+Dd+(108==jd(e,t+3)?"$3":"$2-$3"))+e;case 115:return~Pd(e,"stretch")?gp(_d(e,"stretch","fill-available"),t)+e:e}break;case 4949:if(115!==jd(e,t+1))break;case 6444:switch(jd(e,Bd(e)-3-(~Pd(e,"!important")&&10))){case 107:return _d(e,":",":"+Id)+e;case 101:return _d(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+Id+(45===jd(e,14)?"inline-":"")+"box$3$1"+Id+"$2$3$1"+Nd+"$2box$3")+e}break;case 5936:switch(jd(e,t+11)){case 114:return Id+e+Nd+_d(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return Id+e+Nd+_d(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return Id+e+Nd+_d(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return Id+e+Nd+e+e}return e}function vp(e,t){for(var n="",r=Vd(e),o=0;o<r;o++)n+=t(e[o],o,e,t)||"";return n}function yp(e,t,n,r){switch(e.type){case"@import":case"decl":return e.return=e.return||e.value;case"comm":return"";case"@keyframes":return e.return=e.value+"{"+vp(e.children,r)+"}";case"rule":e.value=e.props.join(",")}return Bd(n=vp(e.children,r))?e.return=e.value+"{"+n+"}":""}function bp(e){var t=Object.create(null);return function(n){return void 0===t[n]&&(t[n]=e(n)),t[n]}}var wp=function(e,t,n){for(var r=0,o=0;r=o,o=Yd(),38===r&&12===o&&(t[n]=1),!np(o);)Xd();return tp(e,Kd)},kp=function(e,t){return op(function(e,t){var n=-1,r=44;do{switch(np(r)){case 0:38===r&&12===Yd()&&(t[n]=1),e[n]+=wp(Kd-1,t,n);break;case 2:e[n]+=ip(r);break;case 4:if(44===r){e[++n]=58===Yd()?"&\f":"",t[n]=e[n].length;break}default:e[n]+=Fd(r)}}while(r=Xd());return e}(rp(e),t))},xp=new WeakMap,Cp=function(e){if("rule"===e.type&&e.parent&&!(e.length<1)){for(var t=e.value,n=e.parent,r=e.column===n.column&&e.line===n.line;"rule"!==n.type;)if(!(n=n.parent))return;if((1!==e.props.length||58===t.charCodeAt(0)||xp.get(n))&&!r){xp.set(e,!0);for(var o=[],i=kp(t,o),s=n.props,a=0,c=0;a<i.length;a++)for(var l=0;l<s.length;l++,c++)e.props[c]=o[a]?i[a].replace(/&\f/g,s[l]):s[l]+" "+i[a]}}},Sp=function(e){if("decl"===e.type){var t=e.value;108===t.charCodeAt(0)&&98===t.charCodeAt(2)&&(e.return="",e.value="")}},Mp=[function(e,t,n,r){if(e.length>-1&&!e.return)switch(e.type){case"decl":e.return=gp(e.value,e.length);break;case"@keyframes":return vp([Zd(e,{value:_d(e.value,"@","@"+Id)})],r);case"rule":if(e.length)return function(e,t){return e.map(t).join("")}(e.props,(function(t){switch(function(e,t){return(e=t.exec(e))?e[0]:e}(t,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return vp([Zd(e,{props:[_d(t,/:(read-\w+)/,":-moz-$1")]})],r);case"::placeholder":return vp([Zd(e,{props:[_d(t,/:(plac\w+)/,":-webkit-input-$1")]}),Zd(e,{props:[_d(t,/:(plac\w+)/,":-moz-$1")]}),Zd(e,{props:[_d(t,/:(plac\w+)/,Nd+"input-$1")]})],r)}return""}))}}],Op=function(e){var t=e.key;if("css"===t){var n=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(n,(function(e){-1!==e.getAttribute("data-emotion").indexOf(" ")&&(document.head.appendChild(e),e.setAttribute("data-s",""))}))}var r,o,i=e.stylisPlugins||Mp,s={},a=[];r=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+t+' "]'),(function(e){for(var t=e.getAttribute("data-emotion").split(" "),n=1;n<t.length;n++)s[t[n]]=!0;a.push(e)}));var c,l,u,f,d=[yp,(f=function(e){c.insert(e)},function(e){e.root||(e=e.return)&&f(e)})],p=(l=[Cp,Sp].concat(i,d),u=Vd(l),function(e,t,n,r){for(var o="",i=0;i<u;i++)o+=l[i](e,t,n,r)||"";return o});o=function(e,t,n,r){c=n,vp(fp(e?e+"{"+t.styles+"}":t.styles),p),r&&(h.inserted[t.name]=!0)};var h={key:t,sheet:new Td({key:t,container:r,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:s,registered:{},insert:o};return h.sheet.hydrate(a),h};var Ap={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},Ep=/[A-Z]|^ms/g,Tp=/_EMO_([^_]+?)_([^]*?)_EMO_/g,Np=function(e){return 45===e.charCodeAt(1)},Dp=function(e){return null!=e&&"boolean"!=typeof e},Ip=bp((function(e){return Np(e)?e:e.replace(Ep,"-$&").toLowerCase()})),zp=function(e,t){switch(e){case"animation":case"animationName":if("string"==typeof t)return t.replace(Tp,(function(e,t,n){return Rp={name:t,styles:n,next:Rp},t}))}return 1===Ap[e]||Np(e)||"number"!=typeof t||0===t?t:t+"px"};function Fp(e,t,n){if(null==n)return"";if(void 0!==n.__emotion_styles)return n;switch(typeof n){case"boolean":return"";case"object":if(1===n.anim)return Rp={name:n.name,styles:n.styles,next:Rp},n.name;if(void 0!==n.styles){var r=n.next;if(void 0!==r)for(;void 0!==r;)Rp={name:r.name,styles:r.styles,next:Rp},r=r.next;return n.styles+";"}return function(e,t,n){var r="";if(Array.isArray(n))for(var o=0;o<n.length;o++)r+=Fp(e,t,n[o])+";";else for(var i in n){var s=n[i];if("object"!=typeof s)null!=t&&void 0!==t[s]?r+=i+"{"+t[s]+"}":Dp(s)&&(r+=Ip(i)+":"+zp(i,s)+";");else if(!Array.isArray(s)||"string"!=typeof s[0]||null!=t&&void 0!==t[s[0]]){var a=Fp(e,t,s);switch(i){case"animation":case"animationName":r+=Ip(i)+":"+a+";";break;default:r+=i+"{"+a+"}"}}else for(var c=0;c<s.length;c++)Dp(s[c])&&(r+=Ip(i)+":"+zp(i,s[c])+";")}return r}(e,t,n);case"function":if(void 0!==e){var o=Rp,i=n(e);return Rp=o,Fp(e,t,i)}}if(null==t)return n;var s=t[n];return void 0!==s?s:n}var Rp,$p=/label:\s*([^\s;\n{]+)\s*(;|$)/g,_p=function(e,t,n){if(1===e.length&&"object"==typeof e[0]&&null!==e[0]&&void 0!==e[0].styles)return e[0];var r=!0,o="";Rp=void 0;var i=e[0];null==i||void 0===i.raw?(r=!1,o+=Fp(n,t,i)):o+=i[0];for(var s=1;s<e.length;s++)o+=Fp(n,t,e[s]),r&&(o+=i[s]);$p.lastIndex=0;for(var a,c="";null!==(a=$p.exec(o));)c+="-"+a[1];return{name:function(e){for(var t,n=0,r=0,o=e.length;o>=4;++r,o-=4)t=1540483477*(65535&(t=255&e.charCodeAt(r)|(255&e.charCodeAt(++r))<<8|(255&e.charCodeAt(++r))<<16|(255&e.charCodeAt(++r))<<24))+(59797*(t>>>16)<<16),n=1540483477*(65535&(t^=t>>>24))+(59797*(t>>>16)<<16)^1540483477*(65535&n)+(59797*(n>>>16)<<16);switch(o){case 3:n^=(255&e.charCodeAt(r+2))<<16;case 2:n^=(255&e.charCodeAt(r+1))<<8;case 1:n=1540483477*(65535&(n^=255&e.charCodeAt(r)))+(59797*(n>>>16)<<16)}return(((n=1540483477*(65535&(n^=n>>>13))+(59797*(n>>>16)<<16))^n>>>15)>>>0).toString(36)}(o)+c,styles:o,next:Rp}};function Pp(e,t,n){var r="";return n.split(" ").forEach((function(n){void 0!==e[n]?t.push(e[n]+";"):r+=n+" "})),r}var jp=function(e,t,n){var r=e.key+"-"+t.name;if(!1===n&&void 0===e.registered[r]&&(e.registered[r]=t.styles),void 0===e.inserted[t.name]){var o=t;do{e.insert(t===o?"."+r:"",o,e.sheet,!0),o=o.next}while(void 0!==o)}};function Lp(e,t){if(void 0===e.inserted[t.name])return e.insert("",t,e.sheet,!0)}function Bp(e,t,n){var r=[],o=Pp(e,r,n);return r.length<2?n:o+t(r)}var Vp=function e(t){for(var n="",r=0;r<t.length;r++){var o=t[r];if(null!=o){var i=void 0;switch(typeof o){case"boolean":break;case"object":if(Array.isArray(o))i=e(o);else for(var s in i="",o)o[s]&&s&&(i&&(i+=" "),i+=s);break;default:i=o}i&&(n&&(n+=" "),n+=i)}}return n},Hp=function(e){var t=Op(e);t.sheet.speedy=function(e){this.isSpeedy=e},t.compat=!0;var n=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var o=_p(n,t.registered,void 0);return jp(t,o,!1),t.key+"-"+o.name};return{css:n,cx:function(){for(var e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];return Bp(t.registered,n,Vp(r))},injectGlobal:function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var o=_p(n,t.registered);Lp(t,o)},keyframes:function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var o=_p(n,t.registered),i="animation-"+o.name;return Lp(t,{name:o.name,styles:"@keyframes "+i+"{"+o.styles+"}"}),i},hydrate:function(e){e.forEach((function(e){t.inserted[e]=!0}))},flush:function(){t.registered={},t.inserted={},t.sheet.flush()},sheet:t.sheet,cache:t,getRegisteredStyles:Pp.bind(null,t.registered),merge:Bp.bind(null,t.registered,n)}}({key:"css"}),Wp=Hp.injectGlobal,qp=Hp.css,Jp=Object.defineProperty,Kp=Object.defineProperties,Up=Object.getOwnPropertyDescriptors,Gp=Object.getOwnPropertySymbols,Qp=Object.prototype.hasOwnProperty,Zp=Object.prototype.propertyIsEnumerable,Xp=(e,t,n)=>t in e?Jp(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Yp=(e,t)=>{for(var n in t||(t={}))Qp.call(t,n)&&Xp(e,n,t[n]);if(Gp)for(var n of Gp(t))Zp.call(t,n)&&Xp(e,n,t[n]);return e},eh=(e,t)=>Kp(e,Up(t));const th={typography:"",code:""},nh={radius:"0",lineWidth:"1px"},rh={scrollbar:()=>"",shadow:()=>"",border:()=>""},oh={icon:e=>{const t=document.createElement("div");return t.className="milkdown-icon",t.textContent=e,t}},ih=e=>{if(e.startsWith("rgba"))return e.slice(5,-1).split(",").slice(0,-1).join(",");if(e.startsWith("rgb"))return e.slice(4,-1);const t=(e=>{const t=e.slice(1).replace(/^([a-f\d])([a-f\d])([a-f\d])$/i,((e,t,n,r)=>t+t+n+n+r+r)),[n,r,o,i]=t.match(/^([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i)||[];return n?[r,o,i].map((e=>parseInt(e,16))):null})(e);return t?t.join(", "):(console.warn(`Invalid hex: ${e}`),e)},sh=(e={},t=(e=>`${e}`))=>Object.entries(e).map((([e,n])=>`--${e}: ${t(n)};`)).join("\n"),ah=e=>{const{color:t={},font:n,size:r={}}=e;Wp`
        :root {
            ${((e={})=>sh(e,ih))(t)};
            ${sh(n,(e=>e.join(", ")))};
            ${sh(r)};
        }
    `},ch=H({mixin:{},font:{},size:{},slots:{},palette:()=>""},"ThemeTool"),lh=e=>t=>(t.inject(ch),t=>{ah(e);const n=(e=>{const{font:t,size:n={},mixin:r,slots:o,global:i}=e,s=(e={})=>Object.fromEntries(Object.keys(e).map((e=>[e,`var(--${e})`]))),a={palette:(e,t=1)=>`rgba(var(--${e}), ${t})`,size:Yp(Yp({},nh),s(n)),font:Yp(Yp({},th),s(t))},c=Yp(Yp({},rh),null==r?void 0:r(a)),l=eh(Yp({},a),{mixin:c}),u=Yp(Yp({},oh),null==o?void 0:o(l)),f=eh(Yp({},l),{slots:u});return null==i||i(f),f})(e);t.set(ch,n)});var uh,fh,dh,ph,hh,mh,gh;class vh{constructor(){uh.set(this,B()),fh.set(this,J()),dh.set(this,new Set),ph.set(this,[]),hh.set(this,new W(C(this,uh,"f"),C(this,fh,"f"))),mh.set(this,new q(C(this,uh,"f"),C(this,fh,"f"))),gh.set(this,(()=>{const e=[_f,Bf,ld,Ed,gd,xd],t=(n=e=>x(this,void 0,void 0,(function*(){yield Promise.all(C(this,ph,"f").map((t=>t(e))))})),e=>(e.record(rf),e=>x(void 0,void 0,void 0,(function*(){yield n(e),e.done(rf)}))));var n,r;this.use(e.concat((r=this,e=>(e.inject(af,r).inject(lf).inject(uf).inject(cf).inject(ff).inject(df,nf()).inject(sf,[rf]).record(of),e=>x(void 0,void 0,void 0,(function*(){yield e.waitTimers(sf),e.done(of)}))))).concat(t))})),this.use=e=>([e].flat().forEach((e=>{C(this,dh,"f").add(e(C(this,mh,"f")))})),this),this.config=e=>(C(this,ph,"f").push(e),this),this.create=()=>x(this,void 0,void 0,(function*(){return C(this,gh,"f").call(this),yield Promise.all([...C(this,dh,"f")].map((e=>e(C(this,hh,"f"))))),this})),this.action=e=>e(C(this,hh,"f"))}static make(){return new vh}}uh=new WeakMap,fh=new WeakMap,dh=new WeakMap,ph=new WeakMap,hh=new WeakMap,mh=new WeakMap,gh=new WeakMap;const yh=e=>Object.prototype.hasOwnProperty.call(e,"origin");class bh extends Array{findThenRun(e,t){const n=this.findIndex((t=>yh(t)&&t.origin===e));return n<0||t(n),this}configure(e,t){return this.findThenRun(e,(n=>{this.splice(n,1,e(t))}))}replace(e,t){return this.findThenRun(e,(e=>{this.splice(e,1,t)}))}remove(e){return this.findThenRun(e,(e=>{this.splice(e,1)}))}headless(){return this.filter(yh).forEach((e=>{this.configure(e.origin,{headless:!0})})),this}static create(e){return new bh(...e)}}const wh=(e,t,n)=>[e,t,n],kh=(e,t)=>{try{const r=e.get(ch);return{getClassName:(n=null==t?void 0:t.className,(e,...t)=>{var r;const o=null!=(r=null==n?void 0:n(e))?r:t;return Array.isArray(o)?o.filter((e=>e)).join(" "):o}),getStyle:e=>(null==t?void 0:t.headless)?"":e(r),themeTool:r}}catch{throw A()}var n},xh=async(e,t,n,r)=>{if(await e.wait(of),t.remarkPlugins){const n=t.remarkPlugins(e);e.update(uf,(e=>[...e,...n]))}const o=await n();if(t.commands){t.commands(o,e).forEach((([t,n])=>{e.get(Sd).create(t,n)}))}if(t.inputRules){const n=t.inputRules(o,e);e.update(cf,(e=>[...e,...n]))}if(t.shortcuts){const n=(e,t)=>{var n,o;return null!=(o=null==(n=null==r?void 0:r.keymap)?void 0:n[e])?o:t},o=Object.entries(t.shortcuts).flatMap((([t,[r,o,i]])=>{const s=()=>e.get(Sd).call(r,i),a=n(t,o);return Array.isArray(a)?a.map((e=>({key:e,runner:s}))):{key:a,runner:s}})).map((e=>[e.key,e.runner]));e.update(lf,(e=>e.concat(Jn(Object.fromEntries(o)))))}if(t.prosePlugins){const n=t.prosePlugins(o,e);e.update(lf,(e=>[...e,...n]))}},Ch=e=>{const t=n=>{const r=e(n);return r.origin=t,r};return t},Sh=(e,t,n)=>{const r=t;return r.extend=t=>n(((...n)=>t(e(...n),...n))),r},Mh=e=>Sh(e,Ch((t=>()=>async n=>{var r;const o=kh(n,t),i=e(o,t);if(i.view=null!=(r=null==t?void 0:t.view)?r:i.view,await xh(n,i,(async()=>{const e=i.schema(n);n.update($f,(t=>[...t,[i.id,e]])),await n.wait(If);return n.get(zf).marks[i.id]}),t),i.view){const e=i.view(n);n.update(ff,(t=>[...t,[i.id,e]]))}})),Mh),Oh=e=>Sh(e,Ch((t=>()=>async n=>{var r;const o=kh(n,t),i=e(o,t);if(i.view=null!=(r=null==t?void 0:t.view)?r:i.view,await xh(n,i,(async()=>{const e=i.schema(n);n.update(Rf,(t=>[...t,[i.id,e]])),await n.wait(If);return n.get(zf).nodes[i.id]}),t),i.view){const e=i.view(n);n.update(ff,(t=>[...t,[i.id,e]]))}})),Oh),Ah=e=>Sh(e,Ch((t=>()=>async n=>{const r=kh(n,t),o=e(r,t);if(await xh(n,o,(async()=>{let e={},t={};if(o.schema){const r=o.schema(n);if(r.node){e=r.node;const t=Object.entries(r.node);n.update(Rf,(e=>[...e,...t]))}if(r.mark){t=r.mark;const e=Object.entries(r.mark);n.update($f,(t=>[...t,...e]))}}await n.wait(If);const r=n.get(zf),i=Object.keys(e).map((e=>[e,r.nodes[e]])),s=Object.keys(t).map((e=>[e,r.marks[e]]));return Object.fromEntries([...i,...s])}),t),o.view){const e=o.view(n);n.update(ff,(t=>[...t,...Object.entries(e)]))}})),Ah),Eh={HardBreak:"HardBreak",Blockquote:"Blockquote",BulletList:"BulletList",OrderedList:"OrderedList",CodeFence:"CodeFence",H1:"H1",H2:"H2",H3:"H3",H4:"H4",H5:"H5",H6:"H6",Text:"Text",CodeInline:"CodeInline",Em:"Em",Bold:"Bold",NextListItem:"NextListItem",SinkListItem:"SinkListItem",LiftListItem:"LiftListItem"},Th=Md(),Nh=Mh((e=>{const t=e.getStyle((({palette:e,size:t,font:n})=>qp`
                background-color: ${e("neutral")};
                color: ${e("background")};
                border-radius: ${t.radius};
                font-weight: 500;
                font-family: ${n.code};
                padding: 0 0.2rem;
            `));return{id:"code_inline",schema:()=>({excludes:"_",parseDOM:[{tag:"code"}],toDOM:n=>["code",{class:e.getClassName(n.attrs,"code-inline",t)}],parseMarkdown:{match:e=>"inlineCode"===e.type,runner:(e,t,n)=>{e.openMark(n),e.addText(t.value),e.closeMark(n)}},toMarkdown:{match:e=>"code_inline"===e.type.name,runner:(e,t,n)=>(e.addNode("inlineCode",void 0,n.text||""),!0)}}),inputRules:e=>[Ia(/(?:^|[^`])(`([^`]+)`)$/,e)],commands:e=>[Cd(Th,(()=>Mn(e)))],shortcuts:{[Eh.CodeInline]:wh(Th,"Mod-e")}}})),Dh=Md(),Ih=Mh((e=>({id:"em",schema:()=>({parseDOM:[{tag:"i"},{tag:"em"},{style:"font-style",getAttrs:e=>"italic"===e}],toDOM:t=>["em",{class:e.getClassName(t.attrs,"em")}],parseMarkdown:{match:e=>"emphasis"===e.type,runner:(e,t,n)=>{e.openMark(n),e.next(t.children),e.closeMark(n)}},toMarkdown:{match:e=>"em"===e.type.name,runner:(e,t)=>{e.withMark(t,"emphasis")}}}),inputRules:e=>[Ia(/(?:^|[^_])(_([^_]+)_)$/,e),Ia(/(?:^|[^*])(\*([^*]+)\*)$/,e)],commands:e=>[Cd(Dh,(()=>Mn(e)))],shortcuts:{[Eh.Em]:wh(Dh,"Mod-i")}}))),zh=Md(),Fh=Md(),Rh=Mh((e=>{const t=e.getStyle((e=>{const t=e.palette("line");return qp`
            color: ${e.palette("secondary")};
            cursor: pointer;
            transition: all 0.4s ease-in-out;
            font-weight: 500;
            &:hover {
                background-color: ${t};
                box-shadow: 0 0.2rem ${t}, 0 -0.2rem ${t};
            }
        `}));return{id:"link",schema:()=>({attrs:{href:{},title:{default:null}},inclusive:!1,parseDOM:[{tag:"a[href]",getAttrs:e=>{if(!(e instanceof HTMLElement))throw new Error;return{href:e.getAttribute("href"),title:e.getAttribute("title")}}}],toDOM:n=>["a",Object.assign(Object.assign({},n.attrs),{class:e.getClassName(n.attrs,"link",t)})],parseMarkdown:{match:e=>"link"===e.type,runner:(e,t,n)=>{const r=t.url,o=t.title;e.openMark(n,{href:r,title:o}),e.next(t.children),e.closeMark(n)}},toMarkdown:{match:e=>"link"===e.type.name,runner:(e,t)=>{e.withMark(t,"link",void 0,{title:t.attrs.title,url:t.attrs.href})}}}),commands:e=>[Cd(zh,((t="")=>Mn(e,{href:t}))),Cd(Fh,((t="")=>(n,r)=>{if(!r)return!1;const{marks:o}=n.schema;let i,s=-1;const{selection:a}=n;if(n.doc.nodesBetween(a.from,a.to,((e,t)=>{if(o.link.isInSet(e.marks))return i=e,s=t,!1})),!i)return!1;const c=i.marks.find((({type:t})=>t===e));if(!c)return!1;const l=s,u=s+i.nodeSize,{tr:f}=n,d=o.link.create(Object.assign(Object.assign({},c.attrs),{href:t}));return r(f.removeMark(l,u,c).addMark(l,u,d).setSelection(new Gt(f.selection.$anchor)).scrollIntoView()),!0}))],inputRules:(e,t)=>[new ds(/\[(?<text>.*?)]\((?<href>.*?)(?=|\))"?(?<title>[^"]+)?"?\)/,((n,r,o,i)=>{const[s,a="",c,l]=r,{tr:u}=n;if(s){const n=a||"link";u.replaceWith(o,i,t.get(zf).text(n)).addMark(o,n.length+o,e.create({title:l,href:c}))}return u}))]}})),$h=Md(),_h=Mh((e=>{const t=e.getStyle((()=>qp`
                font-weight: 600;
            `));return{id:"strong",schema:()=>({parseDOM:[{tag:"b"},{tag:"strong"},{style:"font-style",getAttrs:e=>"bold"===e}],toDOM:n=>["strong",{class:e.getClassName(n.attrs,"strong",t)}],parseMarkdown:{match:e=>"strong"===e.type,runner:(e,t,n)=>{e.openMark(n),e.next(t.children),e.closeMark(n)}},toMarkdown:{match:e=>"strong"===e.type.name,runner:(e,t)=>{e.withMark(t,"strong")}}}),inputRules:e=>[Ia(/(?:__)([^_]+)(?:__)$/,e),Ia(/(?:\*\*)([^*]+)(?:\*\*)$/,e)],commands:e=>[Cd($h,(()=>Mn(e)))],shortcuts:{[Eh.Bold]:wh($h,"Mod-b")}}})),Ph=[Nh(),Ih(),_h(),Rh()],jh="blockquote",Lh=Md(),Bh=Oh((e=>{const t=e.getStyle((e=>qp`
                padding-left: 1.875rem;
                line-height: 1.75rem;
                border-left: 4px solid ${e.palette("primary")};
                * {
                    font-size: 1rem;
                    line-height: 1.5rem;
                }
            `));return{id:jh,schema:()=>({content:"block+",group:"block",defining:!0,parseDOM:[{tag:"blockquote"}],toDOM:n=>["blockquote",{class:e.getClassName(n.attrs,jh,t)},0],parseMarkdown:{match:({type:e})=>e===jh,runner:(e,t,n)=>{e.openNode(n).next(t.children).closeNode()}},toMarkdown:{match:e=>e.type.name===jh,runner:(e,t)=>{e.openNode("blockquote").next(t.content).closeNode()}}}),inputRules:e=>[vs(/^\s*>\s$/,e)],commands:e=>[Cd(Lh,(()=>Cn(e)))],shortcuts:{[Eh.Blockquote]:wh(Lh,"Mod-Shift-b")}}})),Vh=Md(),Hh=Oh((e=>{const t="bullet_list";return{id:t,schema:()=>({content:"listItem+",group:"block",parseDOM:[{tag:"ul"}],toDOM:t=>["ul",{class:e.getClassName(t.attrs,"bullet-list")},0],parseMarkdown:{match:({type:e,ordered:t})=>"list"===e&&!t,runner:(e,t,n)=>{e.openNode(n).next(t.children).closeNode()}},toMarkdown:{match:e=>e.type.name===t,runner:(e,t)=>{e.openNode("list",void 0,{ordered:!1}).next(t.content).closeNode()}}}),inputRules:e=>[vs(/^\s*([-+*])\s$/,e)],commands:e=>[Cd(Vh,(()=>Cn(e)))],shortcuts:{[Eh.BulletList]:wh(Vh,"Mod-Shift-8")}}})),Wh=["","javascript","typescript","bash","sql","json","html","css","c","cpp","java","ruby","python","go","rust","markdown"],qh=/^```(?<language>[a-z]*)? $/,Jh=Md(),Kh=Oh(((e,t)=>{const n=e.getStyle((({palette:e,mixin:t,size:n,font:r})=>{const{shadow:o,scrollbar:i,border:s}=t,{lineWidth:a,radius:c}=n;return qp`
            background-color: ${e("background")};
            color: ${e("neutral")};
            font-size: 0.85rem;
            padding: 1.2rem 0.4rem 1.4rem;
            border-radius: ${c};
            font-family: ${r.typography};

            * {
                margin: 0;
            }

            .code-fence_select-wrapper {
                position: relative;
            }

            .code-fence_value {
                width: 10.25rem;
                box-sizing: border-box;
                border-radius: ${n.radius};
                margin: 0 1.2rem 1.2rem;
                ${s()};
                ${o()};
                cursor: pointer;
                background-color: ${e("surface")};
                position: relative;
                display: flex;
                color: ${e("neutral",.87)};
                letter-spacing: 0.5px;
                height: 2.625rem;
                align-items: center;

                & > *:last-child {
                    width: 2.625rem;
                    height: 100%;
                    display: flex;
                    justify-content: center;
                    align-items: center;
                    color: ${e("solid",.87)};
                    border-left: ${a} solid ${e("line")};

                    text-align: center;
                    transition: all 0.2s ease-in-out;
                    &:hover {
                        background: ${e("background")};
                        color: ${e("primary")};
                    }
                }

                > span:first-child {
                    padding-left: 1rem;
                    flex: 1;
                    font-weight: 500;
                }
            }

            .code-fence_select-option {
                list-style: none;
                line-height: 2rem;
                padding-left: 1rem;
                cursor: pointer;
                :hover {
                    background: ${e("secondary",.12)};
                    color: ${e("primary")};
                }
            }

            .code-fence_select {
                &[data-fold='true'] {
                    display: none;
                }

                font-weight: 500;
                position: absolute;
                z-index: 1;
                top: 2.625rem;
                box-sizing: border-box;
                left: 1.2rem;
                padding: 0.5rem 0;
                max-height: 16.75rem;
                width: 10.25rem;
                ${s()};
                ${o()};
                background-color: ${e("surface")};
                border-top: none;
                overflow-y: auto;
                display: flex;
                flex-direction: column;

                ${i("y")}
            }

            code {
                line-height: 1.5;
                font-family: ${r.code};
            }

            pre {
                font-family: ${r.code};
                margin: 0 1.2rem !important;
                overflow-x: scroll;
                white-space: pre !important;

                padding-bottom: 1.4rem;

                ${i("x")}
            }
        `}));return{id:"fence",schema:()=>({content:"text*",group:"block",marks:"",defining:!0,code:!0,attrs:{language:{default:""},fold:{default:!0}},parseDOM:[{tag:"pre",preserveWhitespace:"full",getAttrs:e=>{if(!(e instanceof HTMLElement))throw new Error("Parse DOM error.");return{language:e.dataset.language}}}],toDOM:t=>["div",{"data-language":t.attrs.language,class:e.getClassName(t.attrs,"code-fence",n)},["pre",["code",{spellCheck:"false"},0]]],parseMarkdown:{match:({type:e})=>"code"===e,runner:(e,t,n)=>{const r=t.lang,o=t.value;e.openNode(n,{language:r}),e.addText(o),e.closeNode()}},toMarkdown:{match:e=>"fence"===e.type.name,runner:(e,t)=>{var n;e.addNode("code",void 0,(null===(n=t.content.firstChild)||void 0===n?void 0:n.text)||"",{lang:t.attrs.language})}}}),inputRules:e=>[ys(qh,e,(([e,t])=>{if(e)return{language:t}}))],commands:e=>[Cd(Jh,(()=>Sn(e)))],shortcuts:{[Eh.CodeFence]:wh(Jh,"Mod-Alt-c")},view:r=>(o,i,s)=>{const a=document.createElement("div"),c=document.createElement("div"),l=document.createElement("ul"),u=document.createElement("pre"),f=document.createElement("code"),d=document.createElement("div");d.className="code-fence_value";const p=document.createElement("span");return d.appendChild(p),d.appendChild(r.get(ch).slots.icon("downArrow")),l.className="code-fence_select",l.addEventListener("mousedown",(e=>{if(e.preventDefault(),e.stopPropagation(),!i.editable)return;const t=e.target;if(!(t instanceof HTMLLIElement))return;const{tr:n}=i.state;i.dispatch(n.setNodeMarkup(s(),void 0,{fold:!0,language:t.dataset.value}))})),d.addEventListener("mousedown",(e=>{if(e.preventDefault(),e.stopPropagation(),!i.editable)return;const{tr:t}=i.state;i.dispatch(t.setNodeMarkup(s(),void 0,{fold:!1,language:a.dataset.language}))})),document.addEventListener("mousedown",(()=>{if(!i.editable||"true"===l.dataset.fold)return;const{tr:e}=i.state;i.dispatch(e.setNodeMarkup(s(),void 0,{fold:!0,language:a.dataset.language}))})),((null==t?void 0:t.languageList)||Wh).forEach((e=>{const t=document.createElement("li");t.className="code-fence_select-option",t.innerText=e||"--",l.appendChild(t),t.setAttribute("data-value",e)})),f.spellcheck=!1,c.className="code-fence_select-wrapper",c.contentEditable="false",c.append(d),c.append(l),u.append(f),a.append(c,u),a.setAttribute("class",e.getClassName(o.attrs,"code-fence",n)),a.setAttribute("data-language",o.attrs.language),p.innerText=o.attrs.language||"--",l.setAttribute("data-fold",o.attrs.fold?"true":"false"),{dom:a,contentDOM:f,update:e=>{if("fence"!==e.type.name)return!1;const t=e.attrs.language;return a.dataset.language=t,p.innerText=t||"--",l.setAttribute("data-fold",e.attrs.fold?"true":"false"),!0}}}}})),Uh=Oh((()=>({id:"doc",schema:()=>({content:"block+",parseMarkdown:{match:({type:e})=>"root"===e,runner:(e,t,n)=>{e.injectRoot(t,n)}},toMarkdown:{match:e=>"doc"===e.type.name,runner:(e,t)=>{e.openNode("root"),e.next(t.content)}}})}))),Gh=Md(),Qh=Oh((e=>({id:"hardbreak",schema:()=>({inline:!0,group:"inline",selectable:!1,parseDOM:[{tag:"br"}],toDOM:t=>["br",{class:e.getClassName(t.attrs,"hardbreak")}],parseMarkdown:{match:({type:e})=>"break"===e,runner:(e,t,n)=>{e.addNode(n)}},toMarkdown:{match:e=>"hardbreak"===e.type.name,runner:e=>{e.addNode("break")}}}),commands:e=>[Cd(Gh,(()=>(t,n)=>(null==n||n(t.tr.replaceSelectionWith(e.create()).scrollIntoView()),!0)))],shortcuts:{[Eh.HardBreak]:wh(Gh,"Shift-Enter")}}))),Zh=Array(6).fill(0).map(((e,t)=>t+1)),Xh=Md(),Yh=Ah(((e,t)=>{const n="heading",r={1:qp`
            font-size: 3rem;
            line-height: 3.5rem;
        `,2:qp`
            font-size: 2.125rem;
            line-height: 2.25rem;
        `,3:qp`
            font-size: 1.5rem;
            line-height: 1.5rem;
        `};return{schema:()=>({node:{heading:{content:"inline*",group:"block",attrs:{level:{default:1},id:{default:""}},parseDOM:Zh.map((e=>({tag:`h${e}`,attrs:{level:e}}))),toDOM:n=>{return[`h${n.attrs.level}`,{class:e.getClassName(n.attrs,`heading h${n.attrs.level}`,(o=n.attrs.level,(null==t?void 0:t.headless)?null:qp`
                  ${r[o]||""}
                  margin: 2.5rem 0 !important;
                  font-weight: 400;
              `))},0];var o},parseMarkdown:{match:({type:e})=>e===n,runner:(e,t,n)=>{const r=t.depth;e.openNode(n,{level:r}),e.next(t.children),e.closeNode()}},toMarkdown:{match:e=>e.type.name===n,runner:(e,t)=>{e.openNode("heading",void 0,{depth:t.attrs.level}),e.next(t.content),e.closeNode()}}}}}),inputRules:e=>Zh.map((t=>ys(new RegExp(`^(#{1,${t}})\\s$`),e.heading,(()=>({level:t}))))),commands:e=>[Cd(Xh,((t=1)=>Sn(e.heading,{level:t})))],shortcuts:{[Eh.H1]:wh(Xh,"Mod-Alt-1",1),[Eh.H2]:wh(Xh,"Mod-Alt-2",2),[Eh.H3]:wh(Xh,"Mod-Alt-3",3),[Eh.H4]:wh(Xh,"Mod-Alt-4",4),[Eh.H5]:wh(Xh,"Mod-Alt-5",5),[Eh.H6]:wh(Xh,"Mod-Alt-6",6)}}})),em=Md(),tm=Oh((e=>{const t=e.getStyle((e=>qp`
            height: ${e.size.lineWidth};
            background-color: ${e.palette("line")};
            border-width: 0;
        `));return{id:"hr",schema:()=>({group:"block",parseDOM:[{tag:"hr"}],toDOM:n=>["hr",{class:e.getClassName(n.attrs,"hr",t)}],parseMarkdown:{match:({type:e})=>"thematicBreak"===e,runner:(e,t,n)=>{e.addNode(n)}},toMarkdown:{match:e=>"hr"===e.type.name,runner:e=>{e.addNode("thematicBreak")}}}),inputRules:e=>[new ds(/^(?:---|___\s|\*\*\*\s)$/,((t,n,r,o)=>{const{tr:i}=t;return n[0]&&i.replaceWith(r,o,e.create({})),i}))],commands:(e,t)=>[Cd(em,(()=>(n,r)=>{if(!r)return!0;const{tr:o,selection:i}=n,s=i.from,a=e.create();if(!a)return!0;const c=o.replaceSelectionWith(a).insert(s,t.get(zf).node("paragraph")),l=Jt.findFrom(c.doc.resolve(s),1,!0);return!l||(r(c.setSelection(l).scrollIntoView()),!0)}))]}})),nm=Md(),rm=Md(),om="image",im=Oh(((e,t)=>{var n,r;const o=Object.assign({loading:"Loading...",empty:"Add an Image",failed:"Image loads failed"},null!==(n=null==t?void 0:t.placeholder)&&void 0!==n?n:{}),i=null!==(r=null==t?void 0:t.isBlock)&&void 0!==r&&r,s=e.getStyle((e=>qp`
                display: inline-block;
                position: relative;
                text-align: center;
                font-size: 0;
                vertical-align: text-bottom;
                ${i?"\n                width: 100%;\n                margin: 0 auto;\n                ":""}
                img {
                    max-width: 100%;
                    height: auto;
                    object-fit: contain;
                    margin: 0 2px;
                }
                .icon,
                .placeholder {
                    display: none;
                }

                &.system {
                    width: 100%;
                    padding: 0 2rem;

                    img {
                        width: 0;
                        height: 0;
                        display: none;
                    }

                    .icon,
                    .placeholder {
                        display: inline;
                    }

                    box-sizing: border-box;
                    height: 3rem;
                    background-color: ${e.palette("background")};
                    border-radius: ${e.size.radius};
                    display: inline-flex;
                    gap: 2rem;
                    justify-content: flex-start;
                    align-items: center;
                    .placeholder {
                        margin: 0;
                        line-height: 1;
                        &::before {
                            content: '';
                            font-size: 0.875rem;
                            color: ${e.palette("neutral",.6)};
                        }
                    }
                }

                &.loading {
                    .placeholder {
                        &::before {
                            content: '${o.loading}';
                        }
                    }
                }

                &.empty {
                    .placeholder {
                        &::before {
                            content: '${o.empty}';
                        }
                    }
                }

                &.failed {
                    .placeholder {
                        &::before {
                            content: '${o.failed}';
                        }
                    }
                }
            `)),a=e.getStyle((()=>qp`
                display: inline-block;
                margin: 0 auto;
                object-fit: contain;
                width: 100%;
                position: relative;
                height: auto;
                text-align: center;
            `));return{id:"image",schema:()=>({inline:!0,group:"inline",draggable:!0,marks:"",atom:!0,defining:!0,isolating:!0,attrs:{src:{default:""},alt:{default:null},title:{default:null},failed:{default:!1},loading:{default:!0},width:{default:0}},parseDOM:[{tag:"img[src]",getAttrs:e=>{if(!(e instanceof HTMLElement))throw new Error;return{failed:e.classList.contains("failed"),loading:e.classList.contains("loading"),src:e.getAttribute("src")||"",alt:e.getAttribute("alt"),title:e.getAttribute("title")||e.getAttribute("alt"),width:e.getAttribute("width")||0}}}],toDOM:t=>["img",Object.assign(Object.assign({},t.attrs),{class:e.getClassName(t.attrs,om,t.attrs.failed?"failed":"",t.attrs.loading?"loading":"",a)})],parseMarkdown:{match:({type:e})=>e===om,runner:(e,t,n)=>{const r=t.url,o=t.alt,i=t.title;e.addNode(n,{src:r,alt:o,title:i})}},toMarkdown:{match:e=>e.type.name===om,runner:(e,t)=>{e.addNode("image",void 0,void 0,{title:t.attrs.title,url:t.attrs.src,alt:t.attrs.alt})}}}),commands:e=>[Cd(rm,((t="")=>(n,r)=>{if(!r)return!0;const{tr:o}=n,i=e.create({src:t});if(!i)return!0;return r(o.replaceSelectionWith(i).scrollIntoView()),!0})),Cd(nm,((t="")=>(n,r)=>{const o=Pa(n.selection,e);if(!o)return!1;const{tr:i}=n;return null==r||r(i.setNodeMarkup(o.pos,void 0,Object.assign(Object.assign({},o.node.attrs),{loading:!0,src:t})).scrollIntoView()),!0}))],inputRules:e=>[new ds(/!\[(?<alt>.*?)]\((?<filename>.*?)\s*(?="|\))"?(?<title>[^"]+)?"?\)/,((t,n,r,o)=>{const[i,s,a="",c]=n,{tr:l}=t;return i&&l.replaceWith(r,o,e.create({src:a,alt:s,title:c})),l}))],view:t=>(n,r,o)=>{const i=n.type,a=t.get(ch).slots.icon,c=document.createElement("span");c.className=e.getClassName(n.attrs,om,s),c.contentEditable="false";const l=document.createElement("img");l.contentEditable="true",c.append(l);let u=a("image");const f=document.createElement("span");f.classList.add("placeholder"),c.append(u,f);const d=e=>{const t=a(e);c.replaceChild(t,u),u=t},p=e=>{c.classList.add("system","loading"),d("loading");const t=document.createElement("img");t.src=e,t.onerror=()=>{const{tr:t}=r.state,s=t.setNodeMarkup(o(),i,Object.assign(Object.assign({},n.attrs),{src:e,loading:!1,failed:!0}));r.dispatch(s)},t.onload=()=>{const{tr:s}=r.state,a=s.setNodeMarkup(o(),i,Object.assign(Object.assign({},n.attrs),{width:t.width,src:e,loading:!1,failed:!1}));r.dispatch(a)}},{src:h,loading:m,title:g,alt:v,width:y}=n.attrs;return l.src=h,l.title=g||v,l.alt=v,l.width=y,0===h.length?(c.classList.add("system","empty"),d("image")):m&&p(h),{dom:c,update:e=>{if(e.type.name!==om)return!1;const{src:t,alt:n,title:r,loading:o,failed:i,width:s}=e.attrs;return l.src=t,l.alt=n,l.title=r||n,l.width=s,o?(p(t),!0):i?(c.classList.remove("loading","empty"),c.classList.add("system","failed"),d("brokenImage"),!0):t.length>0?(c.classList.remove("system","empty","loading"),!0):(c.classList.add("system","empty"),d("image"),!0)}}}}})),sm=Md(),am=Md(),cm=Md(),lm=Oh((e=>{const t=e.getStyle((e=>qp`
                &,
                & > * {
                    margin: 0.5rem 0;
                }

                &,
                li {
                    &::marker {
                        color: ${e.palette("primary")};
                    }
                }
            `));return{id:"list_item",schema:()=>({group:"listItem",content:"paragraph block*",defining:!0,parseDOM:[{tag:"li"}],toDOM:n=>["li",{class:e.getClassName(n.attrs,"list-item",t)},0],parseMarkdown:{match:({type:e,checked:t})=>"listItem"===e&&null===t,runner:(e,t,n)=>{e.openNode(n),e.next(t.children),e.closeNode()}},toMarkdown:{match:e=>"list_item"===e.type.name,runner:(e,t)=>{e.openNode("listItem"),e.next(t.content),e.closeNode()}}}),inputRules:e=>[vs(/^\s*([-+*])\s$/,e)],commands:e=>[Cd(sm,(()=>bs(e))),Cd(am,(()=>ks(e))),Cd(cm,(()=>ws(e)))],shortcuts:{[Eh.NextListItem]:wh(sm,"Enter"),[Eh.SinkListItem]:wh(am,"Mod-]"),[Eh.LiftListItem]:wh(cm,"Mod-[")}}})),um=Md(),fm=Oh((e=>({id:"ordered_list",schema:()=>({content:"listItem+",group:"block",attrs:{order:{default:1}},parseDOM:[{tag:"ol",getAttrs:e=>{if(!(e instanceof HTMLElement))throw new Error;return{order:e.hasAttribute("start")?Number(e.getAttribute("start")):1}}}],toDOM:t=>["ol",Object.assign(Object.assign({},1===t.attrs.order?{}:t.attrs.order),{class:e.getClassName(t.attrs,"ordered-list")}),0],parseMarkdown:{match:({type:e,ordered:t})=>"list"===e&&!!t,runner:(e,t,n)=>{e.openNode(n).next(t.children).closeNode()}},toMarkdown:{match:e=>"ordered_list"===e.type.name,runner:(e,t)=>{e.openNode("list",void 0,{ordered:!0,start:1}),e.next(t.content),e.closeNode()}}}),inputRules:e=>[vs(/^(\d+)\.\s$/,e,(e=>({order:Number(e[1])})),((e,t)=>t.childCount+t.attrs.order===Number(e[1])))],commands:e=>[Cd(um,(()=>Cn(e)))],shortcuts:{[Eh.OrderedList]:wh(um,"Mod-Shift-7")}}))),dm=Md(),pm="paragraph",hm=Oh(((e,t)=>{const n=(null==t?void 0:t.headless)?null:qp`
              font-size: 1rem;
              line-height: 1.5;
              letter-spacing: 0.5px;
          `;return{id:pm,schema:()=>({content:"inline*",group:"block",parseDOM:[{tag:"p"}],toDOM:t=>["p",{class:e.getClassName(t.attrs,pm,n)},0],parseMarkdown:{match:e=>"paragraph"===e.type,runner:(e,t,n)=>{e.openNode(n),t.children?e.next(t.children):e.addText(t.value),e.closeNode()}},toMarkdown:{match:e=>"paragraph"===e.type.name,runner:(e,t)=>{e.openNode("paragraph"),e.next(t.content),e.closeNode()}}}),commands:e=>[Cd(dm,(()=>Sn(e)))],shortcuts:{[Eh.Text]:wh(dm,"Mod-Alt-0")}}})),mm=Oh((()=>({id:"text",schema:()=>({group:"inline",parseMarkdown:{match:({type:e})=>"text"===e,runner:(e,t)=>{e.addText(t.value)}},toMarkdown:{match:e=>"text"===e.type.name,runner:(e,t)=>{e.addNode("text",void 0,t.text)}}})}))),gm=[Uh(),hm(),Qh(),Bh(),Kh(),Hh(),fm(),lm(),Yh(),tm(),im(),mm()];function vm(e){if(null==e)return ym;if("string"==typeof e)return function(e){return t;function t(t){return Boolean(t&&t.type===e)}}(e);if("object"==typeof e)return"length"in e?function(e){var t=[],n=-1;for(;++n<e.length;)t[n]=vm(e[n]);return r;function r(){for(var e=-1;++e<t.length;)if(t[e].apply(this,arguments))return!0;return!1}}(e):function(e){return t;function t(t){var n;for(n in e)if(t[n]!==e[n])return!1;return!0}}(e);if("function"==typeof e)return e;throw new Error("Expected function, string, or object as test")}function ym(){return!0}var bm=xm,wm=vm,km=function(e){return e};function xm(e,t,n,r){var o,i;"function"==typeof t&&"function"!=typeof n&&(r=n,n=t,t=null),i=wm(t),o=r?-1:1,function e(s,a,c){var l,u="object"==typeof s&&null!==s?s:{};"string"==typeof u.type&&(l="string"==typeof u.tagName?u.tagName:"string"==typeof u.name?u.name:void 0,f.displayName="node ("+km(u.type+(l?"<"+l+">":""))+")");return f;function f(){var l,u,f=c.concat(s),d=[];if((!t||i(s,a,c[c.length-1]||null))&&false===(d=function(e){if(null!==e&&"object"==typeof e&&"length"in e)return e;if("number"==typeof e)return[true,e];return[e]}(n(s,c)))[0])return d;if(s.children&&"skip"!==d[0])for(u=(r?s.children.length:-1)+o;u>-1&&u<s.children.length;){if(false===(l=e(s.children[u],u,f)())[0])return l;u="number"==typeof l[1]?l[1]:u+o}return d}}(e,null,[])()}xm.CONTINUE=true,xm.SKIP="skip",xm.EXIT=false;var Cm=Em,Sm=bm,Mm=Sm.CONTINUE,Om=Sm.SKIP,Am=Sm.EXIT;function Em(e,t,n,r){"function"==typeof t&&"function"!=typeof n&&(r=n,n=t,t=null),Sm(e,t,(function(e,t){var r=t[t.length-1],o=r?r.children.indexOf(e):null;return n(e,o,r)}),r)}Em.CONTINUE=Mm,Em.SKIP=Om,Em.EXIT=Am;var Tm=Cm,Nm=function(e,t){return function(e){return t;function t(t){var n=t&&Im(t);return n&&Dm.call(e,n)?e[n]:null}}(function(e){var t={};if(!e||!e.type)throw new Error("mdast-util-definitions expected node");return Tm(e,"definition",n),t;function n(e){var n=Im(e.identifier);Dm.call(t,n)||(t[n]=e)}}(e))},Dm={}.hasOwnProperty;function Im(e){return e.toUpperCase()}var zm=Cm,Fm=Nm,Rm=function(){return function(e){var t=Fm(e);function n(e,n,r){var o,i,s;return"definition"===e.type?(r.children.splice(n,1),[zm.SKIP,n]):"imageReference"!==e.type&&"linkReference"!==e.type||!(o=t(e.identifier))?void 0:(i={type:(s="imageReference"===e.type)?"image":"link",url:o.url,title:o.title},s?i.alt=e.alt:i.children=e.children,r.children[n]=i,[zm.SKIP,n])}zm(e,n)}};const $m=()=>function(e){var t;t=e=>(e=>"html"===e.type)(e)?[]:[e],function e(n,r,o){if((e=>!!e.children)(n)){const t=[];for(let r=0,o=n.children.length;r<o;r++){const o=e(n.children[r],r,n);if(o)for(let e=0,n=o.length;e<n;e++)t.push(o[e])}n.children=t}return t(n,r,o)}(e,0,null)[0]},_m=[Ah((()=>({remarkPlugins:()=>[Rm,$m]})))()],Pm=bh.create([...gm,...Ph]),jm=bh.create([..._m,...Pm]),Lm={ToggleInlineCode:Th,ToggleItalic:Dh,ToggleLink:zh,ToggleBold:$h,ModifyLink:Fh,ModifyImage:nm,WrapInBlockquote:Lh,WrapInBulletList:Vh,WrapInOrderedList:um,TurnIntoCodeFence:Jh,TurnIntoHeading:Xh,TurnIntoText:dm,InsertHardbreak:Gh,InsertHr:em,InsertImage:rm,SplitListItem:sm,SinkListItem:am,LiftListItem:cm},Bm=H({},"listener"),Vm=e=>(e.inject(Bm),e=>x(void 0,void 0,void 0,(function*(){yield e.wait(cd);const t=e.get(Bm),n=e.get(sd),r=new pn({state:{init:()=>{},apply:e=>{var r,o;e.docChanged&&(null===(r=t.markdown)||void 0===r||r.forEach((t=>{t((()=>n(e.doc)))})),null===(o=t.doc)||void 0===o||o.forEach((t=>{t(e.doc)})))}}});e.update(lf,(e=>e.concat(r)))}))),Hm=e=>Object.prototype.hasOwnProperty.call(e,"origin");class Wm extends Array{findThenRun(e,t){const n=this.findIndex((t=>Hm(t)&&t.origin===e));return n<0||t(n),this}configure(e,t){return this.findThenRun(e,(n=>{this.splice(n,1,e(t))}))}replace(e,t){return this.findThenRun(e,(e=>{this.splice(e,1,t)}))}remove(e){return this.findThenRun(e,(e=>{this.splice(e,1)}))}headless(){return this.filter(Hm).forEach((e=>{this.configure(e.origin,{headless:!0})})),this}static create(e){return new Wm(...e)}}const qm=(e,t,n)=>[e,t,n],Jm=(e,t)=>{try{const r=e.get(ch);return{getClassName:(n=null==t?void 0:t.className,(e,...t)=>{var r;const o=null!==(r=null==n?void 0:n(e))&&void 0!==r?r:t;return Array.isArray(o)?o.filter((e=>e)).join(" "):o}),getStyle:e=>(null==t?void 0:t.headless)?"":e(r),themeTool:r}}catch(r){throw A()}var n},Km=(e,t,n,r)=>x(void 0,void 0,void 0,(function*(){if(yield e.wait(of),t.remarkPlugins){const n=t.remarkPlugins(e);e.update(uf,(e=>[...e,...n]))}const o=yield n();if(t.commands){t.commands(o,e).forEach((([t,n])=>{e.get(Sd).create(t,n)}))}if(t.inputRules){const n=t.inputRules(o,e);e.update(cf,(e=>[...e,...n]))}if(t.shortcuts){const n=(e,t)=>{var n,o;return null!==(o=null===(n=null==r?void 0:r.keymap)||void 0===n?void 0:n[e])&&void 0!==o?o:t},o=Object.entries(t.shortcuts).flatMap((([t,[r,o,i]])=>{const s=()=>e.get(Sd).call(r,i),a=n(t,o);return Array.isArray(a)?a.map((e=>({key:e,runner:s}))):{key:a,runner:s}})).map((e=>[e.key,e.runner]));e.update(lf,(e=>e.concat(Jn(Object.fromEntries(o)))))}if(t.prosePlugins){const n=t.prosePlugins(o,e);e.update(lf,(e=>[...e,...n]))}})),Um=e=>{const t=(...n)=>{const r=e(...n);return r.origin=t,r};return t},Gm=e=>Um((t=>()=>n=>x(void 0,void 0,void 0,(function*(){const r=Jm(n,t),o=e(r,t);if(yield Km(n,o,(()=>x(void 0,void 0,void 0,(function*(){let e={},t={};if(o.schema){const r=o.schema(n);if(r.node){e=r.node;const t=Object.entries(r.node);n.update(Rf,(e=>[...e,...t]))}if(r.mark){t=r.mark;const e=Object.entries(r.mark);n.update($f,(t=>[...t,...e]))}}yield n.wait(If);const r=n.get(zf),i=Object.keys(e).map((e=>[e,r.nodes[e]])),s=Object.keys(t).map((e=>[e,r.marks[e]]));return Object.fromEntries([...i,...s])}))),t),o.view){const e=o.view(n);n.update(ff,(t=>[...t,...Object.entries(e)]))}})))),Qm={tokenize:function(e,t,n){return function(t){return e.consume(t),r};function r(t){return 87===t||119===t?(e.consume(t),o):n(t)}function o(t){return 87===t||119===t?(e.consume(t),i):n(t)}function i(t){return 46===t?(e.consume(t),s):n(t)}function s(e){return null===e||Lc(e)?n(e):t(e)}},partial:!0},Zm={tokenize:function(e,t,n){let r,o;return i;function i(t){return 38===t?e.check(eg,a,s)(t):46===t||95===t?e.check(Ym,a,s)(t):null===t||Pc(t)||Vc(t)||45!==t&&Hc(t)?a(t):(e.consume(t),i)}function s(t){return 46===t?(o=r,r=void 0,e.consume(t),i):(95===t&&(r=!0),e.consume(t),i)}function a(e){return o||r?n(e):t(e)}},partial:!0},Xm={tokenize:function(e,t){let n=0;return r;function r(s){return 38===s?e.check(eg,t,o)(s):(40===s&&n++,41===s?e.check(Ym,i,o)(s):cg(s)?t(s):ag(s)?e.check(Ym,t,o)(s):(e.consume(s),r))}function o(t){return e.consume(t),r}function i(e){return n--,n<0?t(e):o(e)}},partial:!0},Ym={tokenize:function(e,t,n){return function(t){return e.consume(t),r};function r(o){return ag(o)?(e.consume(o),r):cg(o)?t(o):n(o)}},partial:!0},eg={tokenize:function(e,t,n){return function(t){return e.consume(t),r};function r(t){return Ic(t)?(e.consume(t),r):59===t?(e.consume(t),o):n(t)}function o(e){return cg(e)?t(e):n(e)}},partial:!0},tg={tokenize:function(e,t,n){const r=this;return function(t){if(87!==t&&119!==t||!ug(r.previous)||pg(r.events))return n(t);return e.enter("literalAutolink"),e.enter("literalAutolinkWww"),e.check(Qm,e.attempt(Zm,e.attempt(Xm,o),n),n)(t)};function o(n){return e.exit("literalAutolinkWww"),e.exit("literalAutolink"),t(n)}},previous:ug},ng={tokenize:function(e,t,n){const r=this;return function(t){if(72!==t&&104!==t||!fg(r.previous)||pg(r.events))return n(t);return e.enter("literalAutolink"),e.enter("literalAutolinkHttp"),e.consume(t),o};function o(t){return 84===t||116===t?(e.consume(t),i):n(t)}function i(t){return 84===t||116===t?(e.consume(t),s):n(t)}function s(t){return 80===t||112===t?(e.consume(t),a):n(t)}function a(t){return 83===t||115===t?(e.consume(t),c):c(t)}function c(t){return 58===t?(e.consume(t),l):n(t)}function l(t){return 47===t?(e.consume(t),u):n(t)}function u(t){return 47===t?(e.consume(t),f):n(t)}function f(t){return null===t||Pc(t)||Vc(t)||Hc(t)?n(t):e.attempt(Zm,e.attempt(Xm,d),n)(t)}function d(n){return e.exit("literalAutolinkHttp"),e.exit("literalAutolink"),t(n)}},previous:fg},rg={tokenize:function(e,t,n){const r=this;let o,i;return function(t){if(!lg(t)||!dg(r.previous)||pg(r.events))return n(t);return e.enter("literalAutolink"),e.enter("literalAutolinkEmail"),s(t)};function s(t){return lg(t)?(e.consume(t),s):64===t?(e.consume(t),a):n(t)}function a(t){return 46===t?e.check(Ym,f,c)(t):45===t||95===t?e.check(Ym,n,l)(t):Rc(t)?(!i&&zc(t)&&(i=!0),e.consume(t),a):f(t)}function c(t){return e.consume(t),o=!0,i=void 0,a}function l(t){return e.consume(t),u}function u(t){return 46===t?e.check(Ym,n,c)(t):a(t)}function f(r){return o&&!i?(e.exit("literalAutolinkEmail"),e.exit("literalAutolink"),t(r)):n(r)}},previous:dg},og={},ig={text:og};let sg=48;for(;sg<123;)og[sg]=rg,sg++,58===sg?sg=65:91===sg&&(sg=97);function ag(e){return 33===e||34===e||39===e||41===e||42===e||44===e||46===e||58===e||59===e||60===e||63===e||95===e||126===e}function cg(e){return null===e||60===e||jc(e)}function lg(e){return 43===e||45===e||46===e||95===e||Rc(e)}function ug(e){return null===e||40===e||42===e||95===e||126===e||jc(e)}function fg(e){return null===e||!Ic(e)}function dg(e){return 47!==e&&fg(e)}function pg(e){let t=e.length,n=!1;for(;t--;){const r=e[t][1];if(("labelLink"===r.type||"labelImage"===r.type)&&!r._balanced){n=!0;break}if(r._gfmAutolinkLiteralWalkedInto){n=!1;break}}return e.length>0&&!n&&(e[e.length-1][1]._gfmAutolinkLiteralWalkedInto=!0),n}og[43]=rg,og[45]=rg,og[46]=rg,og[95]=rg,og[72]=[rg,ng],og[104]=[rg,ng],og[87]=[rg,tg],og[119]=[rg,tg];const hg={tokenize:function(e,t,n){const r=this;return qc(e,(function(e){const o=r.events[r.events.length-1];return o&&"gfmFootnoteDefinitionIndent"===o[1].type&&4===o[2].sliceSerialize(o[1],!0).length?t(e):n(e)}),"gfmFootnoteDefinitionIndent",5)},partial:!0};function mg(e,t,n){const r=this;let o=r.events.length;const i=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let s;for(;o--;){const e=r.events[o][1];if("labelImage"===e.type){s=e;break}if("gfmFootnoteCall"===e.type||"labelLink"===e.type||"label"===e.type||"image"===e.type||"link"===e.type)break}return function(o){if(!s||!s._balanced)return n(o);const a=yl(r.sliceSerialize({start:s.end,end:r.now()}));if(94!==a.charCodeAt(0)||!i.includes(a.slice(1)))return n(o);return e.enter("gfmFootnoteCallLabelMarker"),e.consume(o),e.exit("gfmFootnoteCallLabelMarker"),t(o)}}function gg(e,t){let n=e.length;for(;n--;)if("labelImage"===e[n][1].type&&"enter"===e[n][0]){e[n][1];break}e[n+1][1].type="data",e[n+3][1].type="gfmFootnoteCallLabelMarker";const r={type:"gfmFootnoteCall",start:Object.assign({},e[n+3][1].start),end:Object.assign({},e[e.length-1][1].end)},o={type:"gfmFootnoteCallMarker",start:Object.assign({},e[n+3][1].end),end:Object.assign({},e[n+3][1].end)};o.end.column++,o.end.offset++,o.end._bufferIndex++;const i={type:"gfmFootnoteCallString",start:Object.assign({},o.end),end:Object.assign({},e[e.length-1][1].start)},s={type:"chunkString",contentType:"string",start:Object.assign({},i.start),end:Object.assign({},i.end)},a=[e[n+1],e[n+2],["enter",r,t],e[n+3],e[n+4],["enter",o,t],["exit",o,t],["enter",i,t],["enter",s,t],["exit",s,t],["exit",i,t],e[e.length-2],e[e.length-1],["exit",r,t]];return e.splice(n,e.length-n+1,...a),e}function vg(e,t,n){const r=this,o=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let i,s=0;return function(t){return e.enter("gfmFootnoteCall"),e.enter("gfmFootnoteCallLabelMarker"),e.consume(t),e.exit("gfmFootnoteCallLabelMarker"),a};function a(t){return 94!==t?n(t):(e.enter("gfmFootnoteCallMarker"),e.consume(t),e.exit("gfmFootnoteCallMarker"),e.enter("gfmFootnoteCallString"),e.enter("chunkString").contentType="string",c)}function c(a){let u;return null===a||91===a||s++>999?n(a):93===a?i?(e.exit("chunkString"),u=e.exit("gfmFootnoteCallString"),o.includes(yl(r.sliceSerialize(u)))?function(n){return e.enter("gfmFootnoteCallLabelMarker"),e.consume(n),e.exit("gfmFootnoteCallLabelMarker"),e.exit("gfmFootnoteCall"),t}(a):n(a)):n(a):(e.consume(a),jc(a)||(i=!0),92===a?l:c)}function l(t){return 91===t||92===t||93===t?(e.consume(t),s++,c):c(t)}}function yg(e,t,n){const r=this,o=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let i,s,a=0;return function(t){return e.enter("gfmFootnoteDefinition")._container=!0,e.enter("gfmFootnoteDefinitionLabel"),e.enter("gfmFootnoteDefinitionLabelMarker"),e.consume(t),e.exit("gfmFootnoteDefinitionLabelMarker"),c};function c(t){return 94===t?(e.enter("gfmFootnoteDefinitionMarker"),e.consume(t),e.exit("gfmFootnoteDefinitionMarker"),e.enter("gfmFootnoteDefinitionLabelString"),l):n(t)}function l(t){let o;return null===t||91===t||a>999?n(t):93===t?s?(o=e.exit("gfmFootnoteDefinitionLabelString"),i=yl(r.sliceSerialize(o)),e.enter("gfmFootnoteDefinitionLabelMarker"),e.consume(t),e.exit("gfmFootnoteDefinitionLabelMarker"),e.exit("gfmFootnoteDefinitionLabel"),d):n(t):Lc(t)?(e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),a++,l):(e.enter("chunkString").contentType="string",u(t))}function u(t){return null===t||Lc(t)||91===t||93===t||a>999?(e.exit("chunkString"),l(t)):(jc(t)||(s=!0),a++,e.consume(t),92===t?f:u)}function f(t){return 91===t||92===t||93===t?(e.consume(t),a++,u):u(t)}function d(t){return 58===t?(e.enter("definitionMarker"),e.consume(t),e.exit("definitionMarker"),qc(e,p,"gfmFootnoteDefinitionWhitespace")):n(t)}function p(e){return o.includes(i)||o.push(i),t(e)}}function bg(e,t,n){return e.check(el,t,e.attempt(hg,t,n))}function wg(e){e.exit("gfmFootnoteDefinition")}function kg(e={}){let t=e.singleTilde;const n={tokenize:function(e,n,r){const o=this.previous,i=this.events;let s=0;return function(t){if(126===o&&"characterEscape"!==i[i.length-1][1].type)return r(t);return e.enter("strikethroughSequenceTemporary"),a(t)};function a(i){const c=Gc(o);if(126===i)return s>1?r(i):(e.consume(i),s++,a);if(s<2&&!t)return r(i);const l=e.exit("strikethroughSequenceTemporary"),u=Gc(i);return l._open=!u||2===u&&Boolean(c),l._close=!c||2===c&&Boolean(u),n(i)}},resolveAll:function(e,t){let n=-1;for(;++n<e.length;)if("enter"===e[n][0]&&"strikethroughSequenceTemporary"===e[n][1].type&&e[n][1]._close){let r=n;for(;r--;)if("exit"===e[r][0]&&"strikethroughSequenceTemporary"===e[r][1].type&&e[r][1]._open&&e[n][1].end.offset-e[n][1].start.offset==e[r][1].end.offset-e[r][1].start.offset){e[n][1].type="strikethroughSequence",e[r][1].type="strikethroughSequence";const o={type:"strikethrough",start:Object.assign({},e[r][1].start),end:Object.assign({},e[n][1].end)},i={type:"strikethroughText",start:Object.assign({},e[r][1].end),end:Object.assign({},e[n][1].start)},s=[["enter",o,t],["enter",e[r][1],t],["exit",e[r][1],t],["enter",i,t]];Oc(s,s.length,0,Qc(t.parser.constructs.insideSpan.null,e.slice(r+1,n),t)),Oc(s,s.length,0,[["exit",i,t],["enter",e[n][1],t],["exit",e[n][1],t],["exit",o,t]]),Oc(e,r-1,n-r+3,s),n=r+s.length-2;break}}n=-1;for(;++n<e.length;)"strikethroughSequenceTemporary"===e[n][1].type&&(e[n][1].type="data");return e}};return null==t&&(t=!0),{text:{126:n},insideSpan:{null:[n]},attentionMarkers:{null:[126]}}}const xg={flow:{null:{tokenize:function(e,t,n){const r=this,o=[];let i,s,a=0;return function(t){if(e.enter("table")._align=o,e.enter("tableHead"),e.enter("tableRow"),124===t)return c(t);return a++,e.enter("temporaryTableCellContent"),f(t)};function c(t){return e.enter("tableCellDivider"),e.consume(t),e.exit("tableCellDivider"),i=!0,l}function l(t){return null===t||Lc(t)?function(t){if(null===t)return n(t);e.exit("tableRow"),e.exit("tableHead");const o=r.interrupt;return r.interrupt=!0,e.attempt({tokenize:E,partial:!0},(function(t){return r.interrupt=o,e.enter("tableDelimiterRow"),p(t)}),(function(e){return r.interrupt=o,n(e)}))(t)}(t):Bc(t)?(e.enter("whitespace"),e.consume(t),u):(i&&(i=void 0,a++),124===t?c(t):(e.enter("temporaryTableCellContent"),f(t)))}function u(t){return Bc(t)?(e.consume(t),u):(e.exit("whitespace"),l(t))}function f(t){return null===t||124===t||jc(t)?(e.exit("temporaryTableCellContent"),l(t)):(e.consume(t),92===t?d:f)}function d(t){return 92===t||124===t?(e.consume(t),f):f(t)}function p(t){return null===t||Lc(t)?y(t):Bc(t)?(e.enter("whitespace"),e.consume(t),h):45===t?(e.enter("tableDelimiterFiller"),e.consume(t),s=!0,o.push("none"),m):58===t?(e.enter("tableDelimiterAlignment"),e.consume(t),e.exit("tableDelimiterAlignment"),o.push("left"),g):124===t?(e.enter("tableCellDivider"),e.consume(t),e.exit("tableCellDivider"),p):n(t)}function h(t){return Bc(t)?(e.consume(t),h):(e.exit("whitespace"),p(t))}function m(t){return 45===t?(e.consume(t),m):(e.exit("tableDelimiterFiller"),58===t?(e.enter("tableDelimiterAlignment"),e.consume(t),e.exit("tableDelimiterAlignment"),o[o.length-1]="left"===o[o.length-1]?"center":"right",v):p(t))}function g(t){return 45===t?(e.enter("tableDelimiterFiller"),e.consume(t),s=!0,m):n(t)}function v(t){return null===t||Lc(t)?y(t):Bc(t)?(e.enter("whitespace"),e.consume(t),h):124===t?(e.enter("tableCellDivider"),e.consume(t),e.exit("tableCellDivider"),p):n(t)}function y(t){return e.exit("tableDelimiterRow"),s&&a===o.length?null===t?b(t):e.check(Cg,b,e.attempt({tokenize:E,partial:!0},qc(e,w,"linePrefix",4),b))(t):n(t)}function b(n){return e.exit("table"),t(n)}function w(t){return e.enter("tableBody"),k(t)}function k(t){return e.enter("tableRow"),124===t?x(t):(e.enter("temporaryTableCellContent"),M(t))}function x(t){return e.enter("tableCellDivider"),e.consume(t),e.exit("tableCellDivider"),C}function C(t){return null===t||Lc(t)?function(t){if(e.exit("tableRow"),null===t)return A(t);return e.check(Cg,A,e.attempt({tokenize:E,partial:!0},qc(e,k,"linePrefix",4),A))(t)}(t):Bc(t)?(e.enter("whitespace"),e.consume(t),S):124===t?x(t):(e.enter("temporaryTableCellContent"),M(t))}function S(t){return Bc(t)?(e.consume(t),S):(e.exit("whitespace"),C(t))}function M(t){return null===t||124===t||jc(t)?(e.exit("temporaryTableCellContent"),C(t)):(e.consume(t),92===t?O:M)}function O(t){return 92===t||124===t?(e.consume(t),M):M(t)}function A(t){return e.exit("tableBody"),b(t)}function E(e,t,n){return function(t){return e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),qc(e,o,"linePrefix")};function o(o){if(r.parser.lazy[r.now().line]||null===o||Lc(o))return n(o);const i=r.events[r.events.length-1];return!r.parser.constructs.disable.null.includes("codeIndented")&&i&&"linePrefix"===i[1].type&&i[2].sliceSerialize(i[1],!0).length>=4?n(o):(r._gfmTableDynamicInterruptHack=!0,e.check(r.parser.constructs.flow,(function(e){return r._gfmTableDynamicInterruptHack=!1,n(e)}),(function(e){return r._gfmTableDynamicInterruptHack=!1,t(e)}))(o))}}},resolve:function(e,t){let n,r,o,i,s,a,c,l=-1;for(;++l<e.length;){const u=e[l][1];if(o&&("temporaryTableCellContent"===u.type&&(i=i||l,s=l),("tableCellDivider"===u.type||"tableRow"===u.type)&&s)){const n={type:"tableContent",start:e[i][1].start,end:e[s][1].end},r={type:"chunkText",start:n.start,end:n.end,contentType:"text"};e.splice(i,s-i+1,["enter",n,t],["enter",r,t],["exit",r,t],["exit",n,t]),l-=s-i-3,i=void 0,s=void 0}if("exit"===e[l][0]&&void 0!==a&&a+(c?0:1)<l&&("tableCellDivider"===u.type||"tableRow"===u.type&&(a+3<l||"whitespace"!==e[a][1].type))){const o={type:r?"tableDelimiter":n?"tableHeader":"tableData",start:e[a][1].start,end:e[l][1].end};e.splice(l+("tableCellDivider"===u.type?1:0),0,["exit",o,t]),e.splice(a,0,["enter",o,t]),l+=2,a=l+1,c=!0}"tableRow"===u.type&&(o="enter"===e[l][0],o&&(a=l+1,c=!1)),"tableDelimiterRow"===u.type&&(r="enter"===e[l][0],r&&(a=l+1,c=!1)),"tableHead"===u.type&&(n="enter"===e[l][0])}return e}}}},Cg={tokenize:function(e,t,n){let r=0;return function(t){return e.enter("check"),e.consume(t),o};function o(i){return-1===i||32===i?(e.consume(i),r++,4===r?t:o):null===i||jc(i)?t(i):n(i)}},partial:!0};const Sg={text:{91:{tokenize:function(e,t,n){const r=this;return function(t){if(null!==r.previous||!r._gfmTasklistFirstContentOfListItem)return n(t);return e.enter("taskListCheck"),e.enter("taskListCheckMarker"),e.consume(t),e.exit("taskListCheckMarker"),o};function o(t){return jc(t)?(e.enter("taskListCheckValueUnchecked"),e.consume(t),e.exit("taskListCheckValueUnchecked"),i):88===t||120===t?(e.enter("taskListCheckValueChecked"),e.consume(t),e.exit("taskListCheckValueChecked"),i):n(t)}function i(r){return 93===r?(e.enter("taskListCheckMarker"),e.consume(r),e.exit("taskListCheckMarker"),e.exit("taskListCheck"),e.check({tokenize:Mg},t,n)):n(r)}}}}};function Mg(e,t,n){const r=this;return qc(e,(function(e){const o=r.events[r.events.length-1];return(o&&"whitespace"===o[1].type||Lc(e))&&null!==e?t(e):n(e)}),"whitespace")}function Og(e,t){const n=String(e);if("string"!=typeof t)throw new TypeError("Expected character");let r=0,o=n.indexOf(t);for(;-1!==o;)r++,o=n.indexOf(t,o+t.length);return r}const Ag=function(e,t,n,r){"function"==typeof t&&"function"!=typeof n&&(r=n,n=t,t=null);var o=Du(t),i=r?-1:1;!function e(s,a,c){var l,u="object"==typeof s&&null!==s?s:{};"string"==typeof u.type&&(l="string"==typeof u.tagName?u.tagName:"string"==typeof u.name?u.name:void 0,Object.defineProperty(f,"name",{value:"node ("+u.type+(l?"<"+l+">":"")+")"}));return f;function f(){var l,u,f,d=[];if((!t||o(s,a,c[c.length-1]||null))&&false===(d=function(e){if(Array.isArray(e))return e;if("number"==typeof e)return[true,e];return[e]}(n(s,c)))[0])return d;if(s.children&&"skip"!==d[0])for(u=(r?s.children.length:-1)+i,f=c.concat(s);u>-1&&u<s.children.length;){if(false===(l=e(s.children[u],u,f)())[0])return l;u="number"==typeof l[1]?l[1]:u+i}return d}}(e,null,[])()};const Eg={}.hasOwnProperty,Tg=function(e,t,n,r){let o,i;"string"==typeof t||t instanceof RegExp?(i=[[t,n]],o=r):(i=t,o=n),o||(o={});const s=Du(o.ignore||[]),a=function(e){const t=[];if("object"!=typeof e)throw new TypeError("Expected array or object as schema");if(Array.isArray(e)){let n=-1;for(;++n<e.length;)t.push([Ng(e[n][0]),Dg(e[n][1])])}else{let n;for(n in e)Eg.call(e,n)&&t.push([Ng(n),Dg(e[n])])}return t}(i);let c=-1;for(;++c<a.length;)Ag(e,"text",l);return e;function l(e,t){let n,r=-1;for(;++r<t.length;){const e=t[r];if(s(e,n?n.children.indexOf(e):void 0,n))return;n=e}if(n)return function(e,t){const n=a[c][0],r=a[c][1];let o,i=0,s=t.children.indexOf(e),l=[];n.lastIndex=0;let u=n.exec(e.value);for(;u;){o=u.index;let t=r(...u,{index:u.index,input:u.input});if("string"==typeof t&&(t=t.length>0?{type:"text",value:t}:void 0),!1!==t&&(i!==o&&l.push({type:"text",value:e.value.slice(i,o)}),Array.isArray(t)?l.push(...t):t&&l.push(t),i=o+u[0].length),!n.global)break;u=n.exec(e.value)}void 0===o?(l=[e],s--):(i<e.value.length&&l.push({type:"text",value:e.value.slice(i)}),t.children.splice(s,1,...l));return s+l.length+1}(e,n)}};function Ng(e){return"string"==typeof e?new RegExp(function(e){if("string"!=typeof e)throw new TypeError("Expected a string");return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}(e),"g"):e}function Dg(e){return"function"==typeof e?e:()=>e}const Ig=["autolink","link","image","label"],zg={transforms:[function(e){Tg(e,[[/(https?:\/\/|www(?=\.))([-.\w]+)([^ \t\r\n]*)/gi,$g],[/([-.\w+]+)@([-\w]+(?:\.[-\w]+)+)/g,_g]],{ignore:["link","linkReference"]})}],enter:{literalAutolink:function(e){this.enter({type:"link",title:null,url:"",children:[]},e)},literalAutolinkEmail:Rg,literalAutolinkHttp:Rg,literalAutolinkWww:Rg},exit:{literalAutolink:function(e){this.exit(e)},literalAutolinkEmail:function(e){this.config.exit.autolinkEmail.call(this,e)},literalAutolinkHttp:function(e){this.config.exit.autolinkProtocol.call(this,e)},literalAutolinkWww:function(e){this.config.exit.data.call(this,e);this.stack[this.stack.length-1].url="http://"+this.sliceSerialize(e)}}},Fg={unsafe:[{character:"@",before:"[+\\-.\\w]",after:"[\\-.\\w]",inConstruct:"phrasing",notInConstruct:Ig},{character:".",before:"[Ww]",after:"[\\-.\\w]",inConstruct:"phrasing",notInConstruct:Ig},{character:":",before:"[ps]",after:"\\/",inConstruct:"phrasing",notInConstruct:Ig}]};function Rg(e){this.config.enter.autolinkProtocol.call(this,e)}function $g(e,t,n,r,o){let i="";if(!Pg(o))return!1;if(/^w/i.test(t)&&(n=t+n,t="",i="http://"),!function(e){const t=e.split(".");if(t.length<2||t[t.length-1]&&(/_/.test(t[t.length-1])||!/[a-zA-Z\d]/.test(t[t.length-1]))||t[t.length-2]&&(/_/.test(t[t.length-2])||!/[a-zA-Z\d]/.test(t[t.length-2])))return!1;return!0}(n))return!1;const s=function(e){const t=/[!"&'),.:;<>?\]}]+$/.exec(e);let n,r,o,i;if(t)for(e=e.slice(0,t.index),i=t[0],n=i.indexOf(")"),r=Og(e,"("),o=Og(e,")");-1!==n&&r>o;)e+=i.slice(0,n+1),i=i.slice(n+1),n=i.indexOf(")"),o++;return[e,i]}(n+r);if(!s[0])return!1;const a={type:"link",title:null,url:i+t+s[0],children:[{type:"text",value:t+s[0]}]};return s[1]?[a,{type:"text",value:s[1]}]:a}function _g(e,t,n,r){return!(!Pg(r,!0)||/[_-\d]$/.test(n))&&{type:"link",title:null,url:"mailto:"+t+"@"+n,children:[{type:"text",value:t+"@"+n}]}}function Pg(e,t){const n=e.input.charCodeAt(e.index-1);return(0===e.index||Vc(n)||Hc(n))&&(!t||47!==n)}const jg=function(e,t,n,r){"function"==typeof t&&"function"!=typeof n&&(r=n,n=t,t=null);const o=Du(t),i=r?-1:1;!function e(s,a,c){const l="object"==typeof s&&null!==s?s:{};let u;"string"==typeof l.type&&(u="string"==typeof l.tagName?l.tagName:"string"==typeof l.name?l.name:void 0,Object.defineProperty(f,"name",{value:"node ("+l.type+(u?"<"+u+">":"")+")"}));return f;function f(){let l,u,f,d=[];if((!t||o(s,a,c[c.length-1]||null))&&(d=function(e){if(Array.isArray(e))return e;if("number"==typeof e)return[true,e];return[e]}(n(s,c)),false===d[0]))return d;if(s.children&&"skip"!==d[0])for(u=(r?s.children.length:-1)+i,f=c.concat(s);u>-1&&u<s.children.length;){if(l=e(s.children[u],u,f)(),false===l[0])return l;u="number"==typeof l[1]?l[1]:u+i}return d}}(e,null,[])()};let Lg=!1,Bg=!1;function Vg(){return e.peek=function(){return"["},{unsafe:[{character:"[",inConstruct:["phrasing","label","reference"]}],handlers:{footnoteDefinition:function(e,t,n){const r=n.enter("footnoteDefinition"),o=n.enter("label"),i=Cu(n,Au(e),{before:"^",after:"]"}),s="[^"+i+"]:";o();const a=gu(hu(e,n),(function(e,t,n){if(t)return(n?"":"    ")+e;return(n?s:s+" ")+e}));r(),!Lg&&i.includes(":")&&(console.warn("[mdast-util-gfm-footnote] Warning: Found a colon in footnote identifier `"+i+"`. GitHub currently crahes on colons in footnotes (see <https://github.com/github/cmark-gfm/issues/241> for more info)"),Lg=!0);Bg||(l=()=>(console.warn("[mdast-util-gfm-footnote] Warning: Found a list in a footnote definition. GitHub currently crahes on lists in footnotes (see <https://github.com/github/cmark-gfm/issues/241> for more info)"),Bg=!0,!1),"function"==typeof(c="list")&&"function"!=typeof l&&(u=l,l=c,c=null),jg(e,c,(function(e,t){const n=t[t.length-1];return l(e,n?n.children.indexOf(e):null,n)}),u));var c,l,u;return a},footnoteReference:e}};function e(e,t,n){const r=n.enter("footnoteReference"),o=n.enter("reference"),i=Cu(n,Au(e),{before:"^",after:"]"});return o(),r(),"[^"+i+"]"}}const Hg={canContainEols:["delete"],enter:{strikethrough:function(e){this.enter({type:"delete",children:[]},e)}},exit:{strikethrough:function(e){this.exit(e)}}},Wg={unsafe:[{character:"~",inConstruct:"phrasing"}],handlers:{delete:qg}};function qg(e,t,n){const r=n.enter("emphasis"),o=Tu(e,n,{before:"~",after:"~"});return r(),"~~"+o+"~~"}function Jg(e){return e.length}function Kg(e){const t="string"==typeof e?e.codePointAt(0):0;return 67===t||99===t?99:76===t||108===t?108:82===t||114===t?114:0}qg.peek=function(){return"~"};const Ug={enter:{table:function(e){const t=e._align;this.enter({type:"table",align:t,children:[]},e),this.setData("inTable",!0)},tableData:Qg,tableHeader:Qg,tableRow:function(e){this.enter({type:"tableRow",children:[]},e)}},exit:{codeText:function(e){let t=this.resume();this.getData("inTable")&&(t=t.replace(/\\([\\|])/g,Zg));this.stack[this.stack.length-1].value=t,this.exit(e)},table:function(e){this.exit(e),this.setData("inTable")},tableData:Gg,tableHeader:Gg,tableRow:Gg}};function Gg(e){this.exit(e)}function Qg(e){this.enter({type:"tableCell",children:[]},e)}function Zg(e,t){return"|"===t?t:e}function Xg(e){const t=e||{},n=t.tableCellPadding,r=t.tablePipeAlign,o=t.stringLength,i=n?" ":"|";return{unsafe:[{character:"\r",inConstruct:"tableCell"},{character:"\n",inConstruct:"tableCell"},{atBreak:!0,character:"|",after:"[\t :-]"},{character:"|",inConstruct:"tableCell"},{atBreak:!0,character:":",after:"-"},{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{table:function(e,t,n){return a(function(e,t){const n=e.children;let r=-1;const o=[],i=t.enter("table");for(;++r<n.length;)o[r]=c(n[r],t);return i(),o}(e,n),e.align)},tableRow:function(e,t,n){const r=a([c(e,n)]);return r.slice(0,r.indexOf("\n"))},tableCell:s,inlineCode:function(e,t,n){let r=ju(e,0,n);n.stack.includes("tableCell")&&(r=r.replace(/\|/g,"\\$&"));return r}}};function s(e,t,n){const r=n.enter("tableCell"),o=n.enter("phrasing"),s=Tu(e,n,{before:i,after:i});return o(),r(),s}function a(e,t){return function(e,t={}){const n=(t.align||[]).concat(),r=t.stringLength||Jg,o=[],i=[],s=[],a=[];let c=0,l=-1;for(;++l<e.length;){const n=[],o=[];let f=-1;for(e[l].length>c&&(c=e[l].length);++f<e[l].length;){const i=null==(u=e[l][f])?"":String(u);if(!1!==t.alignDelimiters){const e=r(i);o[f]=e,(void 0===a[f]||e>a[f])&&(a[f]=e)}n.push(i)}i[l]=n,s[l]=o}var u;let f=-1;if("object"==typeof n&&"length"in n)for(;++f<c;)o[f]=Kg(n[f]);else{const e=Kg(n);for(;++f<c;)o[f]=e}f=-1;const d=[],p=[];for(;++f<c;){const e=o[f];let n="",r="";99===e?(n=":",r=":"):108===e?n=":":114===e&&(r=":");let i=!1===t.alignDelimiters?1:Math.max(1,a[f]-n.length-r.length);const s=n+"-".repeat(i)+r;!1!==t.alignDelimiters&&(i=n.length+i+r.length,i>a[f]&&(a[f]=i),p[f]=i),d[f]=s}i.splice(1,0,d),s.splice(1,0,p),l=-1;const h=[];for(;++l<i.length;){const e=i[l],n=s[l];f=-1;const r=[];for(;++f<c;){const i=e[f]||"";let s="",l="";if(!1!==t.alignDelimiters){const e=a[f]-(n[f]||0),t=o[f];114===t?s=" ".repeat(e):99===t?e%2?(s=" ".repeat(e/2+.5),l=" ".repeat(e/2-.5)):(s=" ".repeat(e/2),l=s):l=" ".repeat(e)}!1===t.delimiterStart||f||r.push("|"),!1===t.padding||!1===t.alignDelimiters&&""===i||!1===t.delimiterStart&&!f||r.push(" "),!1!==t.alignDelimiters&&r.push(s),r.push(i),!1!==t.alignDelimiters&&r.push(l),!1!==t.padding&&r.push(" "),!1===t.delimiterEnd&&f===c-1||r.push("|")}h.push(!1===t.delimiterEnd?r.join("").replace(/ +$/,""):r.join(""))}return h.join("\n")}(e,{align:t,alignDelimiters:r,padding:n,stringLength:o})}function c(e,t){const n=e.children;let r=-1;const o=[],i=t.enter("tableRow");for(;++r<n.length;)o[r]=s(n[r],0,t);return i(),o}}const Yg={exit:{taskListCheckValueChecked:tv,taskListCheckValueUnchecked:tv,paragraph:function(e){const t=this.stack[this.stack.length-2],n=this.stack[this.stack.length-1],r=t.children,o=n.children[0];let i,s=-1;if(t&&"listItem"===t.type&&"boolean"==typeof t.checked&&o&&"text"===o.type){for(;++s<r.length;){const e=r[s];if("paragraph"===e.type){i=e;break}}i===n&&(o.value=o.value.slice(1),0===o.value.length?n.children.shift():(o.position.start.column++,o.position.start.offset++,n.position.start=Object.assign({},o.position.start)))}this.exit(e)}}},ev={unsafe:[{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{listItem:function(e,t,n){const r=e.children[0];let o=Ju(e,t,n);"boolean"==typeof e.checked&&r&&"paragraph"===r.type&&(o=o.replace(/^(?:[*+-]|\d+\.)([\r\n]| {1,3})/,(function(t){return t+"["+(e.checked?"x":" ")+"] "})));return o}}};function tv(e){this.stack[this.stack.length-2].checked="taskListCheckValueChecked"===e.type}function nv(e={}){const t=this.data();function n(e,n){(t[e]?t[e]:t[e]=[]).push(n)}n("micromarkExtensions",function(e){return Tc([ig,{document:{91:{tokenize:yg,continuation:{tokenize:bg},exit:wg}},text:{91:{tokenize:vg},93:{add:"after",tokenize:mg,resolveTo:gg}}},kg(e),xg,Sg])}(e)),n("fromMarkdownExtensions",[zg,{enter:{gfmFootnoteDefinition:function(e){this.enter({type:"footnoteDefinition",identifier:"",label:"",children:[]},e)},gfmFootnoteDefinitionLabelString:function(){this.buffer()},gfmFootnoteCall:function(e){this.enter({type:"footnoteReference",identifier:"",label:""},e)},gfmFootnoteCallString:function(){this.buffer()}},exit:{gfmFootnoteDefinition:function(e){this.exit(e)},gfmFootnoteDefinitionLabelString:function(e){const t=this.resume(),n=this.stack[this.stack.length-1];n.label=t,n.identifier=yl(this.sliceSerialize(e)).toLowerCase()},gfmFootnoteCall:function(e){this.exit(e)},gfmFootnoteCallString:function(e){const t=this.resume(),n=this.stack[this.stack.length-1];n.label=t,n.identifier=yl(this.sliceSerialize(e)).toLowerCase()}}},Hg,Ug,Yg]),n("toMarkdownExtensions",function(e){return{extensions:[Fg,Vg(),Wg,Xg(e),ev]}}(e))}const rv=e=>_a((e=>"table"===e.type.spec.tableRole))(e),ov=(e,t=3,n=3)=>{const{cell:r,header_cell:o,row:i,table:s}=Ns(e),a=Array(n).fill(0).map((()=>r.createAndFill(null))),c=Array(n).fill(0).map((()=>o.createAndFill(null))),l=Array(t).fill(0).map(((e,t)=>i.create(null,0===t?c:a)));return s.create(null,l)},iv=e=>t=>n=>{const r=rv(n.selection),o="row"===e;if(r){const e=Os.get(r.node);if(t>=0&&t<(o?e.height:e.width)){const i=e.positionAt(o?t:e.height-1,o?e.width-1:t,r.node),s=n.doc.resolve(r.start+i),a=o?Bs.rowSelection:Bs.colSelection,c=e.positionAt(o?t:0,o?0:t,r.node),l=n.doc.resolve(r.start+c);return Ra(n.setSelection(a(s,l)))}}return n},sv=e=>{const t=(e=>{const t=rv(e);if(!t)return;const n=Os.get(t.node);return n.cellsInRect({left:0,right:n.width,top:0,bottom:n.height}).map((e=>{const n=t.node.nodeAt(e),r=e+t.start;return{pos:r,start:r+1,node:n}}))})(e.selection);if(t){const n=e.doc.resolve(t[0].pos),r=e.doc.resolve(t[t.length-1].pos);return Ra(e.setSelection(new Bs(r,n)))}return e};function av(e,{map:t,tableStart:n,table:r},o){const i=Array(o).fill(0).reduce(((e,t,n)=>e+r.child(n).nodeSize),n),{cell:s,row:a}=Ns(r.type.schema),c=Array(t.width).fill(0).map(((e,n)=>{const o=r.nodeAt(t.map[n]);return s.createAndFill({alignment:null==o?void 0:o.attrs.alignment})}));return e.insert(i,a.create(null,c)),e}const cv=e=>e.state.selection;var lv,uv;(uv=lv||(lv={}))[uv.AddColLeft=0]="AddColLeft",uv[uv.AddColRight=1]="AddColRight",uv[uv.AddRowTop=2]="AddRowTop",uv[uv.AddRowBottom=3]="AddRowBottom",uv[uv.AlignLeft=4]="AlignLeft",uv[uv.AlignCenter=5]="AlignCenter",uv[uv.AlignRight=6]="AlignRight",uv[uv.Delete=7]="Delete";const fv=e=>({[lv.AddColLeft]:{$:e.get(ch).slots.icon("leftArrow"),command:()=>fa,disable:e=>!cv(e).isColSelection()},[lv.AddColRight]:{$:e.get(ch).slots.icon("rightArrow"),command:()=>da,disable:e=>!cv(e).isColSelection()},[lv.AddRowTop]:{$:e.get(ch).slots.icon("upArrow"),command:()=>(e,t)=>{if(!zs(e))return!1;if(t){const n=la(e);t(av(e.tr,n,n.top))}return!0},disable:e=>!cv(e).isRowSelection()||"table_header"===cv(e).$head.parent.type.name},[lv.AddRowBottom]:{$:e.get(ch).slots.icon("downArrow"),command:()=>(e,t)=>{if(!zs(e))return!1;if(t){const n=la(e);t(av(e.tr,n,n.bottom))}return!0},disable:e=>!cv(e).isRowSelection()},[lv.AlignLeft]:{$:e.get(ch).slots.icon("alignLeft"),command:()=>va("alignment","left"),disable:e=>!cv(e).isColSelection()},[lv.AlignCenter]:{$:e.get(ch).slots.icon("alignCenter"),command:()=>va("alignment","center"),disable:e=>!cv(e).isColSelection()},[lv.AlignRight]:{$:e.get(ch).slots.icon("alignRight"),command:()=>va("alignment","right"),disable:e=>!cv(e).isColSelection()},[lv.Delete]:{$:e.get(ch).slots.icon("delete"),command:(e,t)=>{const n=cv(t),r=n.isColSelection(),o=n.isRowSelection();return r&&o?ka:r?ha:ga},disable:e=>{const t=cv(e);return!!t.isRowSelection()&&(!t.isColSelection()&&(e=>{const t=Os.get(e.$anchorCell.node(-1)),n=e.$anchorCell.start(-1),r=t.cellsInRect({left:0,right:t.width,top:0,bottom:1}),o=t.cellsInRect(t.rectBetween(e.$anchorCell.pos-n,e.$headCell.pos-n));for(let i=0,s=r.length;i<s;i++)if(-1===o.indexOf(r[i]))return!1;return!0})(t))}}});var dv,pv;(pv=dv||(dv={})).Left="Left",pv.Top="Top",pv.Point="Point";const hv=({size:e,mixin:t,palette:n})=>{var r,o;return qp`
    display: inline-flex;
    cursor: pointer;
    z-index: 2;

    justify-content: space-evenly;

    position: absolute;

    border-radius: ${e.radius};

    ${null===(r=t.border)||void 0===r?void 0:r.call(t)};

    ${null===(o=t.shadow)||void 0===o?void 0:o.call(t)};

    overflow: hidden;
    background: ${n("surface")};

    .icon {
        position: relative;
        color: ${n("solid",.87)};

        width: 3rem;
        line-height: 3rem;
        text-align: center;
        transition: all 0.4s ease-in-out;
        &:hover {
            background-color: ${n("secondary",.12)};
        }
        &.active {
            color: ${n("primary")};
        }
        &:not(:last-child)::after {
            content: '';
            position: absolute;
            right: 0px;
            top: 0;
            width: ${e.lineWidth};
            bottom: 0;
            background: ${n("line")};
        }
    }
    &.hide,
    .hide {
        display: none;
    }
`};function mv(e,t,n,r=0){return ki.widget(t.pos+1,(t=>{const o=document.createElement("div");return o.classList.add((e=>{switch(e){case dv.Left:return"milkdown-cell-left";case dv.Top:return"milkdown-cell-top";case dv.Point:default:return"milkdown-cell-point"}})(n)),n===dv.Point&&o.appendChild(e.get(ch).slots.icon("select")),o.addEventListener("mousedown",(e=>{if(t)switch(e.preventDefault(),n){case dv.Point:return void t.dispatch(sv(t.state.tr));case dv.Left:return void t.dispatch(iv("row")(r)(t.state.tr));case dv.Top:return void t.dispatch(iv("col")(r)(t.state.tr))}})),o}))}const gv=(e,t)=>{const n=fv(e),r=document.createElement("div"),o=t.getStyle(hv);return o&&r.classList.add(o),r.classList.add("table-tooltip","hide"),new pn({key:new gn("MILKDOWN_TABLE_OP"),props:{decorations:t=>{const n=[],r=(o=0,e=>{const t=rv(e);if(!t)return;const n=Os.get(t.node);return o<0||o>=n.width?void 0:n.cellsInRect({left:o,right:o+1,top:0,bottom:n.height}).map((e=>{const n=t.node.nodeAt(e);if(!n)throw new Error;const r=e+t.start;return{pos:r,start:r+1,node:n}}))})(t.selection);var o;if(!r)return null;const i=(s=0,e=>{const t=rv(e);if(!t)return;const n=Os.get(t.node);return s<0||s>=n.height?void 0:n.cellsInRect({left:0,right:n.width,top:s,bottom:s+1}).map((e=>{const n=t.node.nodeAt(e);if(!n)throw new Error;const r=e+t.start;return{pos:r,start:r+1,node:n}}))})(t.selection);var s;if(!i)return null;const[a]=r;return n.push(mv(e,a,dv.Point)),r.forEach(((t,r)=>{n.push(mv(e,t,dv.Left,r))})),i.forEach(((t,r)=>{n.push(mv(e,t,dv.Top,r))})),Mi.create(t.doc,n)}},view:e=>{var t;Object.values(n).forEach((({$:e})=>r.appendChild(e))),null===(t=e.dom.parentNode)||void 0===t||t.appendChild(r);const o=t=>{e&&(t.stopPropagation(),t.preventDefault(),Object.values(n).forEach((({$:n,command:r})=>{n.contains(t.target)&&r(t,e)(e.state,e.dispatch,e)})))},i=()=>{r.classList.add("hide")};return r.addEventListener("mousedown",o),{update:(e,t)=>{const o=e.state;if((null==t?void 0:t.doc.eq(o.doc))&&t.selection.eq(o.selection))return;o.selection instanceof Bs&&e.editable?(((e,t)=>{Object.values(e).forEach((e=>{var n;(null===(n=e.disable)||void 0===n?void 0:n.call(e,t))?e.$.classList.add("hide"):e.$.classList.remove("hide")}))})(n,e),Object.values(n).every((({$:e})=>e.classList.contains("hide")))?i():(r.classList.remove("hide"),((e,t)=>{const{selection:n}=e.state,r=n.isColSelection(),o=n.isRowSelection();za(e,t,((e,t,n)=>{let i=o?e.left-n.left-t.width/2-8:e.left-n.left+(e.width-t.width)/2;return i<0&&(i=0),[e.top-n.top-t.height-(r?14:0)-14,i]}))})(e,r))):i()},destroy:()=>{r.removeEventListener("mousedown",o),r.remove()}}}})},vv=function(e){var t=e.cellAttributes||{},n={colspan:{default:1},rowspan:{default:1},colwidth:{default:null}};for(var r in t)n[r]={default:t[r].default};return{table:{content:"table_row+",tableRole:"table",isolating:!0,group:e.tableGroup,parseDOM:[{tag:"table"}],toDOM:function(){return["table",["tbody",0]]}},table_row:{content:"(table_cell | table_header)*",tableRole:"row",parseDOM:[{tag:"tr"}],toDOM:function(){return["tr",0]}},table_cell:{content:e.cellContent,attrs:n,tableRole:"cell",isolating:!0,parseDOM:[{tag:"td",getAttrs:function(e){return Es(e,t)}}],toDOM:function(e){return["td",Ts(e,t),0]}},table_header:{content:e.cellContent,attrs:n,tableRole:"header_cell",isolating:!0,parseDOM:[{tag:"th",getAttrs:function(e){return Es(e,t)}}],toDOM:function(e){return["th",Ts(e,t),0]}}}}({tableGroup:"block",cellContent:"paragraph",cellAttributes:{alignment:{default:"left",getFromDOM:e=>e.style.textAlign||"left",setDOMAttr:(e,t)=>{t.style=`text-align: ${e||"left"}`}}}}),yv=qp`
    /* copy from https://github.com/ProseMirror/prosemirror-tables/blob/master/style/tables.css */
    .ProseMirror .tableWrapper {
        overflow-x: auto;
    }
    .ProseMirror table {
        border-collapse: collapse;
        table-layout: fixed;
        width: 100%;
        overflow: hidden;
    }
    .ProseMirror td,
    .ProseMirror th {
        vertical-align: top;
        box-sizing: border-box;
        position: relative;
    }
    .ProseMirror .column-resize-handle {
        position: absolute;
        right: -2px;
        top: 0;
        bottom: 0;
        width: 4px;
        z-index: 20;
        background-color: #adf;
        pointer-events: none;
    }
    .ProseMirror.resize-cursor {
        cursor: ew-resize;
        cursor: col-resize;
    }
    /* Give selected cells a blue overlay */
    .ProseMirror .selectedCell:after {
        z-index: 2;
        position: absolute;
        content: '';
        left: 0;
        right: 0;
        top: 0;
        bottom: 0;
        background: rgba(200, 200, 255, 0.4);
        pointer-events: none;
    }
`,bv={NextCell:"NextCell",PrevCell:"PrevCell",ExitTable:"ExitTable"},wv=Md(),kv=Md(),xv=Md(),Cv=Md(),Sv=Gm((e=>((e=>{const t=Wp;e.getStyle((({size:e,palette:n,mixin:r})=>{var o,i,s;t`
            ${yv}

            .tableWrapper {
                margin: 0 !important;

                ${null===(o=r.scrollbar)||void 0===o?void 0:o.call(r,"x")};

                width: 100%;

                table {
                    width: calc(100% - 2rem) !important;
                    border-radius: ${e.radius};
                    box-sizing: border-box;
                    margin: 1rem 0 1rem 1rem !important;
                    overflow: auto !important;
                    * {
                        margin: 0 !important;
                        box-sizing: border-box;
                        font-size: 1rem;
                    }
                    tr {
                        ${null===(i=r.border)||void 0===i?void 0:i.call(r,"bottom")};
                    }

                    th {
                        background: ${n("background",.5)};
                        font-weight: 400;
                    }

                    th,
                    td {
                        min-width: 100px;
                        ${null===(s=r.border)||void 0===s?void 0:s.call(r)};
                        text-align: left;
                        position: relative;
                        line-height: 3rem;
                        box-sizing: border-box;
                        height: 3rem;
                    }

                    .selectedCell {
                        &::after {
                            background: ${n("secondary",.38)};
                        }
                        & ::selection {
                            background: transparent;
                        }
                    }

                    .column-resize-handle {
                        background: ${n("primary")};
                        width: ${e.lineWidth};
                    }

                    th,
                    td {
                        padding: 0 1rem;
                        p {
                            line-height: unset !important;
                        }
                    }

                    .milkdown-cell-left,
                    .milkdown-cell-point,
                    .milkdown-cell-top {
                        position: absolute;

                        &::after {
                            cursor: pointer;
                            position: absolute;
                            top: 0;
                            left: 0;
                            height: 100%;
                            width: 100%;
                            display: block;
                            transition: all 0.2s ease-in-out;
                            background: ${n("secondary",.12)};
                            content: '';
                        }
                        &:hover::after {
                            background: ${n("secondary",.38)};
                        }
                    }

                    .milkdown-cell-left {
                        left: calc(-6px - 0.5rem);
                        top: 0;
                        bottom: 0;
                        width: 0.5rem;
                    }

                    .milkdown-cell-top {
                        left: 0;
                        right: 0;
                        top: calc(-6px - 0.5rem);
                        height: 0.5rem;
                    }

                    .milkdown-cell-point {
                        left: calc(-2px - 1rem);
                        top: calc(-2px - 1rem);
                        width: 1rem;
                        height: 1rem;

                        .icon {
                            position: absolute;
                            top: 0;
                            bottom: 0;
                            left: 0;
                            right: 0;
                        }
                    }
                }
            }
        `}))})(e),{schema:()=>({node:{table:Object.assign(Object.assign({},vv.table),{parseMarkdown:{match:e=>"table"===e.type,runner:(e,t,n)=>{const r=t.align,o=t.children.map(((e,t)=>Object.assign(Object.assign({},e),{align:r,isHeader:0===t})));e.openNode(n),e.next(o),e.closeNode()}},toMarkdown:{match:e=>"table"===e.type.name,runner:(e,t)=>{var n;const r=null===(n=t.content.firstChild)||void 0===n?void 0:n.content;if(!r)return;const o=[];r.forEach((e=>{o.push(e.attrs.alignment)})),e.openNode("table",void 0,{align:o}),e.next(t.content),e.closeNode()}}}),table_row:Object.assign(Object.assign({},vv.table_row),{parseMarkdown:{match:e=>"tableRow"===e.type,runner:(e,t,n)=>{const r=t.align,o=t.children.map(((e,n)=>Object.assign(Object.assign({},e),{align:r[n],isHeader:t.isHeader})));e.openNode(n),e.next(o),e.closeNode()}},toMarkdown:{match:e=>"table_row"===e.type.name,runner:(e,t)=>{e.openNode("tableRow"),e.next(t.content),e.closeNode()}}}),table_cell:Object.assign(Object.assign({},vv.table_cell),{parseMarkdown:{match:e=>"tableCell"===e.type&&!e.isHeader,runner:(e,t,n)=>{const r=t.align;e.openNode(n,{alignment:r}).openNode(e.schema.nodes.paragraph).next(t.children).closeNode().closeNode()}},toMarkdown:{match:e=>"table_cell"===e.type.name,runner:(e,t)=>{e.openNode("tableCell").next(t.content).closeNode()}}}),table_header:Object.assign(Object.assign({},vv.table_header),{parseMarkdown:{match:e=>"tableCell"===e.type&&!!e.isHeader,runner:(e,t,n)=>{const r=t.align;e.openNode(n,{alignment:r}),e.openNode(e.schema.nodes.paragraph),e.next(t.children),e.closeNode(),e.closeNode()}},toMarkdown:{match:e=>"table_header"===e.type.name,runner:(e,t)=>{e.openNode("tableCell"),e.next(t.content),e.closeNode()}}})}}),inputRules:(e,t)=>[new ds(/^\|\|\s$/,((n,r,o,i)=>{const s=n.doc.resolve(o);if(!s.node(-1).canReplaceWith(s.index(-1),s.indexAfter(-1),e.table))return null;const a=ov(t.get(zf)),c=n.tr.replaceRangeWith(o,i,a).scrollIntoView();return c.setSelection(Gt.create(c.doc,o+3))}))],commands:(e,t)=>[Cd(wv,(()=>wa(-1))),Cd(kv,(()=>wa(1))),Cd(xv,(()=>{return e=t.get(zf).nodes.paragraph,(t,n)=>{if(!zs(t))return!1;const{$head:r}=t.selection,o=r.after(),i=t.tr.replaceWith(o,o,e.createAndFill());return i.setSelection(Jt.near(i.doc.resolve(o),1)),null==n||n(i.scrollIntoView()),!0};var e})),Cd(Cv,(()=>(e,n)=>{const{selection:r,tr:o}=e,{from:i}=r,s=ov(t.get(zf)),a=o.replaceSelectionWith(s),c=Jt.findFrom(a.doc.resolve(i),1,!0);return c&&(null==n||n(a.setSelection(c))),!0}))],shortcuts:{[bv.NextCell]:qm(kv,"Mod-]"),[bv.PrevCell]:qm(wv,"Mod-["),[bv.ExitTable]:qm(xv,"Mod-Enter")},prosePlugins:(t,n)=>[gv(n,e),Ma({}),Da()],remarkPlugins:()=>[nv]}))),Mv=/(https?:\/\/)?www\.[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-zA-Z]{2,}\b(?:[-a-zA-Z0-9@:%._+~#=?!&/]*)(?:[-a-zA-Z0-9@:%._+~#=?!&/]*)$/,Ov=Gm((()=>({prosePlugins:()=>[ms({rules:[new ds(Mv,((e,t,n,r)=>{const{schema:o}=e,[i]=t;return i?e.tr.replaceWith(n,r,o.text(i)).addMark(n,i.length+n,o.marks.link.create({href:i.startsWith("www")?`https://${i}`:i})):null}))]})]}))),Av=Object.assign(Object.assign(Object.assign({},Eh),bv),{StrikeThrough:"StrikeThrough",TaskList:"TaskList"}),Ev=Md(),Tv=(Nv=e=>{const t="strike_through",n=e.getStyle((e=>qp`
                text-decoration-color: ${e.palette("secondary")};
            `));return{id:t,schema:()=>({parseDOM:[{tag:"del"},{style:"text-decoration",getAttrs:e=>"line-through"===e}],toDOM:t=>["del",{class:e.getClassName(t.attrs,"strike-through",n)}],parseMarkdown:{match:e=>"delete"===e.type,runner:(e,t,n)=>{e.openMark(n),e.next(t.children),e.closeMark(n)}},toMarkdown:{match:e=>e.type.name===t,runner:(e,t)=>{e.withMark(t,"delete")}}}),inputRules:e=>[Ia(/(?:~~)([^~]+)(?:~~)$/,e),Ia(/(?:^|[^~])(~([^~]+)~)$/,e)],commands:e=>[Cd(Ev,(()=>Mn(e)))],shortcuts:{[Av.StrikeThrough]:qm(Ev,"Mod-Alt-x")}}},Um((e=>()=>t=>x(void 0,void 0,void 0,(function*(){const n=Jm(t,e),r=Nv(n,e);if(yield Km(t,r,(()=>x(void 0,void 0,void 0,(function*(){const e=r.schema(t);return t.update($f,(t=>[...t,[r.id,e]])),yield t.wait(If),t.get(zf).marks[r.id]}))),e),r.view){const e=r.view(t);t.update(ff,(t=>[...t,[r.id,e]]))}})))));var Nv;const Dv=Md(),Iv=Md(),zv=Md(),Fv=Md(),Rv=(e=>Um((t=>()=>n=>x(void 0,void 0,void 0,(function*(){const r=Jm(n,t),o=e(r,t);if(yield Km(n,o,(()=>x(void 0,void 0,void 0,(function*(){const e=o.schema(n);n.update(Rf,(t=>[...t,[o.id,e]])),yield n.wait(If);return n.get(zf).nodes[o.id]}))),t),o.view){const e=o.view(n);n.update(ff,(t=>[...t,[o.id,e]]))}})))))((e=>{const t="task_list_item",n=e.getStyle((({palette:e,size:t})=>qp`
                list-style-type: none;
                position: relative;

                & > div {
                    overflow: hidden;
                    padding: 0 2px;
                }

                label {
                    position: absolute;
                    top: 0;
                    left: -2rem;
                    display: inline-block;
                    width: 1.5rem;
                    height: 1.5rem;
                    margin: 0.5rem 0;
                    input {
                        visibility: hidden;
                    }
                }
                label:before {
                    position: absolute;
                    top: 0;
                    right: 0;
                    bottom: 0;
                    left: 0;
                    border-radius: ${t.radius};
                }
                label:hover:before {
                    background: ${e("background")};
                }
                &[data-checked='true'] {
                    label {
                        color: ${e("primary")};
                    }
                }
                &[data-checked='false'] {
                    label {
                        color: ${e("solid",.87)};
                    }
                }
                .paragraph {
                    margin: 0.5rem 0;
                }
            `));return{id:t,schema:()=>({group:"listItem",content:"paragraph block*",defining:!0,attrs:{checked:{default:!1}},parseDOM:[{tag:'li[data-type="task-list-item"]',getAttrs:e=>{if(!(e instanceof HTMLElement))throw new Error;return{checked:"true"===e.dataset.checked}}}],toDOM:t=>["li",{"data-type":"task-item","data-checked":t.attrs.checked?"true":"false",class:e.getClassName(t.attrs,"task-list-item",n)},0],parseMarkdown:{match:({type:e,checked:t})=>"listItem"===e&&null!==t,runner:(e,t,n)=>{e.openNode(n,{checked:t.checked}),e.next(t.children),e.closeNode()}},toMarkdown:{match:e=>e.type.name===t,runner:(e,t)=>{e.openNode("listItem",void 0,{checked:t.attrs.checked}),e.next(t.content),e.closeNode()}}}),inputRules:e=>[vs(/^\s*(\[([ |x])\])\s$/,e,(e=>({checked:"x"===e[e.length-1]})))],commands:e=>[Cd(Dv,(()=>bs(e))),Cd(Iv,(()=>ks(e))),Cd(zv,(()=>ws(e))),Cd(Fv,(()=>Cn(e)))],shortcuts:{[Av.NextListItem]:qm(Dv,"Enter"),[Av.SinkListItem]:qm(Iv,"Mod-]"),[Av.LiftListItem]:qm(zv,"Mod-["),[Av.TaskList]:qm(Fv,"Mod-Alt-9")},view:r=>(o,i,s)=>{const a=r.get(ch).slots.icon,c=document.createElement("li"),l=document.createElement("label"),u=document.createElement("span"),f=document.createElement("input"),d=document.createElement("div");let p=a("unchecked");l.appendChild(p);const h=e=>{const t=a(e);l.replaceChild(t,p),p=t};l.contentEditable="false",f.type="checkbox";const m=e=>{const t=e.target;if(!(t instanceof HTMLInputElement))return;if(!i.editable)return void(f.checked=!f.checked);const{tr:n}=i.state;i.dispatch(n.setNodeMarkup(s(),void 0,{checked:t.checked}))};f.addEventListener("change",m),c.dataset.checked=o.attrs.checked,o.attrs.checked&&f.setAttribute("checked","checked"),l.append(f,u),c.append(l,d);const g={"data-type":"task-item","data-checked":o.attrs.checked?"true":"false",class:e.getClassName(o.attrs,"task-list-item",n)};return Object.entries(g).forEach((([e,t])=>{c.setAttribute(e,t)})),h(o.attrs.checked?"checked":"unchecked"),{dom:c,contentDOM:d,update:e=>e.type.name===t&&(c.dataset.checked=e.attrs.checked,e.attrs.checked?f.setAttribute("checked","checked"):f.removeAttribute("checked"),h(e.attrs.checked?"checked":"unchecked"),!0),destroy:()=>{f.removeEventListener("change",m)}}}}})),$v=Wm.create([...jm,Sv(),Ov(),Tv(),Rv()]);Object.assign(Object.assign({},Lm),{ToggleStrikeThrough:Ev,TurnIntoTaskList:Fv,SinkTaskListItem:Iv,LiftTaskListItem:zv,SplitTaskListItem:Dv});const _v=({palette:e,size:t})=>({scrollbar:(t="y")=>qp`
        scrollbar-width: thin;
        scrollbar-color: ${e("secondary",.38)} ${e("secondary",.12)};
        -webkit-overflow-scrolling: touch;

        &::-webkit-scrollbar {
            ${"y"===t?"width":"height"}: 4px;
            padding: 0 2px;
            background: ${e("surface")};
        }

        &::-webkit-scrollbar-track {
            border-radius: 4px;
            background: ${e("secondary",.12)};
        }

        &::-webkit-scrollbar-thumb {
            border-radius: 4px;
            background: ${e("secondary",.38)};
        }

        &::-webkit-scrollbar-thumb:hover {
            background: ${e("secondary")};
        }
    `,shadow:()=>{const{lineWidth:n}=t;return qp`
            box-shadow: 0px ${n} ${n} ${e("shadow",.14)},
                0px 2px ${n} ${e("shadow",.12)}, 0px ${n} 3px ${e("shadow",.2)};
        `},border:n=>n?qp`
            ${`border-${n}`}: ${t.lineWidth} solid ${e("line")};
        `:qp`
                border: ${t.lineWidth} solid ${e("line")};
            `}),Pv="#2e3440",jv="#d8dee9",Lv="#eceff4",Bv={shadow:"#3b4252",primary:"#5e81ac",secondary:"#81a1c1",light:{neutral:Pv,solid:"#4c566a",line:jv,background:Lv,surface:"#fff"},dark:{neutral:Lv,solid:jv,line:"#434c5e",background:"#252932",surface:Pv}},Vv=({palette:e,mixin:t,size:n,font:r})=>{var o,i;return qp`
    .milkdown {
        color: ${e("neutral",.87)};
        background: ${e("surface")};

        position: relative;
        font-family: ${r.typography};
        margin-left: auto;
        margin-right: auto;
        ${null===(o=t.shadow)||void 0===o?void 0:o.call(t)};
        padding: 3.125rem 1.25rem;
        box-sizing: border-box;

        .editor {
            outline: none;
            & > * {
                margin: 1.875rem 0;
            }
        }

        .ProseMirror-selectednode {
            outline: ${n.lineWidth} solid ${e("line")};
        }

        li.ProseMirror-selectednode {
            outline: none;
        }

        li.ProseMirror-selectednode::after {
            ${null===(i=t.border)||void 0===i?void 0:i.call(t)};
        }

        @media only screen and (min-width: 72rem) {
            max-width: 57.375rem;
            padding: 3.125rem 7.25rem;
        }

        & ::selection {
            background: ${e("secondary",.38)};
        }
    }
`},Hv={h1:"looks_one",h2:"looks_two",h3:"looks_3",loading:"hourglass_empty",quote:"format_quote",code:"code",table:"table_chart",divider:"horizontal_rule",image:"image",brokenImage:"broken_image",bulletList:"format_list_bulleted",orderedList:"format_list_numbered",taskList:"checklist",bold:"format_bold",italic:"format_italic",inlineCode:"code",strikeThrough:"strikethrough_s",link:"link",leftArrow:"chevron_left",rightArrow:"chevron_right",upArrow:"expand_less",downArrow:"expand_more",alignLeft:"format_align_left",alignRight:"format_align_right",alignCenter:"format_align_center",delete:"delete",select:"select_all",unchecked:"check_box_outline_blank",checked:"check_box"},Wv=qp`
    /* copy from https://github.com/ProseMirror/@milkdown/prose/blob/master/style/prosemirror.css */
    .ProseMirror {
        position: relative;
    }

    .ProseMirror {
        word-wrap: break-word;
        white-space: pre-wrap;
        white-space: break-spaces;
        -webkit-font-variant-ligatures: none;
        font-variant-ligatures: none;
        font-feature-settings: 'liga' 0; /* the above doesn't seem to work in Edge */
    }

    .ProseMirror pre {
        white-space: pre-wrap;
    }

    .ProseMirror li {
        position: relative;
    }

    .ProseMirror-hideselection *::selection {
        background: transparent;
    }
    .ProseMirror-hideselection *::-moz-selection {
        background: transparent;
    }
    .ProseMirror-hideselection {
        caret-color: transparent;
    }

    .ProseMirror-selectednode {
        outline: 2px solid #8cf;
    }

    /* Make sure li selections wrap around markers */

    li.ProseMirror-selectednode {
        outline: none;
    }

    li.ProseMirror-selectednode:after {
        content: '';
        position: absolute;
        left: -32px;
        right: -2px;
        top: -2px;
        bottom: -2px;
        border: 2px solid #8cf;
        pointer-events: none;
    }
`,qv={typography:["Roboto","HelveticaNeue-Light","Helvetica Neue Light","Helvetica Neue","Helvetica","Arial","Lucida Grande","sans-serif"],code:["Consolas","Monaco","Andale Mono","Ubuntu Mono","monospace"]},Jv={radius:"4px",lineWidth:"1px"};lh({font:qv,size:Jv,color:Bv,mixin:_v,slots:()=>({icon:e=>{const t=document.createElement("span");return t.className="icon material-icons material-icons-outlined",t.textContent=Hv[e],t}}),global:e=>{Wp`
            ${Wv};
            ${Vv(e)}
        `}});const Kv={h1:"h1",h2:"h2",h3:"h3",loading:"loading",quote:"quote",code:"code",table:"table",divider:"line",image:"image",brokenImage:"image",bulletList:"unorder-list",orderedList:"order-list",taskList:"checklist",bold:"bold",italic:"italic",inlineCode:"code",strikeThrough:"text-delete",link:"link",leftArrow:"arrow-left",rightArrow:"arrow-right",upArrow:"arrow-up",downArrow:"arrow-down",alignLeft:"align-left",alignRight:"align-right",alignCenter:"align-center",delete:"delete",select:"select-all",unchecked:"unchecked",checked:"checked"};var Uv=lh({font:qv,size:Jv,color:Bv,mixin:_v,slots:()=>({icon:e=>{const t=document.createElement("span");return t.className=`icon ed-icon icon-${Kv[e]}`,t}}),global:e=>{Wp`
          ${Wv};
          ${Vv(e)}
      `}});const Gv=e({props:{enableTooltip:{type:Boolean,default:!1},enableSlash:{type:Boolean,default:!1},enableHistory:{type:Boolean,default:!1},enablePrism:{type:Boolean,default:!1},enableClipboard:{type:Boolean,default:!1},markdown:{type:String,default:""},textColor:{type:String,default:"#494e59"},fontSize:{type:Number,default:16}},emits:["change"],setup(e,{expose:d,emit:p}){const h=e;t((t=>({"2a471791":e.textColor,"5444bbd5":u(m)})));const m=n((()=>k(h.textColor,50))),g=r(),v=r(!0);o((()=>{b()}));let y="";const b=async()=>{const e=vh.make().config((e=>{e.set(bd,g.value),e.set(ud,h.markdown),e.set(yd,{editable:()=>!0}),e.set(Bm,{markdown:[e=>{y=e(),p("change",y)}]})})).use(Uv).use(jm).use($v).use(Vm);if(h.enableTooltip){const{tooltip:t}=await i((()=>import("./index.71d93c8c.js")),["assets/index.71d93c8c.js","assets/index.f259aa9c.js","assets/index.14a817f0.css","assets/color.556e4bcb.js"]);e.use(t)}if(h.enableSlash){const{slash:t}=await i((()=>import("./index.35295a5d.js")),["assets/index.35295a5d.js","assets/index.f259aa9c.js","assets/index.14a817f0.css","assets/color.556e4bcb.js"]);e.use(t)}if(h.enablePrism){const{prism:t}=await i((()=>import("./index.63f2e531.js")),["assets/index.63f2e531.js","assets/index.f259aa9c.js","assets/index.14a817f0.css","assets/color.556e4bcb.js"]);w(),e.use(t)}if(h.enableHistory){const{history:t}=await i((()=>import("./index.13712bcc.js")),["assets/index.13712bcc.js","assets/index.f259aa9c.js","assets/index.14a817f0.css","assets/color.556e4bcb.js"]);e.use(t)}if(h.enableClipboard){const{clipboard:t}=await i((()=>import("./index.d3e68623.js")),["assets/index.d3e68623.js","assets/index.f259aa9c.js","assets/index.14a817f0.css","assets/color.556e4bcb.js"]);e.use(t)}e.create()},w=()=>{const e=document.querySelector("#prism-theme");if(e)return e;const t=document.createElement("link");t.id="prism-theme",t.setAttribute("rel","stylesheet"),t.setAttribute("href","https://unpkg.com/prism-themes/themes/prism-material-light.css"),document.head.appendChild(t)};return d({update:async()=>{v.value=!1,await f(),v.value=!0,await f(),b()}}),(t,n)=>v.value?(s(),a("div",{key:0,ref_key:"editorRef",ref:g,class:"milkdown-wrapper",style:c({width:"100%",height:"100%",fontSize:e.fontSize+"px"})},null,4)):l("",!0)}});const Qv={key:0,class:"logo"},Zv=["width","height"],Xv=[(e=>(y("data-v-5e379799"),e=e(),b(),e))((()=>m("mask",{id:"mask0","mask-type":"alpha",maskUnits:"userSpaceOnUse",x:"0",y:"0",width:"105",height:"140"},[m("path",{d:"M0.183563 0H104.816V139.978H0.183563V0Z",fill:"white"})],-1))),w('<g mask="url(#mask0)" data-v-5e379799><path fill-rule="evenodd" clip-rule="evenodd" d="M2.75348 119.219H64.0647V49.2188H2.75348V119.219Z" fill="#D8DEE9" data-v-5e379799></path><path fill-rule="evenodd" clip-rule="evenodd" d="M101.887 39.4917L91.0489 15.8138V8.20313C91.0489 3.6801 87.3431 0 82.7885 0H22.2115C17.6569 0 13.951 3.6801 13.951 8.20313V15.8138L3.11328 39.4917C0.547759 45.0957 0.183563 47.4742 0.183563 53.3203V131.797C0.183563 136.32 3.8894 140 8.44405 140H96.5559C101.111 140 104.816 136.32 104.816 131.797V53.3203C104.816 47.4742 104.452 45.0957 101.887 39.4917ZM22.2115 5.46875H74.9997C74.6943 6.32479 74.528 7.24464 74.528 8.20313V13.6719H19.458V8.20313C19.458 6.69484 20.6927 5.46875 22.2115 5.46875ZM5.69056 131.797V53.3203C5.69056 47.8928 6.00886 46.3805 8.12722 41.7546L18.4771 19.1406H73.0051L63.6902 39.4917C61.1247 45.0957 60.7605 47.4742 60.7605 53.3203V131.797C60.7605 132.755 60.9268 133.675 61.2323 134.531H8.44405C6.92522 134.531 5.69056 133.305 5.69056 131.797ZM99.3094 131.797C99.3094 133.305 98.0748 134.531 96.5559 134.531H69.021C67.5021 134.531 66.2675 133.305 66.2675 131.797V53.3203C66.2675 47.8928 66.5858 46.3805 68.7041 41.7546L79.7625 17.5926C79.9259 17.2565 80.0221 16.882 80.0335 16.4861C80.0335 16.4832 80.0335 16.4817 80.0335 16.4788C80.035 16.4547 80.035 16.4303 80.035 16.4063V8.20313C80.187 4.57443 85.3914 4.57734 85.542 8.20313V16.4063C85.542 16.7964 85.6264 17.1824 85.7887 17.5372L96.8728 41.7546C98.9911 46.3805 99.3094 47.8928 99.3094 53.3203V131.797Z" fill="#5E81AC" data-v-5e379799></path></g><path fill-rule="evenodd" clip-rule="evenodd" d="M41.6839 55.3754C40.7877 54.8996 39.7021 54.9525 38.8573 55.5121L32.1241 59.968L25.3909 55.5106C24.5461 54.9525 23.4605 54.8996 22.5644 55.3754C21.6693 55.8508 21.1101 56.7779 21.1101 57.7864V68.7239C21.2563 72.3511 26.4721 72.3497 26.6171 68.7239V62.8964L30.5969 65.5309C31.5217 66.1434 32.7266 66.1434 33.6514 65.5309L37.6311 62.8964V68.7239C37.7772 72.3511 42.9931 72.3497 43.1381 68.7239V57.7864C43.1381 56.7779 42.579 55.8508 41.6839 55.3754Z" fill="#434C5E" data-v-5e379799></path><path d="M50.9397 82.4869H13.6757C12.2057 82.4869 11.014 83.6703 11.014 85.1301C11.014 86.5899 12.2057 87.7734 13.6757 87.7734H50.9397C52.4097 87.7734 53.6014 86.5899 53.6014 85.1301C53.6014 83.6703 52.4097 82.4869 50.9397 82.4869Z" fill="#434C5E" data-v-5e379799></path><path d="M50.9397 95.2473H13.6757C12.2057 95.2473 11.014 96.4307 11.014 97.8906C11.014 99.3504 12.2057 100.534 13.6757 100.534H50.9397C52.4097 100.534 53.6014 99.3504 53.6014 97.8906C53.6014 96.4307 52.4097 95.2473 50.9397 95.2473Z" fill="#434C5E" data-v-5e379799></path><path d="M50.9397 108.008H13.6757C12.2057 108.008 11.014 109.191 11.014 110.651C11.014 112.111 12.2057 113.294 13.6757 113.294H50.9397C52.4097 113.294 53.6014 112.111 53.6014 110.651C53.6014 109.191 52.4097 108.008 50.9397 108.008Z" fill="#434C5E" data-v-5e379799></path>',5)];var Yv=d(e({props:{componentSetting:{type:Object,required:!0},element:{type:Object,required:!0},isAction:{type:Boolean,default:!1}},setup(e){const t=e,o=p(),i=n((()=>o.state.isLock)),f=r();h((()=>t.componentSetting.enableTooltip),(()=>f.value.update())),h((()=>t.componentSetting.enableSlash),(()=>f.value.update())),h((()=>t.componentSetting.enablePrism),(()=>f.value.update())),h((()=>t.componentSetting.enableHistory),(()=>f.value.update())),h((()=>t.componentSetting.enableClipboard),(()=>f.value.update()));const d=e=>{const n=JSON.parse(JSON.stringify(v(t.element)));t.isAction?(n.actionSetting.actionClickValue.componentSetting.markdown=e,o.dispatch("updateActionElement",n)):n.componentSetting.markdown=e,o.dispatch("editComponent",n)};return(t,n)=>(s(),a("div",{class:"wrapper",style:c({padding:e.componentSetting.padding+"px"})},[!1!==e.componentSetting.showTitle?(s(),a("div",Qv,[(s(),a("svg",{width:e.componentSetting.textFontSize/96*105,height:e.componentSetting.textFontSize/96*140,viewBox:"0 0 105 140",fill:"none"},Xv,8,Zv)),m("div",{class:"title",style:c({fontSize:1.3*e.componentSetting.textFontSize+"px",color:e.componentSetting.textColor})}," Milkdown Editor ",4)])):l("",!0),g(Gv,{ref_key:"milkdown",ref:f,style:c({fontFamily:e.componentSetting.fontFamily,pointerEvents:u(i)?"auto":"none",flex:1}),textColor:e.componentSetting.textColor,fontSize:e.componentSetting.textFontSize,enableTooltip:e.componentSetting.enableTooltip,enableSlash:e.componentSetting.enableSlash,enableHistory:e.componentSetting.enableHistory,enablePrism:e.componentSetting.enablePrism,enableClipboard:e.componentSetting.enableClipboard,markdown:e.componentSetting.markdown,onChange:d},null,8,["style","textColor","fontSize","enableTooltip","enableSlash","enableHistory","enablePrism","enableClipboard","markdown"])],4))}}),[["__scopeId","data-v-5e379799"]]),ey=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:Yv});export{rm as A,Lh as B,Cv as C,Jh as D,em as E,Mi as F,ki as G,za as H,of as I,Gm as J,Wm as K,$a as L,Fh as M,ls as N,us as O,gn as P,fs as Q,Pf as R,If as S,Gt as T,sd as U,ie as V,Vh as W,ey as X,A as a,Md as b,Sd as c,nm as d,_a as e,Pa as f,$h as g,Dh as h,cf as i,Ev as j,Jn as k,Th as l,$f as m,Rf as n,zh as o,lf as p,Fa as q,uf as r,zf as s,ch as t,qp as u,ff as v,pn as w,Xh as x,um as y,Fv as z};
