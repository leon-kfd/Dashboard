import{d as e,L as t,c as n,r,f as o,M as i,o as s,a,n as c,b as l,N as u,B as f,_ as d,u as p,w as h,i as m,D as v}from"./index.d598616c.js";import{l as g}from"./color.556e4bcb.js";const y=(e,t)=>"function"==typeof t?"[Function]":t,w=e=>JSON.stringify(e,y),b=()=>new Error("Stack over flow, cannot pop on an empty stack."),k=()=>{const e=new Map;return{getSlice:t=>{const n=e.get(t.id);if(!n)throw r=t.sliceName,new Error(`Context "${r}" not found, do you forget to inject it?`);var r;return n},sliceMap:e}};function x(e){this.content=e}x.prototype={constructor:x,find:function(e){for(var t=0;t<this.content.length;t+=2)if(this.content[t]===e)return t;return-1},get:function(e){var t=this.find(e);return-1==t?void 0:this.content[t+1]},update:function(e,t,n){var r=n&&n!=e?this.remove(n):this,o=r.find(e),i=r.content.slice();return-1==o?i.push(n||e,t):(i[o+1]=t,n&&(i[o]=n)),new x(i)},remove:function(e){var t=this.find(e);if(-1==t)return this;var n=this.content.slice();return n.splice(t,2),new x(n)},addToStart:function(e,t){return new x([e,t].concat(this.remove(e).content))},addToEnd:function(e,t){var n=this.remove(e).content.slice();return n.push(e,t),new x(n)},addBefore:function(e,t,n){var r=this.remove(t),o=r.content.slice(),i=r.find(e);return o.splice(-1==i?o.length:i,0,t,n),new x(o)},forEach:function(e){for(var t=0;t<this.content.length;t+=2)e(this.content[t],this.content[t+1])},prepend:function(e){return(e=x.from(e)).size?new x(e.content.concat(this.subtract(e).content)):this},append:function(e){return(e=x.from(e)).size?new x(this.subtract(e).content.concat(e.content)):this},subtract:function(e){var t=this;e=x.from(e);for(var n=0;n<e.content.length;n+=2)t=t.remove(e.content[n]);return t},get size(){return this.content.length>>1}},x.from=function(e){if(e instanceof x)return e;var t=[];if(e)for(var n in e)t.push(n,e[n]);return new x(t)};var S=x;function C(e,t,n){for(var r=0;;r++){if(r==e.childCount||r==t.childCount)return e.childCount==t.childCount?null:n;var o=e.child(r),i=t.child(r);if(o!=i){if(!o.sameMarkup(i))return n;if(o.isText&&o.text!=i.text){for(var s=0;o.text[s]==i.text[s];s++)n++;return n}if(o.content.size||i.content.size){var a=C(o.content,i.content,n+1);if(null!=a)return a}n+=o.nodeSize}else n+=o.nodeSize}}function M(e,t,n,r){for(var o=e.childCount,i=t.childCount;;){if(0==o||0==i)return o==i?null:{a:n,b:r};var s=e.child(--o),a=t.child(--i),c=s.nodeSize;if(s!=a){if(!s.sameMarkup(a))return{a:n,b:r};if(s.isText&&s.text!=a.text){for(var l=0,u=Math.min(s.text.length,a.text.length);l<u&&s.text[s.text.length-l-1]==a.text[a.text.length-l-1];)l++,n--,r--;return{a:n,b:r}}if(s.content.size||a.content.size){var f=M(s.content,a.content,n-1,r-1);if(f)return f}n-=c,r-=c}else n-=c,r-=c}}var O=function(e,t){if(this.content=e,this.size=t||0,null==t)for(var n=0;n<e.length;n++)this.size+=e[n].nodeSize},A={firstChild:{configurable:!0},lastChild:{configurable:!0},childCount:{configurable:!0}};O.prototype.nodesBetween=function(e,t,n,r,o){void 0===r&&(r=0);for(var i=0,s=0;s<t;i++){var a=this.content[i],c=s+a.nodeSize;if(c>e&&!1!==n(a,r+s,o,i)&&a.content.size){var l=s+1;a.nodesBetween(Math.max(0,e-l),Math.min(a.content.size,t-l),n,r+l)}s=c}},O.prototype.descendants=function(e){this.nodesBetween(0,this.size,e)},O.prototype.textBetween=function(e,t,n,r){var o="",i=!0;return this.nodesBetween(e,t,(function(s,a){s.isText?(o+=s.text.slice(Math.max(e,a)-a,t-a),i=!n):s.isLeaf&&r?(o+=r,i=!n):!i&&s.isBlock&&(o+=n,i=!0)}),0),o},O.prototype.append=function(e){if(!e.size)return this;if(!this.size)return e;var t=this.lastChild,n=e.firstChild,r=this.content.slice(),o=0;for(t.isText&&t.sameMarkup(n)&&(r[r.length-1]=t.withText(t.text+n.text),o=1);o<e.content.length;o++)r.push(e.content[o]);return new O(r,this.size+e.size)},O.prototype.cut=function(e,t){if(null==t&&(t=this.size),0==e&&t==this.size)return this;var n=[],r=0;if(t>e)for(var o=0,i=0;i<t;o++){var s=this.content[o],a=i+s.nodeSize;a>e&&((i<e||a>t)&&(s=s.isText?s.cut(Math.max(0,e-i),Math.min(s.text.length,t-i)):s.cut(Math.max(0,e-i-1),Math.min(s.content.size,t-i-1))),n.push(s),r+=s.nodeSize),i=a}return new O(n,r)},O.prototype.cutByIndex=function(e,t){return e==t?O.empty:0==e&&t==this.content.length?this:new O(this.content.slice(e,t))},O.prototype.replaceChild=function(e,t){var n=this.content[e];if(n==t)return this;var r=this.content.slice(),o=this.size+t.nodeSize-n.nodeSize;return r[e]=t,new O(r,o)},O.prototype.addToStart=function(e){return new O([e].concat(this.content),this.size+e.nodeSize)},O.prototype.addToEnd=function(e){return new O(this.content.concat(e),this.size+e.nodeSize)},O.prototype.eq=function(e){if(this.content.length!=e.content.length)return!1;for(var t=0;t<this.content.length;t++)if(!this.content[t].eq(e.content[t]))return!1;return!0},A.firstChild.get=function(){return this.content.length?this.content[0]:null},A.lastChild.get=function(){return this.content.length?this.content[this.content.length-1]:null},A.childCount.get=function(){return this.content.length},O.prototype.child=function(e){var t=this.content[e];if(!t)throw new RangeError("Index "+e+" out of range for "+this);return t},O.prototype.maybeChild=function(e){return this.content[e]},O.prototype.forEach=function(e){for(var t=0,n=0;t<this.content.length;t++){var r=this.content[t];e(r,n,t),n+=r.nodeSize}},O.prototype.findDiffStart=function(e,t){return void 0===t&&(t=0),C(this,e,t)},O.prototype.findDiffEnd=function(e,t,n){return void 0===t&&(t=this.size),void 0===n&&(n=e.size),M(this,e,t,n)},O.prototype.findIndex=function(e,t){if(void 0===t&&(t=-1),0==e)return T(0,e);if(e==this.size)return T(this.content.length,e);if(e>this.size||e<0)throw new RangeError("Position "+e+" outside of fragment ("+this+")");for(var n=0,r=0;;n++){var o=r+this.child(n).nodeSize;if(o>=e)return o==e||t>0?T(n+1,o):T(n,r);r=o}},O.prototype.toString=function(){return"<"+this.toStringInner()+">"},O.prototype.toStringInner=function(){return this.content.join(", ")},O.prototype.toJSON=function(){return this.content.length?this.content.map((function(e){return e.toJSON()})):null},O.fromJSON=function(e,t){if(!t)return O.empty;if(!Array.isArray(t))throw new RangeError("Invalid input for Fragment.fromJSON");return new O(t.map(e.nodeFromJSON))},O.fromArray=function(e){if(!e.length)return O.empty;for(var t,n=0,r=0;r<e.length;r++){var o=e[r];n+=o.nodeSize,r&&o.isText&&e[r-1].sameMarkup(o)?(t||(t=e.slice(0,r)),t[t.length-1]=o.withText(t[t.length-1].text+o.text)):t&&t.push(o)}return new O(t||e,n)},O.from=function(e){if(!e)return O.empty;if(e instanceof O)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new O([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))},Object.defineProperties(O.prototype,A);var E={index:0,offset:0};function T(e,t){return E.index=e,E.offset=t,E}function N(e,t){if(e===t)return!0;if(!e||"object"!=typeof e||!t||"object"!=typeof t)return!1;var n=Array.isArray(e);if(Array.isArray(t)!=n)return!1;if(n){if(e.length!=t.length)return!1;for(var r=0;r<e.length;r++)if(!N(e[r],t[r]))return!1}else{for(var o in e)if(!(o in t)||!N(e[o],t[o]))return!1;for(var i in t)if(!(i in e))return!1}return!0}O.empty=new O([],0);var D=function(e,t){this.type=e,this.attrs=t};function z(e){var t=Error.call(this,e);return t.__proto__=z.prototype,t}D.prototype.addToSet=function(e){for(var t,n=!1,r=0;r<e.length;r++){var o=e[r];if(this.eq(o))return e;if(this.type.excludes(o.type))t||(t=e.slice(0,r));else{if(o.type.excludes(this.type))return e;!n&&o.type.rank>this.type.rank&&(t||(t=e.slice(0,r)),t.push(this),n=!0),t&&t.push(o)}}return t||(t=e.slice()),n||t.push(this),t},D.prototype.removeFromSet=function(e){for(var t=0;t<e.length;t++)if(this.eq(e[t]))return e.slice(0,t).concat(e.slice(t+1));return e},D.prototype.isInSet=function(e){for(var t=0;t<e.length;t++)if(this.eq(e[t]))return!0;return!1},D.prototype.eq=function(e){return this==e||this.type==e.type&&N(this.attrs,e.attrs)},D.prototype.toJSON=function(){var e={type:this.type.name};for(var t in this.attrs){e.attrs=this.attrs;break}return e},D.fromJSON=function(e,t){if(!t)throw new RangeError("Invalid input for Mark.fromJSON");var n=e.marks[t.type];if(!n)throw new RangeError("There is no mark type "+t.type+" in this schema");return n.create(t.attrs)},D.sameSet=function(e,t){if(e==t)return!0;if(e.length!=t.length)return!1;for(var n=0;n<e.length;n++)if(!e[n].eq(t[n]))return!1;return!0},D.setFrom=function(e){if(!e||0==e.length)return D.none;if(e instanceof D)return[e];var t=e.slice();return t.sort((function(e,t){return e.type.rank-t.type.rank})),t},D.none=[],z.prototype=Object.create(Error.prototype),z.prototype.constructor=z,z.prototype.name="ReplaceError";var I=function(e,t,n){this.content=e,this.openStart=t,this.openEnd=n},$={size:{configurable:!0}};function R(e,t,n){var r=e.findIndex(t),o=r.index,i=r.offset,s=e.maybeChild(o),a=e.findIndex(n),c=a.index,l=a.offset;if(i==t||s.isText){if(l!=n&&!e.child(c).isText)throw new RangeError("Removing non-flat range");return e.cut(0,t).append(e.cut(n))}if(o!=c)throw new RangeError("Removing non-flat range");return e.replaceChild(o,s.copy(R(s.content,t-i-1,n-i-1)))}function F(e,t,n,r){var o=e.findIndex(t),i=o.index,s=o.offset,a=e.maybeChild(i);if(s==t||a.isText)return r&&!r.canReplace(i,i,n)?null:e.cut(0,t).append(n).append(e.cut(t));var c=F(a.content,t-s-1,n);return c&&e.replaceChild(i,a.copy(c))}function P(e,t,n){if(n.openStart>e.depth)throw new z("Inserted content deeper than insertion position");if(e.depth-n.openStart!=t.depth-n.openEnd)throw new z("Inconsistent open depths");return _(e,t,n,0)}function _(e,t,n,r){var o=e.index(r),i=e.node(r);if(o==t.index(r)&&r<e.depth-n.openStart){var s=_(e,t,n,r+1);return i.copy(i.content.replaceChild(o,s))}if(n.content.size){if(n.openStart||n.openEnd||e.depth!=r||t.depth!=r){var a=function(e,t){for(var n=t.depth-e.openStart,r=t.node(n).copy(e.content),o=n-1;o>=0;o--)r=t.node(o).copy(O.from(r));return{start:r.resolveNoCache(e.openStart+n),end:r.resolveNoCache(r.content.size-e.openEnd-n)}}(n,e);return W(i,q(e,a.start,a.end,t,r))}var c=e.parent,l=c.content;return W(c,l.cut(0,e.parentOffset).append(n.content).append(l.cut(t.parentOffset)))}return W(i,H(e,t,r))}function B(e,t){if(!t.type.compatibleContent(e.type))throw new z("Cannot join "+t.type.name+" onto "+e.type.name)}function j(e,t,n){var r=e.node(n);return B(r,t.node(n)),r}function L(e,t){var n=t.length-1;n>=0&&e.isText&&e.sameMarkup(t[n])?t[n]=e.withText(t[n].text+e.text):t.push(e)}function V(e,t,n,r){var o=(t||e).node(n),i=0,s=t?t.index(n):o.childCount;e&&(i=e.index(n),e.depth>n?i++:e.textOffset&&(L(e.nodeAfter,r),i++));for(var a=i;a<s;a++)L(o.child(a),r);t&&t.depth==n&&t.textOffset&&L(t.nodeBefore,r)}function W(e,t){if(!e.type.validContent(t))throw new z("Invalid content for node "+e.type.name);return e.copy(t)}function q(e,t,n,r,o){var i=e.depth>o&&j(e,t,o+1),s=r.depth>o&&j(n,r,o+1),a=[];return V(null,e,o,a),i&&s&&t.index(o)==n.index(o)?(B(i,s),L(W(i,q(e,t,n,r,o+1)),a)):(i&&L(W(i,H(e,t,o+1)),a),V(t,n,o,a),s&&L(W(s,H(n,r,o+1)),a)),V(r,null,o,a),new O(a)}function H(e,t,n){var r=[];(V(null,e,n,r),e.depth>n)&&L(W(j(e,t,n+1),H(e,t,n+1)),r);return V(t,null,n,r),new O(r)}$.size.get=function(){return this.content.size-this.openStart-this.openEnd},I.prototype.insertAt=function(e,t){var n=F(this.content,e+this.openStart,t,null);return n&&new I(n,this.openStart,this.openEnd)},I.prototype.removeBetween=function(e,t){return new I(R(this.content,e+this.openStart,t+this.openStart),this.openStart,this.openEnd)},I.prototype.eq=function(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd},I.prototype.toString=function(){return this.content+"("+this.openStart+","+this.openEnd+")"},I.prototype.toJSON=function(){if(!this.content.size)return null;var e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e},I.fromJSON=function(e,t){if(!t)return I.empty;var n=t.openStart||0,r=t.openEnd||0;if("number"!=typeof n||"number"!=typeof r)throw new RangeError("Invalid input for Slice.fromJSON");return new I(O.fromJSON(e,t.content),n,r)},I.maxOpen=function(e,t){void 0===t&&(t=!0);for(var n=0,r=0,o=e.firstChild;o&&!o.isLeaf&&(t||!o.type.spec.isolating);o=o.firstChild)n++;for(var i=e.lastChild;i&&!i.isLeaf&&(t||!i.type.spec.isolating);i=i.lastChild)r++;return new I(e,n,r)},Object.defineProperties(I.prototype,$),I.empty=new I(O.empty,0,0);var J=function(e,t,n){this.pos=e,this.path=t,this.depth=t.length/3-1,this.parentOffset=n},K={parent:{configurable:!0},doc:{configurable:!0},textOffset:{configurable:!0},nodeAfter:{configurable:!0},nodeBefore:{configurable:!0}};J.prototype.resolveDepth=function(e){return null==e?this.depth:e<0?this.depth+e:e},K.parent.get=function(){return this.node(this.depth)},K.doc.get=function(){return this.node(0)},J.prototype.node=function(e){return this.path[3*this.resolveDepth(e)]},J.prototype.index=function(e){return this.path[3*this.resolveDepth(e)+1]},J.prototype.indexAfter=function(e){return e=this.resolveDepth(e),this.index(e)+(e!=this.depth||this.textOffset?1:0)},J.prototype.start=function(e){return 0==(e=this.resolveDepth(e))?0:this.path[3*e-1]+1},J.prototype.end=function(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size},J.prototype.before=function(e){if(!(e=this.resolveDepth(e)))throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[3*e-1]},J.prototype.after=function(e){if(!(e=this.resolveDepth(e)))throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[3*e-1]+this.path[3*e].nodeSize},K.textOffset.get=function(){return this.pos-this.path[this.path.length-1]},K.nodeAfter.get=function(){var e=this.parent,t=this.index(this.depth);if(t==e.childCount)return null;var n=this.pos-this.path[this.path.length-1],r=e.child(t);return n?e.child(t).cut(n):r},K.nodeBefore.get=function(){var e=this.index(this.depth),t=this.pos-this.path[this.path.length-1];return t?this.parent.child(e).cut(0,t):0==e?null:this.parent.child(e-1)},J.prototype.posAtIndex=function(e,t){t=this.resolveDepth(t);for(var n=this.path[3*t],r=0==t?0:this.path[3*t-1]+1,o=0;o<e;o++)r+=n.child(o).nodeSize;return r},J.prototype.marks=function(){var e=this.parent,t=this.index();if(0==e.content.size)return D.none;if(this.textOffset)return e.child(t).marks;var n=e.maybeChild(t-1),r=e.maybeChild(t);if(!n){var o=n;n=r,r=o}for(var i=n.marks,s=0;s<i.length;s++)!1!==i[s].type.spec.inclusive||r&&i[s].isInSet(r.marks)||(i=i[s--].removeFromSet(i));return i},J.prototype.marksAcross=function(e){var t=this.parent.maybeChild(this.index());if(!t||!t.isInline)return null;for(var n=t.marks,r=e.parent.maybeChild(e.index()),o=0;o<n.length;o++)!1!==n[o].type.spec.inclusive||r&&n[o].isInSet(r.marks)||(n=n[o--].removeFromSet(n));return n},J.prototype.sharedDepth=function(e){for(var t=this.depth;t>0;t--)if(this.start(t)<=e&&this.end(t)>=e)return t;return 0},J.prototype.blockRange=function(e,t){if(void 0===e&&(e=this),e.pos<this.pos)return e.blockRange(this);for(var n=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);n>=0;n--)if(e.pos<=this.end(n)&&(!t||t(this.node(n))))return new X(this,e,n)},J.prototype.sameParent=function(e){return this.pos-this.parentOffset==e.pos-e.parentOffset},J.prototype.max=function(e){return e.pos>this.pos?e:this},J.prototype.min=function(e){return e.pos<this.pos?e:this},J.prototype.toString=function(){for(var e="",t=1;t<=this.depth;t++)e+=(e?"/":"")+this.node(t).type.name+"_"+this.index(t-1);return e+":"+this.parentOffset},J.resolve=function(e,t){if(!(t>=0&&t<=e.content.size))throw new RangeError("Position "+t+" out of range");for(var n=[],r=0,o=t,i=e;;){var s=i.content.findIndex(o),a=s.index,c=s.offset,l=o-c;if(n.push(i,a,r+c),!l)break;if((i=i.child(a)).isText)break;o=l-1,r+=c+1}return new J(t,n,o)},J.resolveCached=function(e,t){for(var n=0;n<U.length;n++){var r=U[n];if(r.pos==t&&r.doc==e)return r}var o=U[G]=J.resolve(e,t);return G=(G+1)%Q,o},Object.defineProperties(J.prototype,K);var U=[],G=0,Q=12,X=function(e,t,n){this.$from=e,this.$to=t,this.depth=n},Z={start:{configurable:!0},end:{configurable:!0},parent:{configurable:!0},startIndex:{configurable:!0},endIndex:{configurable:!0}};Z.start.get=function(){return this.$from.before(this.depth+1)},Z.end.get=function(){return this.$to.after(this.depth+1)},Z.parent.get=function(){return this.$from.node(this.depth)},Z.startIndex.get=function(){return this.$from.index(this.depth)},Z.endIndex.get=function(){return this.$to.indexAfter(this.depth)},Object.defineProperties(X.prototype,Z);var Y=Object.create(null),ee=function(e,t,n,r){this.type=e,this.attrs=t,this.content=n||O.empty,this.marks=r||D.none},te={nodeSize:{configurable:!0},childCount:{configurable:!0},textContent:{configurable:!0},firstChild:{configurable:!0},lastChild:{configurable:!0},isBlock:{configurable:!0},isTextblock:{configurable:!0},inlineContent:{configurable:!0},isInline:{configurable:!0},isText:{configurable:!0},isLeaf:{configurable:!0},isAtom:{configurable:!0}};te.nodeSize.get=function(){return this.isLeaf?1:2+this.content.size},te.childCount.get=function(){return this.content.childCount},ee.prototype.child=function(e){return this.content.child(e)},ee.prototype.maybeChild=function(e){return this.content.maybeChild(e)},ee.prototype.forEach=function(e){this.content.forEach(e)},ee.prototype.nodesBetween=function(e,t,n,r){void 0===r&&(r=0),this.content.nodesBetween(e,t,n,r,this)},ee.prototype.descendants=function(e){this.nodesBetween(0,this.content.size,e)},te.textContent.get=function(){return this.textBetween(0,this.content.size,"")},ee.prototype.textBetween=function(e,t,n,r){return this.content.textBetween(e,t,n,r)},te.firstChild.get=function(){return this.content.firstChild},te.lastChild.get=function(){return this.content.lastChild},ee.prototype.eq=function(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)},ee.prototype.sameMarkup=function(e){return this.hasMarkup(e.type,e.attrs,e.marks)},ee.prototype.hasMarkup=function(e,t,n){return this.type==e&&N(this.attrs,t||e.defaultAttrs||Y)&&D.sameSet(this.marks,n||D.none)},ee.prototype.copy=function(e){return void 0===e&&(e=null),e==this.content?this:new this.constructor(this.type,this.attrs,e,this.marks)},ee.prototype.mark=function(e){return e==this.marks?this:new this.constructor(this.type,this.attrs,this.content,e)},ee.prototype.cut=function(e,t){return 0==e&&t==this.content.size?this:this.copy(this.content.cut(e,t))},ee.prototype.slice=function(e,t,n){if(void 0===t&&(t=this.content.size),void 0===n&&(n=!1),e==t)return I.empty;var r=this.resolve(e),o=this.resolve(t),i=n?0:r.sharedDepth(t),s=r.start(i),a=r.node(i).content.cut(r.pos-s,o.pos-s);return new I(a,r.depth-i,o.depth-i)},ee.prototype.replace=function(e,t,n){return P(this.resolve(e),this.resolve(t),n)},ee.prototype.nodeAt=function(e){for(var t=this;;){var n=t.content.findIndex(e),r=n.index,o=n.offset;if(!(t=t.maybeChild(r)))return null;if(o==e||t.isText)return t;e-=o+1}},ee.prototype.childAfter=function(e){var t=this.content.findIndex(e),n=t.index,r=t.offset;return{node:this.content.maybeChild(n),index:n,offset:r}},ee.prototype.childBefore=function(e){if(0==e)return{node:null,index:0,offset:0};var t=this.content.findIndex(e),n=t.index,r=t.offset;if(r<e)return{node:this.content.child(n),index:n,offset:r};var o=this.content.child(n-1);return{node:o,index:n-1,offset:r-o.nodeSize}},ee.prototype.resolve=function(e){return J.resolveCached(this,e)},ee.prototype.resolveNoCache=function(e){return J.resolve(this,e)},ee.prototype.rangeHasMark=function(e,t,n){var r=!1;return t>e&&this.nodesBetween(e,t,(function(e){return n.isInSet(e.marks)&&(r=!0),!r})),r},te.isBlock.get=function(){return this.type.isBlock},te.isTextblock.get=function(){return this.type.isTextblock},te.inlineContent.get=function(){return this.type.inlineContent},te.isInline.get=function(){return this.type.isInline},te.isText.get=function(){return this.type.isText},te.isLeaf.get=function(){return this.type.isLeaf},te.isAtom.get=function(){return this.type.isAtom},ee.prototype.toString=function(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);var e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),re(this.marks,e)},ee.prototype.contentMatchAt=function(e){var t=this.type.contentMatch.matchFragment(this.content,0,e);if(!t)throw new Error("Called contentMatchAt on a node with invalid content");return t},ee.prototype.canReplace=function(e,t,n,r,o){void 0===n&&(n=O.empty),void 0===r&&(r=0),void 0===o&&(o=n.childCount);var i=this.contentMatchAt(e).matchFragment(n,r,o),s=i&&i.matchFragment(this.content,t);if(!s||!s.validEnd)return!1;for(var a=r;a<o;a++)if(!this.type.allowsMarks(n.child(a).marks))return!1;return!0},ee.prototype.canReplaceWith=function(e,t,n,r){if(r&&!this.type.allowsMarks(r))return!1;var o=this.contentMatchAt(e).matchType(n),i=o&&o.matchFragment(this.content,t);return!!i&&i.validEnd},ee.prototype.canAppend=function(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)},ee.prototype.check=function(){if(!this.type.validContent(this.content))throw new RangeError("Invalid content for node "+this.type.name+": "+this.content.toString().slice(0,50));for(var e=D.none,t=0;t<this.marks.length;t++)e=this.marks[t].addToSet(e);if(!D.sameSet(e,this.marks))throw new RangeError("Invalid collection of marks for node "+this.type.name+": "+this.marks.map((function(e){return e.type.name})));this.content.forEach((function(e){return e.check()}))},ee.prototype.toJSON=function(){var e={type:this.type.name};for(var t in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map((function(e){return e.toJSON()}))),e},ee.fromJSON=function(e,t){if(!t)throw new RangeError("Invalid input for Node.fromJSON");var n=null;if(t.marks){if(!Array.isArray(t.marks))throw new RangeError("Invalid mark data for Node.fromJSON");n=t.marks.map(e.markFromJSON)}if("text"==t.type){if("string"!=typeof t.text)throw new RangeError("Invalid text node in JSON");return e.text(t.text,n)}var r=O.fromJSON(e,t.content);return e.nodeType(t.type).create(t.attrs,r,n)},Object.defineProperties(ee.prototype,te);var ne=function(e){function t(t,n,r,o){if(e.call(this,t,n,null,o),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={textContent:{configurable:!0},nodeSize:{configurable:!0}};return t.prototype.toString=function(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):re(this.marks,JSON.stringify(this.text))},n.textContent.get=function(){return this.text},t.prototype.textBetween=function(e,t){return this.text.slice(e,t)},n.nodeSize.get=function(){return this.text.length},t.prototype.mark=function(e){return e==this.marks?this:new t(this.type,this.attrs,this.text,e)},t.prototype.withText=function(e){return e==this.text?this:new t(this.type,this.attrs,e,this.marks)},t.prototype.cut=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=this.text.length),0==e&&t==this.text.length?this:this.withText(this.text.slice(e,t))},t.prototype.eq=function(e){return this.sameMarkup(e)&&this.text==e.text},t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return t.text=this.text,t},Object.defineProperties(t.prototype,n),t}(ee);function re(e,t){for(var n=e.length-1;n>=0;n--)t=e[n].type.name+"("+t+")";return t}var oe=function(e){this.validEnd=e,this.next=[],this.wrapCache=[]},ie={inlineContent:{configurable:!0},defaultType:{configurable:!0},edgeCount:{configurable:!0}};oe.parse=function(e,t){var n=new se(e,t);if(null==n.next)return oe.empty;var r=ce(n);n.next&&n.err("Unexpected trailing text");var o=function(e){var t=Object.create(null);return n(he(e,0));function n(r){var o=[];r.forEach((function(t){e[t].forEach((function(t){var n=t.term,r=t.to;if(n){var i=o.indexOf(n),s=i>-1&&o[i+1];he(e,r).forEach((function(e){s||o.push(n,s=[]),-1==s.indexOf(e)&&s.push(e)}))}}))}));for(var i=t[r.join(",")]=new oe(r.indexOf(e.length-1)>-1),s=0;s<o.length;s+=2){var a=o[s+1].sort(pe);i.next.push(o[s],t[a.join(",")]||n(a))}return i}}(function(e){var t=[[]];return o(i(e,0),n()),t;function n(){return t.push([])-1}function r(e,n,r){var o={term:r,to:n};return t[e].push(o),o}function o(e,t){e.forEach((function(e){return e.to=t}))}function i(e,t){if("choice"==e.type)return e.exprs.reduce((function(e,n){return e.concat(i(n,t))}),[]);if("seq"==e.type)for(var s=0;;s++){var a=i(e.exprs[s],t);if(s==e.exprs.length-1)return a;o(a,t=n())}else{if("star"==e.type){var c=n();return r(t,c),o(i(e.expr,c),c),[r(c)]}if("plus"==e.type){var l=n();return o(i(e.expr,t),l),o(i(e.expr,l),l),[r(l)]}if("opt"==e.type)return[r(t)].concat(i(e.expr,t));if("range"==e.type){for(var u=t,f=0;f<e.min;f++){var d=n();o(i(e.expr,u),d),u=d}if(-1==e.max)o(i(e.expr,u),u);else for(var p=e.min;p<e.max;p++){var h=n();r(u,h),o(i(e.expr,u),h),u=h}return[r(u)]}if("name"==e.type)return[r(t,null,e.value)]}}}(r));return function(e,t){for(var n=0,r=[e];n<r.length;n++){for(var o=r[n],i=!o.validEnd,s=[],a=0;a<o.next.length;a+=2){var c=o.next[a],l=o.next[a+1];s.push(c.name),!i||c.isText||c.hasRequiredAttrs()||(i=!1),-1==r.indexOf(l)&&r.push(l)}i&&t.err("Only non-generatable nodes ("+s.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}(o,n),o},oe.prototype.matchType=function(e){for(var t=0;t<this.next.length;t+=2)if(this.next[t]==e)return this.next[t+1];return null},oe.prototype.matchFragment=function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=e.childCount);for(var r=this,o=t;r&&o<n;o++)r=r.matchType(e.child(o).type);return r},ie.inlineContent.get=function(){var e=this.next[0];return!!e&&e.isInline},ie.defaultType.get=function(){for(var e=0;e<this.next.length;e+=2){var t=this.next[e];if(!t.isText&&!t.hasRequiredAttrs())return t}},oe.prototype.compatible=function(e){for(var t=0;t<this.next.length;t+=2)for(var n=0;n<e.next.length;n+=2)if(this.next[t]==e.next[n])return!0;return!1},oe.prototype.fillBefore=function(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=0);var r=[this];return function o(i,s){var a=i.matchFragment(e,n);if(a&&(!t||a.validEnd))return O.from(s.map((function(e){return e.createAndFill()})));for(var c=0;c<i.next.length;c+=2){var l=i.next[c],u=i.next[c+1];if(!l.isText&&!l.hasRequiredAttrs()&&-1==r.indexOf(u)){r.push(u);var f=o(u,s.concat(l));if(f)return f}}}(this,[])},oe.prototype.findWrapping=function(e){for(var t=0;t<this.wrapCache.length;t+=2)if(this.wrapCache[t]==e)return this.wrapCache[t+1];var n=this.computeWrapping(e);return this.wrapCache.push(e,n),n},oe.prototype.computeWrapping=function(e){for(var t=Object.create(null),n=[{match:this,type:null,via:null}];n.length;){var r=n.shift(),o=r.match;if(o.matchType(e)){for(var i=[],s=r;s.type;s=s.via)i.push(s.type);return i.reverse()}for(var a=0;a<o.next.length;a+=2){var c=o.next[a];c.isLeaf||c.hasRequiredAttrs()||c.name in t||r.type&&!o.next[a+1].validEnd||(n.push({match:c.contentMatch,type:c,via:r}),t[c.name]=!0)}}},ie.edgeCount.get=function(){return this.next.length>>1},oe.prototype.edge=function(e){var t=e<<1;if(t>=this.next.length)throw new RangeError("There's no "+e+"th edge in this content match");return{type:this.next[t],next:this.next[t+1]}},oe.prototype.toString=function(){var e=[];return function t(n){e.push(n);for(var r=1;r<n.next.length;r+=2)-1==e.indexOf(n.next[r])&&t(n.next[r])}(this),e.map((function(t,n){for(var r=n+(t.validEnd?"*":" ")+" ",o=0;o<t.next.length;o+=2)r+=(o?", ":"")+t.next[o].name+"->"+e.indexOf(t.next[o+1]);return r})).join("\n")},Object.defineProperties(oe.prototype,ie),oe.empty=new oe(!0);var se=function(e,t){this.string=e,this.nodeTypes=t,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),""==this.tokens[this.tokens.length-1]&&this.tokens.pop(),""==this.tokens[0]&&this.tokens.shift()},ae={next:{configurable:!0}};function ce(e){var t=[];do{t.push(le(e))}while(e.eat("|"));return 1==t.length?t[0]:{type:"choice",exprs:t}}function le(e){var t=[];do{t.push(ue(e))}while(e.next&&")"!=e.next&&"|"!=e.next);return 1==t.length?t[0]:{type:"seq",exprs:t}}function ue(e){for(var t=function(e){if(e.eat("(")){var t=ce(e);return e.eat(")")||e.err("Missing closing paren"),t}if(!/\W/.test(e.next)){var n=function(e,t){var n=e.nodeTypes,r=n[t];if(r)return[r];var o=[];for(var i in n){var s=n[i];s.groups.indexOf(t)>-1&&o.push(s)}0==o.length&&e.err("No node type or group '"+t+"' found");return o}(e,e.next).map((function(t){return null==e.inline?e.inline=t.isInline:e.inline!=t.isInline&&e.err("Mixing inline and block content"),{type:"name",value:t}}));return e.pos++,1==n.length?n[0]:{type:"choice",exprs:n}}e.err("Unexpected token '"+e.next+"'")}(e);;)if(e.eat("+"))t={type:"plus",expr:t};else if(e.eat("*"))t={type:"star",expr:t};else if(e.eat("?"))t={type:"opt",expr:t};else{if(!e.eat("{"))break;t=de(e,t)}return t}function fe(e){/\D/.test(e.next)&&e.err("Expected number, got '"+e.next+"'");var t=Number(e.next);return e.pos++,t}function de(e,t){var n=fe(e),r=n;return e.eat(",")&&(r="}"!=e.next?fe(e):-1),e.eat("}")||e.err("Unclosed braced range"),{type:"range",min:n,max:r,expr:t}}function pe(e,t){return t-e}function he(e,t){var n=[];return function t(r){var o=e[r];if(1==o.length&&!o[0].term)return t(o[0].to);n.push(r);for(var i=0;i<o.length;i++){var s=o[i],a=s.term,c=s.to;a||-1!=n.indexOf(c)||t(c)}}(t),n.sort(pe)}function me(e){var t=Object.create(null);for(var n in e){var r=e[n];if(!r.hasDefault)return null;t[n]=r.default}return t}function ve(e,t){var n=Object.create(null);for(var r in e){var o=t&&t[r];if(void 0===o){var i=e[r];if(!i.hasDefault)throw new RangeError("No value supplied for attribute "+r);o=i.default}n[r]=o}return n}function ge(e){var t=Object.create(null);if(e)for(var n in e)t[n]=new be(e[n]);return t}ae.next.get=function(){return this.tokens[this.pos]},se.prototype.eat=function(e){return this.next==e&&(this.pos++||!0)},se.prototype.err=function(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")},Object.defineProperties(se.prototype,ae);var ye=function(e,t,n){this.name=e,this.schema=t,this.spec=n,this.groups=n.group?n.group.split(" "):[],this.attrs=ge(n.attrs),this.defaultAttrs=me(this.attrs),this.contentMatch=null,this.markSet=null,this.inlineContent=null,this.isBlock=!(n.inline||"text"==e),this.isText="text"==e},we={isInline:{configurable:!0},isTextblock:{configurable:!0},isLeaf:{configurable:!0},isAtom:{configurable:!0}};we.isInline.get=function(){return!this.isBlock},we.isTextblock.get=function(){return this.isBlock&&this.inlineContent},we.isLeaf.get=function(){return this.contentMatch==oe.empty},we.isAtom.get=function(){return this.isLeaf||this.spec.atom},ye.prototype.hasRequiredAttrs=function(){for(var e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1},ye.prototype.compatibleContent=function(e){return this==e||this.contentMatch.compatible(e.contentMatch)},ye.prototype.computeAttrs=function(e){return!e&&this.defaultAttrs?this.defaultAttrs:ve(this.attrs,e)},ye.prototype.create=function(e,t,n){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new ee(this,this.computeAttrs(e),O.from(t),D.setFrom(n))},ye.prototype.createChecked=function(e,t,n){if(t=O.from(t),!this.validContent(t))throw new RangeError("Invalid content for node "+this.name);return new ee(this,this.computeAttrs(e),t,D.setFrom(n))},ye.prototype.createAndFill=function(e,t,n){if(e=this.computeAttrs(e),(t=O.from(t)).size){var r=this.contentMatch.fillBefore(t);if(!r)return null;t=r.append(t)}var o=this.contentMatch.matchFragment(t).fillBefore(O.empty,!0);return o?new ee(this,e,t.append(o),D.setFrom(n)):null},ye.prototype.validContent=function(e){var t=this.contentMatch.matchFragment(e);if(!t||!t.validEnd)return!1;for(var n=0;n<e.childCount;n++)if(!this.allowsMarks(e.child(n).marks))return!1;return!0},ye.prototype.allowsMarkType=function(e){return null==this.markSet||this.markSet.indexOf(e)>-1},ye.prototype.allowsMarks=function(e){if(null==this.markSet)return!0;for(var t=0;t<e.length;t++)if(!this.allowsMarkType(e[t].type))return!1;return!0},ye.prototype.allowedMarks=function(e){if(null==this.markSet)return e;for(var t,n=0;n<e.length;n++)this.allowsMarkType(e[n].type)?t&&t.push(e[n]):t||(t=e.slice(0,n));return t?t.length?t:D.empty:e},ye.compile=function(e,t){var n=Object.create(null);e.forEach((function(e,r){return n[e]=new ye(e,t,r)}));var r=t.spec.topNode||"doc";if(!n[r])throw new RangeError("Schema is missing its top node type ('"+r+"')");if(!n.text)throw new RangeError("Every schema needs a 'text' type");for(var o in n.text.attrs)throw new RangeError("The text node type should not have attributes");return n},Object.defineProperties(ye.prototype,we);var be=function(e){this.hasDefault=Object.prototype.hasOwnProperty.call(e,"default"),this.default=e.default},ke={isRequired:{configurable:!0}};ke.isRequired.get=function(){return!this.hasDefault},Object.defineProperties(be.prototype,ke);var xe=function(e,t,n,r){this.name=e,this.schema=n,this.spec=r,this.attrs=ge(r.attrs),this.rank=t,this.excluded=null;var o=me(this.attrs);this.instance=o&&new D(this,o)};xe.prototype.create=function(e){return!e&&this.instance?this.instance:new D(this,ve(this.attrs,e))},xe.compile=function(e,t){var n=Object.create(null),r=0;return e.forEach((function(e,o){return n[e]=new xe(e,r++,t,o)})),n},xe.prototype.removeFromSet=function(e){for(var t=0;t<e.length;t++)e[t].type==this&&(e=e.slice(0,t).concat(e.slice(t+1)),t--);return e},xe.prototype.isInSet=function(e){for(var t=0;t<e.length;t++)if(e[t].type==this)return e[t]},xe.prototype.excludes=function(e){return this.excluded.indexOf(e)>-1};var Se=function(e){for(var t in this.spec={},e)this.spec[t]=e[t];this.spec.nodes=S.from(e.nodes),this.spec.marks=S.from(e.marks),this.nodes=ye.compile(this.spec.nodes,this),this.marks=xe.compile(this.spec.marks,this);var n=Object.create(null);for(var r in this.nodes){if(r in this.marks)throw new RangeError(r+" can not be both a node and a mark");var o=this.nodes[r],i=o.spec.content||"",s=o.spec.marks;o.contentMatch=n[i]||(n[i]=oe.parse(i,this.nodes)),o.inlineContent=o.contentMatch.inlineContent,o.markSet="_"==s?null:s?Ce(this,s.split(" ")):""!=s&&o.inlineContent?null:[]}for(var a in this.marks){var c=this.marks[a],l=c.spec.excludes;c.excluded=null==l?[c]:""==l?[]:Ce(this,l.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached=Object.create(null),this.cached.wrappings=Object.create(null)};function Ce(e,t){for(var n=[],r=0;r<t.length;r++){var o=t[r],i=e.marks[o],s=i;if(i)n.push(i);else for(var a in e.marks){var c=e.marks[a];("_"==o||c.spec.group&&c.spec.group.split(" ").indexOf(o)>-1)&&n.push(s=c)}if(!s)throw new SyntaxError("Unknown mark type: '"+t[r]+"'")}return n}Se.prototype.node=function(e,t,n,r){if("string"==typeof e)e=this.nodeType(e);else{if(!(e instanceof ye))throw new RangeError("Invalid node type: "+e);if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}return e.createChecked(t,n,r)},Se.prototype.text=function(e,t){var n=this.nodes.text;return new ne(n,n.defaultAttrs,e,D.setFrom(t))},Se.prototype.mark=function(e,t){return"string"==typeof e&&(e=this.marks[e]),e.create(t)},Se.prototype.nodeFromJSON=function(e){return ee.fromJSON(this,e)},Se.prototype.markFromJSON=function(e){return D.fromJSON(this,e)},Se.prototype.nodeType=function(e){var t=this.nodes[e];if(!t)throw new RangeError("Unknown node type: "+e);return t};var Me=function(e,t){var n=this;this.schema=e,this.rules=t,this.tags=[],this.styles=[],t.forEach((function(e){e.tag?n.tags.push(e):e.style&&n.styles.push(e)})),this.normalizeLists=!this.tags.some((function(t){if(!/^(ul|ol)\b/.test(t.tag)||!t.node)return!1;var n=e.nodes[t.node];return n.contentMatch.matchType(n)}))};Me.prototype.parse=function(e,t){void 0===t&&(t={});var n=new De(this,t,!1);return n.addAll(e,null,t.from,t.to),n.finish()},Me.prototype.parseSlice=function(e,t){void 0===t&&(t={});var n=new De(this,t,!0);return n.addAll(e,null,t.from,t.to),I.maxOpen(n.finish())},Me.prototype.matchTag=function(e,t,n){for(var r=n?this.tags.indexOf(n)+1:0;r<this.tags.length;r++){var o=this.tags[r];if(Ie(e,o.tag)&&(void 0===o.namespace||e.namespaceURI==o.namespace)&&(!o.context||t.matchesContext(o.context))){if(o.getAttrs){var i=o.getAttrs(e);if(!1===i)continue;o.attrs=i}return o}}},Me.prototype.matchStyle=function(e,t,n,r){for(var o=r?this.styles.indexOf(r)+1:0;o<this.styles.length;o++){var i=this.styles[o];if(!(0!=i.style.indexOf(e)||i.context&&!n.matchesContext(i.context)||i.style.length>e.length&&(61!=i.style.charCodeAt(e.length)||i.style.slice(e.length+1)!=t))){if(i.getAttrs){var s=i.getAttrs(t);if(!1===s)continue;i.attrs=s}return i}}},Me.schemaRules=function(e){var t=[];function n(e){for(var n=null==e.priority?50:e.priority,r=0;r<t.length;r++){var o=t[r];if((null==o.priority?50:o.priority)<n)break}t.splice(r,0,e)}var r=function(t){var r=e.marks[t].spec.parseDOM;r&&r.forEach((function(e){n(e=$e(e)),e.mark=t}))};for(var o in e.marks)r(o);var i;for(var s in e.nodes)i=void 0,(i=e.nodes[s].spec.parseDOM)&&i.forEach((function(e){n(e=$e(e)),e.node=s}));return t},Me.fromSchema=function(e){return e.cached.domParser||(e.cached.domParser=new Me(e,Me.schemaRules(e)))};var Oe={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},Ae={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},Ee={ol:!0,ul:!0};function Te(e){return(e?1:0)|("full"===e?2:0)}var Ne=function(e,t,n,r,o,i,s){this.type=e,this.attrs=t,this.solid=o,this.match=i||(4&s?null:e.contentMatch),this.options=s,this.content=[],this.marks=n,this.activeMarks=D.none,this.pendingMarks=r,this.stashMarks=[]};Ne.prototype.findWrapping=function(e){if(!this.match){if(!this.type)return[];var t=this.type.contentMatch.fillBefore(O.from(e));if(!t){var n,r=this.type.contentMatch;return(n=r.findWrapping(e.type))?(this.match=r,n):null}this.match=this.type.contentMatch.matchFragment(t)}return this.match.findWrapping(e.type)},Ne.prototype.finish=function(e){if(!(1&this.options)){var t,n=this.content[this.content.length-1];n&&n.isText&&(t=/[ \t\r\n\u000c]+$/.exec(n.text))&&(n.text.length==t[0].length?this.content.pop():this.content[this.content.length-1]=n.withText(n.text.slice(0,n.text.length-t[0].length)))}var r=O.from(this.content);return!e&&this.match&&(r=r.append(this.match.fillBefore(O.empty,!0))),this.type?this.type.create(this.attrs,r,this.marks):r},Ne.prototype.popFromStashMark=function(e){for(var t=this.stashMarks.length-1;t>=0;t--)if(e.eq(this.stashMarks[t]))return this.stashMarks.splice(t,1)[0]},Ne.prototype.applyPending=function(e){for(var t=0,n=this.pendingMarks;t<n.length;t++){var r=n[t];(this.type?this.type.allowsMarkType(r.type):Re(r.type,e))&&!r.isInSet(this.activeMarks)&&(this.activeMarks=r.addToSet(this.activeMarks),this.pendingMarks=r.removeFromSet(this.pendingMarks))}},Ne.prototype.inlineContext=function(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!Oe.hasOwnProperty(e.parentNode.nodeName.toLowerCase())};var De=function(e,t,n){this.parser=e,this.options=t,this.isOpen=n;var r,o=t.topNode,i=Te(t.preserveWhitespace)|(n?4:0);r=o?new Ne(o.type,o.attrs,D.none,D.none,!0,t.topMatch||o.type.contentMatch,i):new Ne(n?null:e.schema.topNodeType,null,D.none,D.none,!0,null,i),this.nodes=[r],this.open=0,this.find=t.findPositions,this.needsBlock=!1},ze={top:{configurable:!0},currentPos:{configurable:!0}};function Ie(e,t){return(e.matches||e.msMatchesSelector||e.webkitMatchesSelector||e.mozMatchesSelector).call(e,t)}function $e(e){var t={};for(var n in e)t[n]=e[n];return t}function Re(e,t){var n=t.schema.nodes,r=function(r){var o=n[r];if(o.allowsMarkType(e)){var i=[],s=function(e){i.push(e);for(var n=0;n<e.edgeCount;n++){var r=e.edge(n),o=r.type,a=r.next;if(o==t)return!0;if(i.indexOf(a)<0&&s(a))return!0}};return s(o.contentMatch)?{v:!0}:void 0}};for(var o in n){var i=r(o);if(i)return i.v}}ze.top.get=function(){return this.nodes[this.open]},De.prototype.addDOM=function(e){if(3==e.nodeType)this.addTextNode(e);else if(1==e.nodeType){var t=e.getAttribute("style"),n=t?this.readStyles(function(e){var t,n=/\s*([\w-]+)\s*:\s*([^;]+)/g,r=[];for(;t=n.exec(e);)r.push(t[1],t[2].trim());return r}(t)):null,r=this.top;if(null!=n)for(var o=0;o<n.length;o++)this.addPendingMark(n[o]);if(this.addElement(e),null!=n)for(var i=0;i<n.length;i++)this.removePendingMark(n[i],r)}},De.prototype.addTextNode=function(e){var t=e.nodeValue,n=this.top;if(2&n.options||n.inlineContext(e)||/[^ \t\r\n\u000c]/.test(t)){if(1&n.options)t=2&n.options?t.replace(/\r\n?/g,"\n"):t.replace(/\r?\n|\r/g," ");else if(t=t.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(t)&&this.open==this.nodes.length-1){var r=n.content[n.content.length-1],o=e.previousSibling;(!r||o&&"BR"==o.nodeName||r.isText&&/[ \t\r\n\u000c]$/.test(r.text))&&(t=t.slice(1))}t&&this.insertNode(this.parser.schema.text(t)),this.findInText(e)}else this.findInside(e)},De.prototype.addElement=function(e,t){var n,r=e.nodeName.toLowerCase();Ee.hasOwnProperty(r)&&this.parser.normalizeLists&&function(e){for(var t=e.firstChild,n=null;t;t=t.nextSibling){var r=1==t.nodeType?t.nodeName.toLowerCase():null;r&&Ee.hasOwnProperty(r)&&n?(n.appendChild(t),t=n):"li"==r?n=t:r&&(n=null)}}(e);var o=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(n=this.parser.matchTag(e,this,t));if(o?o.ignore:Ae.hasOwnProperty(r))this.findInside(e),this.ignoreFallback(e);else if(!o||o.skip||o.closeParent){o&&o.closeParent?this.open=Math.max(0,this.open-1):o&&o.skip.nodeType&&(e=o.skip);var i,s=this.top,a=this.needsBlock;if(Oe.hasOwnProperty(r))i=!0,s.type||(this.needsBlock=!0);else if(!e.firstChild)return void this.leafFallback(e);this.addAll(e),i&&this.sync(s),this.needsBlock=a}else this.addElementByRule(e,o,!1===o.consuming?n:null)},De.prototype.leafFallback=function(e){"BR"==e.nodeName&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode("\n"))},De.prototype.ignoreFallback=function(e){"BR"!=e.nodeName||this.top.type&&this.top.type.inlineContent||this.findPlace(this.parser.schema.text("-"))},De.prototype.readStyles=function(e){var t=D.none;e:for(var n=0;n<e.length;n+=2)for(var r=null;;){var o=this.parser.matchStyle(e[n],e[n+1],this,r);if(!o)continue e;if(o.ignore)return null;if(t=this.parser.schema.marks[o.mark].create(o.attrs).addToSet(t),!1!==o.consuming)break;r=o}return t},De.prototype.addElementByRule=function(e,t,n){var r,o,i,s=this;t.node?(o=this.parser.schema.nodes[t.node]).isLeaf?this.insertNode(o.create(t.attrs))||this.leafFallback(e):r=this.enter(o,t.attrs,t.preserveWhitespace):(i=this.parser.schema.marks[t.mark].create(t.attrs),this.addPendingMark(i));var a=this.top;if(o&&o.isLeaf)this.findInside(e);else if(n)this.addElement(e,n);else if(t.getContent)this.findInside(e),t.getContent(e,this.parser.schema).forEach((function(e){return s.insertNode(e)}));else{var c=t.contentElement;"string"==typeof c?c=e.querySelector(c):"function"==typeof c&&(c=c(e)),c||(c=e),this.findAround(e,c,!0),this.addAll(c,r)}r&&(this.sync(a),this.open--),i&&this.removePendingMark(i,a)},De.prototype.addAll=function(e,t,n,r){for(var o=n||0,i=n?e.childNodes[n]:e.firstChild,s=null==r?null:e.childNodes[r];i!=s;i=i.nextSibling,++o)this.findAtPoint(e,o),this.addDOM(i),t&&Oe.hasOwnProperty(i.nodeName.toLowerCase())&&this.sync(t);this.findAtPoint(e,o)},De.prototype.findPlace=function(e){for(var t,n,r=this.open;r>=0;r--){var o=this.nodes[r],i=o.findWrapping(e);if(i&&(!t||t.length>i.length)&&(t=i,n=o,!i.length))break;if(o.solid)break}if(!t)return!1;this.sync(n);for(var s=0;s<t.length;s++)this.enterInner(t[s],null,!1);return!0},De.prototype.insertNode=function(e){if(e.isInline&&this.needsBlock&&!this.top.type){var t=this.textblockFromContext();t&&this.enterInner(t)}if(this.findPlace(e)){this.closeExtra();var n=this.top;n.applyPending(e.type),n.match&&(n.match=n.match.matchType(e.type));for(var r=n.activeMarks,o=0;o<e.marks.length;o++)n.type&&!n.type.allowsMarkType(e.marks[o].type)||(r=e.marks[o].addToSet(r));return n.content.push(e.mark(r)),!0}return!1},De.prototype.enter=function(e,t,n){var r=this.findPlace(e.create(t));return r&&this.enterInner(e,t,!0,n),r},De.prototype.enterInner=function(e,t,n,r){this.closeExtra();var o=this.top;o.applyPending(e),o.match=o.match&&o.match.matchType(e,t);var i=null==r?-5&o.options:Te(r);4&o.options&&0==o.content.length&&(i|=4),this.nodes.push(new Ne(e,t,o.activeMarks,o.pendingMarks,n,null,i)),this.open++},De.prototype.closeExtra=function(e){var t=this.nodes.length-1;if(t>this.open){for(;t>this.open;t--)this.nodes[t-1].content.push(this.nodes[t].finish(e));this.nodes.length=this.open+1}},De.prototype.finish=function(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)},De.prototype.sync=function(e){for(var t=this.open;t>=0;t--)if(this.nodes[t]==e)return void(this.open=t)},ze.currentPos.get=function(){this.closeExtra();for(var e=0,t=this.open;t>=0;t--){for(var n=this.nodes[t].content,r=n.length-1;r>=0;r--)e+=n[r].nodeSize;t&&e++}return e},De.prototype.findAtPoint=function(e,t){if(this.find)for(var n=0;n<this.find.length;n++)this.find[n].node==e&&this.find[n].offset==t&&(this.find[n].pos=this.currentPos)},De.prototype.findInside=function(e){if(this.find)for(var t=0;t<this.find.length;t++)null==this.find[t].pos&&1==e.nodeType&&e.contains(this.find[t].node)&&(this.find[t].pos=this.currentPos)},De.prototype.findAround=function(e,t,n){if(e!=t&&this.find)for(var r=0;r<this.find.length;r++){if(null==this.find[r].pos&&1==e.nodeType&&e.contains(this.find[r].node))t.compareDocumentPosition(this.find[r].node)&(n?2:4)&&(this.find[r].pos=this.currentPos)}},De.prototype.findInText=function(e){if(this.find)for(var t=0;t<this.find.length;t++)this.find[t].node==e&&(this.find[t].pos=this.currentPos-(e.nodeValue.length-this.find[t].offset))},De.prototype.matchesContext=function(e){var t=this;if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);var n=e.split("/"),r=this.options.context,o=!(this.isOpen||r&&r.parent.type!=this.nodes[0].type),i=-(r?r.depth+1:0)+(o?0:1),s=function(e,a){for(;e>=0;e--){var c=n[e];if(""==c){if(e==n.length-1||0==e)continue;for(;a>=i;a--)if(s(e-1,a))return!0;return!1}var l=a>0||0==a&&o?t.nodes[a].type:r&&a>=i?r.node(a-i).type:null;if(!l||l.name!=c&&-1==l.groups.indexOf(c))return!1;a--}return!0};return s(n.length-1,this.open)},De.prototype.textblockFromContext=function(){var e=this.options.context;if(e)for(var t=e.depth;t>=0;t--){var n=e.node(t).contentMatchAt(e.indexAfter(t)).defaultType;if(n&&n.isTextblock&&n.defaultAttrs)return n}for(var r in this.parser.schema.nodes){var o=this.parser.schema.nodes[r];if(o.isTextblock&&o.defaultAttrs)return o}},De.prototype.addPendingMark=function(e){var t=function(e,t){for(var n=0;n<t.length;n++)if(e.eq(t[n]))return t[n]}(e,this.top.pendingMarks);t&&this.top.stashMarks.push(t),this.top.pendingMarks=e.addToSet(this.top.pendingMarks)},De.prototype.removePendingMark=function(e,t){for(var n=this.open;n>=0;n--){var r=this.nodes[n];if(r.pendingMarks.lastIndexOf(e)>-1)r.pendingMarks=e.removeFromSet(r.pendingMarks);else{r.activeMarks=e.removeFromSet(r.activeMarks);var o=r.popFromStashMark(e);o&&r.type&&r.type.allowsMarkType(o.type)&&(r.activeMarks=o.addToSet(r.activeMarks))}if(r==t)break}},Object.defineProperties(De.prototype,ze);var Fe=function(e,t){this.nodes=e||{},this.marks=t||{}};function Pe(e){var t={};for(var n in e){var r=e[n].spec.toDOM;r&&(t[n]=r)}return t}function _e(e){return e.document||window.document}Fe.prototype.serializeFragment=function(e,t,n){var r=this;void 0===t&&(t={}),n||(n=_e(t).createDocumentFragment());var o=n,i=null;return e.forEach((function(e){if(i||e.marks.length){i||(i=[]);for(var n=0,s=0;n<i.length&&s<e.marks.length;){var a=e.marks[s];if(r.marks[a.type.name]){if(!a.eq(i[n])||!1===a.type.spec.spanning)break;n+=2,s++}else s++}for(;n<i.length;)o=i.pop(),i.pop();for(;s<e.marks.length;){var c=e.marks[s++],l=r.serializeMark(c,e.isInline,t);l&&(i.push(c,o),o.appendChild(l.dom),o=l.contentDOM||l.dom)}}o.appendChild(r.serializeNodeInner(e,t))})),n},Fe.prototype.serializeNodeInner=function(e,t){void 0===t&&(t={});var n=Fe.renderSpec(_e(t),this.nodes[e.type.name](e)),r=n.dom,o=n.contentDOM;if(o){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");t.onContent?t.onContent(e,o,t):this.serializeFragment(e.content,t,o)}return r},Fe.prototype.serializeNode=function(e,t){void 0===t&&(t={});for(var n=this.serializeNodeInner(e,t),r=e.marks.length-1;r>=0;r--){var o=this.serializeMark(e.marks[r],e.isInline,t);o&&((o.contentDOM||o.dom).appendChild(n),n=o.dom)}return n},Fe.prototype.serializeMark=function(e,t,n){void 0===n&&(n={});var r=this.marks[e.type.name];return r&&Fe.renderSpec(_e(n),r(e,t))},Fe.renderSpec=function(e,t,n){if(void 0===n&&(n=null),"string"==typeof t)return{dom:e.createTextNode(t)};if(null!=t.nodeType)return{dom:t};if(t.dom&&null!=t.dom.nodeType)return t;var r=t[0],o=r.indexOf(" ");o>0&&(n=r.slice(0,o),r=r.slice(o+1));var i=null,s=n?e.createElementNS(n,r):e.createElement(r),a=t[1],c=1;if(a&&"object"==typeof a&&null==a.nodeType&&!Array.isArray(a))for(var l in c=2,a)if(null!=a[l]){var u=l.indexOf(" ");u>0?s.setAttributeNS(l.slice(0,u),l.slice(u+1),a[l]):s.setAttribute(l,a[l])}for(var f=c;f<t.length;f++){var d=t[f];if(0===d){if(f<t.length-1||f>c)throw new RangeError("Content hole must be the only child of its parent node");return{dom:s,contentDOM:s}}var p=Fe.renderSpec(e,d,n),h=p.dom,m=p.contentDOM;if(s.appendChild(h),m){if(i)throw new RangeError("Multiple content holes");i=m}}return{dom:s,contentDOM:i}},Fe.fromSchema=function(e){return e.cached.domSerializer||(e.cached.domSerializer=new Fe(this.nodesFromSchema(e),this.marksFromSchema(e)))},Fe.nodesFromSchema=function(e){var t=Pe(e.nodes);return t.text||(t.text=function(e){return e.text}),t},Fe.marksFromSchema=function(e){return Pe(e.marks)};const Be=e=>e.isText,je=(e,t,n)=>t[n?"nodes":"marks"][e],Le=()=>{const e=e=>e.elements.length,t=t=>t.elements[e(t)-1];return{size:e,top:t,push:e=>n=>{var r;null===(r=t(e))||void 0===r||r.push(n)},open:e=>t=>{e.elements.push(t)},close:e=>{const t=e.elements.pop();if(!t)throw b();return t}}},Ve=(e,t)=>{const n=Symbol("Context"),r=(t,r=(e=>Array.isArray(e)?[...e]:"object"==typeof e?Object.assign({},e):e)(e))=>{let o=r;const i={id:n,set:e=>{o=e},get:()=>o,update:e=>{o=e(o)}};return t.set(n,i),i};return r.sliceName=t,r.id=n,r._typeInfo=()=>{throw new Error("Should not call a context out of the plugin.")},r};function We(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(t){i(t)}}function a(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))}function qe(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)}function He(e,t,n,r,o){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?o.call(e,n):o?o.value=n:t.set(e,n),n}var Je,Ke;class Ue{constructor(e,t){Je.set(this,void 0),Ke.set(this,void 0),this.use=e=>qe(this,Je,"f").getSlice(e),this.get=e=>this.use(e).get(),this.set=(e,t)=>this.use(e).set(t),this.update=(e,t)=>this.use(e).update(t),this.timing=e=>qe(this,Ke,"f").get(e),this.wait=e=>this.timing(e)(),this.done=e=>this.timing(e).done(),this.waitTimers=e=>We(this,void 0,void 0,(function*(){yield Promise.all(this.get(e).map((e=>this.wait(e))))})),He(this,Je,e,"f"),He(this,Ke,t,"f")}}Je=new WeakMap,Ke=new WeakMap;const Ge=()=>{const e=new Map;return{store:e,get:t=>{const n=e.get(t.id);if(!n)throw new Error("Timer not found, do you forget to record it?");return n}}},Qe=(e,t=3e3)=>{const n=Symbol("Timer"),r=r=>{const o=Symbol(e),i=()=>new Promise(((n,r)=>{setTimeout((()=>{r(`Timing ${e} timeout.`)}),t),addEventListener(e,(e=>{e instanceof CustomEvent&&e.detail.id===o&&n(void 0)}))}));return i.done=()=>{const t=new CustomEvent(e,{detail:{id:o}});dispatchEvent(t)},r.set(n,i),i};return r.id=n,r};var Xe=Math.pow(2,16);function Ze(e){return 65535&e}var Ye=function(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=null),this.pos=e,this.deleted=t,this.recover=n},et=function(e,t){void 0===t&&(t=!1),this.ranges=e,this.inverted=t};et.prototype.recover=function(e){var t=0,n=Ze(e);if(!this.inverted)for(var r=0;r<n;r++)t+=this.ranges[3*r+2]-this.ranges[3*r+1];return this.ranges[3*n]+t+function(e){return(e-(65535&e))/Xe}(e)},et.prototype.mapResult=function(e,t){return void 0===t&&(t=1),this._map(e,t,!1)},et.prototype.map=function(e,t){return void 0===t&&(t=1),this._map(e,t,!0)},et.prototype._map=function(e,t,n){for(var r=0,o=this.inverted?2:1,i=this.inverted?1:2,s=0;s<this.ranges.length;s+=3){var a=this.ranges[s]-(this.inverted?r:0);if(a>e)break;var c=this.ranges[s+o],l=this.ranges[s+i],u=a+c;if(e<=u){var f=a+r+((c?e==a?-1:e==u?1:t:t)<0?0:l);if(n)return f;var d=e==(t<0?a:u)?null:s/3+(e-a)*Xe;return new Ye(f,t<0?e!=a:e!=u,d)}r+=l-c}return n?e+r:new Ye(e+r)},et.prototype.touches=function(e,t){for(var n=0,r=Ze(t),o=this.inverted?2:1,i=this.inverted?1:2,s=0;s<this.ranges.length;s+=3){var a=this.ranges[s]-(this.inverted?n:0);if(a>e)break;var c=this.ranges[s+o];if(e<=a+c&&s==3*r)return!0;n+=this.ranges[s+i]-c}return!1},et.prototype.forEach=function(e){for(var t=this.inverted?2:1,n=this.inverted?1:2,r=0,o=0;r<this.ranges.length;r+=3){var i=this.ranges[r],s=i-(this.inverted?o:0),a=i+(this.inverted?0:o),c=this.ranges[r+t],l=this.ranges[r+n];e(s,s+c,a,a+l),o+=l-c}},et.prototype.invert=function(){return new et(this.ranges,!this.inverted)},et.prototype.toString=function(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)},et.offset=function(e){return 0==e?et.empty:new et(e<0?[0,-e,0]:[0,0,e])},et.empty=new et([]);var tt=function(e,t,n,r){this.maps=e||[],this.from=n||0,this.to=null==r?this.maps.length:r,this.mirror=t};function nt(e){var t=Error.call(this,e);return t.__proto__=nt.prototype,t}tt.prototype.slice=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=this.maps.length),new tt(this.maps,this.mirror,e,t)},tt.prototype.copy=function(){return new tt(this.maps.slice(),this.mirror&&this.mirror.slice(),this.from,this.to)},tt.prototype.appendMap=function(e,t){this.to=this.maps.push(e),null!=t&&this.setMirror(this.maps.length-1,t)},tt.prototype.appendMapping=function(e){for(var t=0,n=this.maps.length;t<e.maps.length;t++){var r=e.getMirror(t);this.appendMap(e.maps[t],null!=r&&r<t?n+r:null)}},tt.prototype.getMirror=function(e){if(this.mirror)for(var t=0;t<this.mirror.length;t++)if(this.mirror[t]==e)return this.mirror[t+(t%2?-1:1)]},tt.prototype.setMirror=function(e,t){this.mirror||(this.mirror=[]),this.mirror.push(e,t)},tt.prototype.appendMappingInverted=function(e){for(var t=e.maps.length-1,n=this.maps.length+e.maps.length;t>=0;t--){var r=e.getMirror(t);this.appendMap(e.maps[t].invert(),null!=r&&r>t?n-r-1:null)}},tt.prototype.invert=function(){var e=new tt;return e.appendMappingInverted(this),e},tt.prototype.map=function(e,t){if(void 0===t&&(t=1),this.mirror)return this._map(e,t,!0);for(var n=this.from;n<this.to;n++)e=this.maps[n].map(e,t);return e},tt.prototype.mapResult=function(e,t){return void 0===t&&(t=1),this._map(e,t,!1)},tt.prototype._map=function(e,t,n){for(var r=!1,o=this.from;o<this.to;o++){var i=this.maps[o].mapResult(e,t);if(null!=i.recover){var s=this.getMirror(o);if(null!=s&&s>o&&s<this.to){o=s,e=this.maps[s].recover(i.recover);continue}}i.deleted&&(r=!0),e=i.pos}return n?e:new Ye(e,r)},nt.prototype=Object.create(Error.prototype),nt.prototype.constructor=nt,nt.prototype.name="TransformError";var rt=function(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new tt},ot={before:{configurable:!0},docChanged:{configurable:!0}};function it(){throw new Error("Override me")}ot.before.get=function(){return this.docs.length?this.docs[0]:this.doc},rt.prototype.step=function(e){var t=this.maybeStep(e);if(t.failed)throw new nt(t.failed);return this},rt.prototype.maybeStep=function(e){var t=e.apply(this.doc);return t.failed||this.addStep(e,t.doc),t},ot.docChanged.get=function(){return this.steps.length>0},rt.prototype.addStep=function(e,t){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=t},Object.defineProperties(rt.prototype,ot);var st=Object.create(null),at=function(){};at.prototype.apply=function(e){return it()},at.prototype.getMap=function(){return et.empty},at.prototype.invert=function(e){return it()},at.prototype.map=function(e){return it()},at.prototype.merge=function(e){return null},at.prototype.toJSON=function(){return it()},at.fromJSON=function(e,t){if(!t||!t.stepType)throw new RangeError("Invalid input for Step.fromJSON");var n=st[t.stepType];if(!n)throw new RangeError("No step type "+t.stepType+" defined");return n.fromJSON(e,t)},at.jsonID=function(e,t){if(e in st)throw new RangeError("Duplicate use of step JSON ID "+e);return st[e]=t,t.prototype.jsonID=e,t};var ct=function(e,t){this.doc=e,this.failed=t};ct.ok=function(e){return new ct(e,null)},ct.fail=function(e){return new ct(null,e)},ct.fromReplace=function(e,t,n,r){try{return ct.ok(e.replace(t,n,r))}catch(o){if(o instanceof z)return ct.fail(o.message);throw o}};var lt=function(e){function t(t,n,r,o){e.call(this),this.from=t,this.to=n,this.slice=r,this.structure=!!o}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.apply=function(e){return this.structure&&ft(e,this.from,this.to)?ct.fail("Structure replace would overwrite content"):ct.fromReplace(e,this.from,this.to,this.slice)},t.prototype.getMap=function(){return new et([this.from,this.to-this.from,this.slice.size])},t.prototype.invert=function(e){return new t(this.from,this.from+this.slice.size,e.slice(this.from,this.to))},t.prototype.map=function(e){var n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deleted&&r.deleted?null:new t(n.pos,Math.max(n.pos,r.pos),this.slice)},t.prototype.merge=function(e){if(!(e instanceof t)||e.structure||this.structure)return null;if(this.from+this.slice.size!=e.from||this.slice.openEnd||e.slice.openStart){if(e.to!=this.from||this.slice.openStart||e.slice.openEnd)return null;var n=this.slice.size+e.slice.size==0?I.empty:new I(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new t(e.from,this.to,n,this.structure)}var r=this.slice.size+e.slice.size==0?I.empty:new I(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new t(this.from,this.to+(e.to-e.from),r,this.structure)},t.prototype.toJSON=function(){var e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e},t.fromJSON=function(e,n){if("number"!=typeof n.from||"number"!=typeof n.to)throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new t(n.from,n.to,I.fromJSON(e,n.slice),!!n.structure)},t}(at);at.jsonID("replace",lt);var ut=function(e){function t(t,n,r,o,i,s,a){e.call(this),this.from=t,this.to=n,this.gapFrom=r,this.gapTo=o,this.slice=i,this.insert=s,this.structure=!!a}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.apply=function(e){if(this.structure&&(ft(e,this.from,this.gapFrom)||ft(e,this.gapTo,this.to)))return ct.fail("Structure gap-replace would overwrite content");var t=e.slice(this.gapFrom,this.gapTo);if(t.openStart||t.openEnd)return ct.fail("Gap is not a flat range");var n=this.slice.insertAt(this.insert,t.content);return n?ct.fromReplace(e,this.from,this.to,n):ct.fail("Content does not fit in gap")},t.prototype.getMap=function(){return new et([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])},t.prototype.invert=function(e){var n=this.gapTo-this.gapFrom;return new t(this.from,this.from+this.slice.size+n,this.from+this.insert,this.from+this.insert+n,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)},t.prototype.map=function(e){var n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1),o=e.map(this.gapFrom,-1),i=e.map(this.gapTo,1);return n.deleted&&r.deleted||o<n.pos||i>r.pos?null:new t(n.pos,r.pos,o,i,this.slice,this.insert,this.structure)},t.prototype.toJSON=function(){var e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e},t.fromJSON=function(e,n){if("number"!=typeof n.from||"number"!=typeof n.to||"number"!=typeof n.gapFrom||"number"!=typeof n.gapTo||"number"!=typeof n.insert)throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new t(n.from,n.to,n.gapFrom,n.gapTo,I.fromJSON(e,n.slice),n.insert,!!n.structure)},t}(at);function ft(e,t,n){for(var r=e.resolve(t),o=n-t,i=r.depth;o>0&&i>0&&r.indexAfter(i)==r.node(i).childCount;)i--,o--;if(o>0)for(var s=r.node(i).maybeChild(r.indexAfter(i));o>0;){if(!s||s.isLeaf)return!0;s=s.firstChild,o--}return!1}function dt(e,t,n){return(0==t||e.canReplace(t,e.childCount))&&(n==e.childCount||e.canReplace(0,n))}function pt(e){for(var t=e.parent.content.cutByIndex(e.startIndex,e.endIndex),n=e.depth;;--n){var r=e.$from.node(n),o=e.$from.index(n),i=e.$to.indexAfter(n);if(n<e.depth&&r.canReplace(o,i,t))return n;if(0==n||r.type.spec.isolating||!dt(r,o,i))break}}function ht(e,t,n,r){void 0===r&&(r=e);var o=function(e,t){var n=e.parent,r=e.startIndex,o=e.endIndex,i=n.contentMatchAt(r).findWrapping(t);if(!i)return null;var s=i.length?i[0]:t;return n.canReplaceWith(r,o,s)?i:null}(e,t),i=o&&function(e,t){var n=e.parent,r=e.startIndex,o=e.endIndex,i=n.child(r),s=t.contentMatch.findWrapping(i.type);if(!s)return null;for(var a=(s.length?s[s.length-1]:t).contentMatch,c=r;a&&c<o;c++)a=a.matchType(n.child(c).type);if(!a||!a.validEnd)return null;return s}(r,t);return i?o.map(mt).concat({type:t,attrs:n}).concat(i.map(mt)):null}function mt(e){return{type:e,attrs:null}}function vt(e,t,n,r){void 0===n&&(n=1);var o=e.resolve(t),i=o.depth-n,s=r&&r[r.length-1]||o.parent;if(i<0||o.parent.type.spec.isolating||!o.parent.canReplace(o.index(),o.parent.childCount)||!s.type.validContent(o.parent.content.cutByIndex(o.index(),o.parent.childCount)))return!1;for(var a=o.depth-1,c=n-2;a>i;a--,c--){var l=o.node(a),u=o.index(a);if(l.type.spec.isolating)return!1;var f=l.content.cutByIndex(u,l.childCount),d=r&&r[c]||l;if(d!=l&&(f=f.replaceChild(0,d.type.create(d.attrs))),!l.canReplace(u+1,l.childCount)||!d.type.validContent(f))return!1}var p=o.indexAfter(i),h=r&&r[0];return o.node(i).canReplaceWith(p,p,h?h.type:o.node(i+1).type)}function gt(e,t){var n,r,o=e.resolve(t),i=o.index();return n=o.nodeBefore,r=o.nodeAfter,n&&r&&!n.isLeaf&&n.canAppend(r)&&o.parent.canReplace(i,i+1)}function yt(e,t,n){for(var r=[],o=0;o<e.childCount;o++){var i=e.child(o);i.content.size&&(i=i.copy(yt(i.content,t,i))),i.isInline&&(i=t(i,n,o)),r.push(i)}return O.fromArray(r)}at.jsonID("replaceAround",ut),rt.prototype.lift=function(e,t){for(var n=e.$from,r=e.$to,o=e.depth,i=n.before(o+1),s=r.after(o+1),a=i,c=s,l=O.empty,u=0,f=o,d=!1;f>t;f--)d||n.index(f)>0?(d=!0,l=O.from(n.node(f).copy(l)),u++):a--;for(var p=O.empty,h=0,m=o,v=!1;m>t;m--)v||r.after(m+1)<r.end(m)?(v=!0,p=O.from(r.node(m).copy(p)),h++):c++;return this.step(new ut(a,c,i,s,new I(l.append(p),u,h),l.size-u,!0))},rt.prototype.wrap=function(e,t){for(var n=O.empty,r=t.length-1;r>=0;r--)n=O.from(t[r].type.create(t[r].attrs,n));var o=e.start,i=e.end;return this.step(new ut(o,i,o,i,new I(n,0,0),t.length,!0))},rt.prototype.setBlockType=function(e,t,n,r){var o=this;if(void 0===t&&(t=e),!n.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");var i=this.steps.length;return this.doc.nodesBetween(e,t,(function(e,t){if(e.isTextblock&&!e.hasMarkup(n,r)&&function(e,t,n){var r=e.resolve(t),o=r.index();return r.parent.canReplaceWith(o,o+1,n)}(o.doc,o.mapping.slice(i).map(t),n)){o.clearIncompatible(o.mapping.slice(i).map(t,1),n);var s=o.mapping.slice(i),a=s.map(t,1),c=s.map(t+e.nodeSize,1);return o.step(new ut(a,c,a+1,c-1,new I(O.from(n.create(r,null,e.marks)),0,0),1,!0)),!1}})),this},rt.prototype.setNodeMarkup=function(e,t,n,r){var o=this.doc.nodeAt(e);if(!o)throw new RangeError("No node at given position");t||(t=o.type);var i=t.create(n,null,r||o.marks);if(o.isLeaf)return this.replaceWith(e,e+o.nodeSize,i);if(!t.validContent(o.content))throw new RangeError("Invalid content for node type "+t.name);return this.step(new ut(e,e+o.nodeSize,e+1,e+o.nodeSize-1,new I(O.from(i),0,0),1,!0))},rt.prototype.split=function(e,t,n){void 0===t&&(t=1);for(var r=this.doc.resolve(e),o=O.empty,i=O.empty,s=r.depth,a=r.depth-t,c=t-1;s>a;s--,c--){o=O.from(r.node(s).copy(o));var l=n&&n[c];i=O.from(l?l.type.create(l.attrs,i):r.node(s).copy(i))}return this.step(new lt(e,e,new I(o.append(i),t,t),!0))},rt.prototype.join=function(e,t){void 0===t&&(t=1);var n=new lt(e-t,e+t,I.empty,!0);return this.step(n)};var wt=function(e){function t(t,n,r){e.call(this),this.from=t,this.to=n,this.mark=r}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.apply=function(e){var t=this,n=e.slice(this.from,this.to),r=e.resolve(this.from),o=r.node(r.sharedDepth(this.to)),i=new I(yt(n.content,(function(e,n){return e.isAtom&&n.type.allowsMarkType(t.mark.type)?e.mark(t.mark.addToSet(e.marks)):e}),o),n.openStart,n.openEnd);return ct.fromReplace(e,this.from,this.to,i)},t.prototype.invert=function(){return new bt(this.from,this.to,this.mark)},t.prototype.map=function(e){var n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deleted&&r.deleted||n.pos>=r.pos?null:new t(n.pos,r.pos,this.mark)},t.prototype.merge=function(e){if(e instanceof t&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from)return new t(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark)},t.prototype.toJSON=function(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}},t.fromJSON=function(e,n){if("number"!=typeof n.from||"number"!=typeof n.to)throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new t(n.from,n.to,e.markFromJSON(n.mark))},t}(at);at.jsonID("addMark",wt);var bt=function(e){function t(t,n,r){e.call(this),this.from=t,this.to=n,this.mark=r}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.apply=function(e){var t=this,n=e.slice(this.from,this.to),r=new I(yt(n.content,(function(e){return e.mark(t.mark.removeFromSet(e.marks))})),n.openStart,n.openEnd);return ct.fromReplace(e,this.from,this.to,r)},t.prototype.invert=function(){return new wt(this.from,this.to,this.mark)},t.prototype.map=function(e){var n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deleted&&r.deleted||n.pos>=r.pos?null:new t(n.pos,r.pos,this.mark)},t.prototype.merge=function(e){if(e instanceof t&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from)return new t(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark)},t.prototype.toJSON=function(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}},t.fromJSON=function(e,n){if("number"!=typeof n.from||"number"!=typeof n.to)throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new t(n.from,n.to,e.markFromJSON(n.mark))},t}(at);function kt(e,t,n){return!n.openStart&&!n.openEnd&&e.start()==t.start()&&e.parent.canReplace(e.index(),t.index(),n.content)}at.jsonID("removeMark",bt),rt.prototype.addMark=function(e,t,n){var r=this,o=[],i=[],s=null,a=null;return this.doc.nodesBetween(e,t,(function(r,c,l){if(r.isInline){var u=r.marks;if(!n.isInSet(u)&&l.type.allowsMarkType(n.type)){for(var f=Math.max(c,e),d=Math.min(c+r.nodeSize,t),p=n.addToSet(u),h=0;h<u.length;h++)u[h].isInSet(p)||(s&&s.to==f&&s.mark.eq(u[h])?s.to=d:o.push(s=new bt(f,d,u[h])));a&&a.to==f?a.to=d:i.push(a=new wt(f,d,n))}}})),o.forEach((function(e){return r.step(e)})),i.forEach((function(e){return r.step(e)})),this},rt.prototype.removeMark=function(e,t,n){var r=this;void 0===n&&(n=null);var o=[],i=0;return this.doc.nodesBetween(e,t,(function(r,s){if(r.isInline){i++;var a=null;if(n instanceof xe)for(var c,l=r.marks;c=n.isInSet(l);)(a||(a=[])).push(c),l=c.removeFromSet(l);else n?n.isInSet(r.marks)&&(a=[n]):a=r.marks;if(a&&a.length)for(var u=Math.min(s+r.nodeSize,t),f=0;f<a.length;f++){for(var d=a[f],p=void 0,h=0;h<o.length;h++){var m=o[h];m.step==i-1&&d.eq(o[h].style)&&(p=m)}p?(p.to=u,p.step=i):o.push({style:d,from:Math.max(s,e),to:u,step:i})}}})),o.forEach((function(e){return r.step(new bt(e.from,e.to,e.style))})),this},rt.prototype.clearIncompatible=function(e,t,n){void 0===n&&(n=t.contentMatch);for(var r=this.doc.nodeAt(e),o=[],i=e+1,s=0;s<r.childCount;s++){var a=r.child(s),c=i+a.nodeSize,l=n.matchType(a.type,a.attrs);if(l){n=l;for(var u=0;u<a.marks.length;u++)t.allowsMarkType(a.marks[u].type)||this.step(new bt(i,c,a.marks[u]))}else o.push(new lt(i,c,I.empty));i=c}if(!n.validEnd){var f=n.fillBefore(O.empty,!0);this.replace(i,i,new I(f,0,0))}for(var d=o.length-1;d>=0;d--)this.step(o[d]);return this},rt.prototype.replace=function(e,t,n){void 0===t&&(t=e),void 0===n&&(n=I.empty);var r=function(e,t,n,r){if(void 0===n&&(n=t),void 0===r&&(r=I.empty),t==n&&!r.size)return null;var o=e.resolve(t),i=e.resolve(n);return kt(o,i,r)?new lt(t,n,r):new xt(o,i,r).fit()}(this.doc,e,t,n);return r&&this.step(r),this},rt.prototype.replaceWith=function(e,t,n){return this.replace(e,t,new I(O.from(n),0,0))},rt.prototype.delete=function(e,t){return this.replace(e,t,I.empty)},rt.prototype.insert=function(e,t){return this.replaceWith(e,e,t)};var xt=function(e,t,n){this.$to=t,this.$from=e,this.unplaced=n,this.frontier=[];for(var r=0;r<=e.depth;r++){var o=e.node(r);this.frontier.push({type:o.type,match:o.contentMatchAt(e.indexAfter(r))})}this.placed=O.empty;for(var i=e.depth;i>0;i--)this.placed=O.from(e.node(i).copy(this.placed))},St={depth:{configurable:!0}};function Ct(e,t,n){return 0==t?e.cutByIndex(n):e.replaceChild(0,e.firstChild.copy(Ct(e.firstChild.content,t-1,n)))}function Mt(e,t,n){return 0==t?e.append(n):e.replaceChild(e.childCount-1,e.lastChild.copy(Mt(e.lastChild.content,t-1,n)))}function Ot(e,t){for(var n=0;n<t;n++)e=e.firstChild.content;return e}function At(e,t,n){if(t<=0)return e;var r=e.content;return t>1&&(r=r.replaceChild(0,At(r.firstChild,t-1,1==r.childCount?n-1:0))),t>0&&(r=e.type.contentMatch.fillBefore(r).append(r),n<=0&&(r=r.append(e.type.contentMatch.matchFragment(r).fillBefore(O.empty,!0)))),e.copy(r)}function Et(e,t,n,r,o){var i=e.node(t),s=o?e.indexAfter(t):e.index(t);if(s==i.childCount&&!n.compatibleContent(i.type))return null;var a=r.fillBefore(i.content,!0,s);return a&&!function(e,t,n){for(var r=n;r<t.childCount;r++)if(!e.allowsMarks(t.child(r).marks))return!0;return!1}(n,i.content,s)?a:null}function Tt(e,t,n,r,o){if(t<n){var i=e.firstChild;e=e.replaceChild(0,i.copy(Tt(i.content,t+1,n,r,i)))}if(t>r){var s=o.contentMatchAt(0),a=s.fillBefore(e).append(e);e=a.append(s.matchFragment(a).fillBefore(O.empty,!0))}return e}function Nt(e,t){for(var n=[],r=Math.min(e.depth,t.depth);r>=0;r--){var o=e.start(r);if(o<e.pos-(e.depth-r)||t.end(r)>t.pos+(t.depth-r)||e.node(r).type.spec.isolating||t.node(r).type.spec.isolating)break;(o==t.start(r)||r==e.depth&&r==t.depth&&e.parent.inlineContent&&t.parent.inlineContent&&r&&t.start(r-1)==o-1)&&n.push(r)}return n}St.depth.get=function(){return this.frontier.length-1},xt.prototype.fit=function(){for(;this.unplaced.size;){var e=this.findFittable();e?this.placeNodes(e):this.openMore()||this.dropNode()}var t=this.mustMoveInline(),n=this.placed.size-this.depth-this.$from.depth,r=this.$from,o=this.close(t<0?this.$to:r.doc.resolve(t));if(!o)return null;for(var i=this.placed,s=r.depth,a=o.depth;s&&a&&1==i.childCount;)i=i.firstChild.content,s--,a--;var c=new I(i,s,a);return t>-1?new ut(r.pos,t,this.$to.pos,this.$to.end(),c,n):c.size||r.pos!=this.$to.pos?new lt(r.pos,o.pos,c):void 0},xt.prototype.findFittable=function(){for(var e=1;e<=2;e++)for(var t=this.unplaced.openStart;t>=0;t--)for(var n=void 0,r=(t?(n=Ot(this.unplaced.content,t-1).firstChild).content:this.unplaced.content).firstChild,o=this.depth;o>=0;o--){var i=this.frontier[o],s=i.type,a=i.match,c=void 0,l=void 0;if(1==e&&(r?a.matchType(r.type)||(l=a.fillBefore(O.from(r),!1)):s.compatibleContent(n.type)))return{sliceDepth:t,frontierDepth:o,parent:n,inject:l};if(2==e&&r&&(c=a.findWrapping(r.type)))return{sliceDepth:t,frontierDepth:o,parent:n,wrap:c};if(n&&a.matchType(n.type))break}},xt.prototype.openMore=function(){var e=this.unplaced,t=e.content,n=e.openStart,r=e.openEnd,o=Ot(t,n);return!(!o.childCount||o.firstChild.isLeaf)&&(this.unplaced=new I(t,n+1,Math.max(r,o.size+n>=t.size-r?n+1:0)),!0)},xt.prototype.dropNode=function(){var e=this.unplaced,t=e.content,n=e.openStart,r=e.openEnd,o=Ot(t,n);if(o.childCount<=1&&n>0){var i=t.size-n<=n+o.size;this.unplaced=new I(Ct(t,n-1,1),n-1,i?n-1:r)}else this.unplaced=new I(Ct(t,n,1),n,r)},xt.prototype.placeNodes=function(e){for(var t=e.sliceDepth,n=e.frontierDepth,r=e.parent,o=e.inject,i=e.wrap;this.depth>n;)this.closeFrontierNode();if(i)for(var s=0;s<i.length;s++)this.openFrontierNode(i[s]);var a=this.unplaced,c=r?r.content:a.content,l=a.openStart-t,u=0,f=[],d=this.frontier[n],p=d.match,h=d.type;if(o){for(var m=0;m<o.childCount;m++)f.push(o.child(m));p=p.matchFragment(o)}for(var v=c.size+t-(a.content.size-a.openEnd);u<c.childCount;){var g=c.child(u),y=p.matchType(g.type);if(!y)break;(++u>1||0==l||g.content.size)&&(p=y,f.push(At(g.mark(h.allowedMarks(g.marks)),1==u?l:0,u==c.childCount?v:-1)))}var w=u==c.childCount;w||(v=-1),this.placed=Mt(this.placed,n,O.from(f)),this.frontier[n].match=p,w&&v<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(var b=0,k=c;b<v;b++){var x=k.lastChild;this.frontier.push({type:x.type,match:x.contentMatchAt(x.childCount)}),k=x.content}this.unplaced=w?0==t?I.empty:new I(Ct(a.content,t-1,1),t-1,v<0?a.openEnd:t-1):new I(Ct(a.content,t,u),a.openStart,a.openEnd)},xt.prototype.mustMoveInline=function(){if(!this.$to.parent.isTextblock||this.$to.end()==this.$to.pos)return-1;var e,t=this.frontier[this.depth];if(!t.type.isTextblock||!Et(this.$to,this.$to.depth,t.type,t.match,!1)||this.$to.depth==this.depth&&(e=this.findCloseLevel(this.$to))&&e.depth==this.depth)return-1;for(var n=this.$to.depth,r=this.$to.after(n);n>1&&r==this.$to.end(--n);)++r;return r},xt.prototype.findCloseLevel=function(e){e:for(var t=Math.min(this.depth,e.depth);t>=0;t--){var n=this.frontier[t],r=n.match,o=n.type,i=t<e.depth&&e.end(t+1)==e.pos+(e.depth-(t+1)),s=Et(e,t,o,r,i);if(s){for(var a=t-1;a>=0;a--){var c=this.frontier[a],l=c.match,u=Et(e,a,c.type,l,!0);if(!u||u.childCount)continue e}return{depth:t,fit:s,move:i?e.doc.resolve(e.after(t+1)):e}}}},xt.prototype.close=function(e){var t=this.findCloseLevel(e);if(!t)return null;for(;this.depth>t.depth;)this.closeFrontierNode();t.fit.childCount&&(this.placed=Mt(this.placed,t.depth,t.fit)),e=t.move;for(var n=t.depth+1;n<=e.depth;n++){var r=e.node(n),o=r.type.contentMatch.fillBefore(r.content,!0,e.index(n));this.openFrontierNode(r.type,r.attrs,o)}return e},xt.prototype.openFrontierNode=function(e,t,n){var r=this.frontier[this.depth];r.match=r.match.matchType(e),this.placed=Mt(this.placed,this.depth,O.from(e.create(t,n))),this.frontier.push({type:e,match:e.contentMatch})},xt.prototype.closeFrontierNode=function(){var e=this.frontier.pop().match.fillBefore(O.empty,!0);e.childCount&&(this.placed=Mt(this.placed,this.frontier.length,e))},Object.defineProperties(xt.prototype,St),rt.prototype.replaceRange=function(e,t,n){if(!n.size)return this.deleteRange(e,t);var r=this.doc.resolve(e),o=this.doc.resolve(t);if(kt(r,o,n))return this.step(new lt(e,t,n));var i=Nt(r,this.doc.resolve(t));0==i[i.length-1]&&i.pop();var s=-(r.depth+1);i.unshift(s);for(var a=r.depth,c=r.pos-1;a>0;a--,c--){var l=r.node(a).type.spec;if(l.defining||l.isolating)break;i.indexOf(a)>-1?s=a:r.before(a)==c&&i.splice(1,0,-a)}for(var u=i.indexOf(s),f=[],d=n.openStart,p=n.content,h=0;;h++){var m=p.firstChild;if(f.push(m),h==n.openStart)break;p=m.content}d>0&&f[d-1].type.spec.defining&&r.node(u).type!=f[d-1].type?d-=1:d>=2&&f[d-1].isTextblock&&f[d-2].type.spec.defining&&r.node(u).type!=f[d-2].type&&(d-=2);for(var v=n.openStart;v>=0;v--){var g=(v+d+1)%(n.openStart+1),y=f[g];if(y)for(var w=0;w<i.length;w++){var b=i[(w+u)%i.length],k=!0;b<0&&(k=!1,b=-b);var x=r.node(b-1),S=r.index(b-1);if(x.canReplaceWith(S,S,y.type,y.marks))return this.replace(r.before(b),k?o.after(b):t,new I(Tt(n.content,0,n.openStart,g),g,n.openEnd))}}for(var C=this.steps.length,M=i.length-1;M>=0&&(this.replace(e,t,n),!(this.steps.length>C));M--){var O=i[M];O<0||(e=r.before(O),t=o.after(O))}return this},rt.prototype.replaceRangeWith=function(e,t,n){if(!n.isInline&&e==t&&this.doc.resolve(e).parent.content.size){var r=function(e,t,n){var r=e.resolve(t);if(r.parent.canReplaceWith(r.index(),r.index(),n))return t;if(0==r.parentOffset)for(var o=r.depth-1;o>=0;o--){var i=r.index(o);if(r.node(o).canReplaceWith(i,i,n))return r.before(o+1);if(i>0)return null}if(r.parentOffset==r.parent.content.size)for(var s=r.depth-1;s>=0;s--){var a=r.indexAfter(s);if(r.node(s).canReplaceWith(a,a,n))return r.after(s+1);if(a<r.node(s).childCount)return null}}(this.doc,e,n.type);null!=r&&(e=t=r)}return this.replaceRange(e,t,new I(O.from(n),0,0))},rt.prototype.deleteRange=function(e,t){for(var n=this.doc.resolve(e),r=this.doc.resolve(t),o=Nt(n,r),i=0;i<o.length;i++){var s=o[i],a=i==o.length-1;if(a&&0==s||n.node(s).type.contentMatch.validEnd)return this.delete(n.start(s),r.end(s));if(s>0&&(a||n.node(s-1).canReplace(n.index(s-1),r.indexAfter(s-1))))return this.delete(n.before(s),r.after(s))}for(var c=1;c<=n.depth&&c<=r.depth;c++)if(e-n.start(c)==n.depth-c&&t>n.end(c)&&r.end(c)-t!=r.depth-c)return this.delete(n.before(c),t);return this.delete(e,t)};var Dt=Object.create(null),zt=function(e,t,n){this.ranges=n||[new $t(e.min(t),e.max(t))],this.$anchor=e,this.$head=t},It={anchor:{configurable:!0},head:{configurable:!0},from:{configurable:!0},to:{configurable:!0},$from:{configurable:!0},$to:{configurable:!0},empty:{configurable:!0}};It.anchor.get=function(){return this.$anchor.pos},It.head.get=function(){return this.$head.pos},It.from.get=function(){return this.$from.pos},It.to.get=function(){return this.$to.pos},It.$from.get=function(){return this.ranges[0].$from},It.$to.get=function(){return this.ranges[0].$to},It.empty.get=function(){for(var e=this.ranges,t=0;t<e.length;t++)if(e[t].$from.pos!=e[t].$to.pos)return!1;return!0},zt.prototype.content=function(){return this.$from.node(0).slice(this.from,this.to,!0)},zt.prototype.replace=function(e,t){void 0===t&&(t=I.empty);for(var n=t.content.lastChild,r=null,o=0;o<t.openEnd;o++)r=n,n=n.lastChild;for(var i=e.steps.length,s=this.ranges,a=0;a<s.length;a++){var c=s[a],l=c.$from,u=c.$to,f=e.mapping.slice(i);e.replaceRange(f.map(l.pos),f.map(u.pos),a?I.empty:t),0==a&&Vt(e,i,(n?n.isInline:r&&r.isTextblock)?-1:1)}},zt.prototype.replaceWith=function(e,t){for(var n=e.steps.length,r=this.ranges,o=0;o<r.length;o++){var i=r[o],s=i.$from,a=i.$to,c=e.mapping.slice(n),l=c.map(s.pos),u=c.map(a.pos);o?e.deleteRange(l,u):(e.replaceRangeWith(l,u,t),Vt(e,n,t.isInline?-1:1))}},zt.findFrom=function(e,t,n){var r=e.parent.inlineContent?new Rt(e):Lt(e.node(0),e.parent,e.pos,e.index(),t,n);if(r)return r;for(var o=e.depth-1;o>=0;o--){var i=t<0?Lt(e.node(0),e.node(o),e.before(o+1),e.index(o),t,n):Lt(e.node(0),e.node(o),e.after(o+1),e.index(o)+1,t,n);if(i)return i}},zt.near=function(e,t){return void 0===t&&(t=1),this.findFrom(e,t)||this.findFrom(e,-t)||new Bt(e.node(0))},zt.atStart=function(e){return Lt(e,e,0,0,1)||new Bt(e)},zt.atEnd=function(e){return Lt(e,e,e.content.size,e.childCount,-1)||new Bt(e)},zt.fromJSON=function(e,t){if(!t||!t.type)throw new RangeError("Invalid input for Selection.fromJSON");var n=Dt[t.type];if(!n)throw new RangeError("No selection type "+t.type+" defined");return n.fromJSON(e,t)},zt.jsonID=function(e,t){if(e in Dt)throw new RangeError("Duplicate use of selection JSON ID "+e);return Dt[e]=t,t.prototype.jsonID=e,t},zt.prototype.getBookmark=function(){return Rt.between(this.$anchor,this.$head).getBookmark()},Object.defineProperties(zt.prototype,It),zt.prototype.visible=!0;var $t=function(e,t){this.$from=e,this.$to=t},Rt=function(e){function t(t,n){void 0===n&&(n=t),e.call(this,t,n)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={$cursor:{configurable:!0}};return n.$cursor.get=function(){return this.$anchor.pos==this.$head.pos?this.$head:null},t.prototype.map=function(n,r){var o=n.resolve(r.map(this.head));if(!o.parent.inlineContent)return e.near(o);var i=n.resolve(r.map(this.anchor));return new t(i.parent.inlineContent?i:o,o)},t.prototype.replace=function(t,n){if(void 0===n&&(n=I.empty),e.prototype.replace.call(this,t,n),n==I.empty){var r=this.$from.marksAcross(this.$to);r&&t.ensureMarks(r)}},t.prototype.eq=function(e){return e instanceof t&&e.anchor==this.anchor&&e.head==this.head},t.prototype.getBookmark=function(){return new Ft(this.anchor,this.head)},t.prototype.toJSON=function(){return{type:"text",anchor:this.anchor,head:this.head}},t.fromJSON=function(e,n){if("number"!=typeof n.anchor||"number"!=typeof n.head)throw new RangeError("Invalid input for TextSelection.fromJSON");return new t(e.resolve(n.anchor),e.resolve(n.head))},t.create=function(e,t,n){void 0===n&&(n=t);var r=e.resolve(t);return new this(r,n==t?r:e.resolve(n))},t.between=function(n,r,o){var i=n.pos-r.pos;if(o&&!i||(o=i>=0?1:-1),!r.parent.inlineContent){var s=e.findFrom(r,o,!0)||e.findFrom(r,-o,!0);if(!s)return e.near(r,o);r=s.$head}return n.parent.inlineContent||(0==i||(n=(e.findFrom(n,-o,!0)||e.findFrom(n,o,!0)).$anchor).pos<r.pos!=i<0)&&(n=r),new t(n,r)},Object.defineProperties(t.prototype,n),t}(zt);zt.jsonID("text",Rt);var Ft=function(e,t){this.anchor=e,this.head=t};Ft.prototype.map=function(e){return new Ft(e.map(this.anchor),e.map(this.head))},Ft.prototype.resolve=function(e){return Rt.between(e.resolve(this.anchor),e.resolve(this.head))};var Pt=function(e){function t(t){var n=t.nodeAfter,r=t.node(0).resolve(t.pos+n.nodeSize);e.call(this,t,r),this.node=n}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.map=function(n,r){var o=r.mapResult(this.anchor),i=o.deleted,s=o.pos,a=n.resolve(s);return i?e.near(a):new t(a)},t.prototype.content=function(){return new I(O.from(this.node),0,0)},t.prototype.eq=function(e){return e instanceof t&&e.anchor==this.anchor},t.prototype.toJSON=function(){return{type:"node",anchor:this.anchor}},t.prototype.getBookmark=function(){return new _t(this.anchor)},t.fromJSON=function(e,n){if("number"!=typeof n.anchor)throw new RangeError("Invalid input for NodeSelection.fromJSON");return new t(e.resolve(n.anchor))},t.create=function(e,t){return new this(e.resolve(t))},t.isSelectable=function(e){return!e.isText&&!1!==e.type.spec.selectable},t}(zt);Pt.prototype.visible=!1,zt.jsonID("node",Pt);var _t=function(e){this.anchor=e};_t.prototype.map=function(e){var t=e.mapResult(this.anchor),n=t.deleted,r=t.pos;return n?new Ft(r,r):new _t(r)},_t.prototype.resolve=function(e){var t=e.resolve(this.anchor),n=t.nodeAfter;return n&&Pt.isSelectable(n)?new Pt(t):zt.near(t)};var Bt=function(e){function t(t){e.call(this,t.resolve(0),t.resolve(t.content.size))}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.replace=function(t,n){if(void 0===n&&(n=I.empty),n==I.empty){t.delete(0,t.doc.content.size);var r=e.atStart(t.doc);r.eq(t.selection)||t.setSelection(r)}else e.prototype.replace.call(this,t,n)},t.prototype.toJSON=function(){return{type:"all"}},t.fromJSON=function(e){return new t(e)},t.prototype.map=function(e){return new t(e)},t.prototype.eq=function(e){return e instanceof t},t.prototype.getBookmark=function(){return jt},t}(zt);zt.jsonID("all",Bt);var jt={map:function(){return this},resolve:function(e){return new Bt(e)}};function Lt(e,t,n,r,o,i){if(t.inlineContent)return Rt.create(e,n);for(var s=r-(o>0?0:1);o>0?s<t.childCount:s>=0;s+=o){var a=t.child(s);if(a.isAtom){if(!i&&Pt.isSelectable(a))return Pt.create(e,n-(o<0?a.nodeSize:0))}else{var c=Lt(e,a,n+o,o<0?a.childCount:0,o,i);if(c)return c}n+=a.nodeSize*o}}function Vt(e,t,n){var r=e.steps.length-1;if(!(r<t)){var o,i=e.steps[r];if(i instanceof lt||i instanceof ut)e.mapping.maps[r].forEach((function(e,t,n,r){null==o&&(o=r)})),e.setSelection(zt.near(e.doc.resolve(o),n))}}var Wt=function(e){function t(t){e.call(this,t.doc),this.time=Date.now(),this.curSelection=t.selection,this.curSelectionFor=0,this.storedMarks=t.storedMarks,this.updated=0,this.meta=Object.create(null)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={selection:{configurable:!0},selectionSet:{configurable:!0},storedMarksSet:{configurable:!0},isGeneric:{configurable:!0},scrolledIntoView:{configurable:!0}};return n.selection.get=function(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection},t.prototype.setSelection=function(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=-3&(1|this.updated),this.storedMarks=null,this},n.selectionSet.get=function(){return(1&this.updated)>0},t.prototype.setStoredMarks=function(e){return this.storedMarks=e,this.updated|=2,this},t.prototype.ensureMarks=function(e){return D.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this},t.prototype.addStoredMark=function(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))},t.prototype.removeStoredMark=function(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))},n.storedMarksSet.get=function(){return(2&this.updated)>0},t.prototype.addStep=function(t,n){e.prototype.addStep.call(this,t,n),this.updated=-3&this.updated,this.storedMarks=null},t.prototype.setTime=function(e){return this.time=e,this},t.prototype.replaceSelection=function(e){return this.selection.replace(this,e),this},t.prototype.replaceSelectionWith=function(e,t){var n=this.selection;return!1!==t&&(e=e.mark(this.storedMarks||(n.empty?n.$from.marks():n.$from.marksAcross(n.$to)||D.none))),n.replaceWith(this,e),this},t.prototype.deleteSelection=function(){return this.selection.replace(this),this},t.prototype.insertText=function(e,t,n){void 0===n&&(n=t);var r=this.doc.type.schema;if(null==t)return e?this.replaceSelectionWith(r.text(e),!0):this.deleteSelection();if(!e)return this.deleteRange(t,n);var o=this.storedMarks;if(!o){var i=this.doc.resolve(t);o=n==t?i.marks():i.marksAcross(this.doc.resolve(n))}return this.replaceRangeWith(t,n,r.text(e,o)),this.selection.empty||this.setSelection(zt.near(this.selection.$to)),this},t.prototype.setMeta=function(e,t){return this.meta["string"==typeof e?e:e.key]=t,this},t.prototype.getMeta=function(e){return this.meta["string"==typeof e?e:e.key]},n.isGeneric.get=function(){for(var e in this.meta)return!1;return!0},t.prototype.scrollIntoView=function(){return this.updated|=4,this},n.scrolledIntoView.get=function(){return(4&this.updated)>0},Object.defineProperties(t.prototype,n),t}(rt);function qt(e,t){return t&&e?e.bind(t):e}var Ht=function(e,t,n){this.name=e,this.init=qt(t.init,n),this.apply=qt(t.apply,n)},Jt=[new Ht("doc",{init:function(e){return e.doc||e.schema.topNodeType.createAndFill()},apply:function(e){return e.doc}}),new Ht("selection",{init:function(e,t){return e.selection||zt.atStart(t.doc)},apply:function(e){return e.selection}}),new Ht("storedMarks",{init:function(e){return e.storedMarks||null},apply:function(e,t,n,r){return r.selection.$cursor?e.storedMarks:null}}),new Ht("scrollToSelection",{init:function(){return 0},apply:function(e,t){return e.scrolledIntoView?t+1:t}})],Kt=function(e,t){var n=this;this.schema=e,this.fields=Jt.concat(),this.plugins=[],this.pluginsByKey=Object.create(null),t&&t.forEach((function(e){if(n.pluginsByKey[e.key])throw new RangeError("Adding different instances of a keyed plugin ("+e.key+")");n.plugins.push(e),n.pluginsByKey[e.key]=e,e.spec.state&&n.fields.push(new Ht(e.key,e.spec.state,e))}))},Ut=function(e){this.config=e},Gt={schema:{configurable:!0},plugins:{configurable:!0},tr:{configurable:!0}};Gt.schema.get=function(){return this.config.schema},Gt.plugins.get=function(){return this.config.plugins},Ut.prototype.apply=function(e){return this.applyTransaction(e).state},Ut.prototype.filterTransaction=function(e,t){void 0===t&&(t=-1);for(var n=0;n<this.config.plugins.length;n++)if(n!=t){var r=this.config.plugins[n];if(r.spec.filterTransaction&&!r.spec.filterTransaction.call(r,e,this))return!1}return!0},Ut.prototype.applyTransaction=function(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};for(var t=[e],n=this.applyInner(e),r=null;;){for(var o=!1,i=0;i<this.config.plugins.length;i++){var s=this.config.plugins[i];if(s.spec.appendTransaction){var a=r?r[i].n:0,c=r?r[i].state:this,l=a<t.length&&s.spec.appendTransaction.call(s,a?t.slice(a):t,c,n);if(l&&n.filterTransaction(l,i)){if(l.setMeta("appendedTransaction",e),!r){r=[];for(var u=0;u<this.config.plugins.length;u++)r.push(u<i?{state:n,n:t.length}:{state:this,n:0})}t.push(l),n=n.applyInner(l),o=!0}r&&(r[i]={state:n,n:t.length})}}if(!o)return{state:n,transactions:t}}},Ut.prototype.applyInner=function(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");for(var t=new Ut(this.config),n=this.config.fields,r=0;r<n.length;r++){var o=n[r];t[o.name]=o.apply(e,this[o.name],this,t)}for(var i=0;i<Qt.length;i++)Qt[i](this,e,t);return t},Gt.tr.get=function(){return new Wt(this)},Ut.create=function(e){for(var t=new Kt(e.doc?e.doc.type.schema:e.schema,e.plugins),n=new Ut(t),r=0;r<t.fields.length;r++)n[t.fields[r].name]=t.fields[r].init(e,n);return n},Ut.prototype.reconfigure=function(e){for(var t=new Kt(this.schema,e.plugins),n=t.fields,r=new Ut(t),o=0;o<n.length;o++){var i=n[o].name;r[i]=this.hasOwnProperty(i)?this[i]:n[o].init(e,r)}return r},Ut.prototype.toJSON=function(e){var t={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(t.storedMarks=this.storedMarks.map((function(e){return e.toJSON()}))),e&&"object"==typeof e)for(var n in e){if("doc"==n||"selection"==n)throw new RangeError("The JSON fields `doc` and `selection` are reserved");var r=e[n],o=r.spec.state;o&&o.toJSON&&(t[n]=o.toJSON.call(r,this[r.key]))}return t},Ut.fromJSON=function(e,t,n){if(!t)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");var r=new Kt(e.schema,e.plugins),o=new Ut(r);return r.fields.forEach((function(r){if("doc"==r.name)o.doc=ee.fromJSON(e.schema,t.doc);else if("selection"==r.name)o.selection=zt.fromJSON(o.doc,t.selection);else if("storedMarks"==r.name)t.storedMarks&&(o.storedMarks=t.storedMarks.map(e.schema.markFromJSON));else{if(n)for(var i in n){var s=n[i],a=s.spec.state;if(s.key==r.name&&a&&a.fromJSON&&Object.prototype.hasOwnProperty.call(t,i))return void(o[r.name]=a.fromJSON.call(s,e,t[i],o))}o[r.name]=r.init(e,o)}})),o},Ut.addApplyListener=function(e){Qt.push(e)},Ut.removeApplyListener=function(e){var t=Qt.indexOf(e);t>-1&&Qt.splice(t,1)},Object.defineProperties(Ut.prototype,Gt);var Qt=[];function Xt(e,t,n){for(var r in e){var o=e[r];o instanceof Function?o=o.bind(t):"handleDOMEvents"==r&&(o=Xt(o,t,{})),n[r]=o}return n}var Zt=function(e){this.props={},e.props&&Xt(e.props,this,this.props),this.spec=e,this.key=e.key?e.key.key:en("plugin")};Zt.prototype.getState=function(e){return e[this.key]};var Yt=Object.create(null);function en(e){return e in Yt?e+"$"+ ++Yt[e]:(Yt[e]=0,e+"$")}var tn=function(e){void 0===e&&(e="key"),this.key=en(e)};tn.prototype.get=function(e){return e.config.pluginsByKey[this.key]},tn.prototype.getState=function(e){return e[this.key]};var nn={};if("undefined"!=typeof navigator&&"undefined"!=typeof document){var rn=/Edge\/(\d+)/.exec(navigator.userAgent),on=/MSIE \d/.test(navigator.userAgent),sn=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);nn.mac=/Mac/.test(navigator.platform);var an=nn.ie=!!(on||sn||rn);nn.ie_version=on?document.documentMode||6:sn?+sn[1]:rn?+rn[1]:null,nn.gecko=!an&&/gecko\/(\d+)/i.test(navigator.userAgent),nn.gecko_version=nn.gecko&&+(/Firefox\/(\d+)/.exec(navigator.userAgent)||[0,0])[1];var cn=!an&&/Chrome\/(\d+)/.exec(navigator.userAgent);nn.chrome=!!cn,nn.chrome_version=cn&&+cn[1],nn.safari=!an&&/Apple Computer/.test(navigator.vendor),nn.ios=nn.safari&&(/Mobile\/\w+/.test(navigator.userAgent)||navigator.maxTouchPoints>2),nn.android=/Android \d/.test(navigator.userAgent),nn.webkit="webkitFontSmoothing"in document.documentElement.style,nn.webkit_version=nn.webkit&&+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]}var ln=function(e){for(var t=0;;t++)if(!(e=e.previousSibling))return t},un=function(e){var t=e.assignedSlot||e.parentNode;return t&&11==t.nodeType?t.host:t},fn=null,dn=function(e,t,n){var r=fn||(fn=document.createRange());return r.setEnd(e,null==n?e.nodeValue.length:n),r.setStart(e,t||0),r},pn=function(e,t,n,r){return n&&(mn(e,t,n,r,-1)||mn(e,t,n,r,1))},hn=/^(img|br|input|textarea|hr)$/i;function mn(e,t,n,r,o){for(;;){if(e==n&&t==r)return!0;if(t==(o<0?0:vn(e))){var i=e.parentNode;if(1!=i.nodeType||gn(e)||hn.test(e.nodeName)||"false"==e.contentEditable)return!1;t=ln(e)+(o<0?0:1),e=i}else{if(1!=e.nodeType)return!1;if("false"==(e=e.childNodes[t+(o<0?-1:0)]).contentEditable)return!1;t=o<0?vn(e):0}}}function vn(e){return 3==e.nodeType?e.nodeValue.length:e.childNodes.length}function gn(e){for(var t,n=e;n&&!(t=n.pmViewDesc);n=n.parentNode);return t&&t.node&&t.node.isBlock&&(t.dom==e||t.contentDOM==e)}var yn=function(e){var t=e.isCollapsed;return t&&nn.chrome&&e.rangeCount&&!e.getRangeAt(0).collapsed&&(t=!1),t};function wn(e,t){var n=document.createEvent("Event");return n.initEvent("keydown",!0,!0),n.keyCode=e,n.key=n.code=t,n}function bn(e){return{left:0,right:e.documentElement.clientWidth,top:0,bottom:e.documentElement.clientHeight}}function kn(e,t){return"number"==typeof e?e:e[t]}function xn(e){var t=e.getBoundingClientRect(),n=t.width/e.offsetWidth||1,r=t.height/e.offsetHeight||1;return{left:t.left,right:t.left+e.clientWidth*n,top:t.top,bottom:t.top+e.clientHeight*r}}function Sn(e,t,n){for(var r=e.someProp("scrollThreshold")||0,o=e.someProp("scrollMargin")||5,i=e.dom.ownerDocument,s=n||e.dom;s;s=un(s))if(1==s.nodeType){var a=s==i.body||1!=s.nodeType,c=a?bn(i):xn(s),l=0,u=0;if(t.top<c.top+kn(r,"top")?u=-(c.top-t.top+kn(o,"top")):t.bottom>c.bottom-kn(r,"bottom")&&(u=t.bottom-c.bottom+kn(o,"bottom")),t.left<c.left+kn(r,"left")?l=-(c.left-t.left+kn(o,"left")):t.right>c.right-kn(r,"right")&&(l=t.right-c.right+kn(o,"right")),l||u)if(a)i.defaultView.scrollBy(l,u);else{var f=s.scrollLeft,d=s.scrollTop;u&&(s.scrollTop+=u),l&&(s.scrollLeft+=l);var p=s.scrollLeft-f,h=s.scrollTop-d;t={left:t.left-p,top:t.top-h,right:t.right-p,bottom:t.bottom-h}}if(a)break}}function Cn(e){for(var t=[],n=e.ownerDocument;e&&(t.push({dom:e,top:e.scrollTop,left:e.scrollLeft}),e!=n);e=un(e));return t}function Mn(e,t){for(var n=0;n<e.length;n++){var r=e[n],o=r.dom,i=r.top,s=r.left;o.scrollTop!=i+t&&(o.scrollTop=i+t),o.scrollLeft!=s&&(o.scrollLeft=s)}}var On=null;function An(e,t){for(var n,r,o=2e8,i=0,s=t.top,a=t.top,c=e.firstChild,l=0;c;c=c.nextSibling,l++){var u=void 0;if(1==c.nodeType)u=c.getClientRects();else{if(3!=c.nodeType)continue;u=dn(c).getClientRects()}for(var f=0;f<u.length;f++){var d=u[f];if(d.top<=s&&d.bottom>=a){s=Math.max(d.bottom,s),a=Math.min(d.top,a);var p=d.left>t.left?d.left-t.left:d.right<t.left?t.left-d.right:0;if(p<o){n=c,o=p,r=p&&3==n.nodeType?{left:d.right<t.left?d.right:d.left,top:t.top}:t,1==c.nodeType&&p&&(i=l+(t.left>=(d.left+d.right)/2?1:0));continue}}!n&&(t.left>=d.right&&t.top>=d.top||t.left>=d.left&&t.top>=d.bottom)&&(i=l+1)}}return n&&3==n.nodeType?function(e,t){for(var n=e.nodeValue.length,r=document.createRange(),o=0;o<n;o++){r.setEnd(e,o+1),r.setStart(e,o);var i=Dn(r,1);if(i.top!=i.bottom&&En(t,i))return{node:e,offset:o+(t.left>=(i.left+i.right)/2?1:0)}}return{node:e,offset:0}}(n,r):!n||o&&1==n.nodeType?{node:e,offset:i}:An(n,r)}function En(e,t){return e.left>=t.left-1&&e.left<=t.right+1&&e.top>=t.top-1&&e.top<=t.bottom+1}function Tn(e,t,n){var r=e.childNodes.length;if(r&&n.top<n.bottom)for(var o=Math.max(0,Math.min(r-1,Math.floor(r*(t.top-n.top)/(n.bottom-n.top))-2)),i=o;;){var s=e.childNodes[i];if(1==s.nodeType)for(var a=s.getClientRects(),c=0;c<a.length;c++){var l=a[c];if(En(t,l))return Tn(s,t,l)}if((i=(i+1)%r)==o)break}return e}function Nn(e,t){var n,r,o,i,s=e.dom.ownerDocument;if(s.caretPositionFromPoint)try{var a=s.caretPositionFromPoint(t.left,t.top);a&&(o=(n=a).offsetNode,i=n.offset)}catch(v){}if(!o&&s.caretRangeFromPoint){var c=s.caretRangeFromPoint(t.left,t.top);c&&(o=(r=c).startContainer,i=r.startOffset)}var l,u=(e.root.elementFromPoint?e.root:s).elementFromPoint(t.left,t.top+1);if(!u||!e.dom.contains(1!=u.nodeType?u.parentNode:u)){var f=e.dom.getBoundingClientRect();if(!En(t,f))return null;if(!(u=Tn(e.dom,t,f)))return null}if(nn.safari)for(var d=u;o&&d;d=un(d))d.draggable&&(o=i=null);if(u=function(e,t){var n=e.parentNode;return n&&/^li$/i.test(n.nodeName)&&t.left<e.getBoundingClientRect().left?n:e}(u,t),o){if(nn.gecko&&1==o.nodeType&&(i=Math.min(i,o.childNodes.length))<o.childNodes.length){var p,h=o.childNodes[i];"IMG"==h.nodeName&&(p=h.getBoundingClientRect()).right<=t.left&&p.bottom>t.top&&i++}o==e.dom&&i==o.childNodes.length-1&&1==o.lastChild.nodeType&&t.top>o.lastChild.getBoundingClientRect().bottom?l=e.state.doc.content.size:0!=i&&1==o.nodeType&&"BR"==o.childNodes[i-1].nodeName||(l=function(e,t,n,r){for(var o=-1,i=t;i!=e.dom;){var s=e.docView.nearestDesc(i,!0);if(!s)return null;if(s.node.isBlock&&s.parent){var a=s.dom.getBoundingClientRect();if(a.left>r.left||a.top>r.top)o=s.posBefore;else{if(!(a.right<r.left||a.bottom<r.top))break;o=s.posAfter}}i=s.dom.parentNode}return o>-1?o:e.docView.posFromDOM(t,n)}(e,o,i,t))}null==l&&(l=function(e,t,n){var r=An(t,n),o=r.node,i=r.offset,s=-1;if(1==o.nodeType&&!o.firstChild){var a=o.getBoundingClientRect();s=a.left!=a.right&&n.left>(a.left+a.right)/2?1:-1}return e.docView.posFromDOM(o,i,s)}(e,u,t));var m=e.docView.nearestDesc(u,!0);return{pos:l,inside:m?m.posAtStart-m.border:-1}}function Dn(e,t){var n=e.getClientRects();return n.length?n[t<0?0:n.length-1]:e.getBoundingClientRect()}var zn=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function In(e,t,n){var r=e.docView.domFromPos(t,n<0?-1:1),o=r.node,i=r.offset,s=nn.webkit||nn.gecko;if(3==o.nodeType){if(!s||!zn.test(o.nodeValue)&&(n<0?i:i!=o.nodeValue.length)){var a=i,c=i,l=n<0?1:-1;return n<0&&!i?(c++,l=-1):n>=0&&i==o.nodeValue.length?(a--,l=1):n<0?a--:c++,$n(Dn(dn(o,a,c),l),l<0)}var u=Dn(dn(o,i,i),n);if(nn.gecko&&i&&/\s/.test(o.nodeValue[i-1])&&i<o.nodeValue.length){var f=Dn(dn(o,i-1,i-1),-1);if(f.top==u.top){var d=Dn(dn(o,i,i+1),-1);if(d.top!=u.top)return $n(d,d.left<f.left)}}return u}if(!e.state.doc.resolve(t).parent.inlineContent){if(i&&(n<0||i==vn(o))){var p=o.childNodes[i-1];if(1==p.nodeType)return Rn(p.getBoundingClientRect(),!1)}if(i<vn(o)){var h=o.childNodes[i];if(1==h.nodeType)return Rn(h.getBoundingClientRect(),!0)}return Rn(o.getBoundingClientRect(),n>=0)}if(i&&(n<0||i==vn(o))){var m=o.childNodes[i-1],v=3==m.nodeType?dn(m,vn(m)-(s?0:1)):1!=m.nodeType||"BR"==m.nodeName&&m.nextSibling?null:m;if(v)return $n(Dn(v,1),!1)}if(i<vn(o)){for(var g=o.childNodes[i];g.pmViewDesc&&g.pmViewDesc.ignoreForCoords;)g=g.nextSibling;var y=g?3==g.nodeType?dn(g,0,s?0:1):1==g.nodeType?g:null:null;if(y)return $n(Dn(y,-1),!0)}return $n(Dn(3==o.nodeType?dn(o):o,-n),n>=0)}function $n(e,t){if(0==e.width)return e;var n=t?e.left:e.right;return{top:e.top,bottom:e.bottom,left:n,right:n}}function Rn(e,t){if(0==e.height)return e;var n=t?e.top:e.bottom;return{top:n,bottom:n,left:e.left,right:e.right}}function Fn(e,t,n){var r=e.state,o=e.root.activeElement;r!=t&&e.updateState(t),o!=e.dom&&e.focus();try{return n()}finally{r!=t&&e.updateState(r),o!=e.dom&&o&&o.focus()}}var Pn=/[\u0590-\u08ac]/;var _n=null,Bn=null,jn=!1;function Ln(e,t,n){return _n==t&&Bn==n?jn:(_n=t,Bn=n,jn="up"==n||"down"==n?function(e,t,n){var r=t.selection,o="up"==n?r.$from:r.$to;return Fn(e,t,(function(){for(var t=e.docView.domFromPos(o.pos,"up"==n?-1:1).node;;){var r=e.docView.nearestDesc(t,!0);if(!r)break;if(r.node.isBlock){t=r.dom;break}t=r.dom.parentNode}for(var i=In(e,o.pos,1),s=t.firstChild;s;s=s.nextSibling){var a=void 0;if(1==s.nodeType)a=s.getClientRects();else{if(3!=s.nodeType)continue;a=dn(s,0,s.nodeValue.length).getClientRects()}for(var c=0;c<a.length;c++){var l=a[c];if(l.bottom>l.top+1&&("up"==n?i.top-l.top>2*(l.bottom-i.top):l.bottom-i.bottom>2*(i.bottom-l.top)))return!1}}return!0}))}(e,t,n):function(e,t,n){var r=t.selection.$head;if(!r.parent.isTextblock)return!1;var o=r.parentOffset,i=!o,s=o==r.parent.content.size,a=e.root.getSelection();return Pn.test(r.parent.textContent)&&a.modify?Fn(e,t,(function(){var t=a.getRangeAt(0),o=a.focusNode,i=a.focusOffset,s=a.caretBidiLevel;a.modify("move",n,"character");var c=!(r.depth?e.docView.domAfterPos(r.before()):e.dom).contains(1==a.focusNode.nodeType?a.focusNode:a.focusNode.parentNode)||o==a.focusNode&&i==a.focusOffset;return a.removeAllRanges(),a.addRange(t),null!=s&&(a.caretBidiLevel=s),c})):"left"==n||"backward"==n?i:s}(e,t,n))}var Vn=function(e,t,n,r){this.parent=e,this.children=t,this.dom=n,n.pmViewDesc=this,this.contentDOM=r,this.dirty=0},Wn={size:{configurable:!0},border:{configurable:!0},posBefore:{configurable:!0},posAtStart:{configurable:!0},posAfter:{configurable:!0},posAtEnd:{configurable:!0},contentLost:{configurable:!0},domAtom:{configurable:!0},ignoreForCoords:{configurable:!0}};Vn.prototype.matchesWidget=function(){return!1},Vn.prototype.matchesMark=function(){return!1},Vn.prototype.matchesNode=function(){return!1},Vn.prototype.matchesHack=function(e){return!1},Vn.prototype.parseRule=function(){return null},Vn.prototype.stopEvent=function(){return!1},Wn.size.get=function(){for(var e=0,t=0;t<this.children.length;t++)e+=this.children[t].size;return e},Wn.border.get=function(){return 0},Vn.prototype.destroy=function(){this.parent=null,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=null);for(var e=0;e<this.children.length;e++)this.children[e].destroy()},Vn.prototype.posBeforeChild=function(e){for(var t=0,n=this.posAtStart;t<this.children.length;t++){var r=this.children[t];if(r==e)return n;n+=r.size}},Wn.posBefore.get=function(){return this.parent.posBeforeChild(this)},Wn.posAtStart.get=function(){return this.parent?this.parent.posBeforeChild(this)+this.border:0},Wn.posAfter.get=function(){return this.posBefore+this.size},Wn.posAtEnd.get=function(){return this.posAtStart+this.size-2*this.border},Vn.prototype.localPosFromDOM=function(e,t,n){if(this.contentDOM&&this.contentDOM.contains(1==e.nodeType?e:e.parentNode)){if(n<0){var r,o;if(e==this.contentDOM)r=e.childNodes[t-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;r=e.previousSibling}for(;r&&(!(o=r.pmViewDesc)||o.parent!=this);)r=r.previousSibling;return r?this.posBeforeChild(o)+o.size:this.posAtStart}var i,s;if(e==this.contentDOM)i=e.childNodes[t];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;i=e.nextSibling}for(;i&&(!(s=i.pmViewDesc)||s.parent!=this);)i=i.nextSibling;return i?this.posBeforeChild(s):this.posAtEnd}var a;if(e==this.dom&&this.contentDOM)a=t>ln(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))a=2&e.compareDocumentPosition(this.contentDOM);else if(this.dom.firstChild){if(0==t)for(var c=e;;c=c.parentNode){if(c==this.dom){a=!1;break}if(c.parentNode.firstChild!=c)break}if(null==a&&t==e.childNodes.length)for(var l=e;;l=l.parentNode){if(l==this.dom){a=!0;break}if(l.parentNode.lastChild!=l)break}}return(null==a?n>0:a)?this.posAtEnd:this.posAtStart},Vn.prototype.nearestDesc=function(e,t){for(var n=!0,r=e;r;r=r.parentNode){var o=this.getDesc(r);if(o&&(!t||o.node)){if(!n||!o.nodeDOM||(1==o.nodeDOM.nodeType?o.nodeDOM.contains(1==e.nodeType?e:e.parentNode):o.nodeDOM==e))return o;n=!1}}},Vn.prototype.getDesc=function(e){for(var t=e.pmViewDesc,n=t;n;n=n.parent)if(n==this)return t},Vn.prototype.posFromDOM=function(e,t,n){for(var r=e;r;r=r.parentNode){var o=this.getDesc(r);if(o)return o.localPosFromDOM(e,t,n)}return-1},Vn.prototype.descAt=function(e){for(var t=0,n=0;t<this.children.length;t++){var r=this.children[t],o=n+r.size;if(n==e&&o!=n){for(;!r.border&&r.children.length;)r=r.children[0];return r}if(e<o)return r.descAt(e-n-r.border);n=o}},Vn.prototype.domFromPos=function(e,t){if(!this.contentDOM)return{node:this.dom,offset:0};for(var n=0,r=0,o=0;n<this.children.length;n++){var i=this.children[n],s=o+i.size;if(s>e||i instanceof Xn){r=e-o;break}o=s}if(r)return this.children[n].domFromPos(r-this.children[n].border,t);for(var a=void 0;n&&!(a=this.children[n-1]).size&&a instanceof Hn&&a.widget.type.side>=0;n--);if(t<=0){for(var c,l=!0;(c=n?this.children[n-1]:null)&&c.dom.parentNode!=this.contentDOM;n--,l=!1);return c&&t&&l&&!c.border&&!c.domAtom?c.domFromPos(c.size,t):{node:this.contentDOM,offset:c?ln(c.dom)+1:0}}for(var u,f=!0;(u=n<this.children.length?this.children[n]:null)&&u.dom.parentNode!=this.contentDOM;n++,f=!1);return u&&f&&!u.border&&!u.domAtom?u.domFromPos(0,t):{node:this.contentDOM,offset:u?ln(u.dom):this.contentDOM.childNodes.length}},Vn.prototype.parseRange=function(e,t,n){if(void 0===n&&(n=0),0==this.children.length)return{node:this.contentDOM,from:e,to:t,fromOffset:0,toOffset:this.contentDOM.childNodes.length};for(var r=-1,o=-1,i=n,s=0;;s++){var a=this.children[s],c=i+a.size;if(-1==r&&e<=c){var l=i+a.border;if(e>=l&&t<=c-a.border&&a.node&&a.contentDOM&&this.contentDOM.contains(a.contentDOM))return a.parseRange(e,t,l);e=i;for(var u=s;u>0;u--){var f=this.children[u-1];if(f.size&&f.dom.parentNode==this.contentDOM&&!f.emptyChildAt(1)){r=ln(f.dom)+1;break}e-=f.size}-1==r&&(r=0)}if(r>-1&&(c>t||s==this.children.length-1)){t=c;for(var d=s+1;d<this.children.length;d++){var p=this.children[d];if(p.size&&p.dom.parentNode==this.contentDOM&&!p.emptyChildAt(-1)){o=ln(p.dom);break}t+=p.size}-1==o&&(o=this.contentDOM.childNodes.length);break}i=c}return{node:this.contentDOM,from:e,to:t,fromOffset:r,toOffset:o}},Vn.prototype.emptyChildAt=function(e){if(this.border||!this.contentDOM||!this.children.length)return!1;var t=this.children[e<0?0:this.children.length-1];return 0==t.size||t.emptyChildAt(e)},Vn.prototype.domAfterPos=function(e){var t=this.domFromPos(e,0),n=t.node,r=t.offset;if(1!=n.nodeType||r==n.childNodes.length)throw new RangeError("No node after pos "+e);return n.childNodes[r]},Vn.prototype.setSelection=function(e,t,n,r){for(var o=Math.min(e,t),i=Math.max(e,t),s=0,a=0;s<this.children.length;s++){var c=this.children[s],l=a+c.size;if(o>a&&i<l)return c.setSelection(e-a-c.border,t-a-c.border,n,r);a=l}var u=this.domFromPos(e,e?-1:1),f=t==e?u:this.domFromPos(t,t?-1:1),d=n.getSelection(),p=!1;if((nn.gecko||nn.safari)&&e==t){var h=u.node,m=u.offset;if(3==h.nodeType){if((p=m&&"\n"==h.nodeValue[m-1])&&m==h.nodeValue.length)for(var v=h,g=void 0;v;v=v.parentNode){if(g=v.nextSibling){"BR"==g.nodeName&&(u=f={node:g.parentNode,offset:ln(g)+1});break}var y=v.pmViewDesc;if(y&&y.node&&y.node.isBlock)break}}else{var w=h.childNodes[m-1];p=w&&("BR"==w.nodeName||"false"==w.contentEditable)}}if(nn.gecko&&d.focusNode&&d.focusNode!=f.node&&1==d.focusNode.nodeType){var b=d.focusNode.childNodes[d.focusOffset];b&&"false"==b.contentEditable&&(r=!0)}if(r||p&&nn.safari||!pn(u.node,u.offset,d.anchorNode,d.anchorOffset)||!pn(f.node,f.offset,d.focusNode,d.focusOffset)){var k=!1;if((d.extend||e==t)&&!p){d.collapse(u.node,u.offset);try{e!=t&&d.extend(f.node,f.offset),k=!0}catch(C){if(!(C instanceof DOMException))throw C}}if(!k){if(e>t){var x=u;u=f,f=x}var S=document.createRange();S.setEnd(f.node,f.offset),S.setStart(u.node,u.offset),d.removeAllRanges(),d.addRange(S)}}},Vn.prototype.ignoreMutation=function(e){return!this.contentDOM&&"selection"!=e.type},Wn.contentLost.get=function(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)},Vn.prototype.markDirty=function(e,t){for(var n=0,r=0;r<this.children.length;r++){var o=this.children[r],i=n+o.size;if(n==i?e<=i&&t>=n:e<i&&t>n){var s=n+o.border,a=i-o.border;if(e>=s&&t<=a)return this.dirty=e==n||t==i?2:1,void(e!=s||t!=a||!o.contentLost&&o.dom.parentNode==this.contentDOM?o.markDirty(e-s,t-s):o.dirty=3);o.dirty=o.dom==o.contentDOM&&o.dom.parentNode==this.contentDOM?2:3}n=i}this.dirty=2},Vn.prototype.markParentsDirty=function(){for(var e=1,t=this.parent;t;t=t.parent,e++){var n=1==e?2:1;t.dirty<n&&(t.dirty=n)}},Wn.domAtom.get=function(){return!1},Wn.ignoreForCoords.get=function(){return!1},Object.defineProperties(Vn.prototype,Wn);var qn=[],Hn=function(e){function t(t,n,r,o){var i,s=n.type.toDOM;if("function"==typeof s&&(s=s(r,(function(){return i?i.parent?i.parent.posBeforeChild(i):void 0:o}))),!n.type.spec.raw){if(1!=s.nodeType){var a=document.createElement("span");a.appendChild(s),s=a}s.contentEditable=!1,s.classList.add("ProseMirror-widget")}e.call(this,t,qn,s,null),this.widget=n,i=this}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={domAtom:{configurable:!0}};return t.prototype.matchesWidget=function(e){return 0==this.dirty&&e.type.eq(this.widget.type)},t.prototype.parseRule=function(){return{ignore:!0}},t.prototype.stopEvent=function(e){var t=this.widget.spec.stopEvent;return!!t&&t(e)},t.prototype.ignoreMutation=function(e){return"selection"!=e.type||this.widget.spec.ignoreSelection},n.domAtom.get=function(){return!0},Object.defineProperties(t.prototype,n),t}(Vn),Jn=function(e){function t(t,n,r,o){e.call(this,t,qn,n,null),this.textDOM=r,this.text=o}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={size:{configurable:!0}};return n.size.get=function(){return this.text.length},t.prototype.localPosFromDOM=function(e,t){return e!=this.textDOM?this.posAtStart+(t?this.size:0):this.posAtStart+t},t.prototype.domFromPos=function(e){return{node:this.textDOM,offset:e}},t.prototype.ignoreMutation=function(e){return"characterData"===e.type&&e.target.nodeValue==e.oldValue},Object.defineProperties(t.prototype,n),t}(Vn),Kn=function(e){function t(t,n,r,o){e.call(this,t,[],r,o),this.mark=n}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.create=function(e,n,r,o){var i=o.nodeViews[n.type.name],s=i&&i(n,o,r);return s&&s.dom||(s=Fe.renderSpec(document,n.type.spec.toDOM(n,r))),new t(e,n,s.dom,s.contentDOM||s.dom)},t.prototype.parseRule=function(){return{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}},t.prototype.matchesMark=function(e){return 3!=this.dirty&&this.mark.eq(e)},t.prototype.markDirty=function(t,n){if(e.prototype.markDirty.call(this,t,n),0!=this.dirty){for(var r=this.parent;!r.node;)r=r.parent;r.dirty<this.dirty&&(r.dirty=this.dirty),this.dirty=0}},t.prototype.slice=function(e,n,r){var o=t.create(this.parent,this.mark,!0,r),i=this.children,s=this.size;n<s&&(i=ur(i,n,s,r)),e>0&&(i=ur(i,0,e,r));for(var a=0;a<i.length;a++)i[a].parent=o;return o.children=i,o},t}(Vn),Un=function(e){function t(t,n,r,o,i,s,a,c,l){e.call(this,t,n.isLeaf?qn:[],i,s),this.nodeDOM=a,this.node=n,this.outerDeco=r,this.innerDeco=o,s&&this.updateChildren(c,l)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={size:{configurable:!0},border:{configurable:!0},domAtom:{configurable:!0}};return t.create=function(e,n,r,o,i,s){var a,c,l=i.nodeViews[n.type.name],u=l&&l(n,i,(function(){return c?c.parent?c.parent.posBeforeChild(c):void 0:s}),r,o),f=u&&u.dom,d=u&&u.contentDOM;if(n.isText)if(f){if(3!=f.nodeType)throw new RangeError("Text must be rendered as a DOM text node")}else f=document.createTextNode(n.text);else f||(f=(a=Fe.renderSpec(document,n.type.spec.toDOM(n))).dom,d=a.contentDOM);d||n.isText||"BR"==f.nodeName||(f.hasAttribute("contenteditable")||(f.contentEditable=!1),n.type.spec.draggable&&(f.draggable=!0));var p=f;return f=ir(f,r,n),u?c=new Zn(e,n,r,o,f,d,p,u,i,s+1):n.isText?new Qn(e,n,r,o,f,p,i):new t(e,n,r,o,f,d,p,i,s+1)},t.prototype.parseRule=function(){var e=this;if(this.node.type.spec.reparseInView)return null;var t={node:this.node.type.name,attrs:this.node.attrs};return this.node.type.spec.code&&(t.preserveWhitespace="full"),this.contentDOM&&!this.contentLost?t.contentElement=this.contentDOM:t.getContent=function(){return e.contentDOM?O.empty:e.node.content},t},t.prototype.matchesNode=function(e,t,n){return 0==this.dirty&&e.eq(this.node)&&sr(t,this.outerDeco)&&n.eq(this.innerDeco)},n.size.get=function(){return this.node.nodeSize},n.border.get=function(){return this.node.isLeaf?0:1},t.prototype.updateChildren=function(e,t){var n=this,r=this.node.inlineContent,o=t,i=e.composing&&this.localCompositionInfo(e,t),s=i&&i.pos>-1?i:null,a=i&&i.pos<0,c=new cr(this,s&&s.node);!function(e,t,n,r){var o=t.locals(e),i=0;if(0==o.length){for(var s=0;s<e.childCount;s++){var a=e.child(s);r(a,o,t.forChild(i,a),s),i+=a.nodeSize}return}for(var c=0,l=[],u=null,f=0;;){if(c<o.length&&o[c].to==i){for(var d=o[c++],p=void 0;c<o.length&&o[c].to==i;)(p||(p=[d])).push(o[c++]);if(p){p.sort(lr);for(var h=0;h<p.length;h++)n(p[h],f,!!u)}else n(d,f,!!u)}var m=void 0,v=void 0;if(u)v=-1,m=u,u=null;else{if(!(f<e.childCount))break;v=f,m=e.child(f++)}for(var g=0;g<l.length;g++)l[g].to<=i&&l.splice(g--,1);for(;c<o.length&&o[c].from<=i&&o[c].to>i;)l.push(o[c++]);var y=i+m.nodeSize;if(m.isText){var w=y;c<o.length&&o[c].from<w&&(w=o[c].from);for(var b=0;b<l.length;b++)l[b].to<w&&(w=l[b].to);w<y&&(u=m.cut(w-i),m=m.cut(0,w-i),y=w,v=-1)}r(m,l.length?m.isInline&&!m.isLeaf?l.filter((function(e){return!e.inline})):l.slice():qn,t.forChild(i,m),v),i=y}}(this.node,this.innerDeco,(function(t,i,s){t.spec.marks?c.syncToMarks(t.spec.marks,r,e):t.type.side>=0&&!s&&c.syncToMarks(i==n.node.childCount?D.none:n.node.child(i).marks,r,e),c.placeWidget(t,e,o)}),(function(t,n,s,l){var u;c.syncToMarks(t.marks,r,e),c.findNodeMatch(t,n,s,l)||a&&e.state.selection.from>o&&e.state.selection.to<o+t.nodeSize&&(u=c.findIndexWithChild(i.node))>-1&&c.updateNodeAt(t,n,s,u,e)||c.updateNextNode(t,n,s,e,l)||c.addNode(t,n,s,e,o),o+=t.nodeSize})),c.syncToMarks(qn,r,e),this.node.isTextblock&&c.addTextblockHacks(),c.destroyRest(),(c.changed||2==this.dirty)&&(s&&this.protectLocalComposition(e,s),Yn(this.contentDOM,this.children,e),nn.ios&&function(e){if("UL"==e.nodeName||"OL"==e.nodeName){var t=e.style.cssText;e.style.cssText=t+"; list-style: square !important",window.getComputedStyle(e).listStyle,e.style.cssText=t}}(this.dom))},t.prototype.localCompositionInfo=function(e,t){var n=e.state.selection,r=n.from,o=n.to;if(!(!(e.state.selection instanceof Rt)||r<t||o>t+this.node.content.size)){var i=e.root.getSelection(),s=function(e,t){for(;;){if(3==e.nodeType)return e;if(1==e.nodeType&&t>0){if(e.childNodes.length>t&&3==e.childNodes[t].nodeType)return e.childNodes[t];t=vn(e=e.childNodes[t-1])}else{if(!(1==e.nodeType&&t<e.childNodes.length))return null;e=e.childNodes[t],t=0}}}(i.focusNode,i.focusOffset);if(s&&this.dom.contains(s.parentNode)){if(this.node.inlineContent){var a=s.nodeValue,c=function(e,t,n,r){for(var o=0,i=0;o<e.childCount&&i<=r;){var s=e.child(o++),a=i;if(i+=s.nodeSize,s.isText){for(var c=s.text;o<e.childCount;){var l=e.child(o++);if(i+=l.nodeSize,!l.isText)break;c+=l.text}if(i>=n){var u=c.lastIndexOf(t,r-a);if(u>=0&&u+t.length+a>=n)return a+u}}}return-1}(this.node.content,a,r-t,o-t);return c<0?null:{node:s,pos:c,text:a}}return{node:s,pos:-1}}}},t.prototype.protectLocalComposition=function(e,t){var n=t.node,r=t.pos,o=t.text;if(!this.getDesc(n)){for(var i=n;i.parentNode!=this.contentDOM;i=i.parentNode){for(;i.previousSibling;)i.parentNode.removeChild(i.previousSibling);for(;i.nextSibling;)i.parentNode.removeChild(i.nextSibling);i.pmViewDesc&&(i.pmViewDesc=null)}var s=new Jn(this,i,n,o);e.compositionNodes.push(s),this.children=ur(this.children,r,r+o.length,e,s)}},t.prototype.update=function(e,t,n,r){return!(3==this.dirty||!e.sameMarkup(this.node))&&(this.updateInner(e,t,n,r),!0)},t.prototype.updateInner=function(e,t,n,r){this.updateOuterDeco(t),this.node=e,this.innerDeco=n,this.contentDOM&&this.updateChildren(r,this.posAtStart),this.dirty=0},t.prototype.updateOuterDeco=function(e){if(!sr(e,this.outerDeco)){var t=1!=this.nodeDOM.nodeType,n=this.dom;this.dom=rr(this.dom,this.nodeDOM,nr(this.outerDeco,this.node,t),nr(e,this.node,t)),this.dom!=n&&(n.pmViewDesc=null,this.dom.pmViewDesc=this),this.outerDeco=e}},t.prototype.selectNode=function(){this.nodeDOM.classList.add("ProseMirror-selectednode"),!this.contentDOM&&this.node.type.spec.draggable||(this.dom.draggable=!0)},t.prototype.deselectNode=function(){this.nodeDOM.classList.remove("ProseMirror-selectednode"),!this.contentDOM&&this.node.type.spec.draggable||this.dom.removeAttribute("draggable")},n.domAtom.get=function(){return this.node.isAtom},Object.defineProperties(t.prototype,n),t}(Vn);function Gn(e,t,n,r,o){return ir(r,t,e),new Un(null,e,t,n,r,r,r,o,0)}var Qn=function(e){function t(t,n,r,o,i,s,a){e.call(this,t,n,r,o,i,null,s,a)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={domAtom:{configurable:!0}};return t.prototype.parseRule=function(){for(var e=this.nodeDOM.parentNode;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}},t.prototype.update=function(e,t,n,r){return!(3==this.dirty||0!=this.dirty&&!this.inParent()||!e.sameMarkup(this.node))&&(this.updateOuterDeco(t),0==this.dirty&&e.text==this.node.text||e.text==this.nodeDOM.nodeValue||(this.nodeDOM.nodeValue=e.text,r.trackWrites==this.nodeDOM&&(r.trackWrites=null)),this.node=e,this.dirty=0,!0)},t.prototype.inParent=function(){for(var e=this.parent.contentDOM,t=this.nodeDOM;t;t=t.parentNode)if(t==e)return!0;return!1},t.prototype.domFromPos=function(e){return{node:this.nodeDOM,offset:e}},t.prototype.localPosFromDOM=function(t,n,r){return t==this.nodeDOM?this.posAtStart+Math.min(n,this.node.text.length):e.prototype.localPosFromDOM.call(this,t,n,r)},t.prototype.ignoreMutation=function(e){return"characterData"!=e.type&&"selection"!=e.type},t.prototype.slice=function(e,n,r){var o=this.node.cut(e,n),i=document.createTextNode(o.text);return new t(this.parent,o,this.outerDeco,this.innerDeco,i,i,r)},t.prototype.markDirty=function(t,n){e.prototype.markDirty.call(this,t,n),this.dom==this.nodeDOM||0!=t&&n!=this.nodeDOM.nodeValue.length||(this.dirty=3)},n.domAtom.get=function(){return!1},Object.defineProperties(t.prototype,n),t}(Un),Xn=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={domAtom:{configurable:!0},ignoreForCoords:{configurable:!0}};return t.prototype.parseRule=function(){return{ignore:!0}},t.prototype.matchesHack=function(e){return 0==this.dirty&&this.dom.nodeName==e},n.domAtom.get=function(){return!0},n.ignoreForCoords.get=function(){return"IMG"==this.dom.nodeName},Object.defineProperties(t.prototype,n),t}(Vn),Zn=function(e){function t(t,n,r,o,i,s,a,c,l,u){e.call(this,t,n,r,o,i,s,a,l,u),this.spec=c}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.update=function(t,n,r,o){if(3==this.dirty)return!1;if(this.spec.update){var i=this.spec.update(t,n,r);return i&&this.updateInner(t,n,r,o),i}return!(!this.contentDOM&&!t.isLeaf)&&e.prototype.update.call(this,t,n,r,o)},t.prototype.selectNode=function(){this.spec.selectNode?this.spec.selectNode():e.prototype.selectNode.call(this)},t.prototype.deselectNode=function(){this.spec.deselectNode?this.spec.deselectNode():e.prototype.deselectNode.call(this)},t.prototype.setSelection=function(t,n,r,o){this.spec.setSelection?this.spec.setSelection(t,n,r):e.prototype.setSelection.call(this,t,n,r,o)},t.prototype.destroy=function(){this.spec.destroy&&this.spec.destroy(),e.prototype.destroy.call(this)},t.prototype.stopEvent=function(e){return!!this.spec.stopEvent&&this.spec.stopEvent(e)},t.prototype.ignoreMutation=function(t){return this.spec.ignoreMutation?this.spec.ignoreMutation(t):e.prototype.ignoreMutation.call(this,t)},t}(Un);function Yn(e,t,n){for(var r=e.firstChild,o=!1,i=0;i<t.length;i++){var s=t[i],a=s.dom;if(a.parentNode==e){for(;a!=r;)r=ar(r),o=!0;r=r.nextSibling}else o=!0,e.insertBefore(a,r);if(s instanceof Kn){var c=r?r.previousSibling:e.lastChild;Yn(s.contentDOM,s.children,n),r=c?c.nextSibling:e.firstChild}}for(;r;)r=ar(r),o=!0;o&&n.trackWrites==e&&(n.trackWrites=null)}function er(e){e&&(this.nodeName=e)}er.prototype=Object.create(null);var tr=[new er];function nr(e,t,n){if(0==e.length)return tr;for(var r=n?tr[0]:new er,o=[r],i=0;i<e.length;i++){var s=e[i].type.attrs;if(s)for(var a in s.nodeName&&o.push(r=new er(s.nodeName)),s){var c=s[a];null!=c&&(n&&1==o.length&&o.push(r=new er(t.isInline?"span":"div")),"class"==a?r.class=(r.class?r.class+" ":"")+c:"style"==a?r.style=(r.style?r.style+";":"")+c:"nodeName"!=a&&(r[a]=c))}}return o}function rr(e,t,n,r){if(n==tr&&r==tr)return t;for(var o=t,i=0;i<r.length;i++){var s=r[i],a=n[i];if(i){var c=void 0;a&&a.nodeName==s.nodeName&&o!=e&&(c=o.parentNode)&&c.tagName.toLowerCase()==s.nodeName||((c=document.createElement(s.nodeName)).pmIsDeco=!0,c.appendChild(o),a=tr[0]),o=c}or(o,a||tr[0],s)}return o}function or(e,t,n){for(var r in t)"class"==r||"style"==r||"nodeName"==r||r in n||e.removeAttribute(r);for(var o in n)"class"!=o&&"style"!=o&&"nodeName"!=o&&n[o]!=t[o]&&e.setAttribute(o,n[o]);if(t.class!=n.class){for(var i=t.class?t.class.split(" ").filter(Boolean):qn,s=n.class?n.class.split(" ").filter(Boolean):qn,a=0;a<i.length;a++)-1==s.indexOf(i[a])&&e.classList.remove(i[a]);for(var c=0;c<s.length;c++)-1==i.indexOf(s[c])&&e.classList.add(s[c])}if(t.style!=n.style){if(t.style)for(var l,u=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g;l=u.exec(t.style);)e.style.removeProperty(l[1]);n.style&&(e.style.cssText+=n.style)}}function ir(e,t,n){return rr(e,e,tr,nr(t,n,1!=e.nodeType))}function sr(e,t){if(e.length!=t.length)return!1;for(var n=0;n<e.length;n++)if(!e[n].type.eq(t[n].type))return!1;return!0}function ar(e){var t=e.nextSibling;return e.parentNode.removeChild(e),t}var cr=function(e,t){this.top=e,this.lock=t,this.index=0,this.stack=[],this.changed=!1,this.preMatch=function(e,t){for(var n=e.childCount,r=t.length,o=new Map;n>0&&r>0;r--){var i=t[r-1],s=i.node;if(s){if(s!=e.child(n-1))break;--n,o.set(i,n)}}return{index:n,matched:o}}(e.node.content,e.children)};function lr(e,t){return e.type.side-t.type.side}function ur(e,t,n,r,o){for(var i=[],s=0,a=0;s<e.length;s++){var c=e[s],l=a,u=a+=c.size;l>=n||u<=t?i.push(c):(l<t&&i.push(c.slice(0,t-l,r)),o&&(i.push(o),o=null),u>n&&i.push(c.slice(n-l,c.size,r)))}return i}function fr(e,t){var n=e.root.getSelection(),r=e.state.doc;if(!n.focusNode)return null;var o=e.docView.nearestDesc(n.focusNode),i=o&&0==o.size,s=e.docView.posFromDOM(n.focusNode,n.focusOffset);if(s<0)return null;var a,c,l=r.resolve(s);if(yn(n)){for(a=l;o&&!o.node;)o=o.parent;if(o&&o.node.isAtom&&Pt.isSelectable(o.node)&&o.parent&&(!o.node.isInline||!function(e,t,n){for(var r=0==t,o=t==vn(e);r||o;){if(e==n)return!0;var i=ln(e);if(!(e=e.parentNode))return!1;r=r&&0==i,o=o&&i==vn(e)}}(n.focusNode,n.focusOffset,o.dom))){var u=o.posBefore;c=new Pt(s==u?l:r.resolve(u))}}else{var f=e.docView.posFromDOM(n.anchorNode,n.anchorOffset);if(f<0)return null;a=r.resolve(f)}c||(c=br(e,a,l,"pointer"==t||e.state.selection.head<l.pos&&!i?1:-1));return c}function dr(e){return e.editable?e.hasFocus():kr(e)&&document.activeElement&&document.activeElement.contains(e.dom)}function pr(e,t){var n=e.state.selection;if(yr(e,n),dr(e)){if(!t&&e.mouseDown&&e.mouseDown.allowDefault)return e.mouseDown.delayedSelectionSync=!0,void e.domObserver.setCurSelection();if(e.domObserver.disconnectSelection(),e.cursorWrapper)!function(e){var t=e.root.getSelection(),n=document.createRange(),r=e.cursorWrapper.dom,o="IMG"==r.nodeName;o?n.setEnd(r.parentNode,ln(r)+1):n.setEnd(r,0);n.collapse(!1),t.removeAllRanges(),t.addRange(n),!o&&!e.state.selection.visible&&nn.ie&&nn.ie_version<=11&&(r.disabled=!0,r.disabled=!1)}(e);else{var r,o,i=n.anchor,s=n.head;!hr||n instanceof Rt||(n.$from.parent.inlineContent||(r=mr(e,n.from)),n.empty||n.$from.parent.inlineContent||(o=mr(e,n.to))),e.docView.setSelection(i,s,e.root,t),hr&&(r&&gr(r),o&&gr(o)),n.visible?e.dom.classList.remove("ProseMirror-hideselection"):(e.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&function(e){var t=e.dom.ownerDocument;t.removeEventListener("selectionchange",e.hideSelectionGuard);var n=e.root.getSelection(),r=n.anchorNode,o=n.anchorOffset;t.addEventListener("selectionchange",e.hideSelectionGuard=function(){n.anchorNode==r&&n.anchorOffset==o||(t.removeEventListener("selectionchange",e.hideSelectionGuard),setTimeout((function(){dr(e)&&!e.state.selection.visible||e.dom.classList.remove("ProseMirror-hideselection")}),20))})}(e))}e.domObserver.setCurSelection(),e.domObserver.connectSelection()}}cr.prototype.destroyBetween=function(e,t){if(e!=t){for(var n=e;n<t;n++)this.top.children[n].destroy();this.top.children.splice(e,t-e),this.changed=!0}},cr.prototype.destroyRest=function(){this.destroyBetween(this.index,this.top.children.length)},cr.prototype.syncToMarks=function(e,t,n){for(var r=0,o=this.stack.length>>1,i=Math.min(o,e.length);r<i&&(r==o-1?this.top:this.stack[r+1<<1]).matchesMark(e[r])&&!1!==e[r].type.spec.spanning;)r++;for(;r<o;)this.destroyRest(),this.top.dirty=0,this.index=this.stack.pop(),this.top=this.stack.pop(),o--;for(;o<e.length;){this.stack.push(this.top,this.index+1);for(var s=-1,a=this.index;a<Math.min(this.index+3,this.top.children.length);a++)if(this.top.children[a].matchesMark(e[o])){s=a;break}if(s>-1)s>this.index&&(this.changed=!0,this.destroyBetween(this.index,s)),this.top=this.top.children[this.index];else{var c=Kn.create(this.top,e[o],t,n);this.top.children.splice(this.index,0,c),this.top=c,this.changed=!0}this.index=0,o++}},cr.prototype.findNodeMatch=function(e,t,n,r){var o=this.top.children,i=-1;if(r>=this.preMatch.index){for(var s=this.index;s<o.length;s++)if(o[s].matchesNode(e,t,n)){i=s;break}}else for(var a=this.index,c=Math.min(o.length,a+1);a<c;a++){var l=o[a];if(l.matchesNode(e,t,n)&&!this.preMatch.matched.has(l)){i=a;break}}return!(i<0)&&(this.destroyBetween(this.index,i),this.index++,!0)},cr.prototype.updateNodeAt=function(e,t,n,r,o){return!!this.top.children[r].update(e,t,n,o)&&(this.destroyBetween(this.index,r),this.index=r+1,!0)},cr.prototype.findIndexWithChild=function(e){for(;;){var t=e.parentNode;if(!t)return-1;if(t==this.top.contentDOM){var n=e.pmViewDesc;if(n)for(var r=this.index;r<this.top.children.length;r++)if(this.top.children[r]==n)return r;return-1}e=t}},cr.prototype.updateNextNode=function(e,t,n,r,o){for(var i=this.index;i<this.top.children.length;i++){var s=this.top.children[i];if(s instanceof Un){var a=this.preMatch.matched.get(s);if(null!=a&&a!=o)return!1;var c=s.dom;if(!(this.lock&&(c==this.lock||1==c.nodeType&&c.contains(this.lock.parentNode))&&!(e.isText&&s.node&&s.node.isText&&s.nodeDOM.nodeValue==e.text&&3!=s.dirty&&sr(t,s.outerDeco)))&&s.update(e,t,n,r))return this.destroyBetween(this.index,i),s.dom!=c&&(this.changed=!0),this.index++,!0;break}}return!1},cr.prototype.addNode=function(e,t,n,r,o){this.top.children.splice(this.index++,0,Un.create(this.top,e,t,n,r,o)),this.changed=!0},cr.prototype.placeWidget=function(e,t,n){var r=this.index<this.top.children.length?this.top.children[this.index]:null;if(!r||!r.matchesWidget(e)||e!=r.widget&&r.widget.type.toDOM.parentNode){var o=new Hn(this.top,e,t,n);this.top.children.splice(this.index++,0,o),this.changed=!0}else this.index++},cr.prototype.addTextblockHacks=function(){for(var e=this.top.children[this.index-1];e instanceof Kn;)e=e.children[e.children.length-1];e&&e instanceof Qn&&!/\n$/.test(e.node.text)||((nn.safari||nn.chrome)&&e&&"false"==e.dom.contentEditable&&this.addHackNode("IMG"),this.addHackNode("BR"))},cr.prototype.addHackNode=function(e){if(this.index<this.top.children.length&&this.top.children[this.index].matchesHack(e))this.index++;else{var t=document.createElement(e);"IMG"==e&&(t.className="ProseMirror-separator"),"BR"==e&&(t.className="ProseMirror-trailingBreak"),this.top.children.splice(this.index++,0,new Xn(this.top,qn,t,null)),this.changed=!0}};var hr=nn.safari||nn.chrome&&nn.chrome_version<63;function mr(e,t){var n=e.docView.domFromPos(t,0),r=n.node,o=n.offset,i=o<r.childNodes.length?r.childNodes[o]:null,s=o?r.childNodes[o-1]:null;if(nn.safari&&i&&"false"==i.contentEditable)return vr(i);if(!(i&&"false"!=i.contentEditable||s&&"false"!=s.contentEditable)){if(i)return vr(i);if(s)return vr(s)}}function vr(e){return e.contentEditable="true",nn.safari&&e.draggable&&(e.draggable=!1,e.wasDraggable=!0),e}function gr(e){e.contentEditable="false",e.wasDraggable&&(e.draggable=!0,e.wasDraggable=null)}function yr(e,t){if(t instanceof Pt){var n=e.docView.descAt(t.from);n!=e.lastSelectedViewDesc&&(wr(e),n&&n.selectNode(),e.lastSelectedViewDesc=n)}else wr(e)}function wr(e){e.lastSelectedViewDesc&&(e.lastSelectedViewDesc.parent&&e.lastSelectedViewDesc.deselectNode(),e.lastSelectedViewDesc=null)}function br(e,t,n,r){return e.someProp("createSelectionBetween",(function(r){return r(e,t,n)}))||Rt.between(t,n,r)}function kr(e){var t=e.root.getSelection();if(!t.anchorNode)return!1;try{return e.dom.contains(3==t.anchorNode.nodeType?t.anchorNode.parentNode:t.anchorNode)&&(e.editable||e.dom.contains(3==t.focusNode.nodeType?t.focusNode.parentNode:t.focusNode))}catch(n){return!1}}function xr(e,t){var n=e.selection,r=n.$anchor,o=n.$head,i=t>0?r.max(o):r.min(o),s=i.parent.inlineContent?i.depth?e.doc.resolve(t>0?i.after():i.before()):null:i;return s&&zt.findFrom(s,t)}function Sr(e,t){return e.dispatch(e.state.tr.setSelection(t).scrollIntoView()),!0}function Cr(e,t,n){var r=e.state.selection;if(!(r instanceof Rt)){if(r instanceof Pt&&r.node.isInline)return Sr(e,new Rt(t>0?r.$to:r.$from));var o=xr(e.state,t);return!!o&&Sr(e,o)}if(!r.empty||n.indexOf("s")>-1)return!1;if(e.endOfTextblock(t>0?"right":"left")){var i=xr(e.state,t);return!!(i&&i instanceof Pt)&&Sr(e,i)}if(!(nn.mac&&n.indexOf("m")>-1)){var s,a=r.$head,c=a.textOffset?null:t<0?a.nodeBefore:a.nodeAfter;if(!c||c.isText)return!1;var l=t<0?a.pos-c.nodeSize:a.pos;return!!(c.isAtom||(s=e.docView.descAt(l))&&!s.contentDOM)&&(Pt.isSelectable(c)?Sr(e,new Pt(t<0?e.state.doc.resolve(a.pos-c.nodeSize):a)):!!nn.webkit&&Sr(e,new Rt(e.state.doc.resolve(t<0?l:l+c.nodeSize))))}}function Mr(e){return 3==e.nodeType?e.nodeValue.length:e.childNodes.length}function Or(e){var t=e.pmViewDesc;return t&&0==t.size&&(e.nextSibling||"BR"!=e.nodeName)}function Ar(e){var t=e.root.getSelection(),n=t.focusNode,r=t.focusOffset;if(n){var o,i,s=!1;for(nn.gecko&&1==n.nodeType&&r<Mr(n)&&Or(n.childNodes[r])&&(s=!0);;)if(r>0){if(1!=n.nodeType)break;var a=n.childNodes[r-1];if(Or(a))o=n,i=--r;else{if(3!=a.nodeType)break;r=(n=a).nodeValue.length}}else{if(Tr(n))break;for(var c=n.previousSibling;c&&Or(c);)o=n.parentNode,i=ln(c),c=c.previousSibling;if(c)r=Mr(n=c);else{if((n=n.parentNode)==e.dom)break;r=0}}s?Nr(e,t,n,r):o&&Nr(e,t,o,i)}}function Er(e){var t=e.root.getSelection(),n=t.focusNode,r=t.focusOffset;if(n){for(var o,i,s=Mr(n);;)if(r<s){if(1!=n.nodeType)break;if(!Or(n.childNodes[r]))break;o=n,i=++r}else{if(Tr(n))break;for(var a=n.nextSibling;a&&Or(a);)o=a.parentNode,i=ln(a)+1,a=a.nextSibling;if(a)r=0,s=Mr(n=a);else{if((n=n.parentNode)==e.dom)break;r=s=0}}o&&Nr(e,t,o,i)}}function Tr(e){var t=e.pmViewDesc;return t&&t.node&&t.node.isBlock}function Nr(e,t,n,r){if(yn(t)){var o=document.createRange();o.setEnd(n,r),o.setStart(n,r),t.removeAllRanges(),t.addRange(o)}else t.extend&&t.extend(n,r);e.domObserver.setCurSelection();var i=e.state;setTimeout((function(){e.state==i&&pr(e)}),50)}function Dr(e,t,n){var r=e.state.selection;if(r instanceof Rt&&!r.empty||n.indexOf("s")>-1)return!1;if(nn.mac&&n.indexOf("m")>-1)return!1;var o=r.$from,i=r.$to;if(!o.parent.inlineContent||e.endOfTextblock(t<0?"up":"down")){var s=xr(e.state,t);if(s&&s instanceof Pt)return Sr(e,s)}if(!o.parent.inlineContent){var a=t<0?o:i,c=r instanceof Bt?zt.near(a,t):zt.findFrom(a,t);return!!c&&Sr(e,c)}return!1}function zr(e,t){if(!(e.state.selection instanceof Rt))return!0;var n=e.state.selection,r=n.$head,o=n.$anchor,i=n.empty;if(!r.sameParent(o))return!0;if(!i)return!1;if(e.endOfTextblock(t>0?"forward":"backward"))return!0;var s=!r.textOffset&&(t<0?r.nodeBefore:r.nodeAfter);if(s&&!s.isText){var a=e.state.tr;return t<0?a.delete(r.pos-s.nodeSize,r.pos):a.delete(r.pos,r.pos+s.nodeSize),e.dispatch(a),!0}return!1}function Ir(e,t,n){e.domObserver.stop(),t.contentEditable=n,e.domObserver.start()}function $r(e,t){var n=t.keyCode,r=function(e){var t="";return e.ctrlKey&&(t+="c"),e.metaKey&&(t+="m"),e.altKey&&(t+="a"),e.shiftKey&&(t+="s"),t}(t);return 8==n||nn.mac&&72==n&&"c"==r?zr(e,-1)||Ar(e):46==n||nn.mac&&68==n&&"c"==r?zr(e,1)||Er(e):13==n||27==n||(37==n?Cr(e,-1,r)||Ar(e):39==n?Cr(e,1,r)||Er(e):38==n?Dr(e,-1,r)||Ar(e):40==n?function(e){if(nn.safari&&!(e.state.selection.$head.parentOffset>0)){var t=e.root.getSelection(),n=t.focusNode,r=t.focusOffset;if(n&&1==n.nodeType&&0==r&&n.firstChild&&"false"==n.firstChild.contentEditable){var o=n.firstChild;Ir(e,o,!0),setTimeout((function(){return Ir(e,o,!1)}),20)}}}(e)||Dr(e,1,r)||Er(e):r==(nn.mac?"m":"c")&&(66==n||73==n||89==n||90==n))}function Rr(e){var t=e.pmViewDesc;if(t)return t.parseRule();if("BR"==e.nodeName&&e.parentNode){if(nn.safari&&/^(ul|ol)$/i.test(e.parentNode.nodeName)){var n=document.createElement("div");return n.appendChild(document.createElement("li")),{skip:n}}if(e.parentNode.lastChild==e||nn.safari&&/^(tr|table)$/i.test(e.parentNode.nodeName))return{ignore:!0}}else if("IMG"==e.nodeName&&e.getAttribute("mark-placeholder"))return{ignore:!0}}function Fr(e,t,n,r,o){if(t<0){var i=e.lastSelectionTime>Date.now()-50?e.lastSelectionOrigin:null,s=fr(e,i);if(s&&!e.state.selection.eq(s)){var a=e.state.tr.setSelection(s);"pointer"==i?a.setMeta("pointer",!0):"key"==i&&a.scrollIntoView(),e.dispatch(a)}}else{var c=e.state.doc.resolve(t),l=c.sharedDepth(n);t=c.before(l+1),n=e.state.doc.resolve(n).after(l+1);var u=e.state.selection,f=function(e,t,n){var r=e.docView.parseRange(t,n),o=r.node,i=r.fromOffset,s=r.toOffset,a=r.from,c=r.to,l=e.root.getSelection(),u=null,f=l.anchorNode;if(f&&e.dom.contains(1==f.nodeType?f:f.parentNode)&&(u=[{node:f,offset:l.anchorOffset}],yn(l)||u.push({node:l.focusNode,offset:l.focusOffset})),nn.chrome&&8===e.lastKeyCode)for(var d=s;d>i;d--){var p=o.childNodes[d-1],h=p.pmViewDesc;if("BR"==p.nodeName&&!h){s=d;break}if(!h||h.size)break}var m=e.state.doc,v=e.someProp("domParser")||Me.fromSchema(e.state.schema),g=m.resolve(a),y=null,w=v.parse(o,{topNode:g.parent,topMatch:g.parent.contentMatchAt(g.index()),topOpen:!0,from:i,to:s,preserveWhitespace:!g.parent.type.spec.code||"full",editableContent:!0,findPositions:u,ruleFromNode:Rr,context:g});if(u&&null!=u[0].pos){var b=u[0].pos,k=u[1]&&u[1].pos;null==k&&(k=b),y={anchor:b+a,head:k+a}}return{doc:w,sel:y,from:a,to:c}}(e,t,n);if(nn.chrome&&e.cursorWrapper&&f.sel&&f.sel.anchor==e.cursorWrapper.deco.from){var d=e.cursorWrapper.deco.type.toDOM.nextSibling,p=d&&d.nodeValue?d.nodeValue.length:1;f.sel={anchor:f.sel.anchor+p,head:f.sel.anchor+p}}var h,m,v=e.state.doc,g=v.slice(f.from,f.to);8===e.lastKeyCode&&Date.now()-100<e.lastKeyCodeTime?(h=e.state.selection.to,m="end"):(h=e.state.selection.from,m="start"),e.lastKeyCode=null;var y=function(e,t,n,r,o){var i=e.findDiffStart(t,n);if(null==i)return null;var s=e.findDiffEnd(t,n+e.size,n+t.size),a=s.a,c=s.b;if("end"==o){r-=a+Math.max(0,i-Math.min(a,c))-i}if(a<i&&e.size<t.size){c=(i-=r<=i&&r>=a?i-r:0)+(c-a),a=i}else if(c<i){a=(i-=r<=i&&r>=c?i-r:0)+(a-c),c=i}return{start:i,endA:a,endB:c}}(g.content,f.doc.content,f.from,h,m);if(!y){if(!(r&&u instanceof Rt&&!u.empty&&u.$head.sameParent(u.$anchor))||e.composing||f.sel&&f.sel.anchor!=f.sel.head){if((nn.ios&&e.lastIOSEnter>Date.now()-225||nn.android)&&o.some((function(e){return"DIV"==e.nodeName||"P"==e.nodeName}))&&e.someProp("handleKeyDown",(function(t){return t(e,wn(13,"Enter"))})))return void(e.lastIOSEnter=0);if(f.sel){var w=Pr(e,e.state.doc,f.sel);w&&!w.eq(e.state.selection)&&e.dispatch(e.state.tr.setSelection(w))}return}y={start:u.from,endA:u.to,endB:u.to}}e.domChangeCount++,e.state.selection.from<e.state.selection.to&&y.start==y.endB&&e.state.selection instanceof Rt&&(y.start>e.state.selection.from&&y.start<=e.state.selection.from+2?y.start=e.state.selection.from:y.endA<e.state.selection.to&&y.endA>=e.state.selection.to-2&&(y.endB+=e.state.selection.to-y.endA,y.endA=e.state.selection.to)),nn.ie&&nn.ie_version<=11&&y.endB==y.start+1&&y.endA==y.start&&y.start>f.from&&" "==f.doc.textBetween(y.start-f.from-1,y.start-f.from+1)&&(y.start--,y.endA--,y.endB--);var b,k=f.doc.resolveNoCache(y.start-f.from),x=f.doc.resolveNoCache(y.endB-f.from),S=k.sameParent(x)&&k.parent.inlineContent;if((nn.ios&&e.lastIOSEnter>Date.now()-225&&(!S||o.some((function(e){return"DIV"==e.nodeName||"P"==e.nodeName})))||!S&&k.pos<f.doc.content.size&&(b=zt.findFrom(f.doc.resolve(k.pos+1),1,!0))&&b.head==x.pos)&&e.someProp("handleKeyDown",(function(t){return t(e,wn(13,"Enter"))})))e.lastIOSEnter=0;else if(e.state.selection.anchor>y.start&&function(e,t,n,r,o){if(!r.parent.isTextblock||n-t<=o.pos-r.pos||_r(r,!0,!1)<o.pos)return!1;var i=e.resolve(t);if(i.parentOffset<i.parent.content.size||!i.parent.isTextblock)return!1;var s=e.resolve(_r(i,!0,!0));if(!s.parent.isTextblock||s.pos>n||_r(s,!0,!1)<n)return!1;return r.parent.content.cut(r.parentOffset).eq(s.parent.content)}(v,y.start,y.endA,k,x)&&e.someProp("handleKeyDown",(function(t){return t(e,wn(8,"Backspace"))})))nn.android&&nn.chrome&&e.domObserver.suppressSelectionUpdates();else{nn.chrome&&nn.android&&y.toB==y.from&&(e.lastAndroidDelete=Date.now()),nn.android&&!S&&k.start()!=x.start()&&0==x.parentOffset&&k.depth==x.depth&&f.sel&&f.sel.anchor==f.sel.head&&f.sel.head==y.endA&&(y.endB-=2,x=f.doc.resolveNoCache(y.endB-f.from),setTimeout((function(){e.someProp("handleKeyDown",(function(t){return t(e,wn(13,"Enter"))}))}),20));var C,M,A,E,T=y.start,N=y.endA;if(S)if(k.pos==x.pos)nn.ie&&nn.ie_version<=11&&0==k.parentOffset&&(e.domObserver.suppressSelectionUpdates(),setTimeout((function(){return pr(e)}),20)),C=e.state.tr.delete(T,N),M=v.resolve(y.start).marksAcross(v.resolve(y.endA));else if(y.endA==y.endB&&(E=v.resolve(y.start))&&(A=function(e,t){for(var n,r,o,i=e.firstChild.marks,s=t.firstChild.marks,a=i,c=s,l=0;l<s.length;l++)a=s[l].removeFromSet(a);for(var u=0;u<i.length;u++)c=i[u].removeFromSet(c);if(1==a.length&&0==c.length)r=a[0],n="add",o=function(e){return e.mark(r.addToSet(e.marks))};else{if(0!=a.length||1!=c.length)return null;r=c[0],n="remove",o=function(e){return e.mark(r.removeFromSet(e.marks))}}for(var f=[],d=0;d<t.childCount;d++)f.push(o(t.child(d)));if(O.from(f).eq(e))return{mark:r,type:n}}(k.parent.content.cut(k.parentOffset,x.parentOffset),E.parent.content.cut(E.parentOffset,y.endA-E.start()))))C=e.state.tr,"add"==A.type?C.addMark(T,N,A.mark):C.removeMark(T,N,A.mark);else if(k.parent.child(k.index()).isText&&k.index()==x.index()-(x.textOffset?0:1)){var D=k.parent.textBetween(k.parentOffset,x.parentOffset);if(e.someProp("handleTextInput",(function(t){return t(e,T,N,D)})))return;C=e.state.tr.insertText(D,T,N)}if(C||(C=e.state.tr.replace(T,N,f.doc.slice(y.start-f.from,y.endB-f.from))),f.sel){var z=Pr(e,C.doc,f.sel);z&&!(nn.chrome&&nn.android&&e.composing&&z.empty&&(y.start!=y.endB||e.lastAndroidDelete<Date.now()-100)&&(z.head==T||z.head==C.mapping.map(N)-1)||nn.ie&&z.empty&&z.head==T)&&C.setSelection(z)}M&&C.ensureMarks(M),e.dispatch(C.scrollIntoView())}}}function Pr(e,t,n){return Math.max(n.anchor,n.head)>t.content.size?null:br(e,t.resolve(n.anchor),t.resolve(n.head))}function _r(e,t,n){for(var r=e.depth,o=t?e.end():e.pos;r>0&&(t||e.indexAfter(r)==e.node(r).childCount);)r--,o++,t=!1;if(n)for(var i=e.node(r).maybeChild(e.indexAfter(r));i&&!i.isLeaf;)i=i.firstChild,o++;return o}function Br(e,t){for(var n=[],r=t.content,o=t.openStart,i=t.openEnd;o>1&&i>1&&1==r.childCount&&1==r.firstChild.childCount;){o--,i--;var s=r.firstChild;n.push(s.type.name,s.attrs!=s.type.defaultAttrs?s.attrs:null),r=s.content}var a=e.someProp("clipboardSerializer")||Fe.fromSchema(e.state.schema),c=Ur(),l=c.createElement("div");l.appendChild(a.serializeFragment(r,{document:c}));for(var u,f=l.firstChild;f&&1==f.nodeType&&(u=Jr[f.nodeName.toLowerCase()]);){for(var d=u.length-1;d>=0;d--){for(var p=c.createElement(u[d]);l.firstChild;)p.appendChild(l.firstChild);l.appendChild(p),"tbody"!=u[d]&&(o++,i++)}f=l.firstChild}return f&&1==f.nodeType&&f.setAttribute("data-pm-slice",o+" "+i+" "+JSON.stringify(n)),{dom:l,text:e.someProp("clipboardTextSerializer",(function(e){return e(t)}))||t.content.textBetween(0,t.content.size,"\n\n")}}function jr(e,t,n,r,o){var i,s,a=o.parent.type.spec.code;if(!n&&!t)return null;var c=t&&(r||a||!n);if(c){if(e.someProp("transformPastedText",(function(e){t=e(t,a||r)})),a)return t?new I(O.from(e.state.schema.text(t.replace(/\r\n?/g,"\n"))),0,0):I.empty;var l=e.someProp("clipboardTextParser",(function(e){return e(t,o,r)}));if(l)s=l;else{var u=o.marks(),f=e.state.schema,d=Fe.fromSchema(f);i=document.createElement("div"),t.split(/(?:\r\n?|\n)+/).forEach((function(e){var t=i.appendChild(document.createElement("p"));e&&t.appendChild(d.serializeNode(f.text(e,u)))}))}}else e.someProp("transformPastedHTML",(function(e){n=e(n)})),i=function(e){var t=/^(\s*<meta [^>]*>)*/.exec(e);t&&(e=e.slice(t[0].length));var n,r=Ur().createElement("div"),o=/<([a-z][^>\s]+)/i.exec(e);(n=o&&Jr[o[1].toLowerCase()])&&(e=n.map((function(e){return"<"+e+">"})).join("")+e+n.map((function(e){return"</"+e+">"})).reverse().join(""));if(r.innerHTML=e,n)for(var i=0;i<n.length;i++)r=r.querySelector(n[i])||r;return r}(n),nn.webkit&&function(e){for(var t=e.querySelectorAll(nn.chrome?"span:not([class]):not([style])":"span.Apple-converted-space"),n=0;n<t.length;n++){var r=t[n];1==r.childNodes.length&&""==r.textContent&&r.parentNode&&r.parentNode.replaceChild(e.ownerDocument.createTextNode(" "),r)}}(i);var p=i&&i.querySelector("[data-pm-slice]"),h=p&&/^(\d+) (\d+) (.*)/.exec(p.getAttribute("data-pm-slice"));if(!s){var m=e.someProp("clipboardParser")||e.someProp("domParser")||Me.fromSchema(e.state.schema);s=m.parseSlice(i,{preserveWhitespace:!(!c&&!h),context:o})}if(h)s=function(e,t){if(!e.size)return e;var n,r=e.content.firstChild.type.schema;try{n=JSON.parse(t)}catch(l){return e}for(var o=e.content,i=e.openStart,s=e.openEnd,a=n.length-2;a>=0;a-=2){var c=r.nodes[n[a]];if(!c||c.hasRequiredAttrs())break;o=O.from(c.create(n[a+1],o)),i++,s++}return new I(o,i,s)}(Hr(s,+h[1],+h[2]),h[3]);else if((s=I.maxOpen(function(e,t){if(e.childCount<2)return e;for(var n=function(n){var r=t.node(n).contentMatchAt(t.index(n)),o=void 0,i=[];if(e.forEach((function(e){if(i){var t,n=r.findWrapping(e.type);if(!n)return i=null;if(t=i.length&&o.length&&Vr(n,o,e,i[i.length-1],0))i[i.length-1]=t;else{i.length&&(i[i.length-1]=Wr(i[i.length-1],o.length));var s=Lr(e,n);i.push(s),r=r.matchType(s.type,s.attrs),o=n}}})),i)return{v:O.from(i)}},r=t.depth;r>=0;r--){var o=n(r);if(o)return o.v}return e}(s.content,o),!0)).openStart||s.openEnd){for(var v=0,g=0,y=s.content.firstChild;v<s.openStart&&!y.type.spec.isolating;v++,y=y.firstChild);for(var w=s.content.lastChild;g<s.openEnd&&!w.type.spec.isolating;g++,w=w.lastChild);s=Hr(s,v,g)}return e.someProp("transformPasted",(function(e){s=e(s)})),s}function Lr(e,t,n){void 0===n&&(n=0);for(var r=t.length-1;r>=n;r--)e=t[r].create(null,O.from(e));return e}function Vr(e,t,n,r,o){if(o<e.length&&o<t.length&&e[o]==t[o]){var i=Vr(e,t,n,r.lastChild,o+1);if(i)return r.copy(r.content.replaceChild(r.childCount-1,i));if(r.contentMatchAt(r.childCount).matchType(o==e.length-1?n.type:e[o+1]))return r.copy(r.content.append(O.from(Lr(n,e,o+1))))}}function Wr(e,t){if(0==t)return e;var n=e.content.replaceChild(e.childCount-1,Wr(e.lastChild,t-1)),r=e.contentMatchAt(e.childCount).fillBefore(O.empty,!0);return e.copy(n.append(r))}function qr(e,t,n,r,o,i){var s=t<0?e.firstChild:e.lastChild,a=s.content;return o<r-1&&(a=qr(a,t,n,r,o+1,i)),o>=n&&(a=t<0?s.contentMatchAt(0).fillBefore(a,e.childCount>1||i<=o).append(a):a.append(s.contentMatchAt(s.childCount).fillBefore(O.empty,!0))),e.replaceChild(t<0?0:e.childCount-1,s.copy(a))}function Hr(e,t,n){return t<e.openStart&&(e=new I(qr(e.content,-1,t,e.openStart,0,e.openEnd),t,e.openEnd)),n<e.openEnd&&(e=new I(qr(e.content,1,n,e.openEnd,0,0),e.openStart,n)),e}var Jr={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]},Kr=null;function Ur(){return Kr||(Kr=document.implementation.createHTMLDocument("title"))}var Gr={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},Qr=nn.ie&&nn.ie_version<=11,Xr=function(){this.anchorNode=this.anchorOffset=this.focusNode=this.focusOffset=null};Xr.prototype.set=function(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset},Xr.prototype.eq=function(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset};var Zr=function(e,t){var n=this;this.view=e,this.handleDOMChange=t,this.queue=[],this.flushingSoon=-1,this.observer=window.MutationObserver&&new window.MutationObserver((function(e){for(var t=0;t<e.length;t++)n.queue.push(e[t]);nn.ie&&nn.ie_version<=11&&e.some((function(e){return"childList"==e.type&&e.removedNodes.length||"characterData"==e.type&&e.oldValue.length>e.target.nodeValue.length}))?n.flushSoon():n.flush()})),this.currentSelection=new Xr,Qr&&(this.onCharData=function(e){n.queue.push({target:e.target,type:"characterData",oldValue:e.prevValue}),n.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.suppressingSelectionUpdates=!1};Zr.prototype.flushSoon=function(){var e=this;this.flushingSoon<0&&(this.flushingSoon=window.setTimeout((function(){e.flushingSoon=-1,e.flush()}),20))},Zr.prototype.forceFlush=function(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())},Zr.prototype.start=function(){this.observer&&this.observer.observe(this.view.dom,Gr),Qr&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()},Zr.prototype.stop=function(){var e=this;if(this.observer){var t=this.observer.takeRecords();if(t.length){for(var n=0;n<t.length;n++)this.queue.push(t[n]);window.setTimeout((function(){return e.flush()}),20)}this.observer.disconnect()}Qr&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()},Zr.prototype.connectSelection=function(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)},Zr.prototype.disconnectSelection=function(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)},Zr.prototype.suppressSelectionUpdates=function(){var e=this;this.suppressingSelectionUpdates=!0,setTimeout((function(){return e.suppressingSelectionUpdates=!1}),50)},Zr.prototype.onSelectionChange=function(){if((!(e=this.view).editable||e.root.activeElement==e.dom)&&kr(e)){var e;if(this.suppressingSelectionUpdates)return pr(this.view);if(nn.ie&&nn.ie_version<=11&&!this.view.state.selection.empty){var t=this.view.root.getSelection();if(t.focusNode&&pn(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset))return this.flushSoon()}this.flush()}},Zr.prototype.setCurSelection=function(){this.currentSelection.set(this.view.root.getSelection())},Zr.prototype.ignoreSelectionChange=function(e){if(0==e.rangeCount)return!0;var t=e.getRangeAt(0).commonAncestorContainer,n=this.view.docView.nearestDesc(t);return n&&n.ignoreMutation({type:"selection",target:3==t.nodeType?t.parentNode:t})?(this.setCurSelection(),!0):void 0},Zr.prototype.flush=function(){if(this.view.docView&&!(this.flushingSoon>-1)){var e=this.observer?this.observer.takeRecords():[];this.queue.length&&(e=this.queue.concat(e),this.queue.length=0);var t=this.view.root.getSelection(),n=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(t)&&kr(this.view)&&!this.ignoreSelectionChange(t),r=-1,o=-1,i=!1,s=[];if(this.view.editable)for(var a=0;a<e.length;a++){var c=this.registerMutation(e[a],s);c&&(r=r<0?c.from:Math.min(c.from,r),o=o<0?c.to:Math.max(c.to,o),c.typeOver&&(i=!0))}if(nn.gecko&&s.length>1){var l=s.filter((function(e){return"BR"==e.nodeName}));if(2==l.length){var u=l[0],f=l[1];u.parentNode&&u.parentNode.parentNode==f.parentNode?f.remove():u.remove()}}(r>-1||n)&&(r>-1&&(this.view.docView.markDirty(r,o),function(e){if(Yr)return;Yr=!0,"normal"==getComputedStyle(e.dom).whiteSpace&&console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package.")}(this.view)),this.handleDOMChange(r,o,i,s),this.view.docView.dirty?this.view.updateState(this.view.state):this.currentSelection.eq(t)||pr(this.view),this.currentSelection.set(t))}},Zr.prototype.registerMutation=function(e,t){if(t.indexOf(e.target)>-1)return null;var n=this.view.docView.nearestDesc(e.target);if("attributes"==e.type&&(n==this.view.docView||"contenteditable"==e.attributeName||"style"==e.attributeName&&!e.oldValue&&!e.target.getAttribute("style")))return null;if(!n||n.ignoreMutation(e))return null;if("childList"==e.type){for(var r=0;r<e.addedNodes.length;r++)t.push(e.addedNodes[r]);if(n.contentDOM&&n.contentDOM!=n.dom&&!n.contentDOM.contains(e.target))return{from:n.posBefore,to:n.posAfter};var o=e.previousSibling,i=e.nextSibling;if(nn.ie&&nn.ie_version<=11&&e.addedNodes.length)for(var s=0;s<e.addedNodes.length;s++){var a=e.addedNodes[s],c=a.previousSibling,l=a.nextSibling;(!c||Array.prototype.indexOf.call(e.addedNodes,c)<0)&&(o=c),(!l||Array.prototype.indexOf.call(e.addedNodes,l)<0)&&(i=l)}var u=o&&o.parentNode==e.target?ln(o)+1:0,f=n.localPosFromDOM(e.target,u,-1),d=i&&i.parentNode==e.target?ln(i):e.target.childNodes.length;return{from:f,to:n.localPosFromDOM(e.target,d,1)}}return"attributes"==e.type?{from:n.posAtStart-n.border,to:n.posAtEnd+n.border}:{from:n.posAtStart,to:n.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}};var Yr=!1;var eo={},to={};function no(e,t){e.lastSelectionOrigin=t,e.lastSelectionTime=Date.now()}function ro(e){e.someProp("handleDOMEvents",(function(t){for(var n in t)e.eventHandlers[n]||e.dom.addEventListener(n,e.eventHandlers[n]=function(t){return oo(e,t)})}))}function oo(e,t){return e.someProp("handleDOMEvents",(function(n){var r=n[t.type];return!!r&&(r(e,t)||t.defaultPrevented)}))}function io(e){return{left:e.clientX,top:e.clientY}}function so(e,t,n,r,o){if(-1==r)return!1;for(var i=e.state.doc.resolve(r),s=function(r){if(e.someProp(t,(function(t){return r>i.depth?t(e,n,i.nodeAfter,i.before(r),o,!0):t(e,n,i.node(r),i.before(r),o,!1)})))return{v:!0}},a=i.depth+1;a>0;a--){var c=s(a);if(c)return c.v}return!1}function ao(e,t,n){e.focused||e.focus();var r=e.state.tr.setSelection(t);"pointer"==n&&r.setMeta("pointer",!0),e.dispatch(r)}function co(e,t,n,r,o){return so(e,"handleClickOn",t,n,r)||e.someProp("handleClick",(function(n){return n(e,t,r)}))||(o?function(e,t){if(-1==t)return!1;var n,r,o=e.state.selection;o instanceof Pt&&(n=o.node);for(var i=e.state.doc.resolve(t),s=i.depth+1;s>0;s--){var a=s>i.depth?i.nodeAfter:i.node(s);if(Pt.isSelectable(a)){r=n&&o.$from.depth>0&&s>=o.$from.depth&&i.before(o.$from.depth+1)==o.$from.pos?i.before(o.$from.depth):i.before(s);break}}return null!=r&&(ao(e,Pt.create(e.state.doc,r),"pointer"),!0)}(e,n):function(e,t){if(-1==t)return!1;var n=e.state.doc.resolve(t),r=n.nodeAfter;return!!(r&&r.isAtom&&Pt.isSelectable(r))&&(ao(e,new Pt(n),"pointer"),!0)}(e,n))}function lo(e,t,n,r){return so(e,"handleDoubleClickOn",t,n,r)||e.someProp("handleDoubleClick",(function(n){return n(e,t,r)}))}function uo(e,t,n,r){return so(e,"handleTripleClickOn",t,n,r)||e.someProp("handleTripleClick",(function(n){return n(e,t,r)}))||function(e,t,n){if(0!=n.button)return!1;var r=e.state.doc;if(-1==t)return!!r.inlineContent&&(ao(e,Rt.create(r,0,r.content.size),"pointer"),!0);for(var o=r.resolve(t),i=o.depth+1;i>0;i--){var s=i>o.depth?o.nodeAfter:o.node(i),a=o.before(i);if(s.inlineContent)ao(e,Rt.create(r,a+1,a+1+s.content.size),"pointer");else{if(!Pt.isSelectable(s))continue;ao(e,Pt.create(r,a),"pointer")}return!0}}(e,n,r)}function fo(e){return wo(e)}to.keydown=function(e,t){if(e.shiftKey=16==t.keyCode||t.shiftKey,!mo(e,t))if(229!=t.keyCode&&e.domObserver.forceFlush(),e.lastKeyCode=t.keyCode,e.lastKeyCodeTime=Date.now(),!nn.ios||13!=t.keyCode||t.ctrlKey||t.altKey||t.metaKey)e.someProp("handleKeyDown",(function(n){return n(e,t)}))||$r(e,t)?t.preventDefault():no(e,"key");else{var n=Date.now();e.lastIOSEnter=n,e.lastIOSEnterFallbackTimeout=setTimeout((function(){e.lastIOSEnter==n&&(e.someProp("handleKeyDown",(function(t){return t(e,wn(13,"Enter"))})),e.lastIOSEnter=0)}),200)}},to.keyup=function(e,t){16==t.keyCode&&(e.shiftKey=!1)},to.keypress=function(e,t){if(!(mo(e,t)||!t.charCode||t.ctrlKey&&!t.altKey||nn.mac&&t.metaKey))if(e.someProp("handleKeyPress",(function(n){return n(e,t)})))t.preventDefault();else{var n=e.state.selection;if(!(n instanceof Rt&&n.$from.sameParent(n.$to))){var r=String.fromCharCode(t.charCode);e.someProp("handleTextInput",(function(t){return t(e,n.$from.pos,n.$to.pos,r)}))||e.dispatch(e.state.tr.insertText(r).scrollIntoView()),t.preventDefault()}}};var po=nn.mac?"metaKey":"ctrlKey";eo.mousedown=function(e,t){e.shiftKey=t.shiftKey;var n=fo(e),r=Date.now(),o="singleClick";r-e.lastClick.time<500&&function(e,t){var n=t.x-e.clientX,r=t.y-e.clientY;return n*n+r*r<100}(t,e.lastClick)&&!t[po]&&("singleClick"==e.lastClick.type?o="doubleClick":"doubleClick"==e.lastClick.type&&(o="tripleClick")),e.lastClick={time:r,x:t.clientX,y:t.clientY,type:o};var i=e.posAtCoords(io(t));i&&("singleClick"==o?(e.mouseDown&&e.mouseDown.done(),e.mouseDown=new ho(e,i,t,n)):("doubleClick"==o?lo:uo)(e,i.pos,i.inside,t)?t.preventDefault():no(e,"pointer"))};var ho=function(e,t,n,r){var o,i,s=this;if(this.view=e,this.startDoc=e.state.doc,this.pos=t,this.event=n,this.flushed=r,this.selectNode=n[po],this.allowDefault=n.shiftKey,this.delayedSelectionSync=!1,t.inside>-1)o=e.state.doc.nodeAt(t.inside),i=t.inside;else{var a=e.state.doc.resolve(t.pos);o=a.parent,i=a.depth?a.before():0}this.mightDrag=null;var c=r?null:n.target,l=c?e.docView.nearestDesc(c,!0):null;this.target=l?l.dom:null;var u=e.state.selection;(0==n.button&&o.type.spec.draggable&&!1!==o.type.spec.selectable||u instanceof Pt&&u.from<=i&&u.to>i)&&(this.mightDrag={node:o,pos:i,addAttr:this.target&&!this.target.draggable,setUneditable:this.target&&nn.gecko&&!this.target.hasAttribute("contentEditable")}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout((function(){s.view.mouseDown==s&&s.target.setAttribute("contentEditable","false")}),20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),no(e,"pointer")};function mo(e,t){return!!e.composing||!!(nn.safari&&Math.abs(t.timeStamp-e.compositionEndedAt)<500)&&(e.compositionEndedAt=-2e8,!0)}ho.prototype.done=function(){var e=this;this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout((function(){return pr(e.view)})),this.view.mouseDown=null},ho.prototype.up=function(e){if(this.done(),this.view.dom.contains(3==e.target.nodeType?e.target.parentNode:e.target)){var t=this.pos;this.view.state.doc!=this.startDoc&&(t=this.view.posAtCoords(io(e))),this.allowDefault||!t?no(this.view,"pointer"):co(this.view,t.pos,t.inside,e,this.selectNode)?e.preventDefault():0==e.button&&(this.flushed||nn.safari&&this.mightDrag&&!this.mightDrag.node.isAtom||nn.chrome&&!(this.view.state.selection instanceof Rt)&&Math.min(Math.abs(t.pos-this.view.state.selection.from),Math.abs(t.pos-this.view.state.selection.to))<=2)?(ao(this.view,zt.near(this.view.state.doc.resolve(t.pos)),"pointer"),e.preventDefault()):no(this.view,"pointer")}},ho.prototype.move=function(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0),no(this.view,"pointer"),0==e.buttons&&this.done()},eo.touchdown=function(e){fo(e),no(e,"pointer")},eo.contextmenu=function(e){return fo(e)};var vo=nn.android?5e3:-1;function go(e,t){clearTimeout(e.composingTimeout),t>-1&&(e.composingTimeout=setTimeout((function(){return wo(e)}),t))}function yo(e){var t;for(e.composing&&(e.composing=!1,e.compositionEndedAt=((t=document.createEvent("Event")).initEvent("event",!0,!0),t.timeStamp));e.compositionNodes.length>0;)e.compositionNodes.pop().markParentsDirty()}function wo(e,t){if(e.domObserver.forceFlush(),yo(e),t||e.docView.dirty){var n=fr(e);return n&&!n.eq(e.state.selection)?e.dispatch(e.state.tr.setSelection(n)):e.updateState(e.state),!0}return!1}to.compositionstart=to.compositionupdate=function(e){if(!e.composing){e.domObserver.flush();var t=e.state,n=t.selection.$from;if(t.selection.empty&&(t.storedMarks||!n.textOffset&&n.parentOffset&&n.nodeBefore.marks.some((function(e){return!1===e.type.spec.inclusive}))))e.markCursor=e.state.storedMarks||n.marks(),wo(e,!0),e.markCursor=null;else if(wo(e),nn.gecko&&t.selection.empty&&n.parentOffset&&!n.textOffset&&n.nodeBefore.marks.length)for(var r=e.root.getSelection(),o=r.focusNode,i=r.focusOffset;o&&1==o.nodeType&&0!=i;){var s=i<0?o.lastChild:o.childNodes[i-1];if(!s)break;if(3==s.nodeType){r.collapse(s,s.nodeValue.length);break}o=s,i=-1}e.composing=!0}go(e,vo)},to.compositionend=function(e,t){e.composing&&(e.composing=!1,e.compositionEndedAt=t.timeStamp,go(e,20))};var bo=nn.ie&&nn.ie_version<15||nn.ios&&nn.webkit_version<604;function ko(e,t,n,r){var o=jr(e,t,n,e.shiftKey,e.state.selection.$from);if(e.someProp("handlePaste",(function(t){return t(e,r,o||I.empty)})))return!0;if(!o)return!1;var i=function(e){return 0==e.openStart&&0==e.openEnd&&1==e.content.childCount?e.content.firstChild:null}(o),s=i?e.state.tr.replaceSelectionWith(i,e.shiftKey):e.state.tr.replaceSelection(o);return e.dispatch(s.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}eo.copy=to.cut=function(e,t){var n=e.state.selection,r="cut"==t.type;if(!n.empty){var o=bo?null:t.clipboardData,i=Br(e,n.content()),s=i.dom,a=i.text;o?(t.preventDefault(),o.clearData(),o.setData("text/html",s.innerHTML),o.setData("text/plain",a)):function(e,t){if(e.dom.parentNode){var n=e.dom.parentNode.appendChild(document.createElement("div"));n.appendChild(t),n.style.cssText="position: fixed; left: -10000px; top: 10px";var r=getSelection(),o=document.createRange();o.selectNodeContents(t),e.dom.blur(),r.removeAllRanges(),r.addRange(o),setTimeout((function(){n.parentNode&&n.parentNode.removeChild(n),e.focus()}),50)}}(e,s),r&&e.dispatch(e.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))}},to.paste=function(e,t){var n=bo?null:t.clipboardData;n&&ko(e,n.getData("text/plain"),n.getData("text/html"),t)?t.preventDefault():function(e,t){if(e.dom.parentNode){var n=e.shiftKey||e.state.selection.$from.parent.type.spec.code,r=e.dom.parentNode.appendChild(document.createElement(n?"textarea":"div"));n||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus(),setTimeout((function(){e.focus(),r.parentNode&&r.parentNode.removeChild(r),n?ko(e,r.value,null,t):ko(e,r.textContent,r.innerHTML,t)}),50)}}(e,t)};var xo=function(e,t){this.slice=e,this.move=t},So=nn.mac?"altKey":"ctrlKey";for(var Co in eo.dragstart=function(e,t){var n=e.mouseDown;if(n&&n.done(),t.dataTransfer){var r=e.state.selection,o=r.empty?null:e.posAtCoords(io(t));if(o&&o.pos>=r.from&&o.pos<=(r instanceof Pt?r.to-1:r.to));else if(n&&n.mightDrag)e.dispatch(e.state.tr.setSelection(Pt.create(e.state.doc,n.mightDrag.pos)));else if(t.target&&1==t.target.nodeType){var i=e.docView.nearestDesc(t.target,!0);i&&i.node.type.spec.draggable&&i!=e.docView&&e.dispatch(e.state.tr.setSelection(Pt.create(e.state.doc,i.posBefore)))}var s=e.state.selection.content(),a=Br(e,s),c=a.dom,l=a.text;t.dataTransfer.clearData(),t.dataTransfer.setData(bo?"Text":"text/html",c.innerHTML),t.dataTransfer.effectAllowed="copyMove",bo||t.dataTransfer.setData("text/plain",l),e.dragging=new xo(s,!t[So])}},eo.dragend=function(e){var t=e.dragging;window.setTimeout((function(){e.dragging==t&&(e.dragging=null)}),50)},to.dragover=to.dragenter=function(e,t){return t.preventDefault()},to.drop=function(e,t){var n=e.dragging;if(e.dragging=null,t.dataTransfer){var r=e.posAtCoords(io(t));if(r){var o=e.state.doc.resolve(r.pos);if(o){var i=n&&n.slice;i?e.someProp("transformPasted",(function(e){i=e(i)})):i=jr(e,t.dataTransfer.getData(bo?"Text":"text/plain"),bo?null:t.dataTransfer.getData("text/html"),!1,o);var s=n&&!t[So];if(e.someProp("handleDrop",(function(n){return n(e,t,i||I.empty,s)})))t.preventDefault();else if(i){t.preventDefault();var a=i?function(e,t,n){var r=e.resolve(t);if(!n.content.size)return t;for(var o=n.content,i=0;i<n.openStart;i++)o=o.firstChild.content;for(var s=1;s<=(0==n.openStart&&n.size?2:1);s++)for(var a=r.depth;a>=0;a--){var c=a==r.depth?0:r.pos<=(r.start(a+1)+r.end(a+1))/2?-1:1,l=r.index(a)+(c>0?1:0),u=r.node(a),f=!1;if(1==s)f=u.canReplace(l,l,o);else{var d=u.contentMatchAt(l).findWrapping(o.firstChild.type);f=d&&u.canReplaceWith(l,l,d[0])}if(f)return 0==c?r.pos:c<0?r.before(a+1):r.after(a+1)}return null}(e.state.doc,o.pos,i):o.pos;null==a&&(a=o.pos);var c=e.state.tr;s&&c.deleteSelection();var l=c.mapping.map(a),u=0==i.openStart&&0==i.openEnd&&1==i.content.childCount,f=c.doc;if(u?c.replaceRangeWith(l,l,i.content.firstChild):c.replaceRange(l,l,i),!c.doc.eq(f)){var d=c.doc.resolve(l);if(u&&Pt.isSelectable(i.content.firstChild)&&d.nodeAfter&&d.nodeAfter.sameMarkup(i.content.firstChild))c.setSelection(new Pt(d));else{var p=c.mapping.map(a);c.mapping.maps[c.mapping.maps.length-1].forEach((function(e,t,n,r){return p=r})),c.setSelection(br(e,d,c.doc.resolve(p)))}e.focus(),e.dispatch(c.setMeta("uiEvent","drop"))}}}}}},eo.focus=function(e){e.focused||(e.domObserver.stop(),e.dom.classList.add("ProseMirror-focused"),e.domObserver.start(),e.focused=!0,setTimeout((function(){e.docView&&e.hasFocus()&&!e.domObserver.currentSelection.eq(e.root.getSelection())&&pr(e)}),20))},eo.blur=function(e,t){e.focused&&(e.domObserver.stop(),e.dom.classList.remove("ProseMirror-focused"),e.domObserver.start(),t.relatedTarget&&e.dom.contains(t.relatedTarget)&&e.domObserver.currentSelection.set({}),e.focused=!1)},eo.beforeinput=function(e,t){if(nn.chrome&&nn.android&&"deleteContentBackward"==t.inputType){var n=e.domChangeCount;setTimeout((function(){if(e.domChangeCount==n&&(e.dom.blur(),e.focus(),!e.someProp("handleKeyDown",(function(t){return t(e,wn(8,"Backspace"))})))){var t=e.state.selection.$cursor;t&&t.pos>0&&e.dispatch(e.state.tr.delete(t.pos-1,t.pos).scrollIntoView())}}),50)}},to)eo[Co]=to[Co];function Mo(e,t){if(e==t)return!0;for(var n in e)if(e[n]!==t[n])return!1;for(var r in t)if(!(r in e))return!1;return!0}var Oo=function(e,t){this.spec=t||zo,this.side=this.spec.side||0,this.toDOM=e};Oo.prototype.map=function(e,t,n,r){var o=e.mapResult(t.from+r,this.side<0?-1:1),i=o.pos;return o.deleted?null:new To(i-n,i-n,this)},Oo.prototype.valid=function(){return!0},Oo.prototype.eq=function(e){return this==e||e instanceof Oo&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&Mo(this.spec,e.spec))};var Ao=function(e,t){this.spec=t||zo,this.attrs=e};Ao.prototype.map=function(e,t,n,r){var o=e.map(t.from+r,this.spec.inclusiveStart?-1:1)-n,i=e.map(t.to+r,this.spec.inclusiveEnd?1:-1)-n;return o>=i?null:new To(o,i,this)},Ao.prototype.valid=function(e,t){return t.from<t.to},Ao.prototype.eq=function(e){return this==e||e instanceof Ao&&Mo(this.attrs,e.attrs)&&Mo(this.spec,e.spec)},Ao.is=function(e){return e.type instanceof Ao};var Eo=function(e,t){this.spec=t||zo,this.attrs=e};Eo.prototype.map=function(e,t,n,r){var o=e.mapResult(t.from+r,1);if(o.deleted)return null;var i=e.mapResult(t.to+r,-1);return i.deleted||i.pos<=o.pos?null:new To(o.pos-n,i.pos-n,this)},Eo.prototype.valid=function(e,t){var n,r=e.content.findIndex(t.from),o=r.index,i=r.offset;return i==t.from&&!(n=e.child(o)).isText&&i+n.nodeSize==t.to},Eo.prototype.eq=function(e){return this==e||e instanceof Eo&&Mo(this.attrs,e.attrs)&&Mo(this.spec,e.spec)};var To=function(e,t,n){this.from=e,this.to=t,this.type=n},No={spec:{configurable:!0},inline:{configurable:!0}};To.prototype.copy=function(e,t){return new To(e,t,this.type)},To.prototype.eq=function(e,t){return void 0===t&&(t=0),this.type.eq(e.type)&&this.from+t==e.from&&this.to+t==e.to},To.prototype.map=function(e,t,n){return this.type.map(e,this,t,n)},To.widget=function(e,t,n){return new To(e,e,new Oo(t,n))},To.inline=function(e,t,n,r){return new To(e,t,new Ao(n,r))},To.node=function(e,t,n,r){return new To(e,t,new Eo(n,r))},No.spec.get=function(){return this.type.spec},No.inline.get=function(){return this.type instanceof Ao},Object.defineProperties(To.prototype,No);var Do=[],zo={},Io=function(e,t){this.local=e&&e.length?e:Do,this.children=t&&t.length?t:Do};Io.create=function(e,t){return t.length?Bo(t,e,0,zo):$o},Io.prototype.find=function(e,t,n){var r=[];return this.findInner(null==e?0:e,null==t?1e9:t,r,0,n),r},Io.prototype.findInner=function(e,t,n,r,o){for(var i=0;i<this.local.length;i++){var s=this.local[i];s.from<=t&&s.to>=e&&(!o||o(s.spec))&&n.push(s.copy(s.from+r,s.to+r))}for(var a=0;a<this.children.length;a+=3)if(this.children[a]<t&&this.children[a+1]>e){var c=this.children[a]+1;this.children[a+2].findInner(e-c,t-c,n,r+c,o)}},Io.prototype.map=function(e,t,n){return this==$o||0==e.maps.length?this:this.mapInner(e,t,0,0,n||zo)},Io.prototype.mapInner=function(e,t,n,r,o){for(var i,s=0;s<this.local.length;s++){var a=this.local[s].map(e,n,r);a&&a.type.valid(t,a)?(i||(i=[])).push(a):o.onRemove&&o.onRemove(this.local[s].spec)}return this.children.length?function(e,t,n,r,o,i,s){for(var a=e.slice(),c=function(e,t,n,r){for(var s=0;s<a.length;s+=3){var c=a[s+1],l=void 0;-1==c||e>c+i||(t>=a[s]+i?a[s+1]=-1:n>=o&&(l=r-n-(t-e))&&(a[s]+=l,a[s+1]+=l))}},l=0;l<n.maps.length;l++)n.maps[l].forEach(c);for(var u=!1,f=0;f<a.length;f+=3)if(-1==a[f+1]){var d=n.map(e[f]+i),p=d-o;if(p<0||p>=r.content.size){u=!0;continue}var h=n.map(e[f+1]+i,-1)-o,m=r.content.findIndex(p),v=m.index,g=m.offset,y=r.maybeChild(v);if(y&&g==p&&g+y.nodeSize==h){var w=a[f+2].mapInner(n,y,d+1,e[f]+i+1,s);w!=$o?(a[f]=p,a[f+1]=h,a[f+2]=w):(a[f+1]=-2,u=!0)}else u=!0}if(u){var b=Bo(function(e,t,n,r,o,i,s){function a(e,t){for(var i=0;i<e.local.length;i++){var c=e.local[i].map(r,o,t);c?n.push(c):s.onRemove&&s.onRemove(e.local[i].spec)}for(var l=0;l<e.children.length;l+=3)a(e.children[l+2],e.children[l]+t+1)}for(var c=0;c<e.length;c+=3)-1==e[c+1]&&a(e[c+2],t[c]+i+1);return n}(a,e,t||[],n,o,i,s),r,0,s);t=b.local;for(var k=0;k<a.length;k+=3)a[k+1]<0&&(a.splice(k,3),k-=3);for(var x=0,S=0;x<b.children.length;x+=3){for(var C=b.children[x];S<a.length&&a[S]<C;)S+=3;a.splice(S,0,b.children[x],b.children[x+1],b.children[x+2])}}return new Io(t&&t.sort(jo),a)}(this.children,i,e,t,n,r,o):i?new Io(i.sort(jo)):$o},Io.prototype.add=function(e,t){return t.length?this==$o?Io.create(e,t):this.addInner(e,t,0):this},Io.prototype.addInner=function(e,t,n){var r,o=this,i=0;e.forEach((function(e,s){var a,c=s+n;if(a=Po(t,e,c)){for(r||(r=o.children.slice());i<r.length&&r[i]<s;)i+=3;r[i]==s?r[i+2]=r[i+2].addInner(e,a,c+1):r.splice(i,0,s,s+e.nodeSize,Bo(a,e,c+1,zo)),i+=3}}));for(var s=Fo(i?_o(t):t,-n),a=0;a<s.length;a++)s[a].type.valid(e,s[a])||s.splice(a--,1);return new Io(s.length?this.local.concat(s).sort(jo):this.local,r||this.children)},Io.prototype.remove=function(e){return 0==e.length||this==$o?this:this.removeInner(e,0)},Io.prototype.removeInner=function(e,t){for(var n=this.children,r=this.local,o=0;o<n.length;o+=3){for(var i=void 0,s=n[o]+t,a=n[o+1]+t,c=0,l=void 0;c<e.length;c++)(l=e[c])&&l.from>s&&l.to<a&&(e[c]=null,(i||(i=[])).push(l));if(i){n==this.children&&(n=this.children.slice());var u=n[o+2].removeInner(i,s+1);u!=$o?n[o+2]=u:(n.splice(o,3),o-=3)}}if(r.length)for(var f=0,d=void 0;f<e.length;f++)if(d=e[f])for(var p=0;p<r.length;p++)r[p].eq(d,t)&&(r==this.local&&(r=this.local.slice()),r.splice(p--,1));return n==this.children&&r==this.local?this:r.length||n.length?new Io(r,n):$o},Io.prototype.forChild=function(e,t){if(this==$o)return this;if(t.isLeaf)return Io.empty;for(var n,r,o=0;o<this.children.length;o+=3)if(this.children[o]>=e){this.children[o]==e&&(n=this.children[o+2]);break}for(var i=e+1,s=i+t.content.size,a=0;a<this.local.length;a++){var c=this.local[a];if(c.from<s&&c.to>i&&c.type instanceof Ao){var l=Math.max(i,c.from)-i,u=Math.min(s,c.to)-i;l<u&&(r||(r=[])).push(c.copy(l,u))}}if(r){var f=new Io(r.sort(jo));return n?new Ro([f,n]):f}return n||$o},Io.prototype.eq=function(e){if(this==e)return!0;if(!(e instanceof Io)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(var t=0;t<this.local.length;t++)if(!this.local[t].eq(e.local[t]))return!1;for(var n=0;n<this.children.length;n+=3)if(this.children[n]!=e.children[n]||this.children[n+1]!=e.children[n+1]||!this.children[n+2].eq(e.children[n+2]))return!1;return!0},Io.prototype.locals=function(e){return Lo(this.localsInner(e))},Io.prototype.localsInner=function(e){if(this==$o)return Do;if(e.inlineContent||!this.local.some(Ao.is))return this.local;for(var t=[],n=0;n<this.local.length;n++)this.local[n].type instanceof Ao||t.push(this.local[n]);return t};var $o=new Io;Io.empty=$o,Io.removeOverlap=Lo;var Ro=function(e){this.members=e};function Fo(e,t){if(!t||!e.length)return e;for(var n=[],r=0;r<e.length;r++){var o=e[r];n.push(new To(o.from+t,o.to+t,o.type))}return n}function Po(e,t,n){if(t.isLeaf)return null;for(var r=n+t.nodeSize,o=null,i=0,s=void 0;i<e.length;i++)(s=e[i])&&s.from>n&&s.to<r&&((o||(o=[])).push(s),e[i]=null);return o}function _o(e){for(var t=[],n=0;n<e.length;n++)null!=e[n]&&t.push(e[n]);return t}function Bo(e,t,n,r){var o=[],i=!1;t.forEach((function(t,s){var a=Po(e,t,s+n);if(a){i=!0;var c=Bo(a,t,n+s+1,r);c!=$o&&o.push(s,s+t.nodeSize,c)}}));for(var s=Fo(i?_o(e):e,-n).sort(jo),a=0;a<s.length;a++)s[a].type.valid(t,s[a])||(r.onRemove&&r.onRemove(s[a].spec),s.splice(a--,1));return s.length||o.length?new Io(s,o):$o}function jo(e,t){return e.from-t.from||e.to-t.to}function Lo(e){for(var t=e,n=0;n<t.length-1;n++){var r=t[n];if(r.from!=r.to)for(var o=n+1;o<t.length;o++){var i=t[o];if(i.from!=r.from){i.from<r.to&&(t==e&&(t=e.slice()),t[n]=r.copy(r.from,i.from),Vo(t,o,r.copy(i.from,r.to)));break}i.to!=r.to&&(t==e&&(t=e.slice()),t[o]=i.copy(i.from,r.to),Vo(t,o+1,i.copy(r.to,i.to)))}}return t}function Vo(e,t,n){for(;t<e.length&&jo(n,e[t])>0;)t++;e.splice(t,0,n)}function Wo(e){var t=[];return e.someProp("decorations",(function(n){var r=n(e.state);r&&r!=$o&&t.push(r)})),e.cursorWrapper&&t.push(Io.create(e.state.doc,[e.cursorWrapper.deco])),Ro.from(t)}Ro.prototype.map=function(e,t){var n=this.members.map((function(n){return n.map(e,t,zo)}));return Ro.from(n)},Ro.prototype.forChild=function(e,t){if(t.isLeaf)return Io.empty;for(var n=[],r=0;r<this.members.length;r++){var o=this.members[r].forChild(e,t);o!=$o&&(o instanceof Ro?n=n.concat(o.members):n.push(o))}return Ro.from(n)},Ro.prototype.eq=function(e){if(!(e instanceof Ro)||e.members.length!=this.members.length)return!1;for(var t=0;t<this.members.length;t++)if(!this.members[t].eq(e.members[t]))return!1;return!0},Ro.prototype.locals=function(e){for(var t,n=!0,r=0;r<this.members.length;r++){var o=this.members[r].localsInner(e);if(o.length)if(t){n&&(t=t.slice(),n=!1);for(var i=0;i<o.length;i++)t.push(o[i])}else t=o}return t?Lo(n?t:t.sort(jo)):Do},Ro.from=function(e){switch(e.length){case 0:return $o;case 1:return e[0];default:return new Ro(e)}};var qo=function(e,t){this._props=t,this.state=t.state,this.directPlugins=t.plugins||[],this.directPlugins.forEach(Qo),this.dispatch=this.dispatch.bind(this),this._root=null,this.focused=!1,this.trackWrites=null,this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):e.apply?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=Uo(this),this.markCursor=null,this.cursorWrapper=null,Ko(this),this.nodeViews=Go(this),this.docView=Gn(this.state.doc,Jo(this),Wo(this),this.dom,this),this.lastSelectedViewDesc=null,this.dragging=null,function(e){e.shiftKey=!1,e.mouseDown=null,e.lastKeyCode=null,e.lastKeyCodeTime=0,e.lastClick={time:0,x:0,y:0,type:""},e.lastSelectionOrigin=null,e.lastSelectionTime=0,e.lastIOSEnter=0,e.lastIOSEnterFallbackTimeout=null,e.lastAndroidDelete=0,e.composing=!1,e.composingTimeout=null,e.compositionNodes=[],e.compositionEndedAt=-2e8,e.domObserver=new Zr(e,(function(t,n,r,o){return Fr(e,t,n,r,o)})),e.domObserver.start(),e.domChangeCount=0,e.eventHandlers=Object.create(null);var t=function(t){var n=eo[t];e.dom.addEventListener(t,e.eventHandlers[t]=function(t){!function(e,t){if(!t.bubbles)return!0;if(t.defaultPrevented)return!1;for(var n=t.target;n!=e.dom;n=n.parentNode)if(!n||11==n.nodeType||n.pmViewDesc&&n.pmViewDesc.stopEvent(t))return!1;return!0}(e,t)||oo(e,t)||!e.editable&&t.type in to||n(e,t)})};for(var n in eo)t(n);nn.safari&&e.dom.addEventListener("input",(function(){return null})),ro(e)}(this),this.prevDirectPlugins=[],this.pluginViews=[],this.updatePluginViews()},Ho={props:{configurable:!0},root:{configurable:!0}};function Jo(e){var t=Object.create(null);return t.class="ProseMirror",t.contenteditable=String(e.editable),t.translate="no",e.someProp("attributes",(function(n){if("function"==typeof n&&(n=n(e.state)),n)for(var r in n)"class"==r?t.class+=" "+n[r]:t[r]||"contenteditable"==r||"nodeName"==r||(t[r]=String(n[r]))})),[To.node(0,e.state.doc.content.size,t)]}function Ko(e){if(e.markCursor){var t=document.createElement("img");t.className="ProseMirror-separator",t.setAttribute("mark-placeholder","true"),e.cursorWrapper={dom:t,deco:To.widget(e.state.selection.head,t,{raw:!0,marks:e.markCursor})}}else e.cursorWrapper=null}function Uo(e){return!e.someProp("editable",(function(t){return!1===t(e.state)}))}function Go(e){var t={};return e.someProp("nodeViews",(function(e){for(var n in e)Object.prototype.hasOwnProperty.call(t,n)||(t[n]=e[n])})),t}function Qo(e){if(e.spec.state||e.spec.filterTransaction||e.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}function Xo(e,t){return!e.selection.empty&&(t&&t(e.tr.deleteSelection().scrollIntoView()),!0)}function Zo(e,t,n){for(;e;e="start"==t?e.firstChild:e.lastChild){if(e.isTextblock)return!0;if(n&&1!=e.childCount)return!1}return!1}function Yo(e){if(!e.parent.type.spec.isolating)for(var t=e.depth-1;t>=0;t--){if(e.index(t)>0)return e.doc.resolve(e.before(t+1));if(e.node(t).type.spec.isolating)break}return null}function ei(e){if(!e.parent.type.spec.isolating)for(var t=e.depth-1;t>=0;t--){var n=e.node(t);if(e.index(t)+1<n.childCount)return e.doc.resolve(e.after(t+1));if(n.type.spec.isolating)break}return null}function ti(e){for(var t=0;t<e.edgeCount;t++){var n=e.edge(t).type;if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}function ni(e,t,n){var r,o,i=t.nodeBefore,s=t.nodeAfter;if(i.type.spec.isolating||s.type.spec.isolating)return!1;if(function(e,t,n){var r=t.nodeBefore,o=t.nodeAfter,i=t.index();return!(!(r&&o&&r.type.compatibleContent(o.type))||(!r.content.size&&t.parent.canReplace(i-1,i)?(n&&n(e.tr.delete(t.pos-r.nodeSize,t.pos).scrollIntoView()),0):!t.parent.canReplace(i,i+1)||!o.isTextblock&&!gt(e.doc,t.pos)||(n&&n(e.tr.clearIncompatible(t.pos,r.type,r.contentMatchAt(r.childCount)).join(t.pos).scrollIntoView()),0)))}(e,t,n))return!0;var a=t.parent.canReplace(t.index(),t.index()+1);if(a&&(r=(o=i.contentMatchAt(i.childCount)).findWrapping(s.type))&&o.matchType(r[0]||s.type).validEnd){if(n){for(var c=t.pos+s.nodeSize,l=O.empty,u=r.length-1;u>=0;u--)l=O.from(r[u].create(null,l));l=O.from(i.copy(l));var f=e.tr.step(new ut(t.pos-1,c,t.pos,c,new I(l,1,0),r.length,!0)),d=c+2*r.length;gt(f.doc,d)&&f.join(d),n(f.scrollIntoView())}return!0}var p=zt.findFrom(t,1),h=p&&p.$from.blockRange(p.$to),m=h&&pt(h);if(null!=m&&m>=t.depth)return n&&n(e.tr.lift(h,m).scrollIntoView()),!0;if(a&&Zo(s,"start",!0)&&Zo(i,"end")){for(var v=i,g=[];g.push(v),!v.isTextblock;)v=v.lastChild;for(var y=s,w=1;!y.isTextblock;y=y.firstChild)w++;if(v.canReplace(v.childCount,v.childCount,y.content)){if(n){for(var b=O.empty,k=g.length-1;k>=0;k--)b=O.from(g[k].copy(b));n(e.tr.step(new ut(t.pos-g.length,t.pos+s.nodeSize,t.pos+w,t.pos+s.nodeSize-w,new I(b,g.length,0),0,!0)).scrollIntoView())}return!0}}return!1}function ri(e,t){return function(n,r){var o=n.selection,i=o.$from,s=o.$to,a=i.blockRange(s),c=a&&ht(a,e,t);return!!c&&(r&&r(n.tr.wrap(a,c).scrollIntoView()),!0)}}function oi(e,t){return function(n,r){var o=n.selection,i=o.from,s=o.to,a=!1;return n.doc.nodesBetween(i,s,(function(r,o){if(a)return!1;if(r.isTextblock&&!r.hasMarkup(e,t))if(r.type==e)a=!0;else{var i=n.doc.resolve(o),s=i.index();a=i.parent.canReplaceWith(s,s+1,e)}})),!!a&&(r&&r(n.tr.setBlockType(i,s,e,t).scrollIntoView()),!0)}}function ii(e,t){return function(n,r){var o=n.selection,i=o.empty,s=o.$cursor,a=o.ranges;if(i&&!s||!function(e,t,n){for(var r=function(r){var o=t[r],i=o.$from,s=o.$to,a=0==i.depth&&e.type.allowsMarkType(n);if(e.nodesBetween(i.pos,s.pos,(function(e){if(a)return!1;a=e.inlineContent&&e.type.allowsMarkType(n)})),a)return{v:!0}},o=0;o<t.length;o++){var i=r(o);if(i)return i.v}return!1}(n.doc,a,e))return!1;if(r)if(s)e.isInSet(n.storedMarks||s.marks())?r(n.tr.removeStoredMark(e)):r(n.tr.addStoredMark(e.create(t)));else{for(var c=!1,l=n.tr,u=0;!c&&u<a.length;u++){var f=a[u],d=f.$from,p=f.$to;c=n.doc.rangeHasMark(d.pos,p.pos,e)}for(var h=0;h<a.length;h++){var m=a[h],v=m.$from,g=m.$to;if(c)l.removeMark(v.pos,g.pos,e);else{var y=v.pos,w=g.pos,b=v.nodeAfter,k=g.nodeBefore,x=b&&b.isText?/^\s*/.exec(b.text)[0].length:0,S=k&&k.isText?/\s*$/.exec(k.text)[0].length:0;y+x<w&&(y+=x,w-=S),l.addMark(y,w,e.create(t))}}r(l.scrollIntoView())}return!0}}function si(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return function(t,n,r){for(var o=0;o<e.length;o++)if(e[o](t,n,r))return!0;return!1}}Ho.props.get=function(){if(this._props.state!=this.state){var e=this._props;for(var t in this._props={},e)this._props[t]=e[t];this._props.state=this.state}return this._props},qo.prototype.update=function(e){e.handleDOMEvents!=this._props.handleDOMEvents&&ro(this),this._props=e,e.plugins&&(e.plugins.forEach(Qo),this.directPlugins=e.plugins),this.updateStateInner(e.state,!0)},qo.prototype.setProps=function(e){var t={};for(var n in this._props)t[n]=this._props[n];for(var r in t.state=this.state,e)t[r]=e[r];this.update(t)},qo.prototype.updateState=function(e){this.updateStateInner(e,this.state.plugins!=e.plugins)},qo.prototype.updateStateInner=function(e,t){var n=this,r=this.state,o=!1,i=!1;if(e.storedMarks&&this.composing&&(yo(this),i=!0),this.state=e,t){var s=Go(this);(function(e,t){var n=0,r=0;for(var o in e){if(e[o]!=t[o])return!0;n++}for(var i in t)r++;return n!=r})(s,this.nodeViews)&&(this.nodeViews=s,o=!0),ro(this)}this.editable=Uo(this),Ko(this);var a=Wo(this),c=Jo(this),l=t?"reset":e.scrollToSelection>r.scrollToSelection?"to selection":"preserve",u=o||!this.docView.matchesNode(e.doc,c,a);!u&&e.selection.eq(r.selection)||(i=!0);var f,d,p,h,m,v,g,y,w,b,k,x="preserve"==l&&i&&null==this.dom.style.overflowAnchor&&function(e){for(var t,n,r=e.dom.getBoundingClientRect(),o=Math.max(0,r.top),i=(r.left+r.right)/2,s=o+1;s<Math.min(innerHeight,r.bottom);s+=5){var a=e.root.elementFromPoint(i,s);if(a!=e.dom&&e.dom.contains(a)){var c=a.getBoundingClientRect();if(c.top>=o-20){t=a,n=c.top;break}}}return{refDOM:t,refTop:n,stack:Cn(e.dom)}}(this);if(i){this.domObserver.stop();var S=u&&(nn.ie||nn.chrome)&&!this.composing&&!r.selection.empty&&!e.selection.empty&&(h=r.selection,m=e.selection,v=Math.min(h.$anchor.sharedDepth(h.head),m.$anchor.sharedDepth(m.head)),h.$anchor.start(v)!=m.$anchor.start(v));if(u){var C=nn.chrome?this.trackWrites=this.root.getSelection().focusNode:null;!o&&this.docView.update(e.doc,c,a,this)||(this.docView.updateOuterDeco([]),this.docView.destroy(),this.docView=Gn(e.doc,c,a,this.dom,this)),C&&!this.trackWrites&&(S=!0)}S||!(this.mouseDown&&this.domObserver.currentSelection.eq(this.root.getSelection())&&(f=this,d=f.docView.domFromPos(f.state.selection.anchor,0),p=f.root.getSelection(),pn(d.node,d.offset,p.anchorNode,p.anchorOffset)))?pr(this,S):(yr(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}if(this.updatePluginViews(r),"reset"==l)this.dom.scrollTop=0;else if("to selection"==l){var M=this.root.getSelection().focusNode;this.someProp("handleScrollToSelection",(function(e){return e(n)}))||(e.selection instanceof Pt?Sn(this,this.docView.domAfterPos(e.selection.from).getBoundingClientRect(),M):Sn(this,this.coordsAtPos(e.selection.head,1),M))}else x&&(y=(g=x).refDOM,w=g.refTop,b=g.stack,k=y?y.getBoundingClientRect().top:0,Mn(b,0==k?0:k-w))},qo.prototype.destroyPluginViews=function(){for(var e;e=this.pluginViews.pop();)e.destroy&&e.destroy()},qo.prototype.updatePluginViews=function(e){if(e&&e.plugins==this.state.plugins&&this.directPlugins==this.prevDirectPlugins)for(var t=0;t<this.pluginViews.length;t++){var n=this.pluginViews[t];n.update&&n.update(this,e)}else{this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(var r=0;r<this.directPlugins.length;r++){var o=this.directPlugins[r];o.spec.view&&this.pluginViews.push(o.spec.view(this))}for(var i=0;i<this.state.plugins.length;i++){var s=this.state.plugins[i];s.spec.view&&this.pluginViews.push(s.spec.view(this))}}},qo.prototype.someProp=function(e,t){var n,r=this._props&&this._props[e];if(null!=r&&(n=t?t(r):r))return n;for(var o=0;o<this.directPlugins.length;o++){var i=this.directPlugins[o].props[e];if(null!=i&&(n=t?t(i):i))return n}var s=this.state.plugins;if(s)for(var a=0;a<s.length;a++){var c=s[a].props[e];if(null!=c&&(n=t?t(c):c))return n}},qo.prototype.hasFocus=function(){return this.root.activeElement==this.dom},qo.prototype.focus=function(){this.domObserver.stop(),this.editable&&function(e){if(e.setActive)return e.setActive();if(On)return e.focus(On);var t=Cn(e);e.focus(null==On?{get preventScroll(){return On={preventScroll:!0},!0}}:void 0),On||(On=!1,Mn(t,0))}(this.dom),pr(this),this.domObserver.start()},Ho.root.get=function(){var e=this._root;if(null==e)for(var t=this.dom.parentNode;t;t=t.parentNode)if(9==t.nodeType||11==t.nodeType&&t.host)return t.getSelection||(Object.getPrototypeOf(t).getSelection=function(){return document.getSelection()}),this._root=t;return e||document},qo.prototype.posAtCoords=function(e){return Nn(this,e)},qo.prototype.coordsAtPos=function(e,t){return void 0===t&&(t=1),In(this,e,t)},qo.prototype.domAtPos=function(e,t){return void 0===t&&(t=0),this.docView.domFromPos(e,t)},qo.prototype.nodeDOM=function(e){var t=this.docView.descAt(e);return t?t.nodeDOM:null},qo.prototype.posAtDOM=function(e,t,n){void 0===n&&(n=-1);var r=this.docView.posFromDOM(e,t,n);if(null==r)throw new RangeError("DOM position not inside the editor");return r},qo.prototype.endOfTextblock=function(e,t){return Ln(this,t||this.state,e)},qo.prototype.destroy=function(){this.docView&&(!function(e){for(var t in e.domObserver.stop(),e.eventHandlers)e.dom.removeEventListener(t,e.eventHandlers[t]);clearTimeout(e.composingTimeout),clearTimeout(e.lastIOSEnterFallbackTimeout)}(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],Wo(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null)},qo.prototype.dispatchEvent=function(e){return function(e,t){oo(e,t)||!eo[t.type]||!e.editable&&t.type in to||eo[t.type](e,t)}(this,e)},qo.prototype.dispatch=function(e){var t=this._props.dispatchTransaction;t?t.call(this,e):this.updateState(this.state.apply(e))},Object.defineProperties(qo.prototype,Ho);var ai=si(Xo,(function(e,t,n){var r=e.selection.$cursor;if(!r||(n?!n.endOfTextblock("backward",e):r.parentOffset>0))return!1;var o=Yo(r);if(!o){var i=r.blockRange(),s=i&&pt(i);return null!=s&&(t&&t(e.tr.lift(i,s).scrollIntoView()),!0)}var a=o.nodeBefore;if(!a.type.spec.isolating&&ni(e,o,t))return!0;if(0==r.parent.content.size&&(Zo(a,"end")||Pt.isSelectable(a))){if(t){var c=e.tr.deleteRange(r.before(),r.after());c.setSelection(Zo(a,"end")?zt.findFrom(c.doc.resolve(c.mapping.map(o.pos,-1)),-1):Pt.create(c.doc,o.pos-a.nodeSize)),t(c.scrollIntoView())}return!0}return!(!a.isAtom||o.depth!=r.depth-1)&&(t&&t(e.tr.delete(o.pos-a.nodeSize,o.pos).scrollIntoView()),!0)}),(function(e,t,n){var r=e.selection,o=r.$head,i=o;if(!r.empty)return!1;if(o.parent.isTextblock){if(n?!n.endOfTextblock("backward",e):o.parentOffset>0)return!1;i=Yo(o)}var s=i&&i.nodeBefore;return!(!s||!Pt.isSelectable(s))&&(t&&t(e.tr.setSelection(Pt.create(e.doc,i.pos-s.nodeSize)).scrollIntoView()),!0)})),ci=si(Xo,(function(e,t,n){var r=e.selection.$cursor;if(!r||(n?!n.endOfTextblock("forward",e):r.parentOffset<r.parent.content.size))return!1;var o=ei(r);if(!o)return!1;var i=o.nodeAfter;if(ni(e,o,t))return!0;if(0==r.parent.content.size&&(Zo(i,"start")||Pt.isSelectable(i))){if(t){var s=e.tr.deleteRange(r.before(),r.after());s.setSelection(Zo(i,"start")?zt.findFrom(s.doc.resolve(s.mapping.map(o.pos)),1):Pt.create(s.doc,s.mapping.map(o.pos))),t(s.scrollIntoView())}return!0}return!(!i.isAtom||o.depth!=r.depth-1)&&(t&&t(e.tr.delete(o.pos,o.pos+i.nodeSize).scrollIntoView()),!0)}),(function(e,t,n){var r=e.selection,o=r.$head,i=o;if(!r.empty)return!1;if(o.parent.isTextblock){if(n?!n.endOfTextblock("forward",e):o.parentOffset<o.parent.content.size)return!1;i=ei(o)}var s=i&&i.nodeAfter;return!(!s||!Pt.isSelectable(s))&&(t&&t(e.tr.setSelection(Pt.create(e.doc,i.pos)).scrollIntoView()),!0)})),li={Enter:si((function(e,t){var n=e.selection,r=n.$head,o=n.$anchor;return!(!r.parent.type.spec.code||!r.sameParent(o))&&(t&&t(e.tr.insertText("\n").scrollIntoView()),!0)}),(function(e,t){var n=e.selection,r=n.$from,o=n.$to;if(n instanceof Bt||r.parent.inlineContent||o.parent.inlineContent)return!1;var i=ti(o.parent.contentMatchAt(o.indexAfter()));if(!i||!i.isTextblock)return!1;if(t){var s=(!r.parentOffset&&o.index()<o.parent.childCount?r:o).pos,a=e.tr.insert(s,i.createAndFill());a.setSelection(Rt.create(a.doc,s+1)),t(a.scrollIntoView())}return!0}),(function(e,t){var n=e.selection.$cursor;if(!n||n.parent.content.size)return!1;if(n.depth>1&&n.after()!=n.end(-1)){var r=n.before();if(vt(e.doc,r))return t&&t(e.tr.split(r).scrollIntoView()),!0}var o=n.blockRange(),i=o&&pt(o);return null!=i&&(t&&t(e.tr.lift(o,i).scrollIntoView()),!0)}),(function(e,t){var n=e.selection,r=n.$from,o=n.$to;if(e.selection instanceof Pt&&e.selection.node.isBlock)return!(!r.parentOffset||!vt(e.doc,r.pos))&&(t&&t(e.tr.split(r.pos).scrollIntoView()),!0);if(!r.parent.isBlock)return!1;if(t){var i=o.parentOffset==o.parent.content.size,s=e.tr;(e.selection instanceof Rt||e.selection instanceof Bt)&&s.deleteSelection();var a=0==r.depth?null:ti(r.node(-1).contentMatchAt(r.indexAfter(-1))),c=i&&a?[{type:a}]:null,l=vt(s.doc,s.mapping.map(r.pos),1,c);if(c||l||!vt(s.doc,s.mapping.map(r.pos),1,a&&[{type:a}])||(c=[{type:a}],l=!0),l&&(s.split(s.mapping.map(r.pos),1,c),!i&&!r.parentOffset&&r.parent.type!=a)){var u=s.mapping.map(r.before()),f=s.doc.resolve(u);r.node(-1).canReplaceWith(f.index(),f.index()+1,a)&&s.setNodeMarkup(s.mapping.map(r.before()),a)}t(s.scrollIntoView())}return!0})),"Mod-Enter":function(e,t){var n=e.selection,r=n.$head,o=n.$anchor;if(!r.parent.type.spec.code||!r.sameParent(o))return!1;var i=r.node(-1),s=r.indexAfter(-1),a=ti(i.contentMatchAt(s));if(!i.canReplaceWith(s,s,a))return!1;if(t){var c=r.after(),l=e.tr.replaceWith(c,c,a.createAndFill());l.setSelection(zt.near(l.doc.resolve(c),1)),t(l.scrollIntoView())}return!0},Backspace:ai,"Mod-Backspace":ai,"Shift-Backspace":ai,Delete:ci,"Mod-Delete":ci,"Mod-a":function(e,t){return t&&t(e.tr.setSelection(new Bt(e.doc))),!0}},ui={"Ctrl-h":li.Backspace,"Alt-Backspace":li["Mod-Backspace"],"Ctrl-d":li.Delete,"Ctrl-Alt-Backspace":li["Mod-Delete"],"Alt-Delete":li["Mod-Delete"],"Alt-d":li["Mod-Delete"]};for(var fi in li)ui[fi]=li[fi];var di=("undefined"!=typeof navigator?/Mac/.test(navigator.platform):"undefined"!=typeof os&&"darwin"==os.platform())?ui:li,pi=function(e,t){var n;this.match=e,this.handler="string"==typeof t?(n=t,function(e,t,r,o){var i=n;if(t[1]){var s=t[0].lastIndexOf(t[1]);i+=t[0].slice(s+t[1].length);var a=(r+=s)-o;a>0&&(i=t[0].slice(s-a,s)+i,r=o)}return e.tr.insertText(i,r,o)}):t};function hi(e){var t=e.rules,n=new Zt({state:{init:function(){return null},apply:function(e,t){var n=e.getMeta(this);return n||(e.selectionSet||e.docChanged?null:t)}},props:{handleTextInput:function(e,r,o,i){return mi(e,r,o,i,t,n)},handleDOMEvents:{compositionend:function(e){setTimeout((function(){var r=e.state.selection.$cursor;r&&mi(e,r.pos,r.pos,"",t,n)}))}}},isInputRules:!0});return n}function mi(e,t,n,r,o,i){if(e.composing)return!1;var s=e.state,a=s.doc.resolve(t);if(a.parent.type.spec.code)return!1;for(var c=a.parent.textBetween(Math.max(0,a.parentOffset-500),a.parentOffset,null,"")+r,l=0;l<o.length;l++){var u=o[l].match.exec(c),f=u&&o[l].handler(s,u,t-(u[0].length-r.length),n);if(f)return e.dispatch(f.setMeta(i,{transform:f,from:t,to:n,text:r})),!0}return!1}function vi(e,t,n,r){return new pi(e,(function(e,o,i,s){var a=n instanceof Function?n(o):n,c=e.tr.delete(i,s),l=c.doc.resolve(i).blockRange(),u=l&&ht(l,t,a);if(!u)return null;c.wrap(l,u);var f=c.doc.resolve(i-1).nodeBefore;return f&&f.type==t&&gt(c.doc,i-1)&&(!r||r(o,f))&&c.join(i-1),c}))}function gi(e,t,n){return new pi(e,(function(e,r,o,i){var s=e.doc.resolve(o),a=n instanceof Function?n(r):n;return s.node(-1).canReplaceWith(s.index(-1),s.indexAfter(-1),t)?e.tr.delete(o,i).setBlockType(o,o,t,a):null}))}new pi(/--$/,""),new pi(/\.\.\.$/,""),new pi(/(?:^|[\s\{\[\(\<'"\u2018\u201C])(")$/,""),new pi(/"$/,""),new pi(/(?:^|[\s\{\[\(\<'"\u2018\u201C])(')$/,""),new pi(/'$/,"");for(var yi={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",229:"q"},wi={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"',229:"Q"},bi="undefined"!=typeof navigator&&/Chrome\/(\d+)/.exec(navigator.userAgent),ki="undefined"!=typeof navigator&&/Apple Computer/.test(navigator.vendor),xi="undefined"!=typeof navigator&&/Gecko\/\d+/.test(navigator.userAgent),Si="undefined"!=typeof navigator&&/Mac/.test(navigator.platform),Ci="undefined"!=typeof navigator&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),Mi=bi&&(Si||+bi[1]<57)||xi&&Si,Oi=0;Oi<10;Oi++)yi[48+Oi]=yi[96+Oi]=String(Oi);for(Oi=1;Oi<=24;Oi++)yi[Oi+111]="F"+Oi;for(Oi=65;Oi<=90;Oi++)yi[Oi]=String.fromCharCode(Oi+32),wi[Oi]=String.fromCharCode(Oi);for(var Ai in yi)wi.hasOwnProperty(Ai)||(wi[Ai]=yi[Ai]);var Ei="undefined"!=typeof navigator&&/Mac/.test(navigator.platform);function Ti(e){var t,n,r,o,i=e.split(/-(?!$)/),s=i[i.length-1];"Space"==s&&(s=" ");for(var a=0;a<i.length-1;a++){var c=i[a];if(/^(cmd|meta|m)$/i.test(c))o=!0;else if(/^a(lt)?$/i.test(c))t=!0;else if(/^(c|ctrl|control)$/i.test(c))n=!0;else if(/^s(hift)?$/i.test(c))r=!0;else{if(!/^mod$/i.test(c))throw new Error("Unrecognized modifier name: "+c);Ei?o=!0:n=!0}}return t&&(s="Alt-"+s),n&&(s="Ctrl-"+s),o&&(s="Meta-"+s),r&&(s="Shift-"+s),s}function Ni(e,t,n){return t.altKey&&(e="Alt-"+e),t.ctrlKey&&(e="Ctrl-"+e),t.metaKey&&(e="Meta-"+e),!1!==n&&t.shiftKey&&(e="Shift-"+e),e}function Di(e){return new Zt({props:{handleKeyDown:zi(e)}})}function zi(e){var t=function(e){var t=Object.create(null);for(var n in e)t[Ti(n)]=e[n];return t}(e);return function(e,n){var r,o=function(e){var t=!(Mi&&(e.ctrlKey||e.altKey||e.metaKey)||(ki||Ci)&&e.shiftKey&&e.key&&1==e.key.length)&&e.key||(e.shiftKey?wi:yi)[e.keyCode]||e.key||"Unidentified";return"Esc"==t&&(t="Escape"),"Del"==t&&(t="Delete"),"Left"==t&&(t="ArrowLeft"),"Up"==t&&(t="ArrowUp"),"Right"==t&&(t="ArrowRight"),"Down"==t&&(t="ArrowDown"),t}(n),i=1==o.length&&" "!=o,s=t[Ni(o,n,!i)];if(s&&s(e.state,e.dispatch,e))return!0;if(i&&(n.shiftKey||n.altKey||n.metaKey||o.charCodeAt(0)>127)&&(r=yi[n.keyCode])&&r!=o){var a=t[Ni(r,n,!0)];if(a&&a(e.state,e.dispatch,e))return!0}else if(i&&n.shiftKey){var c=t[Ni(o,n,!0)];if(c&&c(e.state,e.dispatch,e))return!0}return!1}}const Ii=Ve([],"inputRules"),$i=Ve([],"inputRulesTimer"),Ri=Qe("InputRulesReady"),Fi=e=>(e.inject(Ii).inject($i,[xh,km]).record(Ri),e=>We(void 0,void 0,void 0,(function*(){yield e.waitTimers($i);const t=e.get(Ch),n=e.get(Mh),r=e.get(Sh),o=(e,t)=>e.map((e=>[je(e.id,r,t),e.inputRules])).flatMap((([e,t])=>e&&(null==t?void 0:t(e,r)))).filter((e=>!!e)),i=[...o(t,!0),...o(n,!1)];e.set(Ii,i),e.done(Ri)}))),Pi=Ve([],"keymap"),_i=Ve([],"keymapTimer"),Bi=Qe("KeymapReady"),ji=e=>(e.inject(Pi).inject(_i,[xh,km]).record(Bi),e=>We(void 0,void 0,void 0,(function*(){yield e.waitTimers(_i);const t=e.get(Ch),n=e.get(Mh),r=e.get(Sh),o=e.get(ym),i=(e,t)=>e.map((e=>[je(e.id,r,t),e.keymap])).map((([e,t])=>e&&(null==t?void 0:t(e,r,o.get)))).filter((e=>!!e)).map(Di),s=[...i(t,!0),...i(n,!1)];e.set(Pi,s),e.done(Bi)}))),{size:Li,push:Vi,top:Wi,open:qi,close:Hi}=Le(),Ji=e=>(t,n)=>qi(e)(((e,t,n)=>{const r={type:e,content:t,attrs:n,push:(...e)=>((e,t,...n)=>{e.content.push(t,...n)})(r,...e),pop:()=>(e=>e.content.pop())(r)};return r})(t,[],n)),Ki=e=>(t,n,r)=>{const o=t.createAndFill(n,r,e.marks);if(!o)throw((...e)=>{const t=e.reduce(((e,t)=>{if(!t)return e;const n=e=>Array.isArray(e)?e.map((e=>n(e))).join(", "):e.toJSON?w(e.toJSON()):e.spec?w(e.spec):e.toString();return`${e}, ${n(t)}`}),"Create prosemirror node from remark failed in parser");return new Error(t)})(t,n,r);return Vi(e)(o),o},Ui=e=>()=>{e.marks=D.none;const t=Hi(e);return Ki(e)(t.type,t.attrs,t.content)},Gi=e=>(t,n)=>{const r=t.create(n);e.marks=r.addToSet(e.marks)},Qi=e=>t=>{e.marks=t.removeFromSet(e.marks)},Xi=e=>t=>{const n=Wi(e);if(!n)throw b();const r=n.pop(),o=t(e.marks);if(!r)return void n.push(o);const i=((e,t)=>{if(Be(e)&&Be(t)&&D.sameSet(e.marks,t.marks))return e.withText(e.text+t.text)})(r,o);i?n.push(i):n.push(r,o)},Zi=e=>()=>{let t=null;do{t=Ui(e)()}while(Li(e));return t};var Yi,es,ts;class ns{constructor(e,t,n){this.stack=e,this.schema=t,this.specMap=n,Yi.add(this),this.run=(e,t)=>{const n=e.runSync(e.parse(t));return this.next(n),this},this.next=(e=[])=>([e].flat().forEach((e=>qe(this,Yi,"m",ts).call(this,e))),this),this.toDoc=()=>this.stack.build(),this.injectRoot=(e,t,n)=>(this.stack.openNode(t,n),this.next(e.children),this),this.addText=(e="")=>(this.stack.addText((t=>this.schema.text(e,t))),this),this.addNode=(...e)=>(this.stack.addNode(...e),this),this.openNode=(...e)=>(this.stack.openNode(...e),this),this.closeNode=(...e)=>(this.stack.closeNode(...e),this),this.openMark=(...e)=>(this.stack.openMark(...e),this),this.closeMark=(...e)=>(this.stack.closeMark(...e),this)}}function rs(e,t,n){return r=>{const o=new ns((()=>{const e={marks:[],elements:[]};return{build:Zi(e),openMark:Gi(e),closeMark:Qi(e),addText:Xi(e),openNode:Ji(e),addNode:Ki(e),closeNode:Ui(e)}})(),e,t);return o.run(n,r),o.toDoc()}}Yi=new WeakSet,es=function(e){const t=Object.values(this.specMap).find((t=>t.match(e)));if(!t)throw(e=>new Error(`Cannot match target parser for node: ${w(e)}.`))(e);return t},ts=function(e){const{key:t,runner:n,is:r}=qe(this,Yi,"m",es).call(this,e);n(this,e,this.schema["node"===r?"nodes":"marks"][t])};var is=function(e){if(e)throw e}
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */;var ss=function(e){return null!=e&&null!=e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)},as=Object.prototype.hasOwnProperty,cs=Object.prototype.toString,ls=Object.defineProperty,us=Object.getOwnPropertyDescriptor,fs=function(e){return"function"==typeof Array.isArray?Array.isArray(e):"[object Array]"===cs.call(e)},ds=function(e){if(!e||"[object Object]"!==cs.call(e))return!1;var t,n=as.call(e,"constructor"),r=e.constructor&&e.constructor.prototype&&as.call(e.constructor.prototype,"isPrototypeOf");if(e.constructor&&!n&&!r)return!1;for(t in e);return void 0===t||as.call(e,t)},ps=function(e,t){ls&&"__proto__"===t.name?ls(e,t.name,{enumerable:!0,configurable:!0,value:t.newValue,writable:!0}):e[t.name]=t.newValue},hs=function(e,t){if("__proto__"===t){if(!as.call(e,t))return;if(us)return us(e,t).value}return e[t]},ms=[].slice;var vs=function(e,t){var n;return function(){var t,i=ms.call(arguments,0),s=e.length>i.length;s&&i.push(r);try{t=e.apply(null,i)}catch(a){if(s&&n)throw a;return r(a)}s||(t&&"function"==typeof t.then?t.then(o,r):t instanceof Error?r(t):o(t))};function r(){n||(n=!0,t.apply(null,arguments))}function o(e){r(null,e)}},gs=ws;ws.wrap=vs;var ys=[].slice;function ws(){var e=[],t={run:function(){var t=-1,n=ys.call(arguments,0,-1),r=arguments[arguments.length-1];if("function"!=typeof r)throw new Error("Expected function as last argument, not "+r);function o(i){var s=e[++t],a=ys.call(arguments,0),c=a.slice(1),l=n.length,u=-1;if(i)r(i);else{for(;++u<l;)null!==c[u]&&void 0!==c[u]||(c[u]=n[u]);n=c,s?vs(s,o).apply(null,n):r.apply(null,[null].concat(n))}}o.apply(null,[null].concat(n))},use:function(n){if("function"!=typeof n)throw new Error("Expected `fn` to be a function, not "+n);return e.push(n),t}};return t}var bs={}.hasOwnProperty,ks=function(e){if(!e||"object"!=typeof e)return"";if(bs.call(e,"position")||bs.call(e,"type"))return Ss(e.position);if(bs.call(e,"start")||bs.call(e,"end"))return Ss(e);if(bs.call(e,"line")||bs.call(e,"column"))return xs(e);return""};function xs(e){return e&&"object"==typeof e||(e={}),Cs(e.line)+":"+Cs(e.column)}function Ss(e){return e&&"object"==typeof e||(e={}),xs(e.start)+"-"+xs(e.end)}function Cs(e){return e&&"number"==typeof e?e:1}var Ms=ks,Os=Ts;function As(){}As.prototype=Error.prototype,Ts.prototype=new As;var Es=Ts.prototype;function Ts(e,t,n){var r,o,i;"string"==typeof t&&(n=t,t=null),r=function(e){var t,n=[null,null];"string"==typeof e&&(-1===(t=e.indexOf(":"))?n[1]=e:(n[0]=e.slice(0,t),n[1]=e.slice(t+1)));return n}(n),o=Ms(t)||"1:1",i={start:{line:null,column:null},end:{line:null,column:null}},t&&t.position&&(t=t.position),t&&(t.start?(i=t,t=t.start):i.start=t),e.stack&&(this.stack=e.stack,e=e.message),this.message=e,this.name=o,this.reason=e,this.line=t?t.line:null,this.column=t?t.column:null,this.location=i,this.source=r[0],this.ruleId=r[1]}Es.file="",Es.name="",Es.reason="",Es.message="",Es.stack="",Es.fatal=null,Es.column=null,Es.line=null;var Ns={};function Ds(e){var t,n;return zs(e),t=47===e.charCodeAt(0),(n=function(e,t){var n,r,o="",i=0,s=-1,a=0,c=-1;for(;++c<=e.length;){if(c<e.length)n=e.charCodeAt(c);else{if(47===n)break;n=47}if(47===n){if(s===c-1||1===a);else if(s!==c-1&&2===a){if(o.length<2||2!==i||46!==o.charCodeAt(o.length-1)||46!==o.charCodeAt(o.length-2))if(o.length>2){if((r=o.lastIndexOf("/"))!==o.length-1){r<0?(o="",i=0):i=(o=o.slice(0,r)).length-1-o.lastIndexOf("/"),s=c,a=0;continue}}else if(o.length){o="",i=0,s=c,a=0;continue}t&&(o=o.length?o+"/..":"..",i=2)}else o.length?o+="/"+e.slice(s+1,c):o=e.slice(s+1,c),i=c-s-1;s=c,a=0}else 46===n&&a>-1?a++:a=-1}return o}(e,!t)).length||t||(n="."),n.length&&47===e.charCodeAt(e.length-1)&&(n+="/"),t?"/"+n:n}function zs(e){if("string"!=typeof e)throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}Ns.basename=function(e,t){var n,r,o,i,s=0,a=-1;if(void 0!==t&&"string"!=typeof t)throw new TypeError('"ext" argument must be a string');if(zs(e),n=e.length,void 0===t||!t.length||t.length>e.length){for(;n--;)if(47===e.charCodeAt(n)){if(o){s=n+1;break}}else a<0&&(o=!0,a=n+1);return a<0?"":e.slice(s,a)}if(t===e)return"";r=-1,i=t.length-1;for(;n--;)if(47===e.charCodeAt(n)){if(o){s=n+1;break}}else r<0&&(o=!0,r=n+1),i>-1&&(e.charCodeAt(n)===t.charCodeAt(i--)?i<0&&(a=n):(i=-1,a=r));s===a?a=r:a<0&&(a=e.length);return e.slice(s,a)},Ns.dirname=function(e){var t,n,r;if(zs(e),!e.length)return".";t=-1,r=e.length;for(;--r;)if(47===e.charCodeAt(r)){if(n){t=r;break}}else n||(n=!0);return t<0?47===e.charCodeAt(0)?"/":".":1===t&&47===e.charCodeAt(0)?"//":e.slice(0,t)},Ns.extname=function(e){var t,n,r,o=-1,i=0,s=-1,a=0;zs(e),r=e.length;for(;r--;)if(47!==(n=e.charCodeAt(r)))s<0&&(t=!0,s=r+1),46===n?o<0?o=r:1!==a&&(a=1):o>-1&&(a=-1);else if(t){i=r+1;break}if(o<0||s<0||0===a||1===a&&o===s-1&&o===i+1)return"";return e.slice(o,s)},Ns.join=function(){var e,t=-1;for(;++t<arguments.length;)zs(arguments[t]),arguments[t]&&(e=void 0===e?arguments[t]:e+"/"+arguments[t]);return void 0===e?".":Ds(e)},Ns.sep="/";var Is={};Is.cwd=function(){return"/"};var $s=Ns,Rs=Is,Fs=ss,Ps=js,_s={}.hasOwnProperty,Bs=["history","path","basename","stem","extname","dirname"];function js(e){var t,n;if(e){if("string"==typeof e||Fs(e))e={contents:e};else if("message"in e&&"messages"in e)return e}else e={};if(!(this instanceof js))return new js(e);for(this.data={},this.messages=[],this.history=[],this.cwd=Rs.cwd(),n=-1;++n<Bs.length;)t=Bs[n],_s.call(e,t)&&(this[t]=e[t]);for(t in e)Bs.indexOf(t)<0&&(this[t]=e[t])}function Ls(e,t){if(e&&e.indexOf($s.sep)>-1)throw new Error("`"+t+"` cannot be a path: did not expect `"+$s.sep+"`")}function Vs(e,t){if(!e)throw new Error("`"+t+"` cannot be empty")}function Ws(e,t){if(!e)throw new Error("Setting `"+t+"` requires `path` to be set too")}js.prototype.toString=function(e){return(this.contents||"").toString(e)},Object.defineProperty(js.prototype,"path",{get:function(){return this.history[this.history.length-1]},set:function(e){Vs(e,"path"),this.path!==e&&this.history.push(e)}}),Object.defineProperty(js.prototype,"dirname",{get:function(){return"string"==typeof this.path?$s.dirname(this.path):void 0},set:function(e){Ws(this.path,"dirname"),this.path=$s.join(e||"",this.basename)}}),Object.defineProperty(js.prototype,"basename",{get:function(){return"string"==typeof this.path?$s.basename(this.path):void 0},set:function(e){Vs(e,"basename"),Ls(e,"basename"),this.path=$s.join(this.dirname||"",e)}}),Object.defineProperty(js.prototype,"extname",{get:function(){return"string"==typeof this.path?$s.extname(this.path):void 0},set:function(e){if(Ls(e,"extname"),Ws(this.path,"extname"),e){if(46!==e.charCodeAt(0))throw new Error("`extname` must start with `.`");if(e.indexOf(".",1)>-1)throw new Error("`extname` cannot contain multiple dots")}this.path=$s.join(this.dirname,this.stem+(e||""))}}),Object.defineProperty(js.prototype,"stem",{get:function(){return"string"==typeof this.path?$s.basename(this.path,this.extname):void 0},set:function(e){Vs(e,"stem"),Ls(e,"stem"),this.path=$s.join(this.dirname||"",e+(this.extname||""))}});var qs=Os,Hs=Ps,Js=Hs;Hs.prototype.message=function(e,t,n){var r=new qs(e,t,n);this.path&&(r.name=this.path+":"+r.name,r.file=this.path);return r.fatal=!1,this.messages.push(r),r},Hs.prototype.info=function(){var e=this.message.apply(this,arguments);return e.fatal=null,e},Hs.prototype.fail=function(){var e=this.message.apply(this,arguments);throw e.fatal=!0,e};var Ks=is,Us=ss,Gs=function e(){var t,n,r,o,i,s,a=arguments[0],c=1,l=arguments.length,u=!1;for("boolean"==typeof a&&(u=a,a=arguments[1]||{},c=2),(null==a||"object"!=typeof a&&"function"!=typeof a)&&(a={});c<l;++c)if(null!=(t=arguments[c]))for(n in t)r=hs(a,n),a!==(o=hs(t,n))&&(u&&o&&(ds(o)||(i=fs(o)))?(i?(i=!1,s=r&&fs(r)?r:[]):s=r&&ds(r)?r:{},ps(a,{name:n,newValue:e(u,s,o)})):void 0!==o&&ps(a,{name:n,newValue:o}));return a},Qs=e=>{if("[object Object]"!==Object.prototype.toString.call(e))return!1;const t=Object.getPrototypeOf(e);return null===t||t===Object.prototype},Xs=gs,Zs=Js,Ys=function e(){var t,n=[],r=Xs(),o={},i=-1;return s.data=function(e,n){if("string"==typeof e)return 2===arguments.length?(sa("data",t),o[e]=n,s):ta.call(o,e)&&o[e]||null;if(e)return sa("data",t),o=e,s;return o},s.freeze=a,s.attachers=n,s.use=function(e){var r;if(sa("use",t),null==e);else if("function"==typeof e)u.apply(null,arguments);else{if("object"!=typeof e)throw new Error("Expected usable value, not `"+e+"`");"length"in e?l(e):i(e)}r&&(o.settings=Gs(o.settings||{},r));return s;function i(e){l(e.plugins),e.settings&&(r=Gs(r||{},e.settings))}function a(e){if("function"==typeof e)u(e);else{if("object"!=typeof e)throw new Error("Expected usable value, not `"+e+"`");"length"in e?u.apply(null,e):i(e)}}function l(e){var t=-1;if(null==e);else{if("object"!=typeof e||!("length"in e))throw new Error("Expected a list of plugins, not `"+e+"`");for(;++t<e.length;)a(e[t])}}function u(e,t){var r=c(e);r?(Qs(r[1])&&Qs(t)&&(t=Gs(!0,r[1],t)),r[1]=t):n.push(ea.call(arguments))}},s.parse=function(e){var t,n=Zs(e);if(a(),oa("parse",t=s.Parser),ra(t,"parse"))return new t(String(n),n).parse();return t(String(n),n)},s.stringify=function(e,t){var n,r=Zs(t);if(a(),ia("stringify",n=s.Compiler),aa(e),ra(n,"compile"))return new n(e,r).compile();return n(e,r)},s.run=l,s.runSync=function(e,t){var n,r;return l(e,t,o),ca("runSync","run",r),n;function o(e,t){r=!0,n=t,Ks(e)}},s.process=u,s.processSync=function(e){var t,n;return a(),oa("processSync",s.Parser),ia("processSync",s.Compiler),u(t=Zs(e),r),ca("processSync","process",n),t;function r(e){n=!0,Ks(e)}},s;function s(){for(var t=e(),r=-1;++r<n.length;)t.use.apply(null,n[r]);return t.data(Gs(!0,{},o)),t}function a(){var e,o;if(t)return s;for(;++i<n.length;)!1!==(e=n[i])[1]&&(!0===e[1]&&(e[1]=void 0),"function"==typeof(o=e[0].apply(s,e.slice(1)))&&r.use(o));return t=!0,i=1/0,s}function c(e){for(var t=-1;++t<n.length;)if(n[t][0]===e)return n[t]}function l(e,t,n){if(aa(e),a(),n||"function"!=typeof t||(n=t,t=null),!n)return new Promise(o);function o(o,i){r.run(e,Zs(t),(function(t,r,s){r=r||e,t?i(t):o?o(r):n(null,r,s)}))}o(null,n)}function u(e,t){if(a(),oa("process",s.Parser),ia("process",s.Compiler),!t)return new Promise(n);function n(n,r){var o=Zs(e);na.run(s,{file:o},(function(e){e?r(e):n?n(o):t(null,o)}))}n(null,t)}}().freeze(),ea=[].slice,ta={}.hasOwnProperty,na=Xs().use((function(e,t){t.tree=e.parse(t.file)})).use((function(e,t,n){e.run(t.tree,t.file,(function(e,r,o){e?n(e):(t.tree=r,t.file=o,n())}))})).use((function(e,t){var n=e.stringify(t.tree,t.file);null==n||("string"==typeof n||Us(n)?("value"in t.file&&(t.file.value=n),t.file.contents=n):t.file.result=n)}));function ra(e,t){return"function"==typeof e&&e.prototype&&(function(e){var t;for(t in e)return!0;return!1}(e.prototype)||t in e.prototype)}function oa(e,t){if("function"!=typeof t)throw new Error("Cannot `"+e+"` without `Parser`")}function ia(e,t){if("function"!=typeof t)throw new Error("Cannot `"+e+"` without `Compiler`")}function sa(e,t){if(t)throw new Error("Cannot invoke `"+e+"` on a frozen processor.\nCreate a new processor first, by invoking it: use `processor()` instead of `processor`.")}function aa(e){if(!e||"string"!=typeof e.type)throw new Error("Expected node, got `"+e+"`")}function ca(e,t,n){if(!n)throw new Error("`"+e+"` finished async. Use `"+t+"` instead")}var la=ua;function ua(e){return e&&(e.value||e.alt||e.title||"children"in e&&fa(e.children)||"length"in e&&fa(e))||""}function fa(e){for(var t=[],n=-1;++n<e.length;)t[n]=ua(e[n]);return t.join("")}var da=Object.assign,pa={}.hasOwnProperty;var ha=function(e){return e.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()},ma=String.fromCharCode,va=ma;var ga=function(e,t){var n=parseInt(e,t);return n<9||11===n||n>13&&n<32||n>126&&n<160||n>55295&&n<57344||n>64975&&n<65008||65535==(65535&n)||65534==(65535&n)||n>1114111?"":va(n)},ya={};var wa=function(e){return e<-2};var ba=function(e){return-2===e||-1===e||32===e},ka=ba;var xa=function(e,t,n,r){var o=r?r-1:1/0,i=0;return function(r){if(ka(r))return e.enter(n),s(r);return t(r)};function s(r){return ka(r)&&i++<o?(e.consume(r),s):(e.exit(n),t(r))}};Object.defineProperty(ya,"__esModule",{value:!0});var Sa=wa,Ca=xa,Ma=function(e){var t,n=e.attempt(this.parser.constructs.contentInitial,(function(t){if(null===t)return void e.consume(t);return e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),Ca(e,n,"linePrefix")}),(function(t){return e.enter("paragraph"),r(t)}));return n;function r(n){var r=e.enter("chunkText",{contentType:"text",previous:t});return t&&(t.next=r),t=r,o(n)}function o(t){return null===t?(e.exit("chunkText"),e.exit("paragraph"),void e.consume(t)):Sa(t)?(e.consume(t),e.exit("chunkText"),r):(e.consume(t),o)}};ya.tokenize=Ma;var Oa={},Aa=wa,Ea=xa;var Ta={tokenize:function(e,t,n){return Ea(e,(function(e){return null===e||Aa(e)?t(e):n(e)}),"linePrefix")},partial:!0};Object.defineProperty(Oa,"__esModule",{value:!0});var Na=wa,Da=xa,za=Ta,Ia=function(e){var t,n,r,o=this,i=[],s=0,a={tokenize:function(e,r){var s=0;return t={},a;function a(r){return s<i.length?(o.containerState=i[s][1],e.attempt(i[s][0].continuation,c,l)(r)):n.currentConstruct&&n.currentConstruct.concrete?(t.flowContinue=!0,d(r)):(o.interrupt=n.currentConstruct&&n.currentConstruct.interruptible,o.containerState={},e.attempt($a,f,d)(r))}function c(e){return s++,o.containerState._closeFlow?f(e):a(e)}function l(t){return n.currentConstruct&&n.currentConstruct.lazy?(o.containerState={},e.attempt($a,f,e.attempt(Ra,f,e.check(za,f,u)))(t)):f(t)}function u(e){return s=i.length,t.lazy=!0,t.flowContinue=!0,d(e)}function f(e){return t.flowEnd=!0,d(e)}function d(e){return t.continued=s,o.interrupt=o.containerState=void 0,r(e)}},partial:!0};return c;function c(t){return s<i.length?(o.containerState=i[s][1],e.attempt(i[s][0].continuation,l,u)(t)):u(t)}function l(e){return s++,c(e)}function u(r){return t&&t.flowContinue?d(r):(o.interrupt=n&&n.currentConstruct&&n.currentConstruct.interruptible,o.containerState={},e.attempt($a,f,d)(r))}function f(e){return i.push([o.currentConstruct,o.containerState]),o.containerState=void 0,u(e)}function d(t){return null===t?(v(0,!0),void e.consume(t)):(n=n||o.parser.flow(o.now()),e.enter("chunkFlow",{contentType:"flow",previous:r,_tokenizer:n}),p(t))}function p(t){return null===t?(m(e.exit("chunkFlow")),d(t)):Na(t)?(e.consume(t),m(e.exit("chunkFlow")),e.check(a,h)):(e.consume(t),p)}function h(e){return v(t.continued,t&&t.flowEnd),s=0,c(e)}function m(e){r&&(r.next=e),r=e,n.lazy=t&&t.lazy,n.defineSkip(e.start),n.write(o.sliceStream(e))}function v(t,s){var a=i.length;for(n&&s&&(n.write([null]),r=n=void 0);a-- >t;)o.containerState=i[a][1],i[a][0].exit.call(o,e);i.length=t}},$a={tokenize:function(e,t,n){return Da(e,e.attempt(this.parser.constructs.document,t,n),"linePrefix",this.parser.constructs.disable.null.indexOf("codeIndented")>-1?void 0:4)}},Ra={tokenize:function(e,t,n){return Da(e,e.lazy(this.parser.constructs.flow,t,n),"linePrefix",this.parser.constructs.disable.null.indexOf("codeIndented")>-1?void 0:4)}};Oa.tokenize=Ia;var Fa={};var Pa=function(e){for(var t=-1,n=0;++t<e.length;)n+="string"==typeof e[t]?e[t].length:1;return n},_a=Pa;var Ba=function(e,t){var n=e[e.length-1];return n&&n[1].type===t?_a(n[2].sliceStream(n[1])):0},ja=[].splice;var La=function(e,t,n,r){var o,i=e.length,s=0;if(t=t<0?-t>i?0:i+t:t>i?i:t,n=n>0?n:0,r.length<1e4)(o=Array.from(r)).unshift(t,n),ja.apply(e,o);else for(n&&ja.apply(e,[t,n]);s<r.length;)(o=r.slice(s,s+1e4)).unshift(t,0),ja.apply(e,o),s+=1e4,t+=1e4},Va=da;var Wa=function(e){return Va({},e)},qa=da,Ha=La,Ja=Wa;function Ka(e,t){for(var n,r,o,i,s,a,c=e[t][1],l=e[t][2],u=t-1,f=[],d=c._tokenizer||l.parser[c.contentType](c.start),p=d.events,h=[],m={};c;){for(;e[++u][1]!==c;);f.push(u),c._tokenizer||(n=l.sliceStream(c),c.next||n.push(null),r&&d.defineSkip(c.start),c.isInFirstContentOfListItem&&(d._gfmTasklistFirstContentOfListItem=!0),d.write(n),c.isInFirstContentOfListItem&&(d._gfmTasklistFirstContentOfListItem=void 0)),r=c,c=c.next}for(c=r,o=p.length;o--;)"enter"===p[o][0]?i=!0:i&&p[o][1].type===p[o-1][1].type&&p[o][1].start.line!==p[o][1].end.line&&(v(p.slice(o+1,s)),c._tokenizer=c.next=void 0,c=c.previous,s=o+1);for(d.events=c._tokenizer=c.next=void 0,v(p.slice(0,s)),o=-1,a=0;++o<h.length;)m[a+h[o][0]]=a+h[o][1],a+=h[o][1]-h[o][0]-1;return m;function v(t){var n=f.pop();h.unshift([n,n+t.length-1]),Ha(e,n,2,t)}}var Ua=function(e){for(var t,n,r,o,i,s,a,c={},l=-1;++l<e.length;){for(;l in c;)l=c[l];if(t=e[l],l&&"chunkFlow"===t[1].type&&"listItemPrefix"===e[l-1][1].type&&((r=0)<(s=t[1]._tokenizer.events).length&&"lineEndingBlank"===s[r][1].type&&(r+=2),r<s.length&&"content"===s[r][1].type))for(;++r<s.length&&"content"!==s[r][1].type;)"chunkText"===s[r][1].type&&(s[r][1].isInFirstContentOfListItem=!0,r++);if("enter"===t[0])t[1].contentType&&(qa(c,Ka(e,l)),l=c[l],a=!0);else if(t[1]._container||t[1]._movePreviousLineEndings){for(r=l,n=void 0;r--&&("lineEnding"===(o=e[r])[1].type||"lineEndingBlank"===o[1].type);)"enter"===o[0]&&(n&&(e[n][1].type="lineEndingBlank"),o[1].type="lineEnding",n=r);n&&(t[1].end=Ja(e[n][1].start),(i=e.slice(n,l)).unshift(t),Ha(e,n,l-n+1,i))}}return!a},Ga=wa,Qa=Ba,Xa=Ua,Za=xa,Ya={tokenize:function(e,t){var n;return function(t){return e.enter("content"),n=e.enter("chunkContent",{contentType:"content"}),r(t)};function r(t){return null===t?o(t):Ga(t)?e.check(ec,i,o)(t):(e.consume(t),r)}function o(n){return e.exit("chunkContent"),e.exit("content"),t(n)}function i(t){return e.consume(t),e.exit("chunkContent"),n=n.next=e.enter("chunkContent",{contentType:"content",previous:n}),r}},resolve:function(e){return Xa(e),e},interruptible:!0,lazy:!0},ec={tokenize:function(e,t,n){var r=this;return function(t){return e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),Za(e,o,"linePrefix")};function o(o){return null===o||Ga(o)?n(o):r.parser.constructs.disable.null.indexOf("codeIndented")>-1||Qa(r.events,"linePrefix")<4?e.interrupt(r.parser.constructs.flow,n,t)(o):t(o)}},partial:!0};var tc=Ya;Object.defineProperty(Fa,"__esModule",{value:!0});var nc=tc,rc=xa,oc=Ta,ic=function(e){var t=this,n=e.attempt(oc,(function(r){if(null===r)return void e.consume(r);return e.enter("lineEndingBlank"),e.consume(r),e.exit("lineEndingBlank"),t.currentConstruct=void 0,n}),e.attempt(this.parser.constructs.flowInitial,r,rc(e,e.attempt(this.parser.constructs.flow,r,e.attempt(nc,r)),"linePrefix")));return n;function r(r){if(null!==r)return e.enter("lineEnding"),e.consume(r),e.exit("lineEnding"),t.currentConstruct=void 0,n;e.consume(r)}};Fa.tokenize=ic;var sc={};Object.defineProperty(sc,"__esModule",{value:!0});var ac=da,cc=Wa,lc=dc("text"),uc=dc("string"),fc={resolveAll:pc()};function dc(e){return{tokenize:function(t){var n=this,r=this.parser.constructs[e],o=t.attempt(r,i,s);return i;function i(e){return c(e)?o(e):s(e)}function s(e){if(null!==e)return t.enter("data"),t.consume(e),a;t.consume(e)}function a(e){return c(e)?(t.exit("data"),o(e)):(t.consume(e),a)}function c(e){var t=r[e],o=-1;if(null===e)return!0;if(t)for(;++o<t.length;)if(!t[o].previous||t[o].previous.call(n,n.previous))return!0}},resolveAll:pc("text"===e?hc:void 0)}}function pc(e){return function(t,n){var r,o=-1;for(;++o<=t.length;)void 0===r?t[o]&&"data"===t[o][1].type&&(r=o,o++):t[o]&&"data"===t[o][1].type||(o!==r+2&&(t[r][1].end=t[o-1][1].end,t.splice(r+2,o-r-2),o=r+2),r=void 0);return e?e(t,n):t}}function hc(e,t){for(var n,r,o,i,s,a,c,l,u=-1;++u<=e.length;)if((u===e.length||"lineEnding"===e[u][1].type)&&"data"===e[u-1][1].type){for(r=e[u-1][1],i=(n=t.sliceStream(r)).length,s=-1,a=0,c=void 0;i--;)if("string"==typeof(o=n[i])){for(s=o.length;32===o.charCodeAt(s-1);)a++,s--;if(s)break;s=-1}else if(-2===o)c=!0,a++;else if(-1!==o){i++;break}a&&(l={type:u===e.length||c||a<2?"lineSuffix":"hardBreakTrailing",start:{line:r.end.line,column:r.end.column-a,offset:r.end.offset-a,_index:r.start._index+i,_bufferIndex:i?s:r.start._bufferIndex+s},end:cc(r.end)},r.end=cc(l.start),r.start.offset===r.end.offset?ac(r,l):(e.splice(u,0,["enter",l,t],["exit",l,t]),u+=2)),u++}return e}sc.resolver=fc,sc.string=uc,sc.text=lc;var mc=function(e){return null==e?[]:"length"in e?e:[e]},vc=pa,gc=La,yc=mc;function wc(e,t){var n,r,o,i;for(n in t)for(i in r=vc.call(e,n)?e[n]:e[n]={},o=t[n])r[i]=bc(yc(o[i]),vc.call(r,i)?r[i]:[])}function bc(e,t){for(var n=-1,r=[];++n<e.length;)("after"===e[n].add?t:r).push(e[n]);return gc(t,0,0,r),t}var kc=function(e){for(var t={},n=-1;++n<e.length;)wc(t,e[n]);return t},xc=La;var Sc=function(e,t){return e.length?(xc(e,e.length,0,t),e):t};var Cc=function(e,t,n){for(var r,o=[],i=-1;++i<e.length;)(r=e[i].resolveAll)&&o.indexOf(r)<0&&(t=r(t,n),o.push(r));return t},Mc=ma;var Oc=da,Ac=wa,Ec=Sc,Tc=La,Nc=mc,Dc=Cc,zc=function(e){for(var t,n,r,o=-1,i=[];++o<e.length;){if("string"==typeof(t=e[o]))n=t;else if(-5===t)n="\r";else if(-4===t)n="\n";else if(-3===t)n="\r\n";else if(-2===t)n="\t";else if(-1===t){if(r)continue;n=" "}else n=Mc(t);r=-2===t,i.push(n)}return i.join("")},Ic=Wa,$c=function(e,t){var n,r=t.start._index,o=t.start._bufferIndex,i=t.end._index,s=t.end._bufferIndex;return r===i?n=[e[r].slice(o,s)]:(n=e.slice(r,i),o>-1&&(n[0]=n[0].slice(o)),s>0&&n.push(e[i].slice(0,s))),n};var Rc=function(e,t,n){var r=n?Ic(n):{line:1,column:1,offset:0},o={},i=[],s=[],a=[],c={consume:function(e){Ac(e)?(r.line++,r.column=1,r.offset+=-3===e?2:1,y()):-1!==e&&(r.column++,r.offset++);r._bufferIndex<0?r._index++:(r._bufferIndex++,r._bufferIndex===s[r._index].length&&(r._bufferIndex=-1,r._index++));l.previous=e},enter:function(e,t){var n=t||{};return n.type=e,n.start=d(),l.events.push(["enter",n,l]),a.push(n),n},exit:function(e){var t=a.pop();return t.end=d(),l.events.push(["exit",t,l]),t},attempt:v((function(e,t){g(e,t.from)})),check:v(m),interrupt:v(m,{interrupt:!0}),lazy:v(m,{lazy:!0})},l={previous:null,events:[],parser:e,sliceStream:f,sliceSerialize:function(e){return zc(f(e))},now:d,defineSkip:function(e){o[e.line]=e.column,y()},write:function(e){if(s=Ec(s,e),p(),null!==s[s.length-1])return[];return g(t,0),l.events=Dc(i,l.events,l),l.events}},u=t.tokenize.call(l,c);return t.resolveAll&&i.push(t),r._index=0,r._bufferIndex=-1,l;function f(e){return $c(s,e)}function d(){return Ic(r)}function p(){for(var e,t;r._index<s.length;)if("string"==typeof(t=s[r._index]))for(e=r._index,r._bufferIndex<0&&(r._bufferIndex=0);r._index===e&&r._bufferIndex<t.length;)h(t.charCodeAt(r._bufferIndex));else h(t)}function h(e){u=u(e)}function m(e,t){t.restore()}function v(e,t){return function(n,o,i){var s,u,f,p;return n.tokenize||"length"in n?h(Nc(n)):function(e){if(e in n||null in n)return h(n.null?Nc(n[e]).concat(Nc(n.null)):n[e])(e);return i(e)};function h(e){return s=e,m(e[u=0])}function m(e){return function(n){p=function(){var e=d(),t=l.previous,n=l.currentConstruct,o=l.events.length,i=Array.from(a);return{restore:s,from:o};function s(){r=e,l.previous=t,l.currentConstruct=n,l.events.length=o,a=i,y()}}(),f=e,e.partial||(l.currentConstruct=e);if(e.name&&l.parser.constructs.disable.null.indexOf(e.name)>-1)return g();return e.tokenize.call(t?Oc({},l,t):l,c,v,g)(n)}}function v(t){return e(f,p),o}function g(e){return p.restore(),++u<s.length?m(s[u]):i}}}function g(e,t){e.resolveAll&&i.indexOf(e)<0&&i.push(e),e.resolve&&Tc(l.events,t,l.events.length-t,e.resolve(l.events.slice(t),l)),e.resolveTo&&(l.events=e.resolveTo(l.events,l))}function y(){r.line in o&&r.column<2&&(r.column=o[r.line],r.offset+=o[r.line]-1)}},Fc={};var Pc=function(e){return e<0||32===e},_c=ma;var Bc=function(e){return function(t){return e.test(_c(t))}},jc=Bc(/[!-\/:-@\[-`\{-~\xA1\xA7\xAB\xB6\xB7\xBB\xBF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061E\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C77\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4F\u2E52\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]/),Lc=Bc(/\s/),Vc=Pc,Wc=jc,qc=Lc;var Hc=function(e){return null===e||Vc(e)||qc(e)?1:Wc(e)?2:void 0};var Jc=Sc,Kc=La,Uc=Hc,Gc=function(e,t){return e.column+=t,e.offset+=t,e._bufferIndex+=t,e},Qc=Cc,Xc=Wa;var Zc={name:"attention",tokenize:function(e,t){var n,r=Uc(this.previous);return function(t){return e.enter("attentionSequence"),n=t,o(t)};function o(i){var s,a,c,l;return i===n?(e.consume(i),o):(s=e.exit("attentionSequence"),c=!(a=Uc(i))||2===a&&r,l=!r||2===r&&a,s._open=42===n?c:c&&(r||!l),s._close=42===n?l:l&&(a||!c),t(i))}},resolveAll:function(e,t){var n,r,o,i,s,a,c,l,u=-1;for(;++u<e.length;)if("enter"===e[u][0]&&"attentionSequence"===e[u][1].type&&e[u][1]._close)for(n=u;n--;)if("exit"===e[n][0]&&"attentionSequence"===e[n][1].type&&e[n][1]._open&&t.sliceSerialize(e[n][1]).charCodeAt(0)===t.sliceSerialize(e[u][1]).charCodeAt(0)){if((e[n][1]._close||e[u][1]._open)&&(e[u][1].end.offset-e[u][1].start.offset)%3&&!((e[n][1].end.offset-e[n][1].start.offset+e[u][1].end.offset-e[u][1].start.offset)%3))continue;a=e[n][1].end.offset-e[n][1].start.offset>1&&e[u][1].end.offset-e[u][1].start.offset>1?2:1,i={type:a>1?"strongSequence":"emphasisSequence",start:Gc(Xc(e[n][1].end),-a),end:Xc(e[n][1].end)},s={type:a>1?"strongSequence":"emphasisSequence",start:Xc(e[u][1].start),end:Gc(Xc(e[u][1].start),a)},o={type:a>1?"strongText":"emphasisText",start:Xc(e[n][1].end),end:Xc(e[u][1].start)},r={type:a>1?"strong":"emphasis",start:Xc(i.start),end:Xc(s.end)},e[n][1].end=Xc(i.start),e[u][1].start=Xc(s.end),c=[],e[n][1].end.offset-e[n][1].start.offset&&(c=Jc(c,[["enter",e[n][1],t],["exit",e[n][1],t]])),c=Jc(c,[["enter",r,t],["enter",i,t],["exit",i,t],["enter",o,t]]),c=Jc(c,Qc(t.parser.constructs.insideSpan.null,e.slice(n+1,u),t)),c=Jc(c,[["exit",o,t],["enter",s,t],["exit",s,t],["exit",r,t]]),e[u][1].end.offset-e[u][1].start.offset?(l=2,c=Jc(c,[["enter",e[u][1],t],["exit",e[u][1],t]])):l=0,Kc(e,n-1,u-n+3,c),u=n+c.length-l-2;break}u=-1;for(;++u<e.length;)"attentionSequence"===e[u][1].type&&(e[u][1].type="data");return e}},Yc=Bc(/[A-Za-z]/),el=Bc(/[\dA-Za-z]/),tl=Bc(/[#-'*+\--9=?A-Z^-~]/);var nl=function(e){return e<32||127===e},rl=Yc,ol=el,il=tl,sl=nl;var al={name:"autolink",tokenize:function(e,t,n){var r=1;return function(t){return e.enter("autolink"),e.enter("autolinkMarker"),e.consume(t),e.exit("autolinkMarker"),e.enter("autolinkProtocol"),o};function o(t){return rl(t)?(e.consume(t),i):il(t)?c(t):n(t)}function i(e){return 43===e||45===e||46===e||ol(e)?s(e):c(e)}function s(t){return 58===t?(e.consume(t),a):(43===t||45===t||46===t||ol(t))&&r++<32?(e.consume(t),s):c(t)}function a(t){return 62===t?(e.exit("autolinkProtocol"),d(t)):32===t||60===t||sl(t)?n(t):(e.consume(t),a)}function c(t){return 64===t?(e.consume(t),r=0,l):il(t)?(e.consume(t),c):n(t)}function l(e){return ol(e)?u(e):n(e)}function u(t){return 46===t?(e.consume(t),r=0,l):62===t?(e.exit("autolinkProtocol").type="autolinkEmail",d(t)):f(t)}function f(t){return(45===t||ol(t))&&r++<63?(e.consume(t),45===t?f:u):n(t)}function d(n){return e.enter("autolinkMarker"),e.consume(n),e.exit("autolinkMarker"),e.exit("autolink"),t}}},cl=ba,ll=xa,ul={name:"blockQuote",tokenize:function(e,t,n){var r=this;return function(t){if(62===t)return r.containerState.open||(e.enter("blockQuote",{_container:!0}),r.containerState.open=!0),e.enter("blockQuotePrefix"),e.enter("blockQuoteMarker"),e.consume(t),e.exit("blockQuoteMarker"),o;return n(t)};function o(n){return cl(n)?(e.enter("blockQuotePrefixWhitespace"),e.consume(n),e.exit("blockQuotePrefixWhitespace"),e.exit("blockQuotePrefix"),t):(e.exit("blockQuotePrefix"),t(n))}},continuation:{tokenize:function(e,t,n){return ll(e,e.attempt(ul,t,n),"linePrefix",this.parser.constructs.disable.null.indexOf("codeIndented")>-1?void 0:4)}},exit:function(e){e.exit("blockQuote")}};var fl=ul,dl=Bc(/[!-/:-@[-`{-~]/);var pl,hl={name:"characterEscape",tokenize:function(e,t,n){return function(t){return e.enter("characterEscape"),e.enter("escapeMarker"),e.consume(t),e.exit("escapeMarker"),r};function r(r){return dl(r)?(e.enter("characterEscapeValue"),e.consume(r),e.exit("characterEscapeValue"),e.exit("characterEscape"),t):n(r)}}},ml=function(e){var t,n="&"+e+";";if((pl=pl||document.createElement("i")).innerHTML=n,59===(t=pl.textContent).charCodeAt(t.length-1)&&"semi"!==e)return!1;return t!==n&&t};var vl=Bc(/\d/),gl=Bc(/[\dA-Fa-f]/),yl=el,wl=vl,bl=gl;function kl(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var xl=kl(ml);var Sl={name:"characterReference",tokenize:function(e,t,n){var r,o,i=this,s=0;return function(t){return e.enter("characterReference"),e.enter("characterReferenceMarker"),e.consume(t),e.exit("characterReferenceMarker"),a};function a(t){return 35===t?(e.enter("characterReferenceMarkerNumeric"),e.consume(t),e.exit("characterReferenceMarkerNumeric"),c):(e.enter("characterReferenceValue"),r=31,o=yl,l(t))}function c(t){return 88===t||120===t?(e.enter("characterReferenceMarkerHexadecimal"),e.consume(t),e.exit("characterReferenceMarkerHexadecimal"),e.enter("characterReferenceValue"),r=6,o=bl,l):(e.enter("characterReferenceValue"),r=7,o=wl,l(t))}function l(a){var c;return 59===a&&s?(c=e.exit("characterReferenceValue"),o!==yl||xl.default(i.sliceSerialize(c))?(e.enter("characterReferenceMarker"),e.consume(a),e.exit("characterReferenceMarker"),e.exit("characterReference"),t):n(a)):o(a)&&s++<r?(e.consume(a),l):n(a)}}},Cl=wa,Ml=Pc,Ol=Ba,Al=xa;var El={name:"codeFenced",tokenize:function(e,t,n){var r,o=this,i={tokenize:function(e,t,n){var o=0;return Al(e,i,"linePrefix",this.parser.constructs.disable.null.indexOf("codeIndented")>-1?void 0:4);function i(t){return e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),s(t)}function s(t){return t===r?(e.consume(t),o++,s):o<a?n(t):(e.exit("codeFencedFenceSequence"),Al(e,c,"whitespace")(t))}function c(r){return null===r||Cl(r)?(e.exit("codeFencedFence"),t(r)):n(r)}},partial:!0},s=Ol(this.events,"linePrefix"),a=0;return function(t){return e.enter("codeFenced"),e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),r=t,c(t)};function c(t){return t===r?(e.consume(t),a++,c):(e.exit("codeFencedFenceSequence"),a<3?n(t):Al(e,l,"whitespace")(t))}function l(t){return null===t||Cl(t)?p(t):(e.enter("codeFencedFenceInfo"),e.enter("chunkString",{contentType:"string"}),u(t))}function u(t){return null===t||Ml(t)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),Al(e,f,"whitespace")(t)):96===t&&t===r?n(t):(e.consume(t),u)}function f(t){return null===t||Cl(t)?p(t):(e.enter("codeFencedFenceMeta"),e.enter("chunkString",{contentType:"string"}),d(t))}function d(t){return null===t||Cl(t)?(e.exit("chunkString"),e.exit("codeFencedFenceMeta"),p(t)):96===t&&t===r?n(t):(e.consume(t),d)}function p(n){return e.exit("codeFencedFence"),o.interrupt?t(n):h(n)}function h(t){return null===t?v(t):Cl(t)?(e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),e.attempt(i,v,s?Al(e,h,"linePrefix",s+1):h)):(e.enter("codeFlowValue"),m(t))}function m(t){return null===t||Cl(t)?(e.exit("codeFlowValue"),h(t)):(e.consume(t),m)}function v(n){return e.exit("codeFenced"),t(n)}},concrete:!0},Tl=wa,Nl=La,Dl=Ba,zl=xa,Il={name:"codeIndented",tokenize:function(e,t,n){return e.attempt($l,r,n);function r(n){return null===n?t(n):Tl(n)?e.attempt($l,r,t)(n):(e.enter("codeFlowValue"),o(n))}function o(t){return null===t||Tl(t)?(e.exit("codeFlowValue"),r(t)):(e.consume(t),o)}},resolve:function(e,t){var n={type:"codeIndented",start:e[0][1].start,end:e[e.length-1][1].end};return Nl(e,0,0,[["enter",n,t]]),Nl(e,e.length,0,[["exit",n,t]]),e}},$l={tokenize:function(e,t,n){var r=this;return zl(e,(function o(i){if(Tl(i))return e.enter("lineEnding"),e.consume(i),e.exit("lineEnding"),zl(e,o,"linePrefix",5);return Dl(r.events,"linePrefix")<4?n(i):t(i)}),"linePrefix",5)},partial:!0};var Rl=Il,Fl=wa;var Pl={name:"codeText",tokenize:function(e,t,n){var r,o,i=0;return function(t){return e.enter("codeText"),e.enter("codeTextSequence"),s(t)};function s(t){return 96===t?(e.consume(t),i++,s):(e.exit("codeTextSequence"),a(t))}function a(t){return null===t?n(t):96===t?(o=e.enter("codeTextSequence"),r=0,l(t)):32===t?(e.enter("space"),e.consume(t),e.exit("space"),a):Fl(t)?(e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),a):(e.enter("codeTextData"),c(t))}function c(t){return null===t||32===t||96===t||Fl(t)?(e.exit("codeTextData"),a(t)):(e.consume(t),c)}function l(n){return 96===n?(e.consume(n),r++,l):r===i?(e.exit("codeTextSequence"),e.exit("codeText"),t(n)):(o.type="codeTextData",c(n))}},resolve:function(e){var t,n,r=e.length-4,o=3;if(!("lineEnding"!==e[o][1].type&&"space"!==e[o][1].type||"lineEnding"!==e[r][1].type&&"space"!==e[r][1].type))for(t=o;++t<r;)if("codeTextData"===e[t][1].type){e[r][1].type=e[o][1].type="codeTextPadding",o+=2,r-=2;break}t=o-1,r++;for(;++t<=r;)void 0===n?t!==r&&"lineEnding"!==e[t][1].type&&(n=t):t!==r&&"lineEnding"!==e[t][1].type||(e[n][1].type="codeTextData",t!==n+2&&(e[n][1].end=e[t-1][1].end,e.splice(n+2,t-n-2),r-=t-n-2,t=n+2),n=void 0);return e},previous:function(e){return 96!==e||"characterEscape"===this.events[this.events.length-1][1].type}},_l=nl,Bl=Pc,jl=wa;var Ll=function(e,t,n,r,o,i,s,a,c){var l=c||1/0,u=0;return function(t){if(60===t)return e.enter(r),e.enter(o),e.enter(i),e.consume(t),e.exit(i),f;if(_l(t)||41===t)return n(t);return e.enter(r),e.enter(s),e.enter(a),e.enter("chunkString",{contentType:"string"}),h(t)};function f(n){return 62===n?(e.enter(i),e.consume(n),e.exit(i),e.exit(o),e.exit(r),t):(e.enter(a),e.enter("chunkString",{contentType:"string"}),d(n))}function d(t){return 62===t?(e.exit("chunkString"),e.exit(a),f(t)):null===t||60===t||jl(t)?n(t):(e.consume(t),92===t?p:d)}function p(t){return 60===t||62===t||92===t?(e.consume(t),d):d(t)}function h(o){return 40===o?++u>l?n(o):(e.consume(o),h):41===o?u--?(e.consume(o),h):(e.exit("chunkString"),e.exit(a),e.exit(s),e.exit(r),t(o)):null===o||Bl(o)?u?n(o):(e.exit("chunkString"),e.exit(a),e.exit(s),e.exit(r),t(o)):_l(o)?n(o):(e.consume(o),92===o?m:h)}function m(t){return 40===t||41===t||92===t?(e.consume(t),h):h(t)}},Vl=wa,Wl=ba;var ql=function(e,t,n,r,o,i){var s,a=this,c=0;return function(t){return e.enter(r),e.enter(o),e.consume(t),e.exit(o),e.enter(i),l};function l(f){return null===f||91===f||93===f&&!s||94===f&&!c&&"_hiddenFootnoteSupport"in a.parser.constructs||c>999?n(f):93===f?(e.exit(i),e.enter(o),e.consume(f),e.exit(o),e.exit(r),t):Vl(f)?(e.enter("lineEnding"),e.consume(f),e.exit("lineEnding"),l):(e.enter("chunkString",{contentType:"string"}),u(f))}function u(t){return null===t||91===t||93===t||Vl(t)||c++>999?(e.exit("chunkString"),l(t)):(e.consume(t),s=s||!Wl(t),92===t?f:u)}function f(t){return 91===t||92===t||93===t?(e.consume(t),c++,u):u(t)}},Hl=wa,Jl=ba,Kl=xa;var Ul=function(e,t){var n;return function r(o){if(Hl(o))return e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),n=!0,r;if(Jl(o))return Kl(e,r,n?"linePrefix":"lineSuffix")(o);return t(o)}},Gl=wa,Ql=xa;var Xl=function(e,t,n,r,o,i){var s;return function(t){return e.enter(r),e.enter(o),e.consume(t),e.exit(o),s=40===t?41:t,a};function a(n){return n===s?(e.enter(o),e.consume(n),e.exit(o),e.exit(r),t):(e.enter(i),c(n))}function c(t){return t===s?(e.exit(i),a(s)):null===t?n(t):Gl(t)?(e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),Ql(e,c,"linePrefix")):(e.enter("chunkString",{contentType:"string"}),l(t))}function l(t){return t===s||null===t||Gl(t)?(e.exit("chunkString"),c(t)):(e.consume(t),92===t?u:l)}function u(t){return t===s||92===t?(e.consume(t),l):l(t)}},Zl=wa,Yl=Pc,eu=ha,tu=Ll,nu=ql,ru=xa,ou=Ul,iu=Xl,su={name:"definition",tokenize:function(e,t,n){var r,o=this;return function(t){return e.enter("definition"),nu.call(o,e,i,n,"definitionLabel","definitionLabelMarker","definitionLabelString")(t)};function i(t){return r=eu(o.sliceSerialize(o.events[o.events.length-1][1]).slice(1,-1)),58===t?(e.enter("definitionMarker"),e.consume(t),e.exit("definitionMarker"),ou(e,tu(e,e.attempt(au,ru(e,s,"whitespace"),ru(e,s,"whitespace")),n,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString"))):n(t)}function s(i){return null===i||Zl(i)?(e.exit("definition"),o.parser.defined.indexOf(r)<0&&o.parser.defined.push(r),t(i)):n(i)}}},au={tokenize:function(e,t,n){return function(t){return Yl(t)?ou(e,r)(t):n(t)};function r(t){return 34===t||39===t||40===t?iu(e,ru(e,o,"whitespace"),n,"definitionTitle","definitionTitleMarker","definitionTitleString")(t):n(t)}function o(e){return null===e||Zl(e)?t(e):n(e)}},partial:!0};var cu=su,lu=wa;var uu={name:"hardBreakEscape",tokenize:function(e,t,n){return function(t){return e.enter("hardBreakEscape"),e.enter("escapeMarker"),e.consume(t),r};function r(r){return lu(r)?(e.exit("escapeMarker"),e.exit("hardBreakEscape"),t(r)):n(r)}}},fu=wa,du=Pc,pu=ba,hu=La,mu=xa;var vu={name:"headingAtx",tokenize:function(e,t,n){var r=this,o=0;return function(t){return e.enter("atxHeading"),e.enter("atxHeadingSequence"),i(t)};function i(a){return 35===a&&o++<6?(e.consume(a),i):null===a||du(a)?(e.exit("atxHeadingSequence"),r.interrupt?t(a):s(a)):n(a)}function s(n){return 35===n?(e.enter("atxHeadingSequence"),a(n)):null===n||fu(n)?(e.exit("atxHeading"),t(n)):pu(n)?mu(e,s,"whitespace")(n):(e.enter("atxHeadingText"),c(n))}function a(t){return 35===t?(e.consume(t),a):(e.exit("atxHeadingSequence"),s(t))}function c(t){return null===t||35===t||du(t)?(e.exit("atxHeadingText"),s(t)):(e.consume(t),c)}},resolve:function(e,t){var n,r,o=e.length-2,i=3;"whitespace"===e[i][1].type&&(i+=2);o-2>i&&"whitespace"===e[o][1].type&&(o-=2);"atxHeadingSequence"===e[o][1].type&&(i===o-1||o-4>i&&"whitespace"===e[o-2][1].type)&&(o-=i+1===o?2:4);o>i&&(n={type:"atxHeadingText",start:e[i][1].start,end:e[o][1].end},r={type:"chunkText",start:e[i][1].start,end:e[o][1].end,contentType:"text"},hu(e,i,o-i+1,[["enter",n,t],["enter",r,t],["exit",r,t],["exit",n,t]]));return e}},gu=Yc,yu=el,wu=wa,bu=Pc,ku=ba,xu=ma,Su=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","section","source","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],Cu=["pre","script","style","textarea"],Mu=Ta,Ou={name:"htmlFlow",tokenize:function(e,t,n){var r,o,i,s,a,c=this;return function(t){return e.enter("htmlFlow"),e.enter("htmlFlowData"),e.consume(t),l};function l(s){return 33===s?(e.consume(s),u):47===s?(e.consume(s),p):63===s?(e.consume(s),r=3,c.interrupt?t:I):gu(s)?(e.consume(s),i=xu(s),o=!0,h):n(s)}function u(o){return 45===o?(e.consume(o),r=2,f):91===o?(e.consume(o),r=5,i="CDATA[",s=0,d):gu(o)?(e.consume(o),r=4,c.interrupt?t:I):n(o)}function f(r){return 45===r?(e.consume(r),c.interrupt?t:I):n(r)}function d(r){return r===i.charCodeAt(s++)?(e.consume(r),s===i.length?c.interrupt?t:O:d):n(r)}function p(t){return gu(t)?(e.consume(t),i=xu(t),h):n(t)}function h(s){return null===s||47===s||62===s||bu(s)?47!==s&&o&&Cu.indexOf(i.toLowerCase())>-1?(r=1,c.interrupt?t(s):O(s)):Su.indexOf(i.toLowerCase())>-1?(r=6,47===s?(e.consume(s),m):c.interrupt?t(s):O(s)):(r=7,c.interrupt?n(s):o?g(s):v(s)):45===s||yu(s)?(e.consume(s),i+=xu(s),h):n(s)}function m(r){return 62===r?(e.consume(r),c.interrupt?t:O):n(r)}function v(t){return ku(t)?(e.consume(t),v):C(t)}function g(t){return 47===t?(e.consume(t),C):58===t||95===t||gu(t)?(e.consume(t),y):ku(t)?(e.consume(t),g):C(t)}function y(t){return 45===t||46===t||58===t||95===t||yu(t)?(e.consume(t),y):w(t)}function w(t){return 61===t?(e.consume(t),b):ku(t)?(e.consume(t),w):g(t)}function b(t){return null===t||60===t||61===t||62===t||96===t?n(t):34===t||39===t?(e.consume(t),a=t,k):ku(t)?(e.consume(t),b):(a=void 0,x(t))}function k(t){return t===a?(e.consume(t),S):null===t||wu(t)?n(t):(e.consume(t),k)}function x(t){return null===t||34===t||39===t||60===t||61===t||62===t||96===t||bu(t)?w(t):(e.consume(t),x)}function S(e){return 47===e||62===e||ku(e)?g(e):n(e)}function C(t){return 62===t?(e.consume(t),M):n(t)}function M(t){return ku(t)?(e.consume(t),M):null===t||wu(t)?O(t):n(t)}function O(t){return 45===t&&2===r?(e.consume(t),T):60===t&&1===r?(e.consume(t),N):62===t&&4===r?(e.consume(t),$):63===t&&3===r?(e.consume(t),I):93===t&&5===r?(e.consume(t),z):!wu(t)||6!==r&&7!==r?null===t||wu(t)?A(t):(e.consume(t),O):e.check(Au,$,A)(t)}function A(t){return e.exit("htmlFlowData"),E(t)}function E(t){return null===t?R(t):wu(t)?(e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),E):(e.enter("htmlFlowData"),O(t))}function T(t){return 45===t?(e.consume(t),I):O(t)}function N(t){return 47===t?(e.consume(t),i="",D):O(t)}function D(t){return 62===t&&Cu.indexOf(i.toLowerCase())>-1?(e.consume(t),$):gu(t)&&i.length<8?(e.consume(t),i+=xu(t),D):O(t)}function z(t){return 93===t?(e.consume(t),I):O(t)}function I(t){return 62===t?(e.consume(t),$):O(t)}function $(t){return null===t||wu(t)?(e.exit("htmlFlowData"),R(t)):(e.consume(t),$)}function R(n){return e.exit("htmlFlow"),t(n)}},resolveTo:function(e){var t=e.length;for(;t--&&("enter"!==e[t][0]||"htmlFlow"!==e[t][1].type););t>1&&"linePrefix"===e[t-2][1].type&&(e[t][1].start=e[t-2][1].start,e[t+1][1].start=e[t-2][1].start,e.splice(t-2,2));return e},concrete:!0},Au={tokenize:function(e,t,n){return function(r){return e.exit("htmlFlowData"),e.enter("lineEndingBlank"),e.consume(r),e.exit("lineEndingBlank"),e.attempt(Mu,t,n)}},partial:!0};var Eu=Ou,Tu=Yc,Nu=el,Du=wa,zu=Pc,Iu=ba,$u=xa;var Ru={name:"htmlText",tokenize:function(e,t,n){var r,o,i,s,a=this;return function(t){return e.enter("htmlText"),e.enter("htmlTextData"),e.consume(t),c};function c(t){return 33===t?(e.consume(t),l):47===t?(e.consume(t),x):63===t?(e.consume(t),b):Tu(t)?(e.consume(t),M):n(t)}function l(t){return 45===t?(e.consume(t),u):91===t?(e.consume(t),o="CDATA[",i=0,m):Tu(t)?(e.consume(t),w):n(t)}function u(t){return 45===t?(e.consume(t),f):n(t)}function f(t){return null===t||62===t?n(t):45===t?(e.consume(t),d):p(t)}function d(e){return null===e||62===e?n(e):p(e)}function p(t){return null===t?n(t):45===t?(e.consume(t),h):Du(t)?(s=p,I(t)):(e.consume(t),p)}function h(t){return 45===t?(e.consume(t),R):p(t)}function m(t){return t===o.charCodeAt(i++)?(e.consume(t),i===o.length?v:m):n(t)}function v(t){return null===t?n(t):93===t?(e.consume(t),g):Du(t)?(s=v,I(t)):(e.consume(t),v)}function g(t){return 93===t?(e.consume(t),y):v(t)}function y(t){return 62===t?R(t):93===t?(e.consume(t),y):v(t)}function w(t){return null===t||62===t?R(t):Du(t)?(s=w,I(t)):(e.consume(t),w)}function b(t){return null===t?n(t):63===t?(e.consume(t),k):Du(t)?(s=b,I(t)):(e.consume(t),b)}function k(e){return 62===e?R(e):b(e)}function x(t){return Tu(t)?(e.consume(t),S):n(t)}function S(t){return 45===t||Nu(t)?(e.consume(t),S):C(t)}function C(t){return Du(t)?(s=C,I(t)):Iu(t)?(e.consume(t),C):R(t)}function M(t){return 45===t||Nu(t)?(e.consume(t),M):47===t||62===t||zu(t)?O(t):n(t)}function O(t){return 47===t?(e.consume(t),R):58===t||95===t||Tu(t)?(e.consume(t),A):Du(t)?(s=O,I(t)):Iu(t)?(e.consume(t),O):R(t)}function A(t){return 45===t||46===t||58===t||95===t||Nu(t)?(e.consume(t),A):E(t)}function E(t){return 61===t?(e.consume(t),T):Du(t)?(s=E,I(t)):Iu(t)?(e.consume(t),E):O(t)}function T(t){return null===t||60===t||61===t||62===t||96===t?n(t):34===t||39===t?(e.consume(t),r=t,N):Du(t)?(s=T,I(t)):Iu(t)?(e.consume(t),T):(e.consume(t),r=void 0,z)}function N(t){return t===r?(e.consume(t),D):null===t?n(t):Du(t)?(s=N,I(t)):(e.consume(t),N)}function D(e){return 62===e||47===e||zu(e)?O(e):n(e)}function z(t){return null===t||34===t||39===t||60===t||61===t||96===t?n(t):62===t||zu(t)?O(t):(e.consume(t),z)}function I(t){return e.exit("htmlTextData"),e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),$u(e,$,"linePrefix",a.parser.constructs.disable.null.indexOf("codeIndented")>-1?void 0:4)}function $(t){return e.enter("htmlTextData"),s(t)}function R(r){return 62===r?(e.consume(r),e.exit("htmlTextData"),e.exit("htmlText"),t):n(r)}}},Fu=Pc,Pu=Sc,_u=La,Bu=ha,ju=Cc,Lu=Wa,Vu=Ll,Wu=ql,qu=Xl,Hu=Ul,Ju={name:"labelEnd",tokenize:function(e,t,n){var r,o,i=this,s=i.events.length;for(;s--;)if(("labelImage"===i.events[s][1].type||"labelLink"===i.events[s][1].type)&&!i.events[s][1]._balanced){r=i.events[s][1];break}return function(t){if(!r)return n(t);return r._inactive?c(t):(o=i.parser.defined.indexOf(Bu(i.sliceSerialize({start:r.end,end:i.now()})))>-1,e.enter("labelEnd"),e.enter("labelMarker"),e.consume(t),e.exit("labelMarker"),e.exit("labelEnd"),a)};function a(n){return 40===n?e.attempt(Ku,t,o?t:c)(n):91===n?e.attempt(Uu,t,o?e.attempt(Gu,t,c):c)(n):o?t(n):c(n)}function c(e){return r._balanced=!0,n(e)}},resolveTo:function(e,t){var n,r,o,i,s,a,c,l=e.length,u=0;for(;l--;)if(i=e[l][1],s){if("link"===i.type||"labelLink"===i.type&&i._inactive)break;"enter"===e[l][0]&&"labelLink"===i.type&&(i._inactive=!0)}else if(a){if("enter"===e[l][0]&&("labelImage"===i.type||"labelLink"===i.type)&&!i._balanced&&(s=l,"labelLink"!==i.type)){u=2;break}}else"labelEnd"===i.type&&(a=l);return n={type:"labelLink"===e[s][1].type?"link":"image",start:Lu(e[s][1].start),end:Lu(e[e.length-1][1].end)},r={type:"label",start:Lu(e[s][1].start),end:Lu(e[a][1].end)},o={type:"labelText",start:Lu(e[s+u+2][1].end),end:Lu(e[a-2][1].start)},c=Pu(c=[["enter",n,t],["enter",r,t]],e.slice(s+1,s+u+3)),c=Pu(c,[["enter",o,t]]),c=Pu(c,ju(t.parser.constructs.insideSpan.null,e.slice(s+u+4,a-3),t)),c=Pu(c,[["exit",o,t],e[a-2],e[a-1],["exit",r,t]]),c=Pu(c,e.slice(a+1)),c=Pu(c,[["exit",n,t]]),_u(e,s,e.length,c),e},resolveAll:function(e){var t,n=-1;for(;++n<e.length;)(t=e[n][1])._used||"labelImage"!==t.type&&"labelLink"!==t.type&&"labelEnd"!==t.type||(e.splice(n+1,"labelImage"===t.type?4:2),t.type="data",n++);return e}},Ku={tokenize:function(e,t,n){return function(t){return e.enter("resource"),e.enter("resourceMarker"),e.consume(t),e.exit("resourceMarker"),Hu(e,r)};function r(t){return 41===t?s(t):Vu(e,o,n,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",3)(t)}function o(t){return Fu(t)?Hu(e,i)(t):s(t)}function i(t){return 34===t||39===t||40===t?qu(e,Hu(e,s),n,"resourceTitle","resourceTitleMarker","resourceTitleString")(t):s(t)}function s(r){return 41===r?(e.enter("resourceMarker"),e.consume(r),e.exit("resourceMarker"),e.exit("resource"),t):n(r)}}},Uu={tokenize:function(e,t,n){var r=this;return function(t){return Wu.call(r,e,o,n,"reference","referenceMarker","referenceString")(t)};function o(e){return r.parser.defined.indexOf(Bu(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)))<0?n(e):t(e)}}},Gu={tokenize:function(e,t,n){return function(t){return e.enter("reference"),e.enter("referenceMarker"),e.consume(t),e.exit("referenceMarker"),r};function r(r){return 93===r?(e.enter("referenceMarker"),e.consume(r),e.exit("referenceMarker"),e.exit("reference"),t):n(r)}}};var Qu=Ju;var Xu={name:"labelStartImage",tokenize:function(e,t,n){var r=this;return function(t){return e.enter("labelImage"),e.enter("labelImageMarker"),e.consume(t),e.exit("labelImageMarker"),o};function o(t){return 91===t?(e.enter("labelMarker"),e.consume(t),e.exit("labelMarker"),e.exit("labelImage"),i):n(t)}function i(e){return 94===e&&"_hiddenFootnoteSupport"in r.parser.constructs?n(e):t(e)}},resolveAll:Qu.resolveAll};var Zu={name:"labelStartLink",tokenize:function(e,t,n){var r=this;return function(t){return e.enter("labelLink"),e.enter("labelMarker"),e.consume(t),e.exit("labelMarker"),e.exit("labelLink"),o};function o(e){return 94===e&&"_hiddenFootnoteSupport"in r.parser.constructs?n(e):t(e)}},resolveAll:Qu.resolveAll},Yu=xa;var ef={name:"lineEnding",tokenize:function(e,t){return function(n){return e.enter("lineEnding"),e.consume(n),e.exit("lineEnding"),Yu(e,t,"linePrefix")}}},tf=wa,nf=ba,rf=xa;var of={name:"thematicBreak",tokenize:function(e,t,n){var r,o=0;return function(t){return e.enter("thematicBreak"),r=t,i(t)};function i(a){return a===r?(e.enter("thematicBreakSequence"),s(a)):nf(a)?rf(e,i,"whitespace")(a):o<3||null!==a&&!tf(a)?n(a):(e.exit("thematicBreak"),t(a))}function s(t){return t===r?(e.consume(t),o++,s):(e.exit("thematicBreakSequence"),i(t))}}},sf=vl,af=ba,cf=Ba,lf=Pa,uf=xa,ff=Ta,df=of,pf={name:"list",tokenize:function(e,t,n){var r=this,o=cf(r.events,"linePrefix"),i=0;return function(t){var o=r.containerState.type||(42===t||43===t||45===t?"listUnordered":"listOrdered");if("listUnordered"===o?!r.containerState.marker||t===r.containerState.marker:sf(t)){if(r.containerState.type||(r.containerState.type=o,e.enter(o,{_container:!0})),"listUnordered"===o)return e.enter("listItemPrefix"),42===t||45===t?e.check(df,n,a)(t):a(t);if(!r.interrupt||49===t)return e.enter("listItemPrefix"),e.enter("listItemValue"),s(t)}return n(t)};function s(t){return sf(t)&&++i<10?(e.consume(t),s):(!r.interrupt||i<2)&&(r.containerState.marker?t===r.containerState.marker:41===t||46===t)?(e.exit("listItemValue"),a(t)):n(t)}function a(t){return e.enter("listItemMarker"),e.consume(t),e.exit("listItemMarker"),r.containerState.marker=r.containerState.marker||t,e.check(ff,r.interrupt?n:c,e.attempt(hf,u,l))}function c(e){return r.containerState.initialBlankLine=!0,o++,u(e)}function l(t){return af(t)?(e.enter("listItemPrefixWhitespace"),e.consume(t),e.exit("listItemPrefixWhitespace"),u):n(t)}function u(n){return r.containerState.size=o+lf(r.sliceStream(e.exit("listItemPrefix"))),t(n)}},continuation:{tokenize:function(e,t,n){var r=this;return r.containerState._closeFlow=void 0,e.check(ff,(function(n){return r.containerState.furtherBlankLines=r.containerState.furtherBlankLines||r.containerState.initialBlankLine,uf(e,t,"listItemIndent",r.containerState.size+1)(n)}),(function(n){if(r.containerState.furtherBlankLines||!af(n))return r.containerState.furtherBlankLines=r.containerState.initialBlankLine=void 0,o(n);return r.containerState.furtherBlankLines=r.containerState.initialBlankLine=void 0,e.attempt(mf,t,o)(n)}));function o(o){return r.containerState._closeFlow=!0,r.interrupt=void 0,uf(e,e.attempt(pf,t,n),"linePrefix",r.parser.constructs.disable.null.indexOf("codeIndented")>-1?void 0:4)(o)}}},exit:function(e){e.exit(this.containerState.type)}},hf={tokenize:function(e,t,n){var r=this;return uf(e,(function(e){return af(e)||!cf(r.events,"listItemPrefixWhitespace")?n(e):t(e)}),"listItemPrefixWhitespace",r.parser.constructs.disable.null.indexOf("codeIndented")>-1?void 0:5)},partial:!0},mf={tokenize:function(e,t,n){var r=this;return uf(e,(function(e){return cf(r.events,"listItemIndent")===r.containerState.size?t(e):n(e)}),"listItemIndent",r.containerState.size+1)},partial:!0};var vf=pf,gf=wa,yf=Wa,wf=xa;var bf={name:"setextUnderline",tokenize:function(e,t,n){var r,o,i=this,s=i.events.length;for(;s--;)if("lineEnding"!==i.events[s][1].type&&"linePrefix"!==i.events[s][1].type&&"content"!==i.events[s][1].type){o="paragraph"===i.events[s][1].type;break}return function(t){if(!i.lazy&&(i.interrupt||o))return e.enter("setextHeadingLine"),e.enter("setextHeadingLineSequence"),r=t,a(t);return n(t)};function a(t){return t===r?(e.consume(t),a):(e.exit("setextHeadingLineSequence"),wf(e,c,"lineSuffix")(t))}function c(r){return null===r||gf(r)?(e.exit("setextHeadingLine"),t(r)):n(r)}},resolveTo:function(e,t){var n,r,o,i,s=e.length;for(;s--;)if("enter"===e[s][0]){if("content"===e[s][1].type){n=s;break}"paragraph"===e[s][1].type&&(r=s)}else"content"===e[s][1].type&&e.splice(s,1),o||"definition"!==e[s][1].type||(o=s);i={type:"setextHeading",start:yf(e[r][1].start),end:yf(e[e.length-1][1].end)},e[r][1].type="setextHeadingText",o?(e.splice(r,0,["enter",i,t]),e.splice(o+1,0,["exit",e[n][1],t]),e[n][1].end=yf(e[o][1].end)):e[n][1]=i;return e.push(["exit",i,t]),e}};Object.defineProperty(Fc,"__esModule",{value:!0});var kf={42:vf,43:vf,45:vf,48:vf,49:vf,50:vf,51:vf,52:vf,53:vf,54:vf,55:vf,56:vf,57:vf,62:fl},xf={91:cu},Sf={"-2":Rl,"-1":Rl,32:Rl},Cf={35:vu,42:of,45:[bf,of],60:Eu,61:bf,95:of,96:El,126:El},Mf={38:Sl,92:hl},Of={"-5":ef,"-4":ef,"-3":ef,33:Xu,38:Sl,42:Zc,60:[al,Ru],91:Zu,92:[uu,hl],93:Qu,95:Zc,96:Pl},Af={null:[Zc,sc.resolver]};Fc.contentInitial=xf,Fc.disable={null:[]},Fc.document=kf,Fc.flow=Cf,Fc.flowInitial=Sf,Fc.insideSpan=Af,Fc.string=Mf,Fc.text=Of;var Ef=ya,Tf=Oa,Nf=Fa,Df=sc,zf=kc,If=Rc,$f=mc,Rf=Fc;var Ff=/[\0\t\n\r]/g;var Pf=Ua;var _f=function(e,t,n){"string"!=typeof t&&(n=t,t=void 0);return function(e){var t=e||{},n=function(e,t){var n=-1;for(;++n<t.length;)Gf(e,t[n]);return e}({transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:l(oe),autolinkProtocol:T,autolinkEmail:T,atxHeading:l(ee),blockQuote:l(G),characterEscape:T,characterReference:T,codeFenced:l(Q),codeFencedFenceInfo:u,codeFencedFenceMeta:u,codeIndented:l(Q,u),codeText:l(X,u),codeTextData:T,data:T,codeFlowValue:T,definition:l(Z),definitionDestinationString:u,definitionLabelString:u,definitionTitleString:u,emphasis:l(Y),hardBreakEscape:l(te),hardBreakTrailing:l(te),htmlFlow:l(ne,u),htmlFlowData:T,htmlText:l(ne,u),htmlTextData:T,image:l(re),label:u,link:l(oe),listItem:l(se),listItemValue:v,listOrdered:l(ie,m),listUnordered:l(ie),paragraph:l(ae),reference:W,referenceString:u,resourceDestinationString:u,resourceTitleString:u,setextHeading:l(ee),strong:l(ce),thematicBreak:l(ue)},exit:{atxHeading:d(),atxHeadingSequence:M,autolink:d(),autolinkEmail:U,autolinkProtocol:K,blockQuote:d(),characterEscapeValue:N,characterReferenceMarkerHexadecimal:H,characterReferenceMarkerNumeric:H,characterReferenceValue:J,codeFenced:d(b),codeFencedFence:w,codeFencedFenceInfo:g,codeFencedFenceMeta:y,codeFlowValue:N,codeIndented:d(k),codeText:d(R),codeTextData:N,data:N,definition:d(),definitionDestinationString:C,definitionLabelString:x,definitionTitleString:S,emphasis:d(),hardBreakEscape:d(z),hardBreakTrailing:d(z),htmlFlow:d(I),htmlFlowData:N,htmlText:d($),htmlTextData:N,image:d(P),label:B,labelText:_,lineEnding:D,link:d(F),listItem:d(),listOrdered:d(),listUnordered:d(),paragraph:d(),referenceString:q,resourceDestinationString:j,resourceTitleString:L,resource:V,setextHeading:d(E),setextHeadingLineSequence:A,setextHeadingText:O,strong:d(),thematicBreak:d()}},t.mdastExtensions||[]),r={};return o;function o(e){for(var t,r={type:"root",children:[]},o=[],l=[],d=-1,m={stack:[r],tokenStack:o,config:n,enter:f,exit:p,buffer:u,resume:h,setData:s,getData:a};++d<e.length;)"listOrdered"!==e[d][1].type&&"listUnordered"!==e[d][1].type||("enter"===e[d][0]?l.push(d):d=i(e,l.pop(d),d));for(d=-1;++d<e.length;)t=n[e[d][0]],Lf.call(t,e[d][1].type)&&t[e[d][1].type].call(jf({sliceSerialize:e[d][2].sliceSerialize},m),e[d][1]);if(o.length)throw new Error("Cannot close document, a token (`"+o[o.length-1].type+"`, "+Uf({start:o[o.length-1].start,end:o[o.length-1].end})+") is still open");for(r.position={start:c(e.length?e[0][1].start:{line:1,column:1,offset:0}),end:c(e.length?e[e.length-2][1].end:{line:1,column:1,offset:0})},d=-1;++d<n.transforms.length;)r=n.transforms[d](r)||r;return r}function i(e,t,n){for(var r,o,i,s,a,l,u,f=t-1,d=-1,p=!1;++f<=n;)if("listUnordered"===(a=e[f])[1].type||"listOrdered"===a[1].type||"blockQuote"===a[1].type?("enter"===a[0]?d++:d--,u=void 0):"lineEndingBlank"===a[1].type?"enter"===a[0]&&(!r||u||d||l||(l=f),u=void 0):"linePrefix"===a[1].type||"listItemValue"===a[1].type||"listItemMarker"===a[1].type||"listItemPrefix"===a[1].type||"listItemPrefixWhitespace"===a[1].type||(u=void 0),!d&&"enter"===a[0]&&"listItemPrefix"===a[1].type||-1===d&&"exit"===a[0]&&("listUnordered"===a[1].type||"listOrdered"===a[1].type)){if(r){for(o=f,i=void 0;o--;)if("lineEnding"===(s=e[o])[1].type||"lineEndingBlank"===s[1].type){if("exit"===s[0])continue;i&&(e[i][1].type="lineEndingBlank",p=!0),s[1].type="lineEnding",i=o}else if("linePrefix"!==s[1].type&&"blockQuotePrefix"!==s[1].type&&"blockQuotePrefixWhitespace"!==s[1].type&&"blockQuoteMarker"!==s[1].type&&"listItemIndent"!==s[1].type)break;l&&(!i||l<i)&&(r._spread=!0),r.end=c(i?e[i][1].start:a[1].end),e.splice(i||f,0,["exit",r,a[2]]),f++,n++}"listItemPrefix"===a[1].type&&(r={type:"listItem",_spread:!1,start:c(a[1].start)},e.splice(f,0,["enter",r,a[2]]),f++,n++,l=void 0,u=!0)}return e[t][1]._spread=p,n}function s(e,t){r[e]=t}function a(e){return r[e]}function c(e){return{line:e.line,column:e.column,offset:e.offset}}function l(e,t){return n;function n(n){f.call(this,e(n),n),t&&t.call(this,n)}}function u(){this.stack.push({type:"fragment",children:[]})}function f(e,t){return this.stack[this.stack.length-1].children.push(e),this.stack.push(e),this.tokenStack.push(t),e.position={start:c(t.start)},e}function d(e){return t;function t(t){e&&e.call(this,t),p.call(this,t)}}function p(e){var t=this.stack.pop(),n=this.tokenStack.pop();if(!n)throw new Error("Cannot close `"+e.type+"` ("+Uf({start:e.start,end:e.end})+"): its not open");if(n.type!==e.type)throw new Error("Cannot close `"+e.type+"` ("+Uf({start:e.start,end:e.end})+"): a different token (`"+n.type+"`, "+Uf({start:n.start,end:n.end})+") is open");return t.position.end=c(e.end),t}function h(){return Bf(this.stack.pop())}function m(){s("expectingFirstListItemValue",!0)}function v(e){a("expectingFirstListItemValue")&&(this.stack[this.stack.length-2].start=parseInt(this.sliceSerialize(e),10),s("expectingFirstListItemValue"))}function g(){var e=this.resume();this.stack[this.stack.length-1].lang=e}function y(){var e=this.resume();this.stack[this.stack.length-1].meta=e}function w(){a("flowCodeInside")||(this.buffer(),s("flowCodeInside",!0))}function b(){var e=this.resume();this.stack[this.stack.length-1].value=e.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),s("flowCodeInside")}function k(){var e=this.resume();this.stack[this.stack.length-1].value=e}function x(e){var t=this.resume();this.stack[this.stack.length-1].label=t,this.stack[this.stack.length-1].identifier=Vf(this.sliceSerialize(e)).toLowerCase()}function S(){var e=this.resume();this.stack[this.stack.length-1].title=e}function C(){var e=this.resume();this.stack[this.stack.length-1].url=e}function M(e){this.stack[this.stack.length-1].depth||(this.stack[this.stack.length-1].depth=this.sliceSerialize(e).length)}function O(){s("setextHeadingSlurpLineEnding",!0)}function A(e){this.stack[this.stack.length-1].depth=61===this.sliceSerialize(e).charCodeAt(0)?1:2}function E(){s("setextHeadingSlurpLineEnding")}function T(e){var t=this.stack[this.stack.length-1].children,n=t[t.length-1];n&&"text"===n.type||((n=le()).position={start:c(e.start)},this.stack[this.stack.length-1].children.push(n)),this.stack.push(n)}function N(e){var t=this.stack.pop();t.value+=this.sliceSerialize(e),t.position.end=c(e.end)}function D(e){var t=this.stack[this.stack.length-1];if(a("atHardBreak"))return t.children[t.children.length-1].position.end=c(e.end),void s("atHardBreak");!a("setextHeadingSlurpLineEnding")&&n.canContainEols.indexOf(t.type)>-1&&(T.call(this,e),N.call(this,e))}function z(){s("atHardBreak",!0)}function I(){var e=this.resume();this.stack[this.stack.length-1].value=e}function $(){var e=this.resume();this.stack[this.stack.length-1].value=e}function R(){var e=this.resume();this.stack[this.stack.length-1].value=e}function F(){var e=this.stack[this.stack.length-1];a("inReference")?(e.type+="Reference",e.referenceType=a("referenceType")||"shortcut",delete e.url,delete e.title):(delete e.identifier,delete e.label,delete e.referenceType),s("referenceType")}function P(){var e=this.stack[this.stack.length-1];a("inReference")?(e.type+="Reference",e.referenceType=a("referenceType")||"shortcut",delete e.url,delete e.title):(delete e.identifier,delete e.label,delete e.referenceType),s("referenceType")}function _(e){this.stack[this.stack.length-2].identifier=Vf(this.sliceSerialize(e)).toLowerCase()}function B(){var e=this.stack[this.stack.length-1],t=this.resume();this.stack[this.stack.length-1].label=t,s("inReference",!0),"link"===this.stack[this.stack.length-1].type?this.stack[this.stack.length-1].children=e.children:this.stack[this.stack.length-1].alt=t}function j(){var e=this.resume();this.stack[this.stack.length-1].url=e}function L(){var e=this.resume();this.stack[this.stack.length-1].title=e}function V(){s("inReference")}function W(){s("referenceType","collapsed")}function q(e){var t=this.resume();this.stack[this.stack.length-1].label=t,this.stack[this.stack.length-1].identifier=Vf(this.sliceSerialize(e)).toLowerCase(),s("referenceType","full")}function H(e){s("characterReferenceType",e.type)}function J(e){var t,n,r=this.sliceSerialize(e),o=a("characterReferenceType");o?(t=Wf(r,"characterReferenceMarkerNumeric"===o?10:16),s("characterReferenceType")):t=Kf(r),(n=this.stack.pop()).value+=t,n.position.end=c(e.end)}function K(e){N.call(this,e),this.stack[this.stack.length-1].url=this.sliceSerialize(e)}function U(e){N.call(this,e),this.stack[this.stack.length-1].url="mailto:"+this.sliceSerialize(e)}function G(){return{type:"blockquote",children:[]}}function Q(){return{type:"code",lang:null,meta:null,value:""}}function X(){return{type:"inlineCode",value:""}}function Z(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function Y(){return{type:"emphasis",children:[]}}function ee(){return{type:"heading",depth:void 0,children:[]}}function te(){return{type:"break"}}function ne(){return{type:"html",value:""}}function re(){return{type:"image",title:null,url:"",alt:null}}function oe(){return{type:"link",title:null,url:"",children:[]}}function ie(e){return{type:"list",ordered:"listOrdered"===e.type,start:null,spread:e._spread,children:[]}}function se(e){return{type:"listItem",spread:e._spread,checked:null,children:[]}}function ae(){return{type:"paragraph",children:[]}}function ce(){return{type:"strong",children:[]}}function le(){return{type:"text",value:""}}function ue(){return{type:"thematicBreak"}}}(n)(Jf(qf(n).document().write(Hf()(e,t,!0))))},Bf=la,jf=da,Lf=pa,Vf=ha,Wf=ga,qf=function(e){var t={defined:[],constructs:zf([Rf].concat($f((e||{}).extensions))),content:n(Ef),document:n(Tf),flow:n(Nf),string:n(Df.string),text:n(Df.text)};return t;function n(e){return function(n){return If(t,e,n)}}},Hf=function(){var e,t=!0,n=1,r="";return function(o,i,s){var a,c,l,u,f,d=[];o=r+o.toString(i),l=0,r="",t&&(65279===o.charCodeAt(0)&&l++,t=void 0);for(;l<o.length;){if(Ff.lastIndex=l,a=Ff.exec(o),u=a?a.index:o.length,f=o.charCodeAt(u),!a){r=o.slice(l);break}if(10===f&&l===u&&e)d.push(-3),e=void 0;else if(e&&(d.push(-5),e=void 0),l<u&&(d.push(o.slice(l,u)),n+=u-l),0===f)d.push(65533),n++;else if(9===f)for(c=4*Math.ceil(n/4),d.push(-2);n++<c;)d.push(-1);else 10===f?(d.push(-4),n=1):(e=!0,n=1);l=u+1}s&&(e&&d.push(-5),r&&d.push(r),d.push(null));return d}},Jf=function(e){for(;!Pf(e););return e},Kf=ml,Uf=ks;function Gf(e,t){var n,r;for(n in t)r=Lf.call(e,n)?e[n]:e[n]={},"canContainEols"===n||"transforms"===n?e[n]=[].concat(r,t[n]):Object.assign(r,t[n])}var Qf=function(e){var t=this;this.Parser=function(n){return Xf(n,Object.assign({},t.data("settings"),e,{extensions:t.data("micromarkExtensions")||[],mdastExtensions:t.data("fromMarkdownExtensions")||[]}))}},Xf=_f;var Zf=function(e,t){var n=t||{};function r(t){var n=r.invalid,o=r.handlers;return t&&ed.call(t,e)&&(n=ed.call(o,t[e])?o[t[e]]:r.unknown),(n||Yf).apply(this,arguments)}return r.handlers=n.handlers||{},r.invalid=n.invalid,r.unknown=n.unknown,r},Yf=Function.prototype,ed={}.hasOwnProperty;var td=function e(t,n){var r,o=-1;if(n.extensions)for(;++o<n.extensions.length;)e(t,n.extensions[o]);for(r in n)"extensions"===r||("unsafe"===r||"join"===r?t[r]=t[r].concat(n[r]||[]):"handlers"===r?t[r]=Object.assign(t[r],n[r]||{}):t.options[r]=n[r]);return t};var nd,rd={},od="",id=function(e,t){if("string"!=typeof e)throw new TypeError("expected a string");if(1===t)return e;if(2===t)return e+e;var n=e.length*t;if(nd!==e||void 0===nd)nd=e,od="";else if(od.length>=n)return od.substr(0,n);for(;n>od.length&&t>1;)1&t&&(od+=e),t>>=1,e+=e;return od=(od+=e).substr(0,n)};
/*!
 * repeat-string <https://github.com/jonschlinkert/repeat-string>
 *
 * Copyright (c) 2014-2015, Jon Schlinkert.
 * Licensed under the MIT License.
 */var sd=function(e,t){var n,r=e.children||[],o=[],i=-1;for(;++i<r.length;)n=r[i],o.push(t.handle(n,e,t,{before:"\n",after:"\n"})),i+1<r.length&&o.push(s(n,r[i+1]));return o.join("");function s(n,r){for(var o,i=-1;++i<t.join.length&&!0!==(o=t.join[i](n,r,e,t))&&1!==o;){if("number"==typeof o)return ad("\n",1+Number(o));if(!1===o)return"\n\n\x3c!----\x3e\n\n"}return"\n\n"}},ad=id;var cd=function(e,t){var n,r=[],o=0,i=0;for(;n=ld.exec(e);)s(e.slice(o,n.index)),r.push(n[0]),o=n.index+n[0].length,i++;return s(e.slice(o)),r.join("");function s(e){r.push(t(e,i,!e))}},ld=/\r?\n|\r/g;var ud=function(e,t,n){var r=n.enter("blockquote"),o=dd(fd(e,n),pd);return r(),o},fd=sd,dd=cd;function pd(e,t,n){return">"+(n?"":" ")+e}var hd=function(e,t){return md(e,t.inConstruct,!0)&&!md(e,t.notInConstruct)};function md(e,t,n){var r;if(!t)return n;for("string"==typeof t&&(t=[t]),r=-1;++r<t.length;)if(-1!==e.indexOf(t[r]))return!0;return!1}var vd=function(e,t,n,r){var o=-1;for(;++o<n.unsafe.length;)if("\n"===n.unsafe[o].character&&gd(n.stack,n.unsafe[o]))return/[ \t]/.test(r.before)?"":" ";return"\\\n"},gd=hd;var yd=function(e,t){return!t.options.fences&&e.value&&!e.lang&&/[^ \r\n]/.test(e.value)&&!/^[\t ]*(?:[\r\n]|$)|(?:^|[\r\n])[\t ]*$/.test(e.value)};var wd=function(e){var t,n;e._compiled||(t=e.before?"(?:"+e.before+")":"",n=e.after?"(?:"+e.after+")":"",e.atBreak&&(t="[\\r\\n][\\t ]*"+t),e._compiled=new RegExp((t?"("+t+")":"")+(/[|\\{}()[\]^$+*?.-]/.test(e.character)?"\\":"")+e.character+(n||""),"g"));return e._compiled};var bd=function(e,t,n){var r,o,i,s,a,c,l,u,f=(n.before||"")+(t||"")+(n.after||""),d=[],p=[],h={},m=-1;for(;++m<e.unsafe.length;)if(s=e.unsafe[m],xd(e.stack,s))for(a=kd(s);c=a.exec(f);)r="before"in s||s.atBreak,o="after"in s,i=c.index+(r?c[1].length:0),-1===d.indexOf(i)?(d.push(i),h[i]={before:r,after:o}):(h[i].before&&!r&&(h[i].before=!1),h[i].after&&!o&&(h[i].after=!1));d.sort(Sd),l=n.before?n.before.length:0,u=f.length-(n.after?n.after.length:0),m=-1;for(;++m<d.length;)(i=d[m])<l||i>=u||i+1<u&&d[m+1]===i+1&&h[i].after&&!h[i+1].before&&!h[i+1].after||(l!==i&&p.push(Cd(f.slice(l,i),"\\")),l=i,!/[!-/:-@[-`{-~]/.test(f.charAt(i))||n.encode&&-1!==n.encode.indexOf(f.charAt(i))?(p.push("&#x"+f.charCodeAt(i).toString(16).toUpperCase()+";"),l++):p.push("\\"));return p.push(Cd(f.slice(l,u),n.after)),p.join("")},kd=wd,xd=hd;function Sd(e,t){return e-t}function Cd(e,t){for(var n,r=/\\(?=[!-/:-@[-`{-~])/g,o=[],i=[],s=-1,a=0,c=e+t;n=r.exec(c);)o.push(n.index);for(;++s<o.length;)a!==o[s]&&i.push(e.slice(a,o[s])),i.push("\\"),a=o[s];return i.push(e.slice(a)),i.join("")}var Md=function(e,t,n){var r,o,i,s,a=Td(n),c=e.value||"",l="`"===a?"GraveAccent":"Tilde";Ed(e,n)?(i=n.enter("codeIndented"),r=Nd(c,zd)):(o=Od(a,Math.max(Ad(c,a)+1,3)),i=n.enter("codeFenced"),r=o,e.lang&&(s=n.enter("codeFencedLang"+l),r+=Dd(n,e.lang,{before:"`",after:" ",encode:["`"]}),s()),e.lang&&e.meta&&(s=n.enter("codeFencedMeta"+l),r+=" "+Dd(n,e.meta,{before:" ",after:"\n",encode:["`"]}),s()),r+="\n",c&&(r+=c+"\n"),r+=o);return i(),r},Od=id,Ad=function(e,t){var n,r,o=0,i=0;if("string"!=typeof t||1!==t.length)throw new Error("Expected character");e=String(e),r=e.indexOf(t),n=r;for(;-1!==r;)o++,r===n?o>i&&(i=o):o=1,n=r+1,r=e.indexOf(t,n);return i},Ed=yd,Td=function(e){var t=e.options.fence||"`";if("`"!==t&&"~"!==t)throw new Error("Cannot serialize code with `"+t+"` for `options.fence`, expected `` ` `` or `~`");return t},Nd=cd,Dd=bd;function zd(e,t,n){return(n?"":"    ")+e}var Id=function(e){if(e.label||!e.identifier)return e.label||"";return e.identifier.replace(Rd,"$1").replace(Fd,Pd)},$d=ml,Rd=/\\([!-/:-@[-`{-~])/g,Fd=/&(#(\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function Pd(e,t){return $d(t)||e}var _d=function(e){var t=e.options.quote||'"';if('"'!==t&&"'"!==t)throw new Error("Cannot serialize title with `"+t+"` for `options.quote`, expected `\"`, or `'`");return t};var Bd=function(e,t,n){var r=Ld(n),o='"'===r?"Quote":"Apostrophe",i=n.enter("definition"),s=n.enter("label"),a="["+Vd(n,jd(e),{before:"[",after:"]"})+"]: ";s(),!e.url||/[ \t\r\n]/.test(e.url)?(s=n.enter("destinationLiteral"),a+="<"+Vd(n,e.url,{before:"<",after:">"})+">"):(s=n.enter("destinationRaw"),a+=Vd(n,e.url,{before:" ",after:" "}));s(),e.title&&(s=n.enter("title"+o),a+=" "+r+Vd(n,e.title,{before:r,after:r})+r,s());return i(),a},jd=Id,Ld=_d,Vd=bd;var Wd=function(e){var t=e.options.emphasis||"*";if("*"!==t&&"_"!==t)throw new Error("Cannot serialize emphasis with `"+t+"` for `options.emphasis`, expected `*`, or `_`");return t};var qd=function(e,t,n){var r,o,i,s=e.children||[],a=[],c=-1,l=n.before;for(;++c<s.length;)i=s[c],c+1<s.length?((o=t.handle.handlers[s[c+1].type])&&o.peek&&(o=o.peek),r=o?o(s[c+1],e,t,{before:"",after:""}).charAt(0):""):r=n.after,a.length>0&&("\r"===l||"\n"===l)&&"html"===i.type&&(a[a.length-1]=a[a.length-1].replace(/(\r?\n|\r)$/," "),l=" "),a.push(t.handle(i,e,t,{before:l,after:r})),l=a[a.length-1].slice(-1);return a.join("")};var Hd=Ud;Ud.peek=function(e,t,n){return n.options.emphasis||"*"};var Jd=Wd,Kd=qd;function Ud(e,t,n){var r=Jd(n),o=n.enter("emphasis"),i=Kd(e,n,{before:r,after:r});return o(),r+i+r}var Gd=function(e,t){return t.options.setext&&(!e.depth||e.depth<3)&&Qd(e)},Qd=la;var Xd=function(e,t,n){var r,o,i,s,a=Math.max(Math.min(6,e.depth||1),1);if(Yd(e,n))return r=n.enter("headingSetext"),o=n.enter("phrasing"),i=ep(e,n,{before:"\n",after:"\n"}),o(),r(),i+"\n"+Zd(1===a?"=":"-",i.length-(Math.max(i.lastIndexOf("\r"),i.lastIndexOf("\n"))+1));s=Zd("#",a),r=n.enter("headingAtx"),o=n.enter("phrasing"),i=(i=ep(e,n,{before:"# ",after:"\n"}))?s+" "+i:s,n.options.closeAtx&&(i+=" "+s);return o(),r(),i},Zd=id,Yd=Gd,ep=qd;var tp=np;function np(e){return e.value||""}np.peek=function(){return"<"};var rp=sp;sp.peek=function(){return"!"};var op=_d,ip=bd;function sp(e,t,n){var r=op(n),o='"'===r?"Quote":"Apostrophe",i=n.enter("image"),s=n.enter("label"),a="!["+ip(n,e.alt,{before:"[",after:"]"})+"](";return s(),!e.url&&e.title||/[ \t\r\n]/.test(e.url)?(s=n.enter("destinationLiteral"),a+="<"+ip(n,e.url,{before:"<",after:">"})+">"):(s=n.enter("destinationRaw"),a+=ip(n,e.url,{before:"(",after:e.title?" ":")"})),s(),e.title&&(s=n.enter("title"+o),a+=" "+r+ip(n,e.title,{before:r,after:r})+r,s()),a+=")",i(),a}var ap=up;up.peek=function(){return"!"};var cp=Id,lp=bd;function up(e,t,n){var r,o,i=e.referenceType,s=n.enter("imageReference"),a=n.enter("label"),c=lp(n,e.alt,{before:"[",after:"]"}),l="!["+c+"]";return a(),o=n.stack,n.stack=[],a=n.enter("reference"),r=lp(n,cp(e),{before:"[",after:"]"}),a(),n.stack=o,s(),"full"!==i&&c&&c===r?"shortcut"!==i&&(l+="[]"):l+="["+r+"]",l}var fp=pp;pp.peek=function(){return"`"};var dp=wd;function pp(e,t,n){for(var r,o,i,s,a=e.value||"",c="`",l=-1;new RegExp("(^|[^`])"+c+"([^`]|$)").test(a);)c+="`";for(/[^ \r\n]/.test(a)&&(/[ \r\n`]/.test(a.charAt(0))||/[ \r\n`]/.test(a.charAt(a.length-1)))&&(a=" "+a+" ");++l<n.unsafe.length;)if((r=n.unsafe[l]).atBreak)for(o=dp(r);i=o.exec(a);)s=i.index,10===a.charCodeAt(s)&&13===a.charCodeAt(s-1)&&s--,a=a.slice(0,s)+" "+a.slice(i.index+1);return c+a+c}var hp=function(e,t){var n=mp(e);return!t.options.resourceLink&&e.url&&!e.title&&e.children&&1===e.children.length&&"text"===e.children[0].type&&(n===e.url||"mailto:"+n===e.url)&&/^[a-z][a-z+.-]+:/i.test(e.url)&&!/[\0- <>\u007F]/.test(e.url)},mp=la;var vp=kp;kp.peek=function(e,t,n){return yp(e,n)?"<":"["};var gp=_d,yp=hp,wp=qd,bp=bd;function kp(e,t,n){var r,o,i,s,a=gp(n),c='"'===a?"Quote":"Apostrophe";return yp(e,n)?(s=n.stack,n.stack=[],r=n.enter("autolink"),i="<"+wp(e,n,{before:"<",after:">"})+">",r(),n.stack=s,i):(r=n.enter("link"),o=n.enter("label"),i="["+wp(e,n,{before:"[",after:"]"})+"](",o(),!e.url&&e.title||/[ \t\r\n]/.test(e.url)?(o=n.enter("destinationLiteral"),i+="<"+bp(n,e.url,{before:"<",after:">"})+">"):(o=n.enter("destinationRaw"),i+=bp(n,e.url,{before:"(",after:e.title?" ":")"})),o(),e.title&&(o=n.enter("title"+c),i+=" "+a+bp(n,e.title,{before:a,after:a})+a,o()),i+=")",r(),i)}var xp=Op;Op.peek=function(){return"["};var Sp=Id,Cp=qd,Mp=bd;function Op(e,t,n){var r,o,i=e.referenceType,s=n.enter("linkReference"),a=n.enter("label"),c=Cp(e,n,{before:"[",after:"]"}),l="["+c+"]";return a(),o=n.stack,n.stack=[],a=n.enter("reference"),r=Mp(n,Sp(e),{before:"[",after:"]"}),a(),n.stack=o,s(),"full"!==i&&c&&c===r?"shortcut"!==i&&(l+="[]"):l+="["+r+"]",l}var Ap=function(e,t,n){var r=n.enter("list"),o=Ep(e,n);return r(),o},Ep=sd;var Tp=function(e,t,n){var r,o,i,s=Dp(n),a=zp(n);t&&t.ordered&&(s=(t.start>-1?t.start:1)+(!1===n.options.incrementListMarker?0:t.children.indexOf(e))+".");r=s.length+1,("tab"===a||"mixed"===a&&(t&&t.spread||e.spread))&&(r=4*Math.ceil(r/4));return i=n.enter("listItem"),o=$p(Ip(e,n),(function(e,t,n){if(t)return(n?"":Np(" ",r))+e;return(n?s:s+Np(" ",r-s.length))+e})),i(),o},Np=id,Dp=function(e){var t=e.options.bullet||"*";if("*"!==t&&"+"!==t&&"-"!==t)throw new Error("Cannot serialize items with `"+t+"` for `options.bullet`, expected `*`, `+`, or `-`");return t},zp=function(e){var t=e.options.listItemIndent||"tab";if(1===t||"1"===t)return"one";if("tab"!==t&&"one"!==t&&"mixed"!==t)throw new Error("Cannot serialize items with `"+t+"` for `options.listItemIndent`, expected `tab`, `one`, or `mixed`");return t},Ip=sd,$p=cd;var Rp=function(e,t,n){var r=n.enter("paragraph"),o=n.enter("phrasing"),i=Fp(e,n,{before:"\n",after:"\n"});return o(),r(),i},Fp=qd;var Pp=function(e,t,n){return _p(e,n)},_p=sd;var Bp=function(e){var t=e.options.strong||"*";if("*"!==t&&"_"!==t)throw new Error("Cannot serialize strong with `"+t+"` for `options.strong`, expected `*`, or `_`");return t};var jp=Wp;Wp.peek=function(e,t,n){return n.options.strong||"*"};var Lp=Bp,Vp=qd;function Wp(e,t,n){var r=Lp(n),o=n.enter("strong"),i=Vp(e,n,{before:r,after:r});return o(),r+r+i+r+r}var qp=function(e,t,n,r){return Hp(n,e.value,r)},Hp=bd;var Jp=function(e,t,n){var r=Kp(Gp(n)+(n.options.ruleSpaces?" ":""),Up(n));return n.options.ruleSpaces?r.slice(0,-1):r},Kp=id,Up=function(e){var t=e.options.ruleRepetition||3;if(t<3)throw new Error("Cannot serialize rules with repetition `"+t+"` for `options.ruleRepetition`, expected `3` or more");return t},Gp=function(e){var t=e.options.rule||"*";if("*"!==t&&"-"!==t&&"_"!==t)throw new Error("Cannot serialize rules with `"+t+"` for `options.rule`, expected `*`, `-`, or `_`");return t};rd.blockquote=ud,rd.break=vd,rd.code=Md,rd.definition=Bd,rd.emphasis=Hd,rd.hardBreak=vd,rd.heading=Xd,rd.html=tp,rd.image=rp,rd.imageReference=ap,rd.inlineCode=fp,rd.link=vp,rd.linkReference=xp,rd.list=Ap,rd.listItem=Tp,rd.paragraph=Rp,rd.root=Pp,rd.strong=jp,rd.text=qp,rd.thematicBreak=Jp;var Qp=[function(e,t,n,r){if("list"===t.type&&t.type===e.type&&Boolean(e.ordered)===Boolean(t.ordered)||"code"===t.type&&Xp(t,r)&&("list"===e.type||e.type===t.type&&Xp(e,r)))return!1;if("boolean"==typeof n.spread){if("paragraph"===e.type&&(e.type===t.type||"definition"===t.type||"heading"===t.type&&Zp(t,r)))return;return n.spread?1:0}}],Xp=yd,Zp=Gd;var Yp=function(e,t){var n,r=t||{},o={enter:function(e){return o.stack.push(e),t;function t(){o.stack.pop()}},stack:[],unsafe:[],join:[],handlers:{},options:{}};th(o,{unsafe:oh,join:rh,handlers:nh}),th(o,r),o.options.tightDefinitions&&(o.join=[ah].concat(o.join));o.handle=eh("type",{invalid:ih,unknown:sh,handlers:o.handlers}),(n=o.handle(e,null,o,{before:"\n",after:"\n"}))&&10!==n.charCodeAt(n.length-1)&&13!==n.charCodeAt(n.length-1)&&(n+="\n");return n},eh=Zf,th=td,nh=rd,rh=Qp,oh=[{character:"\t",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde"]},{character:"\r",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde","codeFencedMetaGraveAccent","codeFencedMetaTilde","destinationLiteral","headingAtx"]},{character:"\n",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde","codeFencedMetaGraveAccent","codeFencedMetaTilde","destinationLiteral","headingAtx"]},{character:" ",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde"]},{character:"!",after:"\\[",inConstruct:"phrasing"},{character:'"',inConstruct:"titleQuote"},{atBreak:!0,character:"#"},{character:"#",inConstruct:"headingAtx",after:"(?:[\r\n]|$)"},{character:"&",after:"[#A-Za-z]",inConstruct:"phrasing"},{character:"'",inConstruct:"titleApostrophe"},{character:"(",inConstruct:"destinationRaw"},{before:"\\]",character:"(",inConstruct:"phrasing"},{atBreak:!0,before:"\\d+",character:")"},{character:")",inConstruct:"destinationRaw"},{atBreak:!0,character:"*"},{character:"*",inConstruct:"phrasing"},{atBreak:!0,character:"+"},{atBreak:!0,character:"-"},{atBreak:!0,before:"\\d+",character:".",after:"(?:[ \t\r\n]|$)"},{atBreak:!0,character:"<",after:"[!/?A-Za-z]"},{character:"<",after:"[!/?A-Za-z]",inConstruct:"phrasing"},{character:"<",inConstruct:"destinationLiteral"},{atBreak:!0,character:"="},{atBreak:!0,character:">"},{character:">",inConstruct:"destinationLiteral"},{atBreak:!0,character:"["},{character:"[",inConstruct:["phrasing","label","reference"]},{character:"\\",after:"[\\r\\n]",inConstruct:"phrasing"},{character:"]",inConstruct:["label","reference"]},{atBreak:!0,character:"_"},{before:"[^A-Za-z]",character:"_",inConstruct:"phrasing"},{character:"_",after:"[^A-Za-z]",inConstruct:"phrasing"},{atBreak:!0,character:"`"},{character:"`",inConstruct:["codeFencedLangGraveAccent","codeFencedMetaGraveAccent","phrasing"]},{atBreak:!0,character:"~"}];function ih(e){throw new Error("Cannot handle value `"+e+"`, expected node")}function sh(e){throw new Error("Cannot handle unknown node `"+e.type+"`")}function ah(e,t){if("definition"===e.type&&e.type===t.type)return 0}var ch=function(e){var t=this;this.Compiler=function(n){return lh(n,Object.assign({},t.data("settings"),e,{extensions:t.data("toMarkdownExtensions")||[]}))}},lh=Yp;var uh=Qf,fh=ch,dh=Ys().use(uh).use(fh).freeze();const ph=Qe("ConfigReady"),hh=Ve([],"prosePlugins"),mh=e=>()=>t=>We(void 0,void 0,void 0,(function*(){yield t.wait(km);const n="function"==typeof e?[e(t)]:[e];t.update(hh,(e=>e.concat(n.flat())))})),vh=Ve([],"remarkPlugins"),gh=e=>()=>t=>{t.update(vh,(t=>t.concat([e].flat())))},yh=Qe("InitReady"),wh=Ve([],"initTimer"),bh=Ve({},"editor"),kh=Ve(dh(),"remark"),xh=Qe("schemaReady"),Sh=Ve({},"schema"),Ch=Ve([],"nodes"),Mh=Ve([],"marks"),Oh=Ve([],"schemaTimer"),Ah=e=>(e.inject(Sh).inject(Ch).inject(Mh).inject(Oh,[yh]).record(xh),e=>We(void 0,void 0,void 0,(function*(){yield e.waitTimers(Oh);const t=e=>Object.fromEntries(e.map((({id:e,schema:t})=>[e,t]))),n=t(e.get(Ch)),r=t(e.get(Mh));e.set(Sh,new Se({nodes:n,marks:r})),e.done(xh)}))),Eh=Ve((()=>null),"parser"),Th=Ve([],"parserTimer"),Nh=Qe("ParserReady"),Dh=e=>(e.inject(Eh).inject(Th,[xh]).record(Nh),e=>We(void 0,void 0,void 0,(function*(){yield e.waitTimers(Th);const t=e.get(Ch),n=e.get(Mh),r=e.get(kh),o=e.get(Sh),i=[...t.map((e=>Object.assign(Object.assign({},e),{is:"node"}))),...n.map((e=>Object.assign(Object.assign({},e),{is:"mark"})))],s=Object.fromEntries(i.map((({id:e,parser:t,is:n})=>[e,Object.assign(Object.assign({},t),{is:n,key:e})])));e.set(Eh,rs(o,s,r)),e.done(Nh)}))),zh=(e,t,n,r={})=>{const o={type:e,children:t,props:r,value:n,push:(...e)=>((e,t,...n)=>{e.children||(e.children=[]),e.children.push(t,...n)})(o,...e),pop:()=>(e=>{var t;return null===(t=e.children)||void 0===t?void 0:t.pop()})(o)};return o},{size:Ih,push:$h,open:Rh,close:Fh}=Le(),Ph=e=>(t,n,r)=>Rh(e)(zh(t,[],n,r)),_h=e=>(t,n,r,o)=>{const i=(e=>{const t=Object.assign(Object.assign({},e.props),{type:e.type});return e.children&&(t.children=e.children),e.value&&(t.value=e.value),t})(zh(t,n,r,o));return $h(e)(i),i},Bh=e=>()=>{const t=Fh(e);return _h(e)(t.type,t.children,t.value,t.props)},jh=e=>(t,n,r,o)=>{t.isInSet(e.marks)||(e.marks=t.addToSet(e.marks),Ph(e)(n,r,o))},Lh=e=>t=>t.isInSet(e.marks)?(e.marks=t.type.removeFromSet(e.marks),Bh(e)()):null,Vh=e=>()=>{let t=null;do{t=Bh(e)()}while(Ih(e));return t};var Wh,qh,Hh,Jh,Kh;class Uh{constructor(e,t,n){this.stack=e,this.schema=t,this.specMap=n,Wh.add(this),this.toString=e=>e.stringify(this.stack.build()),this.next=e=>{return t=e,Object.prototype.hasOwnProperty.call(t,"size")?(e.forEach((e=>{qe(this,Wh,"m",Kh).call(this,e)})),this):(qe(this,Wh,"m",Kh).call(this,e),this);var t},this.addNode=(...e)=>(this.stack.addNode(...e),this),this.openNode=(...e)=>(this.stack.openNode(...e),this),this.closeNode=(...e)=>(this.stack.closeNode(...e),this),this.withMark=(...e)=>(this.stack.openMark(...e),this)}run(e){return this.next(e),this}}function Gh(e,t,n){return r=>{const o=new Uh((()=>{const e={marks:[],elements:[]};return{build:Vh(e),openMark:jh(e),closeMark:Lh(e),openNode:Ph(e),addNode:_h(e),closeNode:Bh(e)}})(),e,t);return o.run(r),o.toString(n)}}Wh=new WeakSet,qh=function(e){const t=Object.entries(this.specMap).map((([e,t])=>Object.assign({key:e},t))).find((t=>t.match(e)));if(!t)throw(e=>new Error(`Cannot match target serializer for node: ${w(e)}.`))(e.type);return t},Hh=function(e){const{runner:t}=qe(this,Wh,"m",qh).call(this,e);t(this,e)},Jh=function(e,t){const{runner:n}=qe(this,Wh,"m",qh).call(this,e);return n(this,e,t)},Kh=function(e){const{marks:t}=e;t.every((t=>!qe(this,Wh,"m",Jh).call(this,t,e)))&&qe(this,Wh,"m",Hh).call(this,e),t.forEach((e=>this.stack.closeMark(e)))};const Qh=Ve((()=>""),"serializer"),Xh=Ve([],"serializerTimer"),Zh=Qe("SerializerReady"),Yh=e=>(e.inject(Qh).inject(Xh,[xh]).record(Zh),e=>We(void 0,void 0,void 0,(function*(){yield e.waitTimers(Xh);const t=e.get(Ch),n=e.get(Mh),r=e.get(kh),o=e.get(Sh),i=[...t,...n],s=Object.fromEntries(i.map((e=>[e.id,e.serializer])));e.set(Qh,Gh(o,s,r)),e.done(Zh)}))),em=Ve("","defaultValue"),tm=Ve({},"editorState"),nm=Ve({},"stateOptions"),rm=Ve([],"editorStateTimer"),om=Qe("EditorStateReady"),im=(e,t,n)=>{if("string"==typeof e)return t(e);if("html"===e.type)return Me.fromSchema(n).parse(e.dom);if("json"===e.type)return ee.fromJSON(n,e.value);throw new Error(`Doc type error, unsupported type: ${w(e)}`)},sm=e=>(e.inject(em).inject(tm).inject(nm).inject(rm,[Bi,Ri,Nh,Zh]).record(om),e=>We(void 0,void 0,void 0,(function*(){yield e.waitTimers(rm);const t=e.get(Sh),n=e.get(Eh),r=e.get(Ii),o=e.get(Pi),i=e.get(nm),s=e.get(hh),a=e.get(em),c=im(a,n,t),l=Ut.create(Object.assign({schema:t,doc:c,plugins:[...s,...o,Di(di),hi({rules:r})]},i));e.set(tm,l),e.done(om)}))),am=Ve({},"nodeView"),cm=Ve([],"nodeViewTimer"),lm=Qe("NodeViewReady"),um=e=>(e.inject(am).inject(cm,[xh]).record(lm),e=>We(void 0,void 0,void 0,(function*(){yield e.waitTimers(cm);const t=e.get(Ch),n=e.get(Mh),r=e.get(Sh),o=e.get(bh),i=(e,t)=>e.map((({id:e,view:n})=>[je(e,r,t),{view:n,id:e}])).map((([e,{id:t,view:n}])=>e&&n?[t,(...t)=>n(o,e,...t)]:void 0)).filter((e=>!!e)),s=i(t,!0),a=i(n,!1),c=Object.fromEntries([...s,...a]);e.set(am,c),e.done(lm)}))),fm=Ve({},"editorView"),dm=Ve({},"editorViewOptions"),pm=Ve(document.body,"root"),hm=Ve([],"editorViewTimer"),mm=Qe("EditorViewReady"),vm=e=>(e.inject(pm,document.body).inject(fm).inject(dm).inject(hm,[om,lm]).record(mm),e=>We(void 0,void 0,void 0,(function*(){yield e.waitTimers(hm);const t=e.get(tm),n=e.get(dm),r=e.get(am),o=e.get(pm),i=o?(e=>{const t=document.createElement("div");return t.className="milkdown",e.appendChild(t),t})(o):void 0,s=new qo(i,Object.assign({state:t,nodeViews:r},n));var a;(a=s.dom).classList.add("editor"),a.setAttribute("role","textbox"),e.set(fm,s),e.done(mm)}))),gm=(e,t)=>[e,t],ym=Ve({},"commands"),wm=()=>Ve((()=>()=>!1),"cmdKey"),bm=Ve([],"commandsTimer"),km=Qe("KeymapReady"),xm=e=>{const t=k(),n={create:(e,n)=>e(t.sliceMap,n),get:e=>t.getSlice(e).get(),call:()=>{throw new Error("You're trying to call a command before editor view initialized, make sure to get commandManager from ctx after editor view has been initialized")}};return e.inject(ym,n).inject(bm,[xh]).record(km),e=>We(void 0,void 0,void 0,(function*(){yield e.waitTimers(bm);const t=e.get(Ch),n=e.get(Mh),r=e.get(Sh),o=(e,t)=>e.map((e=>[je(e.id,r,t),e.commands])).map((([e,t])=>e&&(null==t?void 0:t(e,r)))).filter((e=>!!e)).flat(),i=[...o(t,!0),...o(n,!1)],s=e.get(ym);i.forEach((([e,t])=>{s.create(e,t)})),e.done(km),yield e.wait(mm),e.update(ym,(t=>Object.assign(Object.assign({},t),{call:(t,n)=>{const r=s.get(t)(n),o=e.get(fm);return r(o.state,o.dispatch,o)}})))}))};var Sm=function(){function e(e){var t=this;this._insertTag=function(e){var n;n=0===t.tags.length?t.prepend?t.container.firstChild:t.before:t.tags[t.tags.length-1].nextSibling,t.container.insertBefore(e,n),t.tags.push(e)},this.isSpeedy=void 0===e.speedy||e.speedy,this.tags=[],this.ctr=0,this.nonce=e.nonce,this.key=e.key,this.container=e.container,this.prepend=e.prepend,this.before=null}var t=e.prototype;return t.hydrate=function(e){e.forEach(this._insertTag)},t.insert=function(e){this.ctr%(this.isSpeedy?65e3:1)==0&&this._insertTag(function(e){var t=document.createElement("style");return t.setAttribute("data-emotion",e.key),void 0!==e.nonce&&t.setAttribute("nonce",e.nonce),t.appendChild(document.createTextNode("")),t.setAttribute("data-s",""),t}(this));var t=this.tags[this.tags.length-1];if(this.isSpeedy){var n=function(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}(t);try{n.insertRule(e,n.cssRules.length)}catch(r){}}else t.appendChild(document.createTextNode(e));this.ctr++},t.flush=function(){this.tags.forEach((function(e){return e.parentNode&&e.parentNode.removeChild(e)})),this.tags=[],this.ctr=0},e}(),Cm="-ms-",Mm="-moz-",Om="-webkit-",Am=Math.abs,Em=String.fromCharCode;function Tm(e){return e.trim()}function Nm(e,t,n){return e.replace(t,n)}function Dm(e,t){return e.indexOf(t)}function zm(e,t){return 0|e.charCodeAt(t)}function Im(e,t,n){return e.slice(t,n)}function $m(e){return e.length}function Rm(e){return e.length}function Fm(e,t){return t.push(e),e}var Pm=1,_m=1,Bm=0,jm=0,Lm=0,Vm="";function Wm(e,t,n,r,o,i,s){return{value:e,root:t,parent:n,type:r,props:o,children:i,line:Pm,column:_m,length:s,return:""}}function qm(e,t,n){return Wm(e,t.root,t.parent,n,t.props,t.children,0)}function Hm(){return Lm=jm<Bm?zm(Vm,jm++):0,_m++,10===Lm&&(_m=1,Pm++),Lm}function Jm(){return zm(Vm,jm)}function Km(){return jm}function Um(e,t){return Im(Vm,e,t)}function Gm(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function Qm(e){return Pm=_m=1,Bm=$m(Vm=e),jm=0,[]}function Xm(e){return Vm="",e}function Zm(e){return Tm(Um(jm-1,tv(91===e?e+2:40===e?e+1:e)))}function Ym(e){for(;(Lm=Jm())&&Lm<33;)Hm();return Gm(e)>2||Gm(Lm)>3?"":" "}function ev(e,t){for(;--t&&Hm()&&!(Lm<48||Lm>102||Lm>57&&Lm<65||Lm>70&&Lm<97););return Um(e,Km()+(t<6&&32==Jm()&&32==Hm()))}function tv(e){for(;Hm();)switch(Lm){case e:return jm;case 34:case 39:return tv(34===e||39===e?e:Lm);case 40:41===e&&tv(e);break;case 92:Hm()}return jm}function nv(e,t){for(;Hm()&&e+Lm!==57&&(e+Lm!==84||47!==Jm()););return"/*"+Um(t,jm-1)+"*"+Em(47===e?e:Hm())}function rv(e){for(;!Gm(Jm());)Hm();return Um(e,jm)}function ov(e){return Xm(iv("",null,null,null,[""],e=Qm(e),0,[0],e))}function iv(e,t,n,r,o,i,s,a,c){for(var l=0,u=0,f=s,d=0,p=0,h=0,m=1,v=1,g=1,y=0,w="",b=o,k=i,x=r,S=w;v;)switch(h=y,y=Hm()){case 34:case 39:case 91:case 40:S+=Zm(y);break;case 9:case 10:case 13:case 32:S+=Ym(h);break;case 92:S+=ev(Km()-1,7);continue;case 47:switch(Jm()){case 42:case 47:Fm(av(nv(Hm(),Km()),t,n),c);break;default:S+="/"}break;case 123*m:a[l++]=$m(S)*g;case 125*m:case 59:case 0:switch(y){case 0:case 125:v=0;case 59+u:p>0&&$m(S)-f&&Fm(p>32?cv(S+";",r,n,f-1):cv(Nm(S," ","")+";",r,n,f-2),c);break;case 59:S+=";";default:if(Fm(x=sv(S,t,n,l,u,o,a,w,b=[],k=[],f),i),123===y)if(0===u)iv(S,t,x,x,b,i,f,a,k);else switch(d){case 100:case 109:case 115:iv(e,x,x,r&&Fm(sv(e,x,x,0,0,o,a,w,o,b=[],f),k),o,k,f,a,r?b:k);break;default:iv(S,x,x,x,[""],k,f,a,k)}}l=u=p=0,m=g=1,w=S="",f=s;break;case 58:f=1+$m(S),p=h;default:if(m<1)if(123==y)--m;else if(125==y&&0==m++&&125==(Lm=jm>0?zm(Vm,--jm):0,_m--,10===Lm&&(_m=1,Pm--),Lm))continue;switch(S+=Em(y),y*m){case 38:g=u>0?1:(S+="\f",-1);break;case 44:a[l++]=($m(S)-1)*g,g=1;break;case 64:45===Jm()&&(S+=Zm(Hm())),d=Jm(),u=$m(w=S+=rv(Km())),y++;break;case 45:45===h&&2==$m(S)&&(m=0)}}return i}function sv(e,t,n,r,o,i,s,a,c,l,u){for(var f=o-1,d=0===o?i:[""],p=Rm(d),h=0,m=0,v=0;h<r;++h)for(var g=0,y=Im(e,f+1,f=Am(m=s[h])),w=e;g<p;++g)(w=Tm(m>0?d[g]+" "+y:Nm(y,/&\f/g,d[g])))&&(c[v++]=w);return Wm(e,t,n,0===o?"rule":a,c,l,u)}function av(e,t,n){return Wm(e,t,n,"comm",Em(Lm),Im(e,2,-2),0)}function cv(e,t,n,r){return Wm(e,t,n,"decl",Im(e,0,r),Im(e,r+1,-1),r)}function lv(e,t){switch(function(e,t){return(((t<<2^zm(e,0))<<2^zm(e,1))<<2^zm(e,2))<<2^zm(e,3)}(e,t)){case 5103:return Om+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Om+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return Om+e+Mm+e+Cm+e+e;case 6828:case 4268:return Om+e+Cm+e+e;case 6165:return Om+e+Cm+"flex-"+e+e;case 5187:return Om+e+Nm(e,/(\w+).+(:[^]+)/,"-webkit-box-$1$2-ms-flex-$1$2")+e;case 5443:return Om+e+Cm+"flex-item-"+Nm(e,/flex-|-self/,"")+e;case 4675:return Om+e+Cm+"flex-line-pack"+Nm(e,/align-content|flex-|-self/,"")+e;case 5548:return Om+e+Cm+Nm(e,"shrink","negative")+e;case 5292:return Om+e+Cm+Nm(e,"basis","preferred-size")+e;case 6060:return Om+"box-"+Nm(e,"-grow","")+Om+e+Cm+Nm(e,"grow","positive")+e;case 4554:return Om+Nm(e,/([^-])(transform)/g,"$1-webkit-$2")+e;case 6187:return Nm(Nm(Nm(e,/(zoom-|grab)/,Om+"$1"),/(image-set)/,Om+"$1"),e,"")+e;case 5495:case 3959:return Nm(e,/(image-set\([^]*)/,Om+"$1$`$1");case 4968:return Nm(Nm(e,/(.+:)(flex-)?(.*)/,"-webkit-box-pack:$3-ms-flex-pack:$3"),/s.+-b[^;]+/,"justify")+Om+e+e;case 4095:case 3583:case 4068:case 2532:return Nm(e,/(.+)-inline(.+)/,Om+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if($m(e)-1-t>6)switch(zm(e,t+1)){case 109:if(45!==zm(e,t+4))break;case 102:return Nm(e,/(.+:)(.+)-([^]+)/,"$1-webkit-$2-$3$1"+Mm+(108==zm(e,t+3)?"$3":"$2-$3"))+e;case 115:return~Dm(e,"stretch")?lv(Nm(e,"stretch","fill-available"),t)+e:e}break;case 4949:if(115!==zm(e,t+1))break;case 6444:switch(zm(e,$m(e)-3-(~Dm(e,"!important")&&10))){case 107:return Nm(e,":",":"+Om)+e;case 101:return Nm(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+Om+(45===zm(e,14)?"inline-":"")+"box$3$1"+Om+"$2$3$1"+Cm+"$2box$3")+e}break;case 5936:switch(zm(e,t+11)){case 114:return Om+e+Cm+Nm(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return Om+e+Cm+Nm(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return Om+e+Cm+Nm(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return Om+e+Cm+e+e}return e}function uv(e,t){for(var n="",r=Rm(e),o=0;o<r;o++)n+=t(e[o],o,e,t)||"";return n}function fv(e,t,n,r){switch(e.type){case"@import":case"decl":return e.return=e.return||e.value;case"comm":return"";case"rule":e.value=e.props.join(",")}return $m(n=uv(e.children,r))?e.return=e.value+"{"+n+"}":""}function dv(e){var t=Object.create(null);return function(n){return void 0===t[n]&&(t[n]=e(n)),t[n]}}var pv=function(e,t,n){for(var r=0,o=0;r=o,o=Jm(),38===r&&12===o&&(t[n]=1),!Gm(o);)Hm();return Um(e,jm)},hv=function(e,t){return Xm(function(e,t){var n=-1,r=44;do{switch(Gm(r)){case 0:38===r&&12===Jm()&&(t[n]=1),e[n]+=pv(jm-1,t,n);break;case 2:e[n]+=Zm(r);break;case 4:if(44===r){e[++n]=58===Jm()?"&\f":"",t[n]=e[n].length;break}default:e[n]+=Em(r)}}while(r=Hm());return e}(Qm(e),t))},mv=new WeakMap,vv=function(e){if("rule"===e.type&&e.parent&&e.length){for(var t=e.value,n=e.parent,r=e.column===n.column&&e.line===n.line;"rule"!==n.type;)if(!(n=n.parent))return;if((1!==e.props.length||58===t.charCodeAt(0)||mv.get(n))&&!r){mv.set(e,!0);for(var o=[],i=hv(t,o),s=n.props,a=0,c=0;a<i.length;a++)for(var l=0;l<s.length;l++,c++)e.props[c]=o[a]?i[a].replace(/&\f/g,s[l]):s[l]+" "+i[a]}}},gv=function(e){if("decl"===e.type){var t=e.value;108===t.charCodeAt(0)&&98===t.charCodeAt(2)&&(e.return="",e.value="")}},yv=[function(e,t,n,r){if(!e.return)switch(e.type){case"decl":e.return=lv(e.value,e.length);break;case"@keyframes":return uv([qm(Nm(e.value,"@","@"+Om),e,"")],r);case"rule":if(e.length)return function(e,t){return e.map(t).join("")}(e.props,(function(t){switch(function(e,t){return(e=t.exec(e))?e[0]:e}(t,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return uv([qm(Nm(t,/:(read-\w+)/,":-moz-$1"),e,"")],r);case"::placeholder":return uv([qm(Nm(t,/:(plac\w+)/,":-webkit-input-$1"),e,""),qm(Nm(t,/:(plac\w+)/,":-moz-$1"),e,""),qm(Nm(t,/:(plac\w+)/,Cm+"input-$1"),e,"")],r)}return""}))}}],wv=function(e){var t=e.key;if("css"===t){var n=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(n,(function(e){-1!==e.getAttribute("data-emotion").indexOf(" ")&&(document.head.appendChild(e),e.setAttribute("data-s",""))}))}var r,o,i=e.stylisPlugins||yv,s={},a=[];r=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+t+' "]'),(function(e){for(var t=e.getAttribute("data-emotion").split(" "),n=1;n<t.length;n++)s[t[n]]=!0;a.push(e)}));var c,l,u,f,d=[fv,(f=function(e){c.insert(e)},function(e){e.root||(e=e.return)&&f(e)})],p=(l=[vv,gv].concat(i,d),u=Rm(l),function(e,t,n,r){for(var o="",i=0;i<u;i++)o+=l[i](e,t,n,r)||"";return o});o=function(e,t,n,r){c=n,uv(ov(e?e+"{"+t.styles+"}":t.styles),p),r&&(h.inserted[t.name]=!0)};var h={key:t,sheet:new Sm({key:t,container:r,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend}),nonce:e.nonce,inserted:s,registered:{},insert:o};return h.sheet.hydrate(a),h};var bv={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},kv=/[A-Z]|^ms/g,xv=/_EMO_([^_]+?)_([^]*?)_EMO_/g,Sv=function(e){return 45===e.charCodeAt(1)},Cv=function(e){return null!=e&&"boolean"!=typeof e},Mv=dv((function(e){return Sv(e)?e:e.replace(kv,"-$&").toLowerCase()})),Ov=function(e,t){switch(e){case"animation":case"animationName":if("string"==typeof t)return t.replace(xv,(function(e,t,n){return Ev={name:t,styles:n,next:Ev},t}))}return 1===bv[e]||Sv(e)||"number"!=typeof t||0===t?t:t+"px"};function Av(e,t,n){if(null==n)return"";if(void 0!==n.__emotion_styles)return n;switch(typeof n){case"boolean":return"";case"object":if(1===n.anim)return Ev={name:n.name,styles:n.styles,next:Ev},n.name;if(void 0!==n.styles){var r=n.next;if(void 0!==r)for(;void 0!==r;)Ev={name:r.name,styles:r.styles,next:Ev},r=r.next;return n.styles+";"}return function(e,t,n){var r="";if(Array.isArray(n))for(var o=0;o<n.length;o++)r+=Av(e,t,n[o])+";";else for(var i in n){var s=n[i];if("object"!=typeof s)null!=t&&void 0!==t[s]?r+=i+"{"+t[s]+"}":Cv(s)&&(r+=Mv(i)+":"+Ov(i,s)+";");else if(!Array.isArray(s)||"string"!=typeof s[0]||null!=t&&void 0!==t[s[0]]){var a=Av(e,t,s);switch(i){case"animation":case"animationName":r+=Mv(i)+":"+a+";";break;default:r+=i+"{"+a+"}"}}else for(var c=0;c<s.length;c++)Cv(s[c])&&(r+=Mv(i)+":"+Ov(i,s[c])+";")}return r}(e,t,n);case"function":if(void 0!==e){var o=Ev,i=n(e);return Ev=o,Av(e,t,i)}}if(null==t)return n;var s=t[n];return void 0!==s?s:n}var Ev,Tv=/label:\s*([^\s;\n{]+)\s*(;|$)/g,Nv=function(e,t,n){if(1===e.length&&"object"==typeof e[0]&&null!==e[0]&&void 0!==e[0].styles)return e[0];var r=!0,o="";Ev=void 0;var i=e[0];null==i||void 0===i.raw?(r=!1,o+=Av(n,t,i)):o+=i[0];for(var s=1;s<e.length;s++)o+=Av(n,t,e[s]),r&&(o+=i[s]);Tv.lastIndex=0;for(var a,c="";null!==(a=Tv.exec(o));)c+="-"+a[1];return{name:function(e){for(var t,n=0,r=0,o=e.length;o>=4;++r,o-=4)t=1540483477*(65535&(t=255&e.charCodeAt(r)|(255&e.charCodeAt(++r))<<8|(255&e.charCodeAt(++r))<<16|(255&e.charCodeAt(++r))<<24))+(59797*(t>>>16)<<16),n=1540483477*(65535&(t^=t>>>24))+(59797*(t>>>16)<<16)^1540483477*(65535&n)+(59797*(n>>>16)<<16);switch(o){case 3:n^=(255&e.charCodeAt(r+2))<<16;case 2:n^=(255&e.charCodeAt(r+1))<<8;case 1:n=1540483477*(65535&(n^=255&e.charCodeAt(r)))+(59797*(n>>>16)<<16)}return(((n=1540483477*(65535&(n^=n>>>13))+(59797*(n>>>16)<<16))^n>>>15)>>>0).toString(36)}(o)+c,styles:o,next:Ev}};function Dv(e,t,n){var r="";return n.split(" ").forEach((function(n){void 0!==e[n]?t.push(e[n]+";"):r+=n+" "})),r}var zv=function(e,t,n){var r=e.key+"-"+t.name;if(!1===n&&void 0===e.registered[r]&&(e.registered[r]=t.styles),void 0===e.inserted[t.name]){var o=t;do{e.insert(t===o?"."+r:"",o,e.sheet,!0),o=o.next}while(void 0!==o)}};function Iv(e,t){if(void 0===e.inserted[t.name])return e.insert("",t,e.sheet,!0)}function $v(e,t,n){var r=[],o=Dv(e,r,n);return r.length<2?n:o+t(r)}var Rv=function e(t){for(var n="",r=0;r<t.length;r++){var o=t[r];if(null!=o){var i=void 0;switch(typeof o){case"boolean":break;case"object":if(Array.isArray(o))i=e(o);else for(var s in i="",o)o[s]&&s&&(i&&(i+=" "),i+=s);break;default:i=o}i&&(n&&(n+=" "),n+=i)}}return n},Fv=function(e){var t=wv(e);t.sheet.speedy=function(e){this.isSpeedy=e},t.compat=!0;var n=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var o=Nv(n,t.registered,void 0);return zv(t,o,!1),t.key+"-"+o.name};return{css:n,cx:function(){for(var e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];return $v(t.registered,n,Rv(r))},injectGlobal:function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var o=Nv(n,t.registered);Iv(t,o)},keyframes:function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var o=Nv(n,t.registered),i="animation-"+o.name;return Iv(t,{name:o.name,styles:"@keyframes "+i+"{"+o.styles+"}"}),i},hydrate:function(e){e.forEach((function(e){t.inserted[e]=!0}))},flush:function(){t.registered={},t.inserted={},t.sheet.flush()},sheet:t.sheet,cache:t,getRegisteredStyles:Dv.bind(null,t.registered),merge:$v.bind(null,t.registered,n)}}({key:"css"}),Pv=Fv.injectGlobal,_v=Fv.css;const Bv={typography:"",code:""},jv={radius:"0",lineWidth:"1px"},Lv={scrollbar:()=>"",shadow:()=>"",border:()=>""},Vv={icon:e=>{const t=document.createElement("div");return t.className="milkdown-icon",t.textContent=e,t}},Wv=e=>{if(e.startsWith("rgba"))return e.slice(5,-1).split(",").slice(0,-1).join(",");if(e.startsWith("rgb"))return e.slice(4,-1);const t=(e=>{const t=e.slice(1).replace(/^([a-f\d])([a-f\d])([a-f\d])$/i,((e,t,n,r)=>t+t+n+n+r+r)),[n,r,o,i]=t.match(/^([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i)||[];return n?[r,o,i].map((e=>parseInt(e,16))):null})(e);return t?t.join(", "):(console.warn(`Invalid hex: ${e}`),e)},qv=(e={},t=(e=>`${e}`))=>Object.entries(e).map((([e,n])=>`--${e}: ${t(n)};`)).join("\n"),Hv=(e={})=>qv(e,Wv),Jv=e=>{const{color:t={},font:n,size:r={}}=e,{light:o,dark:i}=t,s=
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}(t,["light","dark"]);Pv`
        :root {
            ${Hv(o)};
            ${Hv(s)};
            ${qv(n,(e=>e.join(", ")))};
            ${qv(r)};
        }
        [data-theme='dark'] {
            ${Hv(i)}
        }
    `},Kv=Ve({mixin:{},font:{},size:{},slots:{},palette:()=>""},"ThemeTool"),Uv=e=>t=>(t.inject(Kv),t=>{Jv(e);const n=(e=>{const{font:t,size:n={},mixin:r,slots:o,global:i}=e,s=(e={})=>Object.fromEntries(Object.keys(e).map((e=>[e,`var(--${e})`]))),a={palette:(e,t=1)=>`rgba(var(--${e}), ${t})`,size:Object.assign(Object.assign({},jv),s(n)),font:Object.assign(Object.assign({},Bv),s(t))},c=Object.assign(Object.assign({},Lv),null==r?void 0:r(a)),l=Object.assign(Object.assign({},a),{mixin:c}),u=Object.assign(Object.assign({},Vv),null==o?void 0:o(l)),f=Object.assign(Object.assign({},l),{slots:u});return null==i||i(f),f})(e);t.set(Kv,n)});var Gv,Qv,Xv,Zv,Yv,eg,tg,ng,rg;class og{constructor(e,t){Gv.set(this,void 0),Qv.set(this,void 0),this.inject=(e,t)=>(e(qe(this,Gv,"f").sliceMap,t),this),this.record=e=>(e(qe(this,Qv,"f").store),this),He(this,Gv,e,"f"),He(this,Qv,t,"f")}}Gv=new WeakMap,Qv=new WeakMap;class ig{constructor(){Xv.set(this,k()),Zv.set(this,Ge()),Yv.set(this,new Set),eg.set(this,[]),tg.set(this,new Ue(qe(this,Xv,"f"),qe(this,Zv,"f"))),ng.set(this,new og(qe(this,Xv,"f"),qe(this,Zv,"f"))),rg.set(this,(()=>{const e=[Ah,Dh,Yh,um,xm,ji,Fi,sm,vm],t=(n=e=>We(this,void 0,void 0,(function*(){yield Promise.all(qe(this,eg,"f").map((t=>t(e))))})),e=>(e.record(ph),e=>We(void 0,void 0,void 0,(function*(){yield n(e),e.done(ph)}))));var n,r;this.use(e.concat((r=this,e=>(e.inject(bh,r).inject(hh).inject(vh).inject(kh,dh()).inject(wh,[ph]).record(yh),e=>We(void 0,void 0,void 0,(function*(){yield e.waitTimers(wh);const t=e.get(kh),n=e.get(vh).reduce(((e,t)=>e.use(t)),t);e.set(kh,n),e.done(yh)}))))).concat(t))})),this.use=e=>([e].flat().forEach((e=>{qe(this,Yv,"f").add(e(qe(this,ng,"f")))})),this),this.config=e=>(qe(this,eg,"f").push(e),this),this.create=()=>We(this,void 0,void 0,(function*(){return qe(this,rg,"f").call(this),yield Promise.all([...qe(this,Yv,"f")].map((e=>e(qe(this,tg,"f"))))),this})),this.action=e=>e(qe(this,tg,"f"))}static make(){return new ig}}Xv=new WeakMap,Zv=new WeakMap,Yv=new WeakMap,eg=new WeakMap,tg=new WeakMap,ng=new WeakMap,rg=new WeakMap;const sg=e=>Object.prototype.hasOwnProperty.call(e,"origin");class ag extends Array{configure(e,t){const n=this.findIndex((t=>sg(t)&&t.origin===e));return n<0||this.splice(n,1,e(t)),this}replace(e,t){const n=this.findIndex((t=>sg(t)&&t.origin===e));return n<0||this.splice(n,1,t),this}remove(e){const t=this.findIndex((t=>sg(t)&&t.origin===e));return t<0||this.splice(t,1),this}headless(){return this.filter(sg).forEach((e=>{this.configure(e.origin,{headless:!0})})),this}static create(e){return new ag(...e)}}const cg=(e,t,n)=>{try{const o=t.get(Kv),i={ctx:t,getClassName:(r=null==n?void 0:n.className,(e,...t)=>{var n;const o=null!==(n=null==r?void 0:r(e))&&void 0!==n?n:t;return Array.isArray(o)?o.filter((e=>e)).join(" "):o}),getStyle:e=>(null==n?void 0:n.headless)?"":e(o)};return e(n,i)}catch(o){throw new Error("It seems that no theme found in editor, please make sure you have use theme in front of all plugins.\nIf you prefer to use an empty theme, you can use `themeFactory({})`.")}var r},lg=(e,t,n)=>{var r;return null!==(r=null==n?void 0:n[e])&&void 0!==r?r:t},ug=(e,t,n)=>e.flatMap(((e,t)=>([n,{defaultKey:r,commandKey:o,args:i}])=>[lg(n,r,t)].flat().map((t=>[t,e(o)(i)])))(t,n)),fg=(e,t)=>e?(n,r,o)=>Object.fromEntries(ug((e=>Object.entries(e).filter((e=>!!e)))(e),o,t)):()=>({}),dg=e=>{const t=n=>{const r=(o=t=>{var o;const i=cg(e,t,n),s=null!==(o=null==n?void 0:n.view)&&void 0!==o?o:i.view,a=fg(i.shortcuts,null==n?void 0:n.keymap);return r.id=i.id,Object.assign(Object.assign({},i),{view:s,keymap:a})},()=>e=>{const t="function"==typeof o?o(e):o;e.update(Mh,(e=>e.concat(t)))});var o;return r.origin=t,r};return t},pg=e=>{const t=n=>{const r=(o=t=>{var o;const i=cg(e,t,n),s=null!==(o=null==n?void 0:n.view)&&void 0!==o?o:i.view,a=fg(i.shortcuts,null==n?void 0:n.keymap);return r.id=i.id,Object.assign(Object.assign({},i),{view:s,keymap:a})},()=>e=>{const t="function"==typeof o?o(e):o;e.update(Ch,(e=>e.concat(t)))});var o;return r.origin=t,r};return t},hg=e=>{const t=n=>{const r=mh((t=>{const o=cg(e,t,n);return r.id=o.id,o.plugin}));return r.origin=t,r};return t},mg=(e,t,n)=>({commandKey:e,defaultKey:t,args:n});function vg(e,t){return new pi(e,((e,n,r,o)=>{const{tr:i}=e,s=n.length;let a=r,c=o;if(n[s-1]){const l=n[0],u=n[s-1],f=n[s-2],d=r+l.indexOf(f),p=d+f.length-1,h=d+f.lastIndexOf(u),m=h+u.length;if(function(e,t,n){let r=[];return n.doc.nodesBetween(e,t,((e,t)=>{r=[...r,...e.marks.map((n=>({start:t,end:t+e.nodeSize,mark:n})))]})),r}(r,o,e).filter((e=>e.mark.type.excludes(t))).filter((e=>e.end>d)).length)return null;m<p&&i.delete(m,p),h>d&&i.delete(d,h),a=d,c=a+u.length}return i.addMark(a,c,t.create()),i.removeStoredMark(t),i}))}const gg=(e,t,n)=>{var r;const o=e.state,{from:i}=o.selection,s=e.domAtPos(i).node;if(!(s instanceof HTMLElement))throw new Error;const a=s.getBoundingClientRect(),c=t.getBoundingClientRect(),l=null===(r=t.parentElement)||void 0===r?void 0:r.getBoundingClientRect();if(!l)throw new Error;const[u,f]=n(a,c,l);t.style.top=u+"px",t.style.left=f+"px"},yg=(e,t,n)=>{var r;const o=e.state,{from:i,to:s}=o.selection,a=e.coordsAtPos(i),c=e.coordsAtPos(s),l=t.getBoundingClientRect(),u=null===(r=t.parentElement)||void 0===r?void 0:r.getBoundingClientRect();if(!u)throw new Error;const[f,d]=n(a,c,l,u);t.style.top=f+"px",t.style.left=d+"px"},wg=e=>Object.assign(Object.create(e),e).setTime(Date.now()),bg=e=>t=>(e=>t=>{for(let n=t.depth;n>0;n--){const r=t.node(n);if(e(r))return{pos:n>0?t.before(n):0,start:t.start(n),depth:n,node:r}}})(e)(t.$from),kg=(e,t)=>{if(!(e instanceof Pt))return;const{node:n,$from:r}=e;return((e,t)=>Array.isArray(e)&&e.indexOf(t.type)>-1||t.type===e)(t,n)?{node:n,pos:r.pos,start:r.start(r.depth),depth:r.depth}:void 0},xg={HardBreak:"HardBreak",Blockquote:"Blockquote",BulletList:"BulletList",OrderedList:"OrderedList",CodeFence:"CodeFence",H1:"H1",H2:"H2",H3:"H3",H4:"H4",H5:"H5",H6:"H6",Text:"Text",CodeInline:"CodeInline",Em:"Em",Bold:"Bold",NextListItem:"NextListItem",SinkListItem:"SinkListItem",LiftListItem:"LiftListItem"},Sg=wm(),Cg=dg(((e,t)=>{const n=t.getStyle((({palette:e,size:t,font:n})=>_v`
                background-color: ${e("neutral")};
                color: ${e("background")};
                border-radius: ${t.radius};
                font-weight: 500;
                font-family: ${n.code};
                padding: 0 0.2rem;
            `));return{id:"code_inline",schema:{excludes:"_",parseDOM:[{tag:"code"}],toDOM:e=>["code",{class:t.getClassName(e.attrs,"code-inline",n)}]},parser:{match:e=>"inlineCode"===e.type,runner:(e,t,n)=>{e.openMark(n),e.addText(t.value),e.closeMark(n)}},serializer:{match:e=>"code_inline"===e.type.name,runner:(e,t,n)=>(e.addNode("inlineCode",void 0,n.text||""),!0)},inputRules:e=>[vg(/(?:^|[^`])(`([^`]+)`)$/,e)],commands:e=>[gm(Sg,(()=>ii(e)))],shortcuts:{[xg.CodeInline]:mg(Sg,"Mod-e")}}})),Mg=wm(),Og=dg(((e,t)=>({id:"em",schema:{parseDOM:[{tag:"i"},{tag:"em"},{style:"font-style",getAttrs:e=>"italic"===e}],toDOM:e=>["em",{class:t.getClassName(e.attrs,"em")}]},parser:{match:e=>"emphasis"===e.type,runner:(e,t,n)=>{e.openMark(n),e.next(t.children),e.closeMark(n)}},serializer:{match:e=>"em"===e.type.name,runner:(e,t)=>{e.withMark(t,"emphasis")}},inputRules:e=>[vg(/(?:^|[^_])(_([^_]+)_)$/,e),vg(/(?:^|[^*])(\*([^*]+)\*)$/,e)],commands:e=>[gm(Mg,(()=>ii(e)))],shortcuts:{[xg.Em]:mg(Mg,"Mod-i")}}))),Ag=wm(),Eg=wm(),Tg=dg(((e,t)=>{const n=t.getStyle((e=>{const t=e.palette("line");return _v`
            color: ${e.palette("secondary")};
            cursor: pointer;
            transition: all 0.4s ease-in-out;
            font-weight: 500;
            &:hover {
                background-color: ${t};
                box-shadow: 0 0.2rem ${t}, 0 -0.2rem ${t};
            }
        `}));return{id:"link",schema:{attrs:{href:{},title:{default:null}},inclusive:!1,parseDOM:[{tag:"a[href]",getAttrs:e=>{if(!(e instanceof HTMLElement))throw new Error;return{href:e.getAttribute("href"),title:e.getAttribute("title")}}}],toDOM:e=>["a",Object.assign(Object.assign({},e.attrs),{class:t.getClassName(e.attrs,"link",n)})]},parser:{match:e=>"link"===e.type,runner:(e,t,n)=>{const r=t.url,o=t.title;e.openMark(n,{href:r,title:o}),e.next(t.children),e.closeMark(n)}},serializer:{match:e=>"link"===e.type.name,runner:(e,t)=>{e.withMark(t,"link",void 0,{title:t.attrs.title,url:t.attrs.href})}},commands:e=>[gm(Ag,((t="")=>ii(e,{href:t}))),gm(Eg,((t="")=>(n,r)=>{if(!r)return!1;const{marks:o}=n.schema;let i,s=-1;const{selection:a}=n;if(n.doc.nodesBetween(a.from,a.to,((e,t)=>{if(o.link.isInSet(e.marks))return i=e,s=t,!1})),!i)return!1;const c=i.marks.find((({type:t})=>t===e));if(!c)return!1;const l=s,u=s+i.nodeSize,{tr:f}=n,d=o.link.create(Object.assign(Object.assign({},c.attrs),{href:t}));return r(f.removeMark(l,u,c).addMark(l,u,d).setSelection(new Rt(f.selection.$anchor)).scrollIntoView()),!0}))],inputRules:(e,t)=>[new pi(/\[(?<text>.*?)]\((?<href>.*?)(?=|\))"?(?<title>[^"]+)?"?\)/,((n,r,o,i)=>{const[s,a="",c,l]=r,{tr:u}=n;if(s){const n=a||"link";u.replaceWith(o,i,t.text(n)).addMark(o,n.length+o,e.create({title:l,href:c}))}return u}))]}})),Ng=wm(),Dg=dg(((e,t)=>{const n=t.getStyle((()=>_v`
                font-weight: 600;
            `));return{id:"strong",schema:{parseDOM:[{tag:"b"},{tag:"strong"},{style:"font-style",getAttrs:e=>"bold"===e}],toDOM:e=>["strong",{class:t.getClassName(e.attrs,"strong",n)}]},parser:{match:e=>"strong"===e.type,runner:(e,t,n)=>{e.openMark(n),e.next(t.children),e.closeMark(n)}},serializer:{match:e=>"strong"===e.type.name,runner:(e,t)=>{e.withMark(t,"strong")}},inputRules:e=>[vg(/(?:__)([^_]+)(?:__)$/,e),vg(/(?:\*\*)([^*]+)(?:\*\*)$/,e)],commands:e=>[gm(Ng,(()=>ii(e)))],shortcuts:{[xg.Bold]:mg(Ng,"Mod-b")}}})),zg=[Cg(),Og(),Dg(),Tg()],Ig="blockquote",$g=wm(),Rg=pg(((e,t)=>{const n=t.getStyle((e=>_v`
                padding-left: 1.875rem;
                line-height: 1.75rem;
                border-left: 4px solid ${e.palette("primary")};
                * {
                    font-size: 1rem;
                    line-height: 1.5rem;
                }
            `));return{id:Ig,schema:{content:"block+",group:"block",defining:!0,parseDOM:[{tag:"blockquote"}],toDOM:e=>["blockquote",{class:t.getClassName(e.attrs,Ig,n)},0]},parser:{match:({type:e})=>e===Ig,runner:(e,t,n)=>{e.openNode(n).next(t.children).closeNode()}},serializer:{match:e=>e.type.name===Ig,runner:(e,t)=>{e.openNode("blockquote").next(t.content).closeNode()}},inputRules:e=>[vi(/^\s*>\s$/,e)],commands:e=>[gm($g,(()=>ri(e)))],shortcuts:{[xg.Blockquote]:mg($g,"Mod-Shift-b")}}})),Fg=wm(),Pg=pg(((e,t)=>({id:"bullet_list",schema:{content:"listItem+",group:"block",parseDOM:[{tag:"ul"}],toDOM:e=>["ul",{class:t.getClassName(e.attrs,"bullet-list")},0]},parser:{match:({type:e,ordered:t})=>"list"===e&&!t,runner:(e,t,n)=>{e.openNode(n).next(t.children).closeNode()}},serializer:{match:e=>"bullet_list"===e.type.name,runner:(e,t)=>{e.openNode("list",void 0,{ordered:!1}).next(t.content).closeNode()}},inputRules:e=>[vi(/^\s*([-+*])\s$/,e)],commands:e=>[gm(Fg,(()=>ri(e)))],shortcuts:{[xg.BulletList]:mg(Fg,"Mod-Shift-8")}}))),_g=["","javascript","typescript","bash","sql","json","html","css","c","cpp","java","ruby","python","go","rust","markdown"],Bg=/^```(?<language>[a-z]*)? $/,jg=wm(),Lg=pg(((e,t)=>{const n=t.getStyle((({palette:e,mixin:t,size:n,font:r})=>{const{shadow:o,scrollbar:i,border:s}=t,{lineWidth:a,radius:c}=n;return _v`
            background-color: ${e("background")};
            color: ${e("neutral")};
            font-size: 0.85rem;
            padding: 1.2rem 0.4rem 1.4rem;
            border-radius: ${c};
            font-family: ${r.typography};

            * {
                margin: 0;
            }

            .code-fence_select-wrapper {
                position: relative;
            }

            .code-fence_value {
                width: 10.25rem;
                box-sizing: border-box;
                border-radius: ${n.radius};
                margin: 0 1.2rem 1.2rem;
                ${s()};
                ${o()};
                cursor: pointer;
                background-color: ${e("surface")};
                position: relative;
                display: flex;
                color: ${e("neutral",.87)};
                letter-spacing: 0.5px;
                height: 2.625rem;
                align-items: center;

                & > *:last-child {
                    width: 2.625rem;
                    height: 100%;
                    display: flex;
                    justify-content: center;
                    align-items: center;
                    color: ${e("solid",.87)};
                    border-left: ${a} solid ${e("line")};

                    text-align: center;
                    transition: all 0.2s ease-in-out;
                    &:hover {
                        background: ${e("background")};
                        color: ${e("primary")};
                    }
                }

                > span:first-child {
                    padding-left: 1rem;
                    flex: 1;
                    font-weight: 500;
                }
            }

            .code-fence_select-option {
                list-style: none;
                line-height: 2rem;
                padding-left: 1rem;
                cursor: pointer;
                :hover {
                    background: ${e("secondary",.12)};
                    color: ${e("primary")};
                }
            }

            .code-fence_select {
                &[data-fold='true'] {
                    display: none;
                }

                font-weight: 500;
                position: absolute;
                z-index: 1;
                top: 2.625rem;
                box-sizing: border-box;
                left: 1.2rem;
                padding: 0.5rem 0;
                max-height: 16.75rem;
                width: 10.25rem;
                ${s()};
                ${o()};
                background-color: ${e("surface")};
                border-top: none;
                overflow-y: auto;
                display: flex;
                flex-direction: column;

                ${i("y")}
            }

            code {
                line-height: 1.5;
            }

            pre {
                font-family: var(--font-code);
                margin: 0 1.2rem !important;
                overflow-x: scroll;
                white-space: pre !important;

                padding-bottom: 1.4rem;

                ${i("x")}
            }
        `}));return{id:"fence",schema:{content:"text*",group:"block",marks:"",defining:!0,code:!0,attrs:{language:{default:""},fold:{default:!0}},parseDOM:[{tag:"pre",preserveWhitespace:"full",getAttrs:e=>{if(!(e instanceof HTMLElement))throw new Error("Parse DOM error.");return{language:e.dataset.language}}}],toDOM:e=>["div",{"data-language":e.attrs.language,class:t.getClassName(e.attrs,"code-fence",n)},["pre",["code",{spellCheck:"false"},0]]]},parser:{match:({type:e})=>"code"===e,runner:(e,t,n)=>{const r=t.lang,o=t.value;e.openNode(n,{language:r}),e.addText(o),e.closeNode()}},serializer:{match:e=>"fence"===e.type.name,runner:(e,t)=>{var n;e.addNode("code",void 0,(null===(n=t.content.firstChild)||void 0===n?void 0:n.text)||"",{lang:t.attrs.language})}},inputRules:e=>[gi(Bg,e,(([e,t])=>{if(e)return{language:t}}))],commands:e=>[gm(jg,(()=>oi(e)))],shortcuts:{[xg.CodeFence]:mg(jg,"Mod-Alt-c")},view:(r,o,i,s,a,c)=>{if(null==e?void 0:e.view)return e.view(r,o,i,s,a,c);const l=document.createElement("div"),u=document.createElement("div"),f=document.createElement("ul"),d=document.createElement("pre"),p=document.createElement("code"),h=document.createElement("div");h.className="code-fence_value";const m=document.createElement("span");return h.appendChild(m),h.appendChild(t.ctx.get(Kv).slots.icon("downArrow")),f.className="code-fence_select",f.addEventListener("mousedown",(e=>{if(e.preventDefault(),e.stopPropagation(),!s.editable)return;const t=e.target;if(!(t instanceof HTMLLIElement))return;const{tr:n}=s.state;s.dispatch(n.setNodeMarkup(a(),void 0,{fold:!0,language:t.dataset.value}))})),h.addEventListener("mousedown",(e=>{if(e.preventDefault(),e.stopPropagation(),!s.editable)return;const{tr:t}=s.state;s.dispatch(t.setNodeMarkup(a(),void 0,{fold:!1,language:l.dataset.language}))})),document.addEventListener("mousedown",(()=>{if(!s.editable||"true"===f.dataset.fold)return;const{tr:e}=s.state;s.dispatch(e.setNodeMarkup(a(),void 0,{fold:!0,language:l.dataset.language}))})),((null==e?void 0:e.languageList)||_g).forEach((e=>{const t=document.createElement("li");t.className="code-fence_select-option",t.innerText=e||"--",f.appendChild(t),t.setAttribute("data-value",e)})),p.spellcheck=!1,u.className="code-fence_select-wrapper",u.contentEditable="false",u.append(h),u.append(f),d.append(p),l.append(u,d),l.setAttribute("class",t.getClassName(i.attrs,"code-fence",n)),l.setAttribute("data-language",i.attrs.language),m.innerText=i.attrs.language||"--",f.setAttribute("data-fold",i.attrs.fold?"true":"false"),{dom:l,contentDOM:p,update:e=>{if("fence"!==e.type.name)return!1;const t=e.attrs.language;return l.dataset.language=t,m.innerText=t||"--",f.setAttribute("data-fold",e.attrs.fold?"true":"false"),!0}}}}})),Vg=pg((()=>({id:"doc",schema:{content:"block+"},parser:{match:({type:e})=>"root"===e,runner:(e,t,n)=>{e.injectRoot(t,n)}},serializer:{match:e=>"doc"===e.type.name,runner:(e,t)=>{e.openNode("root"),e.next(t.content)}}}))),Wg="hardbreak",qg=wm(),Hg=pg(((e,t)=>({id:Wg,schema:{inline:!0,group:"inline",selectable:!1,parseDOM:[{tag:"br"}],toDOM:e=>["br",{class:t.getClassName(e.attrs,Wg)}]},parser:{match:({type:e})=>"break"===e,runner:(e,t,n)=>{e.addNode(n)}},serializer:{match:e=>e.type.name===Wg,runner:e=>{e.addNode("break")}},commands:e=>[gm(qg,(()=>(t,n)=>(null==n||n(t.tr.replaceSelectionWith(e.create()).scrollIntoView()),!0)))],shortcuts:{[xg.HardBreak]:mg(qg,"Shift-Enter")}}))),Jg=Array(5).fill(0).map(((e,t)=>t+1)),Kg=wm(),Ug=pg(((e,t)=>{const n={1:_v`
            font-size: 3rem;
            line-height: 3.5rem;
        `,2:_v`
            font-size: 2.125rem;
            line-height: 2.25rem;
        `,3:_v`
            font-size: 1.5rem;
            line-height: 1.5rem;
        `};return{id:"heading",schema:{content:"inline*",group:"block",attrs:{level:{default:1}},parseDOM:Jg.map((e=>({tag:`h${e}`,attrs:{level:e}}))),toDOM:r=>{return[`h${r.attrs.level}`,{class:t.getClassName(r.attrs,`heading h${r.attrs.level}`,(o=r.attrs.level,(null==e?void 0:e.headless)?null:_v`
                  ${n[o]||""}
                  margin: 2.5rem 0 !important;
                  font-weight: 400;
              `))},0];var o}},parser:{match:({type:e})=>"heading"===e,runner:(e,t,n)=>{const r=t.depth;e.openNode(n,{level:r}),e.next(t.children),e.closeNode()}},serializer:{match:e=>"heading"===e.type.name,runner:(e,t)=>{e.openNode("heading",void 0,{depth:t.attrs.level}),e.next(t.content),e.closeNode()}},inputRules:e=>Jg.map((t=>gi(new RegExp(`^(#{1,${t}})\\s$`),e,(()=>({level:t}))))),commands:e=>[gm(Kg,((t=1)=>oi(e,{level:t})))],shortcuts:{[xg.H1]:mg(Kg,"Mod-Alt-1",1),[xg.H2]:mg(Kg,"Mod-Alt-2",2),[xg.H3]:mg(Kg,"Mod-Alt-3",3),[xg.H4]:mg(Kg,"Mod-Alt-4",4),[xg.H5]:mg(Kg,"Mod-Alt-5",5),[xg.H6]:mg(Kg,"Mod-Alt-6",6)}}})),Gg=wm(),Qg=pg(((e,t)=>{const n=t.getStyle((e=>_v`
            height: ${e.size.lineWidth};
            background-color: ${e.palette("line")};
            border-width: 0;
        `));return{id:"hr",schema:{group:"block",parseDOM:[{tag:"hr"}],toDOM:e=>["hr",{class:t.getClassName(e.attrs,"hr",n)}]},parser:{match:({type:e})=>"thematicBreak"===e,runner:(e,t,n)=>{e.addNode(n)}},serializer:{match:e=>"hr"===e.type.name,runner:e=>{e.addNode("thematicBreak")}},inputRules:e=>[new pi(/^(?:---|___\s|\*\*\*\s)$/,((t,n,r,o)=>{const{tr:i}=t;return n[0]&&i.replaceWith(r,o,e.create({})),i}))],commands:(e,t)=>[gm(Gg,(()=>(n,r)=>{if(!r)return!0;const{tr:o,selection:i}=n,s=i.from,a=e.create();if(!a)return!0;const c=o.replaceSelectionWith(a).insert(s,t.node("paragraph")),l=zt.findFrom(c.doc.resolve(s),1,!0);return!l||(r(c.setSelection(l).scrollIntoView()),!0)}))]}})),Xg=wm(),Zg=wm(),Yg="image",ey=pg(((e,t)=>{var n,r;const o=Object.assign({loading:"Loading...",empty:"Add an Image",failed:"Image loads failed"},null!==(n=null==e?void 0:e.placeholder)&&void 0!==n?n:{}),i=null!==(r=null==e?void 0:e.isBlock)&&void 0!==r&&r,s=t.getStyle((e=>_v`
                display: inline-block;
                position: relative;
                text-align: center;
                font-size: 0;
                vertical-align: text-bottom;
                ${i?"\n                width: 100%;\n                margin: 0 auto;\n                ":""}
                img {
                    max-width: 100%;
                    height: auto;
                    object-fit: contain;
                    margin: 0 2px;
                }
                .icon,
                .placeholder {
                    display: none;
                }

                &.system {
                    width: 100%;
                    padding: 0 2rem;

                    img {
                        width: 0;
                        height: 0;
                        display: none;
                    }

                    .icon,
                    .placeholder {
                        display: inline;
                    }

                    box-sizing: border-box;
                    height: 3rem;
                    background-color: ${e.palette("background")};
                    border-radius: ${e.size.radius};
                    display: inline-flex;
                    gap: 2rem;
                    justify-content: flex-start;
                    align-items: center;
                    .placeholder {
                        margin: 0;
                        line-height: 1;
                        &::before {
                            content: '';
                            font-size: 0.875rem;
                            color: ${e.palette("neutral",.6)};
                        }
                    }
                }

                &.loading {
                    .placeholder {
                        &::before {
                            content: '${o.loading}';
                        }
                    }
                }

                &.empty {
                    .placeholder {
                        &::before {
                            content: '${o.empty}';
                        }
                    }
                }

                &.failed {
                    .placeholder {
                        &::before {
                            content: '${o.failed}';
                        }
                    }
                }
            `)),a=t.getStyle((()=>_v`
                display: inline-block;
                margin: 0 auto;
                object-fit: contain;
                width: 100%;
                position: relative;
                height: auto;
                text-align: center;
            `));return{id:Yg,schema:{inline:!0,group:"inline",draggable:!0,marks:"",atom:!0,defining:!0,isolating:!0,attrs:{src:{default:""},alt:{default:null},title:{default:null},failed:{default:!1},loading:{default:!0},width:{default:0}},parseDOM:[{tag:"img[src]",getAttrs:e=>{if(!(e instanceof HTMLElement))throw new Error;return{failed:e.classList.contains("failed"),loading:e.classList.contains("loading"),src:e.getAttribute("src")||"",alt:e.getAttribute("alt"),title:e.getAttribute("title")||e.getAttribute("alt"),width:e.getAttribute("width")||0}}}],toDOM:e=>["img",Object.assign(Object.assign({},e.attrs),{class:t.getClassName(e.attrs,Yg,e.attrs.failed?"failed":"",e.attrs.loading?"loading":"",a)})]},parser:{match:({type:e})=>e===Yg,runner:(e,t,n)=>{const r=t.url,o=t.alt,i=t.title;e.addNode(n,{src:r,alt:o,title:i})}},serializer:{match:e=>e.type.name===Yg,runner:(e,t)=>{e.addNode("image",void 0,void 0,{title:t.attrs.title,url:t.attrs.src,alt:t.attrs.alt})}},commands:e=>[gm(Zg,((t="")=>(n,r)=>{if(!r)return!0;const{tr:o}=n,i=e.create({src:t});if(!i)return!0;return r(o.replaceSelectionWith(i).scrollIntoView()),!0})),gm(Xg,((t="")=>(n,r)=>{const o=kg(n.selection,e);if(!o)return!1;const{tr:i}=n;return null==r||r(i.setNodeMarkup(o.pos,void 0,Object.assign(Object.assign({},o.node.attrs),{loading:!0,src:t})).scrollIntoView()),!0}))],inputRules:e=>[new pi(/!\[(?<alt>.*?)]\((?<filename>.*?)\s*(?="|\))"?(?<title>[^"]+)?"?\)/,((t,n,r,o)=>{const[i,s,a="",c]=n,{tr:l}=t;return i&&l.replaceWith(r,o,e.create({src:a,alt:s,title:c})),l}))],view:(e,n,r,o,i)=>{const a=t.ctx.get(Kv).slots.icon,c=document.createElement("span");c.className=t.getClassName(r.attrs,Yg,s),c.contentEditable="false";const l=document.createElement("img");l.contentEditable="true",c.append(l);let u=a("image");const f=document.createElement("span");f.classList.add("placeholder"),c.append(u,f);const d=e=>{const t=a(e);c.replaceChild(t,u),u=t},p=e=>{c.classList.add("system","loading"),d("loading");const t=document.createElement("img");t.src=e,t.onerror=()=>{const{tr:t}=o.state,s=t.setNodeMarkup(i(),n,Object.assign(Object.assign({},r.attrs),{src:e,loading:!1,failed:!0}));o.dispatch(s)},t.onload=()=>{const{tr:s}=o.state,a=s.setNodeMarkup(i(),n,Object.assign(Object.assign({},r.attrs),{width:t.width,src:e,loading:!1,failed:!1}));o.dispatch(a)}},{src:h,loading:m,title:v,alt:g,width:y}=r.attrs;return l.src=h,l.title=v||g,l.alt=g,l.width=y,0===h.length?(c.classList.add("system","empty"),d("image")):m&&p(h),{dom:c,update:e=>{if(e.type.name!==Yg)return!1;const{src:t,alt:n,title:r,loading:o,failed:i,width:s}=e.attrs;return l.src=t,l.alt=n,l.title=r||n,l.width=s,o?(p(t),!0):i?(c.classList.remove("loading","empty"),c.classList.add("system","failed"),d("brokenImage"),!0):t.length>0?(c.classList.remove("system","empty","loading"),!0):(c.classList.add("system","empty"),d("image"),!0)}}}}}));function ty(e){return function(t,n){var r=t.selection,o=r.$from,i=r.$to,s=r.node;if(s&&s.isBlock||o.depth<2||!o.sameParent(i))return!1;var a=o.node(-1);if(a.type!=e)return!1;if(0==o.parent.content.size&&o.node(-1).childCount==o.indexAfter(-1)){if(2==o.depth||o.node(-3).type!=e||o.index(-2)!=o.node(-2).childCount-1)return!1;if(n){for(var c=O.empty,l=o.index(-1)?1:o.index(-2)?2:3,u=o.depth-l;u>=o.depth-3;u--)c=O.from(o.node(u).copy(c));var f=o.indexAfter(-1)<o.node(-2).childCount?1:o.indexAfter(-2)<o.node(-3).childCount?2:3;c=c.append(O.from(e.createAndFill()));var d=o.before(o.depth-(l-1)),p=t.tr.replace(d,o.after(-f),new I(c,4-l,0)),h=-1;p.doc.nodesBetween(d,p.doc.content.size,(function(e,t){if(h>-1)return!1;e.isTextblock&&0==e.content.size&&(h=t+1)})),h>-1&&p.setSelection(t.selection.constructor.near(p.doc.resolve(h))),n(p.scrollIntoView())}return!0}var m=i.pos==o.end()?a.contentMatchAt(0).defaultType:null,v=t.tr.delete(o.pos,i.pos),g=m&&[null,{type:m}];return!!vt(v.doc,o.pos,2,g)&&(n&&n(v.split(o.pos,2,g).scrollIntoView()),!0)}}function ny(e){return function(t,n){var r=t.selection,o=r.$from,i=r.$to,s=o.blockRange(i,(function(t){return t.childCount&&t.firstChild.type==e}));return!!s&&(!n||(o.node(s.depth-1).type==e?function(e,t,n,r){var o=e.tr,i=r.end,s=r.$to.end(r.depth);i<s&&(o.step(new ut(i-1,s,i,s,new I(O.from(n.create(null,r.parent.copy())),1,0),1,!0)),r=new X(o.doc.resolve(r.$from.pos),o.doc.resolve(s),r.depth));return t(o.lift(r,pt(r)).scrollIntoView()),!0}(t,n,e,s):function(e,t,n){for(var r=e.tr,o=n.parent,i=n.end,s=n.endIndex-1,a=n.startIndex;s>a;s--)i-=o.child(s).nodeSize,r.delete(i-1,i+1);var c=r.doc.resolve(n.start),l=c.nodeAfter;if(r.mapping.map(n.end)!=n.start+c.nodeAfter.nodeSize)return!1;var u=0==n.startIndex,f=n.endIndex==o.childCount,d=c.node(-1),p=c.index(-1);if(!d.canReplace(p+(u?0:1),p+1,l.content.append(f?O.empty:O.from(o))))return!1;var h=c.pos,m=h+l.nodeSize;return r.step(new ut(h-(u?1:0),m+(f?1:0),h+1,m-1,new I((u?O.empty:O.from(o.copy(O.empty))).append(f?O.empty:O.from(o.copy(O.empty))),u?0:1,f?0:1),u?0:1)),t(r.scrollIntoView()),!0}(t,n,s)))}}function ry(e){return function(t,n){var r=t.selection,o=r.$from,i=r.$to,s=o.blockRange(i,(function(t){return t.childCount&&t.firstChild.type==e}));if(!s)return!1;var a=s.startIndex;if(0==a)return!1;var c=s.parent,l=c.child(a-1);if(l.type!=e)return!1;if(n){var u=l.lastChild&&l.lastChild.type==c.type,f=O.from(u?e.create():null),d=new I(O.from(e.create(null,O.from(c.type.create(null,f)))),u?3:1,0),p=s.start,h=s.end;n(t.tr.step(new ut(p-(u?3:1),h,p,h,d,1,!0)).scrollIntoView())}return!0}}const oy=wm(),iy=wm(),sy=wm(),ay=pg(((e,t)=>{const n=t.getStyle((e=>_v`
                &,
                & > * {
                    margin: 0.5rem 0;
                }

                &,
                li {
                    &::marker {
                        color: ${e.palette("primary")};
                    }
                }
            `));return{id:"list_item",schema:{group:"listItem",content:"paragraph block*",defining:!0,parseDOM:[{tag:"li"}],toDOM:e=>["li",{class:t.getClassName(e.attrs,"list-item",n)},0]},parser:{match:({type:e,checked:t})=>"listItem"===e&&null===t,runner:(e,t,n)=>{e.openNode(n),e.next(t.children),e.closeNode()}},serializer:{match:e=>"list_item"===e.type.name,runner:(e,t)=>{e.openNode("listItem"),e.next(t.content),e.closeNode()}},inputRules:e=>[vi(/^\s*([-+*])\s$/,e)],commands:e=>[gm(oy,(()=>ty(e))),gm(iy,(()=>ry(e))),gm(sy,(()=>ny(e)))],shortcuts:{[xg.NextListItem]:mg(oy,"Enter"),[xg.SinkListItem]:mg(iy,"Mod-]"),[xg.LiftListItem]:mg(sy,"Mod-[")}}})),cy=wm(),ly=pg(((e,t)=>({id:"ordered_list",schema:{content:"listItem+",group:"block",attrs:{order:{default:1}},parseDOM:[{tag:"ol",getAttrs:e=>{if(!(e instanceof HTMLElement))throw new Error;return{order:e.hasAttribute("start")?Number(e.getAttribute("start")):1}}}],toDOM:e=>["ol",Object.assign(Object.assign({},1===e.attrs.order?{}:e.attrs.order),{class:t.getClassName(e.attrs,"ordered-list")}),0]},parser:{match:({type:e,ordered:t})=>"list"===e&&!!t,runner:(e,t,n)=>{e.openNode(n).next(t.children).closeNode()}},serializer:{match:e=>"ordered_list"===e.type.name,runner:(e,t)=>{e.openNode("list",void 0,{ordered:!0,start:1}),e.next(t.content),e.closeNode()}},inputRules:e=>[vi(/^(\d+)\.\s$/,e,(e=>({order:Number(e[1])})),((e,t)=>t.childCount+t.attrs.order===Number(e[1])))],commands:e=>[gm(cy,(()=>ri(e)))],shortcuts:{[xg.OrderedList]:mg(cy,"Mod-Shift-7")}}))),uy=wm(),fy="paragraph",dy=pg(((e,t)=>{const n=(null==e?void 0:e.headless)?null:_v`
              font-size: 1rem;
              line-height: 1.5;
              letter-spacing: 0.5px;
          `;return{id:fy,schema:{content:"inline*",group:"block",parseDOM:[{tag:"p"}],toDOM:e=>["p",{class:t.getClassName(e.attrs,fy,n)},0]},parser:{match:e=>"paragraph"===e.type,runner:(e,t,n)=>{e.openNode(n),t.children?e.next(t.children):e.addText(t.value),e.closeNode()}},serializer:{match:e=>"paragraph"===e.type.name,runner:(e,t)=>{e.openNode("paragraph"),e.next(t.content),e.closeNode()}},commands:e=>[gm(uy,(()=>oi(e)))],shortcuts:{[xg.Text]:mg(uy,"Mod-Alt-0")}}})),py=pg((()=>({id:"text",schema:{group:"inline"},parser:{match:({type:e})=>"text"===e,runner:(e,t)=>{e.addText(t.value)}},serializer:{match:e=>"text"===e.type.name,runner:(e,t)=>{e.addNode("text",void 0,t.text)}}}))),hy=[Vg(),dy(),Hg(),Rg(),Lg(),Pg(),ly(),ay(),Ug(),Qg(),ey(),py()];var my=vy;function vy(e){if(null==e)return gy;if("string"==typeof e)return function(e){return t;function t(t){return Boolean(t&&t.type===e)}}(e);if("object"==typeof e)return"length"in e?function(e){var t=[],n=-1;for(;++n<e.length;)t[n]=vy(e[n]);return r;function r(){for(var e=-1;++e<t.length;)if(t[e].apply(this,arguments))return!0;return!1}}(e):function(e){return t;function t(t){var n;for(n in e)if(t[n]!==e[n])return!1;return!0}}(e);if("function"==typeof e)return e;throw new Error("Expected function, string, or object as test")}function gy(){return!0}var yy=ky,wy=my,by=function(e){return e};function ky(e,t,n,r){var o,i;"function"==typeof t&&"function"!=typeof n&&(r=n,n=t,t=null),i=wy(t),o=r?-1:1,function e(s,a,c){var l,u="object"==typeof s&&null!==s?s:{};"string"==typeof u.type&&(l="string"==typeof u.tagName?u.tagName:"string"==typeof u.name?u.name:void 0,f.displayName="node ("+by(u.type+(l?"<"+l+">":""))+")");return f;function f(){var l,u,f=c.concat(s),d=[];if((!t||i(s,a,c[c.length-1]||null))&&false===(d=function(e){if(null!==e&&"object"==typeof e&&"length"in e)return e;if("number"==typeof e)return[true,e];return[e]}(n(s,c)))[0])return d;if(s.children&&"skip"!==d[0])for(u=(r?s.children.length:-1)+o;u>-1&&u<s.children.length;){if(false===(l=e(s.children[u],u,f)())[0])return l;u="number"==typeof l[1]?l[1]:u+o}return d}}(e,null,[])()}ky.CONTINUE=true,ky.SKIP="skip",ky.EXIT=false;var xy=Ay,Sy=yy,Cy=Sy.CONTINUE,My=Sy.SKIP,Oy=Sy.EXIT;function Ay(e,t,n,r){"function"==typeof t&&"function"!=typeof n&&(r=n,n=t,t=null),Sy(e,t,(function(e,t){var r=t[t.length-1],o=r?r.children.indexOf(e):null;return n(e,o,r)}),r)}Ay.CONTINUE=Cy,Ay.SKIP=My,Ay.EXIT=Oy;var Ey=xy,Ty=function(e,t){return function(e){return t;function t(t){var n=t&&Dy(t);return n&&Ny.call(e,n)?e[n]:null}}(function(e){var t={};if(!e||!e.type)throw new Error("mdast-util-definitions expected node");return Ey(e,"definition",n),t;function n(e){var n=Dy(e.identifier);Ny.call(t,n)||(t[n]=e)}}(e))},Ny={}.hasOwnProperty;function Dy(e){return e.toUpperCase()}var zy=xy,Iy=Ty;const $y=[gh([function(){return function(e){var t=Iy(e);function n(e,n,r){var o,i,s;return"definition"===e.type?(r.children.splice(n,1),[zy.SKIP,n]):"imageReference"!==e.type&&"linkReference"!==e.type||!(o=t(e.identifier))?void 0:(i={type:(s="imageReference"===e.type)?"image":"link",url:o.url,title:o.title},s?i.alt=e.alt:i.children=e.children,r.children[n]=i,[zy.SKIP,n])}zy(e,n)}},()=>function(e){var t;t=e=>(e=>"html"===e.type)(e)?[]:[e],function e(n,r,o){if((e=>!!e.children)(n)){const t=[];for(let r=0,o=n.children.length;r<o;r++){const o=e(n.children[r],r,n);if(o)for(let e=0,n=o.length;e<n;e++)t.push(o[e])}n.children=t}return t(n,r,o)}(e,0,null)[0]}])],Ry=ag.create([...hy,...zg]),Fy=ag.create([...$y,...Ry]),Py={ToggleInlineCode:Sg,ToggleItalic:Mg,ToggleLink:Ag,ToggleBold:Ng,ModifyLink:Eg,ModifyImage:Xg,WrapInBlockquote:$g,WrapInBulletList:Fg,WrapInOrderedList:cy,TurnIntoCodeFence:jg,TurnIntoHeading:Kg,TurnIntoText:uy,InsertHardbreak:qg,InsertHr:Gg,InsertImage:Zg,SplitListItem:oy,SinkListItem:iy,LiftListItem:sy},_y=Ve({},"listener"),By=e=>(e.inject(_y),e=>We(void 0,void 0,void 0,(function*(){yield e.wait(Zh);const t=e.get(_y),n=e.get(Qh),r=new Zt({state:{init:()=>{},apply:e=>{var r,o;e.docChanged&&(null===(r=t.markdown)||void 0===r||r.forEach((t=>{t((()=>n(e.doc)))})),null===(o=t.doc)||void 0===o||o.forEach((t=>{t(e.doc)})))}}});e.update(hh,(e=>e.concat(r)))})));var jy,Ly;if("undefined"!=typeof WeakMap){var Vy=new WeakMap;jy=function(e){return Vy.get(e)},Ly=function(e,t){return Vy.set(e,t),t}}else{var Wy=[],qy=0;jy=function(e){for(var t=0;t<Wy.length;t+=2)if(Wy[t]==e)return Wy[t+1]},Ly=function(e,t){return 10==qy&&(qy=0),Wy[qy++]=e,Wy[qy++]=t}}var Hy=function(e,t,n,r){this.left=e,this.top=t,this.right=n,this.bottom=r},Jy=function(e,t,n,r){this.width=e,this.height=t,this.map=n,this.problems=r};function Ky(e){if(e.colwidth)return e.colwidth.slice();for(var t=[],n=0;n<e.colspan;n++)t.push(0);return t}function Uy(e,t){var n=e.getAttribute("data-colwidth"),r=n&&/^\d+(,\d+)*$/.test(n)?n.split(",").map((function(e){return Number(e)})):null,o=Number(e.getAttribute("colspan")||1),i={colspan:o,rowspan:Number(e.getAttribute("rowspan")||1),colwidth:r&&r.length==o?r:null};for(var s in t){var a=t[s].getFromDOM,c=a&&a(e);null!=c&&(i[s]=c)}return i}function Gy(e,t){var n={};for(var r in 1!=e.attrs.colspan&&(n.colspan=e.attrs.colspan),1!=e.attrs.rowspan&&(n.rowspan=e.attrs.rowspan),e.attrs.colwidth&&(n["data-colwidth"]=e.attrs.colwidth.join(",")),t){var o=t[r].setDOMAttr;o&&o(e.attrs[r],n)}return n}function Qy(e){var t=e.cached.tableNodeTypes;if(!t)for(var n in t=e.cached.tableNodeTypes={},e.nodes){var r=e.nodes[n],o=r.spec.tableRole;o&&(t[o]=r)}return t}Jy.prototype.findCell=function(e){for(var t=0;t<this.map.length;t++){var n=this.map[t];if(n==e){for(var r=t%this.width,o=t/this.width|0,i=r+1,s=o+1,a=1;i<this.width&&this.map[t+a]==n;a++)i++;for(var c=1;s<this.height&&this.map[t+this.width*c]==n;c++)s++;return new Hy(r,o,i,s)}}throw new RangeError("No cell with offset "+e+" found")},Jy.prototype.colCount=function(e){for(var t=0;t<this.map.length;t++)if(this.map[t]==e)return t%this.width;throw new RangeError("No cell with offset "+e+" found")},Jy.prototype.nextCell=function(e,t,n){var r=this.findCell(e),o=r.left,i=r.right,s=r.top,a=r.bottom;return"horiz"==t?(n<0?0==o:i==this.width)?null:this.map[s*this.width+(n<0?o-1:i)]:(n<0?0==s:a==this.height)?null:this.map[o+this.width*(n<0?s-1:a)]},Jy.prototype.rectBetween=function(e,t){var n=this.findCell(e),r=n.left,o=n.right,i=n.top,s=n.bottom,a=this.findCell(t),c=a.left,l=a.right,u=a.top,f=a.bottom;return new Hy(Math.min(r,c),Math.min(i,u),Math.max(o,l),Math.max(s,f))},Jy.prototype.cellsInRect=function(e){for(var t=[],n={},r=e.top;r<e.bottom;r++)for(var o=e.left;o<e.right;o++){var i=r*this.width+o,s=this.map[i];n[s]||(n[s]=!0,o==e.left&&o&&this.map[i-1]==s||r==e.top&&r&&this.map[i-this.width]==s||t.push(s))}return t},Jy.prototype.positionAt=function(e,t,n){for(var r=0,o=0;;r++){var i=o+n.child(r).nodeSize;if(r==e){for(var s=t+e*this.width,a=(e+1)*this.width;s<a&&this.map[s]<o;)s++;return s==a?i-1:this.map[s]}o=i}},Jy.get=function(e){return jy(e)||Ly(e,function(e){if("table"!=e.type.spec.tableRole)throw new RangeError("Not a table node: "+e.type.name);for(var t=function(e){for(var t=-1,n=!1,r=0;r<e.childCount;r++){var o=e.child(r),i=0;if(n)for(var s=0;s<r;s++)for(var a=e.child(s),c=0;c<a.childCount;c++){var l=a.child(c);s+l.attrs.rowspan>r&&(i+=l.attrs.colspan)}for(var u=0;u<o.childCount;u++){var f=o.child(u);i+=f.attrs.colspan,f.attrs.rowspan>1&&(n=!0)}-1==t?t=i:t!=i&&(t=Math.max(t,i))}return t}(e),n=e.childCount,r=[],o=0,i=null,s=[],a=0,c=t*n;a<c;a++)r[a]=0;for(var l=0,u=0;l<n;l++){var f=e.child(l);u++;for(var d=0;;d++){for(;o<r.length&&0!=r[o];)o++;if(d==f.childCount)break;for(var p=f.child(d),h=p.attrs,m=h.colspan,v=h.rowspan,g=h.colwidth,y=0;y<v;y++){if(y+l>=n){(i||(i=[])).push({type:"overlong_rowspan",pos:u,n:v-y});break}for(var w=o+y*t,b=0;b<m;b++){0==r[w+b]?r[w+b]=u:(i||(i=[])).push({type:"collision",row:l,pos:u,n:m-b});var k=g&&g[b];if(k){var x=(w+b)%t*2,S=s[x];null==S||S!=k&&1==s[x+1]?(s[x]=k,s[x+1]=1):S==k&&s[x+1]++}}}o+=m,u+=p.nodeSize}for(var C=(l+1)*t,M=0;o<C;)0==r[o++]&&M++;M&&(i||(i=[])).push({type:"missing",row:l,n:M}),u++}for(var O=new Jy(t,n,r,i),A=!1,E=0;!A&&E<s.length;E+=2)null!=s[E]&&s[E+1]<n&&(A=!0);A&&function(e,t,n){e.problems||(e.problems=[]);for(var r=0,o={};r<e.map.length;r++){var i=e.map[r];if(!o[i]){o[i]=!0;for(var s=n.nodeAt(i),a=null,c=0;c<s.attrs.colspan;c++){var l=t[2*((r+c)%e.width)];null==l||s.attrs.colwidth&&s.attrs.colwidth[c]==l||((a||(a=Ky(s.attrs)))[c]=l)}a&&e.problems.unshift({type:"colwidth mismatch",pos:i,colwidth:a})}}}(O,s,e);return O}(e))};var Xy=new tn("selectingCells");function Zy(e){for(var t=e.depth-1;t>0;t--)if("row"==e.node(t).type.spec.tableRole)return e.node(0).resolve(e.before(t+1));return null}function Yy(e){for(var t=e.selection.$head,n=t.depth;n>0;n--)if("row"==t.node(n).type.spec.tableRole)return!0;return!1}function ew(e){var t=e.selection;return t.$anchorCell?t.$anchorCell.pos>t.$headCell.pos?t.$anchorCell:t.$headCell:t.node&&"cell"==t.node.type.spec.tableRole?t.$anchor:Zy(t.$head)||function(e){for(var t=e.nodeAfter,n=e.pos;t;t=t.firstChild,n++){var r=t.type.spec.tableRole;if("cell"==r||"header_cell"==r)return e.doc.resolve(n)}for(var o=e.nodeBefore,i=e.pos;o;o=o.lastChild,i--){var s=o.type.spec.tableRole;if("cell"==s||"header_cell"==s)return e.doc.resolve(i-o.nodeSize)}}(t.$head)}function tw(e){return"row"==e.parent.type.spec.tableRole&&e.nodeAfter}function nw(e,t){return e.depth==t.depth&&e.pos>=t.start(-1)&&e.pos<=t.end(-1)}function rw(e,t,n){var r=e.start(-1),o=Jy.get(e.node(-1)).nextCell(e.pos-r,t,n);return null==o?null:e.node(0).resolve(r+o)}function ow(e,t,n){var r={};for(var o in e)r[o]=e[o];return r[t]=n,r}function iw(e,t,n){void 0===n&&(n=1);var r=ow(e,"colspan",e.colspan-n);return r.colwidth&&(r.colwidth=r.colwidth.slice(),r.colwidth.splice(t,n),r.colwidth.some((function(e){return e>0}))||(r.colwidth=null)),r}function sw(e,t,n){void 0===n&&(n=1);var r=ow(e,"colspan",e.colspan+n);if(r.colwidth){r.colwidth=r.colwidth.slice();for(var o=0;o<n;o++)r.colwidth.splice(t,0,0)}return r}var aw=function(e){function t(t,n){void 0===n&&(n=t);var r=t.node(-1),o=Jy.get(r),i=t.start(-1),s=o.rectBetween(t.pos-i,n.pos-i),a=t.node(0),c=o.cellsInRect(s).filter((function(e){return e!=n.pos-i}));c.unshift(n.pos-i);var l=c.map((function(e){var t=r.nodeAt(e),n=e+i+1;return new $t(a.resolve(n),a.resolve(n+t.content.size))}));e.call(this,l[0].$from,l[0].$to,l),this.$anchorCell=t,this.$headCell=n}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.map=function(e,n){var r=e.resolve(n.map(this.$anchorCell.pos)),o=e.resolve(n.map(this.$headCell.pos));if(tw(r)&&tw(o)&&nw(r,o)){var i=this.$anchorCell.node(-1)!=r.node(-1);return i&&this.isRowSelection()?t.rowSelection(r,o):i&&this.isColSelection()?t.colSelection(r,o):new t(r,o)}return Rt.between(r,o)},t.prototype.content=function(){for(var e=this.$anchorCell.node(-1),t=Jy.get(e),n=this.$anchorCell.start(-1),r=t.rectBetween(this.$anchorCell.pos-n,this.$headCell.pos-n),o={},i=[],s=r.top;s<r.bottom;s++){for(var a=[],c=s*t.width+r.left,l=r.left;l<r.right;l++,c++){var u=t.map[c];if(!o[u]){o[u]=!0;var f=t.findCell(u),d=e.nodeAt(u),p=r.left-f.left,h=f.right-r.right;if(p>0||h>0){var m=d.attrs;p>0&&(m=iw(m,0,p)),h>0&&(m=iw(m,m.colspan-h,h)),d=f.left<r.left?d.type.createAndFill(m):d.type.create(m,d.content)}if(f.top<r.top||f.bottom>r.bottom){var v=ow(d.attrs,"rowspan",Math.min(f.bottom,r.bottom)-Math.max(f.top,r.top));d=f.top<r.top?d.type.createAndFill(v):d.type.create(v,d.content)}a.push(d)}}i.push(e.child(s).copy(O.from(a)))}var g=this.isColSelection()&&this.isRowSelection()?e:i;return new I(O.from(g),1,1)},t.prototype.replace=function(t,n){void 0===n&&(n=I.empty);for(var r=t.steps.length,o=this.ranges,i=0;i<o.length;i++){var s=o[i],a=s.$from,c=s.$to,l=t.mapping.slice(r);t.replace(l.map(a.pos),l.map(c.pos),i?I.empty:n)}var u=e.findFrom(t.doc.resolve(t.mapping.slice(r).map(this.to)),-1);u&&t.setSelection(u)},t.prototype.replaceWith=function(e,t){this.replace(e,new I(O.from(t),0,0))},t.prototype.forEachCell=function(e){for(var t=this.$anchorCell.node(-1),n=Jy.get(t),r=this.$anchorCell.start(-1),o=n.cellsInRect(n.rectBetween(this.$anchorCell.pos-r,this.$headCell.pos-r)),i=0;i<o.length;i++)e(t.nodeAt(o[i]),r+o[i])},t.prototype.isColSelection=function(){var e=this.$anchorCell.index(-1),t=this.$headCell.index(-1);if(Math.min(e,t)>0)return!1;var n=e+this.$anchorCell.nodeAfter.attrs.rowspan,r=t+this.$headCell.nodeAfter.attrs.rowspan;return Math.max(n,r)==this.$headCell.node(-1).childCount},t.colSelection=function(e,n){void 0===n&&(n=e);var r=Jy.get(e.node(-1)),o=e.start(-1),i=r.findCell(e.pos-o),s=r.findCell(n.pos-o),a=e.node(0);return i.top<=s.top?(i.top>0&&(e=a.resolve(o+r.map[i.left])),s.bottom<r.height&&(n=a.resolve(o+r.map[r.width*(r.height-1)+s.right-1]))):(s.top>0&&(n=a.resolve(o+r.map[s.left])),i.bottom<r.height&&(e=a.resolve(o+r.map[r.width*(r.height-1)+i.right-1]))),new t(e,n)},t.prototype.isRowSelection=function(){var e=Jy.get(this.$anchorCell.node(-1)),t=this.$anchorCell.start(-1),n=e.colCount(this.$anchorCell.pos-t),r=e.colCount(this.$headCell.pos-t);if(Math.min(n,r)>0)return!1;var o=n+this.$anchorCell.nodeAfter.attrs.colspan,i=r+this.$headCell.nodeAfter.attrs.colspan;return Math.max(o,i)==e.width},t.prototype.eq=function(e){return e instanceof t&&e.$anchorCell.pos==this.$anchorCell.pos&&e.$headCell.pos==this.$headCell.pos},t.rowSelection=function(e,n){void 0===n&&(n=e);var r=Jy.get(e.node(-1)),o=e.start(-1),i=r.findCell(e.pos-o),s=r.findCell(n.pos-o),a=e.node(0);return i.left<=s.left?(i.left>0&&(e=a.resolve(o+r.map[i.top*r.width])),s.right<r.width&&(n=a.resolve(o+r.map[r.width*(s.top+1)-1]))):(s.left>0&&(n=a.resolve(o+r.map[s.top*r.width])),i.right<r.width&&(e=a.resolve(o+r.map[r.width*(i.top+1)-1]))),new t(e,n)},t.prototype.toJSON=function(){return{type:"cell",anchor:this.$anchorCell.pos,head:this.$headCell.pos}},t.fromJSON=function(e,n){return new t(e.resolve(n.anchor),e.resolve(n.head))},t.create=function(e,n,r){return void 0===r&&(r=n),new t(e.resolve(n),e.resolve(r))},t.prototype.getBookmark=function(){return new cw(this.$anchorCell.pos,this.$headCell.pos)},t}(zt);aw.prototype.visible=!1,zt.jsonID("cell",aw);var cw=function(e,t){this.anchor=e,this.head=t};function lw(e){if(!(e.selection instanceof aw))return null;var t=[];return e.selection.forEachCell((function(e,n){t.push(To.node(n,n+e.nodeSize,{class:"selectedCell"}))})),Io.create(e.doc,t)}function uw(e){if(!e.size)return null;for(var t=e.content,n=e.openStart,r=e.openEnd;1==t.childCount&&(n>0&&r>0||"table"==t.firstChild.type.spec.tableRole);)n--,r--,t=t.firstChild.content;var o=t.firstChild,i=o.type.spec.tableRole,s=o.type.schema,a=[];if("row"==i)for(var c=0;c<t.childCount;c++){var l=t.child(c).content,u=c?0:Math.max(0,n-1),f=c<t.childCount-1?0:Math.max(0,r-1);(u||f)&&(l=fw(Qy(s).row,new I(l,u,f)).content),a.push(l)}else{if("cell"!=i&&"header_cell"!=i)return null;a.push(n||r?fw(Qy(s).row,new I(t,n,r)).content:t)}return function(e,t){for(var n=[],r=0;r<t.length;r++)for(var o=t[r],i=o.childCount-1;i>=0;i--)for(var s=o.child(i).attrs,a=s.rowspan,c=s.colspan,l=r;l<r+a;l++)n[l]=(n[l]||0)+c;for(var u=0,f=0;f<n.length;f++)u=Math.max(u,n[f]);for(var d=0;d<n.length;d++)if(d>=t.length&&t.push(O.empty),n[d]<u){for(var p=Qy(e).cell.createAndFill(),h=[],m=n[d];m<u;m++)h.push(p);t[d]=t[d].append(O.from(h))}return{height:t.length,width:u,rows:t}}(s,a)}function fw(e,t){var n=e.createAndFill();return new rt(n).replace(0,n.content.size,t).doc}function dw(e,t,n,r,o,i,s,a){if(0==s||s==t.height)return!1;for(var c=!1,l=o;l<i;l++){var u=s*t.width+l,f=t.map[u];if(t.map[u-t.width]==f){c=!0;var d=n.nodeAt(f),p=t.findCell(f),h=p.top,m=p.left;e.setNodeMarkup(e.mapping.slice(a).map(f+r),null,ow(d.attrs,"rowspan",s-h)),e.insert(e.mapping.slice(a).map(t.positionAt(s,m,n)),d.type.createAndFill(ow(d.attrs,"rowspan",h+d.attrs.rowspan-s))),l+=d.attrs.colspan-1}}return c}function pw(e,t,n,r,o,i,s,a){if(0==s||s==t.width)return!1;for(var c=!1,l=o;l<i;l++){var u=l*t.width+s,f=t.map[u];if(t.map[u-1]==f){c=!0;var d=n.nodeAt(f),p=t.colCount(f),h=e.mapping.slice(a).map(f+r);e.setNodeMarkup(h,null,iw(d.attrs,s-p,d.attrs.colspan-(s-p))),e.insert(h+d.nodeSize,d.type.createAndFill(iw(d.attrs,0,s-p))),l+=d.attrs.rowspan-1}}return c}function hw(e,t,n,r,o){var i=n?e.doc.nodeAt(n-1):e.doc,s=Jy.get(i),a=r.top,c=r.left,l=c+o.width,u=a+o.height,f=e.tr,d=0;function p(){i=n?f.doc.nodeAt(n-1):f.doc,s=Jy.get(i),d=f.mapping.maps.length}(function(e,t,n,r,o,i,s){var a,c,l=Qy(e.doc.type.schema);if(o>t.width)for(var u=0,f=0;u<t.height;u++){var d=n.child(u);f+=d.nodeSize;var p=[],h=void 0;h=null==d.lastChild||d.lastChild.type==l.cell?a||(a=l.cell.createAndFill()):c||(c=l.header_cell.createAndFill());for(var m=t.width;m<o;m++)p.push(h);e.insert(e.mapping.slice(s).map(f-1+r),p)}if(i>t.height){for(var v=[],g=0,y=(t.height-1)*t.width;g<Math.max(t.width,o);g++){var w=!(g>=t.width)&&n.nodeAt(t.map[y+g]).type==l.header_cell;v.push(w?c||(c=l.header_cell.createAndFill()):a||(a=l.cell.createAndFill()))}for(var b=l.row.create(null,O.from(v)),k=[],x=t.height;x<i;x++)k.push(b);e.insert(e.mapping.slice(s).map(r+n.nodeSize-2),k)}return!(!a&&!c)})(f,s,i,n,l,u,d)&&p(),dw(f,s,i,n,c,l,a,d)&&p(),dw(f,s,i,n,c,l,u,d)&&p(),pw(f,s,i,n,a,u,c,d)&&p(),pw(f,s,i,n,a,u,l,d)&&p();for(var h=a;h<u;h++){var m=s.positionAt(h,c,i),v=s.positionAt(h,l,i);f.replace(f.mapping.slice(d).map(m+n),f.mapping.slice(d).map(v+n),new I(o.rows[h-a],0,0))}p(),f.setSelection(new aw(f.doc.resolve(n+s.positionAt(a,c,i)),f.doc.resolve(n+s.positionAt(u-1,l-1,i)))),t(f)}cw.prototype.map=function(e){return new cw(e.map(this.anchor),e.map(this.head))},cw.prototype.resolve=function(e){var t=e.resolve(this.anchor),n=e.resolve(this.head);return"row"==t.parent.type.spec.tableRole&&"row"==n.parent.type.spec.tableRole&&t.index()<t.parent.childCount&&n.index()<n.parent.childCount&&nw(t,n)?new aw(t,n):zt.near(n,1)};var mw=zi({ArrowLeft:gw("horiz",-1),ArrowRight:gw("horiz",1),ArrowUp:gw("vert",-1),ArrowDown:gw("vert",1),"Shift-ArrowLeft":yw("horiz",-1),"Shift-ArrowRight":yw("horiz",1),"Shift-ArrowUp":yw("vert",-1),"Shift-ArrowDown":yw("vert",1),Backspace:ww,"Mod-Backspace":ww,Delete:ww,"Mod-Delete":ww});function vw(e,t,n){return!n.eq(e.selection)&&(t&&t(e.tr.setSelection(n).scrollIntoView()),!0)}function gw(e,t){return function(n,r,o){var i=n.selection;if(i instanceof aw)return vw(n,r,zt.near(i.$headCell,t));if("horiz"!=e&&!i.empty)return!1;var s=Sw(o,e,t);if(null==s)return!1;if("horiz"==e)return vw(n,r,zt.near(n.doc.resolve(i.head+t),t));var a,c=n.doc.resolve(s),l=rw(c,e,t);return a=l?zt.near(l,1):t<0?zt.near(n.doc.resolve(c.before(-1)),-1):zt.near(n.doc.resolve(c.after(-1)),1),vw(n,r,a)}}function yw(e,t){return function(n,r,o){var i=n.selection;if(!(i instanceof aw)){var s=Sw(o,e,t);if(null==s)return!1;i=new aw(n.doc.resolve(s))}var a=rw(i.$headCell,e,t);return!!a&&vw(n,r,new aw(i.$anchorCell,a))}}function ww(e,t){var n=e.selection;if(!(n instanceof aw))return!1;if(t){var r=e.tr,o=Qy(e.schema).cell.createAndFill().content;n.forEachCell((function(e,t){e.content.eq(o)||r.replace(r.mapping.map(t+1),r.mapping.map(t+e.nodeSize-1),new I(o,0,0))})),r.docChanged&&t(r)}return!0}function bw(e,t){var n=Zy(e.state.doc.resolve(t));return!!n&&(e.dispatch(e.state.tr.setSelection(new aw(n))),!0)}function kw(e,t,n){if(!Yy(e.state))return!1;var r=uw(n),o=e.state.selection;if(o instanceof aw){r||(r={width:1,height:1,rows:[O.from(fw(Qy(e.state.schema).cell,n))]});var i=o.$anchorCell.node(-1),s=o.$anchorCell.start(-1),a=Jy.get(i).rectBetween(o.$anchorCell.pos-s,o.$headCell.pos-s);return r=function(e,t,n){var r=e.width,o=e.height,i=e.rows;if(r!=t){for(var s=[],a=[],c=0;c<i.length;c++){for(var l=i[c],u=[],f=s[c]||0,d=0;f<t;d++){var p=l.child(d%l.childCount);f+p.attrs.colspan>t&&(p=p.type.create(iw(p.attrs,p.attrs.colspan,f+p.attrs.colspan-t),p.content)),u.push(p),f+=p.attrs.colspan;for(var h=1;h<p.attrs.rowspan;h++)s[c+h]=(s[c+h]||0)+p.attrs.colspan}a.push(O.from(u))}i=a,r=t}if(o!=n){for(var m=[],v=0,g=0;v<n;v++,g++){for(var y=[],w=i[g%o],b=0;b<w.childCount;b++){var k=w.child(b);v+k.attrs.rowspan>n&&(k=k.type.create(ow(k.attrs,"rowspan",Math.max(1,n-k.attrs.rowspan)),k.content)),y.push(k)}m.push(O.from(y))}i=m,o=n}return{width:r,height:o,rows:i}}(r,a.right-a.left,a.bottom-a.top),hw(e.state,e.dispatch,s,a,r),!0}if(r){var c=ew(e.state),l=c.start(-1);return hw(e.state,e.dispatch,l,Jy.get(c.node(-1)).findCell(c.pos-l),r),!0}return!1}function xw(e,t){if(!t.ctrlKey&&!t.metaKey){var n,r=Cw(e,t.target);if(t.shiftKey&&e.state.selection instanceof aw)o(e.state.selection.$anchorCell,t),t.preventDefault();else if(t.shiftKey&&r&&null!=(n=Zy(e.state.selection.$anchor))&&Mw(e,t).pos!=n.pos)o(n,t),t.preventDefault();else if(!r)return;e.root.addEventListener("mouseup",i),e.root.addEventListener("dragstart",i),e.root.addEventListener("mousemove",s)}function o(t,n){var r=Mw(e,n),o=null==Xy.getState(e.state);if(!r||!nw(t,r)){if(!o)return;r=t}var i=new aw(t,r);if(o||!e.state.selection.eq(i)){var s=e.state.tr.setSelection(i);o&&s.setMeta(Xy,t.pos),e.dispatch(s)}}function i(){e.root.removeEventListener("mouseup",i),e.root.removeEventListener("dragstart",i),e.root.removeEventListener("mousemove",s),null!=Xy.getState(e.state)&&e.dispatch(e.state.tr.setMeta(Xy,-1))}function s(n){var s,a=Xy.getState(e.state);if(null!=a)s=e.state.doc.resolve(a);else if(Cw(e,n.target)!=r&&!(s=Mw(e,t)))return i();s&&o(s,n)}}function Sw(e,t,n){if(!(e.state.selection instanceof Rt))return null;for(var r=e.state.selection.$head,o=r.depth-1;o>=0;o--){var i=r.node(o);if((n<0?r.index(o):r.indexAfter(o))!=(n<0?0:i.childCount))return null;if("cell"==i.type.spec.tableRole||"header_cell"==i.type.spec.tableRole){var s=r.before(o),a="vert"==t?n>0?"down":"up":n>0?"right":"left";return e.endOfTextblock(a)?s:null}}return null}function Cw(e,t){for(;t&&t!=e.dom;t=t.parentNode)if("TD"==t.nodeName||"TH"==t.nodeName)return t}function Mw(e,t){var n=e.posAtCoords({left:t.clientX,top:t.clientY});return n&&n?Zy(e.state.doc.resolve(n.pos)):null}var Ow=new tn("fix-tables");function Aw(e,t,n,r){var o=e.childCount,i=t.childCount;e:for(var s=0,a=0;s<i;s++){for(var c=t.child(s),l=a,u=Math.min(o,s+3);l<u;l++)if(e.child(l)==c){a=l+1,n+=c.nodeSize;continue e}r(c,n),a<o&&e.child(a).sameMarkup(c)?Aw(e.child(a),c,n+1,r):c.nodesBetween(0,c.content.size,r,n+1),n+=c.nodeSize}}function Ew(e,t){var n,r=function(t,r){"table"==t.type.spec.tableRole&&(n=function(e,t,n,r){var o=Jy.get(t);if(!o.problems)return r;r||(r=e.tr);for(var i,s,a=[],c=0;c<o.height;c++)a.push(0);for(var l=0;l<o.problems.length;l++){var u=o.problems[l];if("collision"==u.type){for(var f=t.nodeAt(u.pos),d=0;d<f.attrs.rowspan;d++)a[u.row+d]+=u.n;r.setNodeMarkup(r.mapping.map(n+1+u.pos),null,iw(f.attrs,f.attrs.colspan-u.n,u.n))}else if("missing"==u.type)a[u.row]+=u.n;else if("overlong_rowspan"==u.type){var p=t.nodeAt(u.pos);r.setNodeMarkup(r.mapping.map(n+1+u.pos),null,ow(p.attrs,"rowspan",p.attrs.rowspan-u.n))}else if("colwidth mismatch"==u.type){var h=t.nodeAt(u.pos);r.setNodeMarkup(r.mapping.map(n+1+u.pos),null,ow(h.attrs,"colwidth",u.colwidth))}}for(var m=0;m<a.length;m++)a[m]&&(null==i&&(i=m),s=m);for(var v=0,g=n+1;v<o.height;v++){var y=t.child(v),w=g+y.nodeSize,b=a[v];if(b>0){var k="cell";y.firstChild&&(k=y.firstChild.type.spec.tableRole);for(var x=[],S=0;S<b;S++)x.push(Qy(e.schema)[k].createAndFill());var C=0!=v&&i!=v-1||s!=v?w-1:g+1;r.insert(r.mapping.map(C),x)}g=w}return r.setMeta(Ow,{fixTables:!0})}(e,t,r,n))};return t?t.doc!=e.doc&&Aw(t.doc,e.doc,0,r):e.doc.descendants(r),n}function Tw(e){var t,n=e.selection,r=ew(e),o=r.node(-1),i=r.start(-1),s=Jy.get(o);return(t=n instanceof aw?s.rectBetween(n.$anchorCell.pos-i,n.$headCell.pos-i):s.findCell(r.pos-i)).tableStart=i,t.map=s,t.table=o,t}function Nw(e,t,n){var r=t.map,o=t.tableStart,i=t.table,s=n>0?-1:0;(function(e,t,n){for(var r=Qy(t.type.schema).header_cell,o=0;o<e.height;o++)if(t.nodeAt(e.map[n+o*e.width]).type!=r)return!1;return!0})(r,i,n+s)&&(s=0==n||n==r.width?null:0);for(var a=0;a<r.height;a++){var c=a*r.width+n;if(n>0&&n<r.width&&r.map[c-1]==r.map[c]){var l=r.map[c],u=i.nodeAt(l);e.setNodeMarkup(e.mapping.map(o+l),null,sw(u.attrs,n-r.colCount(l))),a+=u.attrs.rowspan-1}else{var f=null==s?Qy(i.type.schema).cell:i.nodeAt(r.map[c+s]).type,d=r.positionAt(a,n,i);e.insert(e.mapping.map(o+d),f.createAndFill())}}return e}function Dw(e,t){if(!Yy(e))return!1;if(t){var n=Tw(e);t(Nw(e.tr,n,n.left))}return!0}function zw(e,t){if(!Yy(e))return!1;if(t){var n=Tw(e);t(Nw(e.tr,n,n.right))}return!0}function Iw(e,t,n){for(var r=t.map,o=t.table,i=t.tableStart,s=e.mapping.maps.length,a=0;a<r.height;){var c=a*r.width+n,l=r.map[c],u=o.nodeAt(l);if(n>0&&r.map[c-1]==l||n<r.width-1&&r.map[c+1]==l)e.setNodeMarkup(e.mapping.slice(s).map(i+l),null,iw(u.attrs,n-r.colCount(l)));else{var f=e.mapping.slice(s).map(i+l);e.delete(f,f+u.nodeSize)}a+=u.attrs.rowspan}}function $w(e,t){if(!Yy(e))return!1;if(t){var n=Tw(e),r=e.tr;if(0==n.left&&n.right==n.map.width)return!1;for(var o=n.right-1;Iw(r,n,o),o!=n.left;o--)n.table=n.tableStart?r.doc.nodeAt(n.tableStart-1):r.doc,n.map=Jy.get(n.table);t(r)}return!0}function Rw(e,t,n){for(var r=t.map,o=t.table,i=t.tableStart,s=0,a=0;a<n;a++)s+=o.child(a).nodeSize;var c=s+o.child(n).nodeSize,l=e.mapping.maps.length;e.delete(s+i,c+i);for(var u=0,f=n*r.width;u<r.width;u++,f++){var d=r.map[f];if(n>0&&d==r.map[f-r.width]){var p=o.nodeAt(d).attrs;e.setNodeMarkup(e.mapping.slice(l).map(d+i),null,ow(p,"rowspan",p.rowspan-1)),u+=p.colspan-1}else if(n<r.width&&d==r.map[f+r.width]){var h=o.nodeAt(d),m=h.type.create(ow(h.attrs,"rowspan",h.attrs.rowspan-1),h.content),v=r.positionAt(n+1,u,o);e.insert(e.mapping.slice(l).map(i+v),m),u+=h.attrs.colspan-1}}}function Fw(e,t){if(!Yy(e))return!1;if(t){var n=Tw(e),r=e.tr;if(0==n.top&&n.bottom==n.map.height)return!1;for(var o=n.bottom-1;Rw(r,n,o),o!=n.top;o--)n.table=n.tableStart?r.doc.nodeAt(n.tableStart-1):r.doc,n.map=Jy.get(n.table);t(r)}return!0}function Pw(e,t){return function(n,r){if(!Yy(n))return!1;var o=ew(n);if(o.nodeAfter.attrs[e]===t)return!1;if(r){var i=n.tr;n.selection instanceof aw?n.selection.forEachCell((function(n,r){n.attrs[e]!==t&&i.setNodeMarkup(r,null,ow(n.attrs,e,t))})):i.setNodeMarkup(o.pos,null,ow(o.nodeAfter.attrs,e,t)),r(i)}return!0}}function _w(e,t,n){for(var r=t.map.cellsInRect({left:0,top:0,right:"row"==e?t.map.width:1,bottom:"column"==e?t.map.height:1}),o=0;o<r.length;o++){var i=t.table.nodeAt(r[o]);if(i&&i.type!==n.header_cell)return!1}return!0}function Bw(e,t){return(t=t||{useDeprecatedLogic:!1}).useDeprecatedLogic?function(e){return function(t,n){if(!Yy(t))return!1;if(n){for(var r=Qy(t.schema),o=Tw(t),i=t.tr,s=o.map.cellsInRect("column"==e?new Hy(o.left,0,o.right,o.map.height):"row"==e?new Hy(0,o.top,o.map.width,o.bottom):o),a=s.map((function(e){return o.table.nodeAt(e)})),c=0;c<s.length;c++)a[c].type==r.header_cell&&i.setNodeMarkup(o.tableStart+s[c],r.cell,a[c].attrs);if(0==i.steps.length)for(var l=0;l<s.length;l++)i.setNodeMarkup(o.tableStart+s[l],r.header_cell,a[l].attrs);n(i)}return!0}}(e):function(t,n){if(!Yy(t))return!1;if(n){var r=Qy(t.schema),o=Tw(t),i=t.tr,s=_w("row",o,r),a=_w("column",o,r),c=("column"===e?s:"row"===e&&a)?1:0,l="column"==e?new Hy(0,c,1,o.map.height):"row"==e?new Hy(c,0,o.map.width,1):o,u="column"==e?a?r.cell:r.header_cell:"row"==e?s?r.cell:r.header_cell:r.cell;o.map.cellsInRect(l).forEach((function(e){var t=e+o.tableStart,n=i.doc.nodeAt(t);n&&i.setNodeMarkup(t,u,n.attrs)})),n(i)}return!0}}function jw(e){return function(t,n){if(!Yy(t))return!1;var r=function(e,t){if(t<0){var n=e.nodeBefore;if(n)return e.pos-n.nodeSize;for(var r=e.index(-1)-1,o=e.before();r>=0;r--){var i=e.node(-1).child(r);if(i.childCount)return o-1-i.lastChild.nodeSize;o-=i.nodeSize}}else{if(e.index()<e.parent.childCount-1)return e.pos+e.nodeAfter.nodeSize;for(var s=e.node(-1),a=e.indexAfter(-1),c=e.after();a<s.childCount;a++){var l=s.child(a);if(l.childCount)return c+1;c+=l.nodeSize}}}(ew(t),e);if(null!=r){if(n){var o=t.doc.resolve(r);n(t.tr.setSelection(Rt.between(o,(i=o,i.node(0).resolve(i.pos+i.nodeAfter.nodeSize)))).scrollIntoView())}var i;return!0}}}function Lw(e,t){for(var n=e.selection.$anchor,r=n.depth;r>0;r--){if("table"==n.node(r).type.spec.tableRole)return t&&t(e.tr.delete(n.before(r),n.after(r)).scrollIntoView()),!0}return!1}Bw("row",{useDeprecatedLogic:!0}),Bw("column",{useDeprecatedLogic:!0}),Bw("cell",{useDeprecatedLogic:!0});var Vw=function(e,t){this.node=e,this.cellMinWidth=t,this.dom=document.createElement("div"),this.dom.className="tableWrapper",this.table=this.dom.appendChild(document.createElement("table")),this.colgroup=this.table.appendChild(document.createElement("colgroup")),Ww(e,this.colgroup,this.table,t),this.contentDOM=this.table.appendChild(document.createElement("tbody"))};function Ww(e,t,n,r,o,i){for(var s=0,a=!0,c=t.firstChild,l=e.firstChild,u=0,f=0;u<l.childCount;u++)for(var d=l.child(u).attrs,p=d.colspan,h=d.colwidth,m=0;m<p;m++,f++){var v=o==f?i:h&&h[m],g=v?v+"px":"";s+=v||r,v||(a=!1),c?(c.style.width!=g&&(c.style.width=g),c=c.nextSibling):t.appendChild(document.createElement("col")).style.width=g}for(;c;){var y=c.nextSibling;c.parentNode.removeChild(c),c=y}a?(n.style.width=s+"px",n.style.minWidth=""):(n.style.width="",n.style.minWidth=s+"px")}Vw.prototype.update=function(e){return e.type==this.node.type&&(this.node=e,Ww(e,this.colgroup,this.table,this.cellMinWidth),!0)},Vw.prototype.ignoreMutation=function(e){return"attributes"==e.type&&(e.target==this.table||this.colgroup.contains(e.target))};var qw=new tn("tableColumnResizing");function Hw(e){void 0===e&&(e={});var t=e.handleWidth;void 0===t&&(t=5);var n=e.cellMinWidth;void 0===n&&(n=25);var r=e.View;void 0===r&&(r=Vw);var o=e.lastColumnResizable;return void 0===o&&(o=!0),new Zt({key:qw,state:{init:function(e,t){return this.spec.props.nodeViews[Qy(t.schema).table.name]=function(e,t){return new r(e,n,t)},new Jw(-1,!1)},apply:function(e,t){return t.apply(e)}},props:{attributes:function(e){return qw.getState(e).activeHandle>-1?{class:"resize-cursor"}:null},handleDOMEvents:{mousemove:function(e,n){!function(e,t,n,r,o){var i=qw.getState(e.state);if(!i.dragging){var s=function(e){for(;e&&"TD"!=e.nodeName&&"TH"!=e.nodeName;)e=e.classList.contains("ProseMirror")?null:e.parentNode;return e}(t.target),a=-1;if(s){var c=s.getBoundingClientRect(),l=c.left,u=c.right;t.clientX-l<=n?a=Kw(e,t,"left"):u-t.clientX<=n&&(a=Kw(e,t,"right"))}if(a!=i.activeHandle){if(!o&&-1!==a){var f=e.state.doc.resolve(a),d=f.node(-1),p=Jy.get(d),h=f.start(-1);if(p.colCount(f.pos-h)+f.nodeAfter.attrs.colspan-1==p.width-1)return}Gw(e,a)}}}(e,n,t,0,o)},mouseleave:function(e){!function(e){var t=qw.getState(e.state);t.activeHandle>-1&&!t.dragging&&Gw(e,-1)}(e)},mousedown:function(e,t){!function(e,t,n){var r=qw.getState(e.state);if(-1==r.activeHandle||r.dragging)return!1;var o=e.state.doc.nodeAt(r.activeHandle),i=function(e,t,n){var r=n.colspan,o=n.colwidth,i=o&&o[o.length-1];if(i)return i;var s=e.domAtPos(t),a=s.node.childNodes[s.offset].offsetWidth,c=r;if(o)for(var l=0;l<r;l++)o[l]&&(a-=o[l],c--);return a/c}(e,r.activeHandle,o.attrs);function s(t){window.removeEventListener("mouseup",s),window.removeEventListener("mousemove",a);var r=qw.getState(e.state);r.dragging&&(!function(e,t,n){for(var r=e.state.doc.resolve(t),o=r.node(-1),i=Jy.get(o),s=r.start(-1),a=i.colCount(r.pos-s)+r.nodeAfter.attrs.colspan-1,c=e.state.tr,l=0;l<i.height;l++){var u=l*i.width+a;if(!l||i.map[u]!=i.map[u-i.width]){var f=i.map[u],d=o.nodeAt(f).attrs,p=1==d.colspan?0:a-i.colCount(f);if(!d.colwidth||d.colwidth[p]!=n){var h=d.colwidth?d.colwidth.slice():Qw(d.colspan);h[p]=n,c.setNodeMarkup(s+f,null,ow(d,"colwidth",h))}}}c.docChanged&&e.dispatch(c)}(e,r.activeHandle,Uw(r.dragging,t,n)),e.dispatch(e.state.tr.setMeta(qw,{setDragging:null})))}function a(t){if(!t.which)return s(t);var r=qw.getState(e.state),o=Uw(r.dragging,t,n);!function(e,t,n,r){var o=e.state.doc.resolve(t),i=o.node(-1),s=o.start(-1),a=Jy.get(i).colCount(o.pos-s)+o.nodeAfter.attrs.colspan-1,c=e.domAtPos(o.start(-1)).node;for(;"TABLE"!=c.nodeName;)c=c.parentNode;Ww(i,c.firstChild,c,r,a,n)}(e,r.activeHandle,o,n)}e.dispatch(e.state.tr.setMeta(qw,{setDragging:{startX:t.clientX,startWidth:i}})),window.addEventListener("mouseup",s),window.addEventListener("mousemove",a),t.preventDefault()}(e,t,n)}},decorations:function(e){var t=qw.getState(e);if(t.activeHandle>-1)return function(e,t){for(var n=[],r=e.doc.resolve(t),o=r.node(-1),i=Jy.get(o),s=r.start(-1),a=i.colCount(r.pos-s)+r.nodeAfter.attrs.colspan,c=0;c<i.height;c++){var l=a+c*i.width-1;if(!(a!=i.width&&i.map[l]==i.map[l+1]||0!=c&&i.map[l-1]==i.map[l-1-i.width])){var u=i.map[l],f=s+u+o.nodeAt(u).nodeSize-1,d=document.createElement("div");d.className="column-resize-handle",n.push(To.widget(f,d))}}return Io.create(e.doc,n)}(e,t.activeHandle)},nodeViews:{}}})}var Jw=function(e,t){this.activeHandle=e,this.dragging=t};function Kw(e,t,n){var r=e.posAtCoords({left:t.clientX,top:t.clientY});if(!r)return-1;var o=r.pos,i=Zy(e.state.doc.resolve(o));if(!i)return-1;if("right"==n)return i.pos;var s=Jy.get(i.node(-1)),a=i.start(-1),c=s.map.indexOf(i.pos-a);return c%s.width==0?-1:a+s.map[c-1]}function Uw(e,t,n){var r=t.clientX-e.startX;return Math.max(n,e.startWidth+r)}function Gw(e,t){e.dispatch(e.state.tr.setMeta(qw,{setHandle:t}))}function Qw(e){for(var t=[],n=0;n<e;n++)t.push(0);return t}function Xw(e){void 0===e&&(e={});var t=e.allowTableNodeSelection;return void 0===t&&(t=!1),new Zt({key:Xy,state:{init:function(){return null},apply:function(e,t){var n=e.getMeta(Xy);if(null!=n)return-1==n?null:n;if(null==t||!e.docChanged)return t;var r=e.mapping.mapResult(t),o=r.deleted,i=r.pos;return o?null:i}},props:{decorations:lw,handleDOMEvents:{mousedown:xw},createSelectionBetween:function(e){if(null!=Xy.getState(e.state))return e.state.selection},handleTripleClick:bw,handleKeyDown:mw,handlePaste:kw},appendTransaction:function(e,n,r){return function(e,t,n){var r,o,i=(t||e).selection,s=(t||e).doc;if(i instanceof Pt&&(o=i.node.type.spec.tableRole)){if("cell"==o||"header_cell"==o)r=aw.create(s,i.from);else if("row"==o){var a=s.resolve(i.from+1);r=aw.rowSelection(a,a)}else if(!n){var c=Jy.get(i.node),l=i.from+1,u=l+c.map[c.width*c.height-1];r=aw.create(s,l+1,u)}}else i instanceof Rt&&function(e){var t=e.$from,n=e.$to;if(t.pos==n.pos||t.pos<t.pos-6)return!1;for(var r=t.pos,o=n.pos,i=t.depth;i>=0&&!(t.after(i+1)<t.end(i));i--,r++);for(var s=n.depth;s>=0&&!(n.before(s+1)>n.start(s));s--,o--);return r==o&&/row|table/.test(t.node(i).type.spec.tableRole)}(i)?r=Rt.create(s,i.from):i instanceof Rt&&function(e){for(var t,n,r=e.$from,o=e.$to,i=r.depth;i>0;i--){var s=r.node(i);if("cell"===s.type.spec.tableRole||"header_cell"===s.type.spec.tableRole){t=s;break}}for(var a=o.depth;a>0;a--){var c=o.node(a);if("cell"===c.type.spec.tableRole||"header_cell"===c.type.spec.tableRole){n=c;break}}return t!==n&&0===o.parentOffset}(i)&&(r=Rt.create(s,i.$from.start(),i.$from.end()));return r&&(t||(t=e.tr)).setSelection(r),t}(r,Ew(r,n),t)}})}Jw.prototype.apply=function(e){var t=this,n=e.getMeta(qw);if(n&&null!=n.setHandle)return new Jw(n.setHandle,null);if(n&&void 0!==n.setDragging)return new Jw(t.activeHandle,n.setDragging);if(t.activeHandle>-1&&e.docChanged){var r=e.mapping.map(t.activeHandle,-1);tw(e.doc.resolve(r))||(r=null),t=new Jw(r,t.dragging)}return t};var Zw={},Yw=Yc,eb=el,tb=nl,nb=wa,rb=jc,ob=Lc,ib={tokenize:function(e,t,n){return function(t){return e.consume(t),r};function r(t){return 87===t||t-32==87?(e.consume(t),o):n(t)}function o(t){return 87===t||t-32==87?(e.consume(t),i):n(t)}function i(t){return 46===t?(e.consume(t),s):n(t)}function s(e){return null===e||nb(e)?n(e):t(e)}},partial:!0},sb={tokenize:function(e,t,n){var r,o;return i;function i(t){return 38===t?e.check(lb,a,s)(t):46===t||95===t?e.check(cb,a,s)(t):tb(t)||ob(t)||45!==t&&rb(t)?a(t):(e.consume(t),i)}function s(t){return 46===t?(o=r,r=void 0,e.consume(t),i):(95===t&&(r=!0),e.consume(t),i)}function a(e){return o||r?n(e):t(e)}},partial:!0},ab={tokenize:function(e,t){var n=0;return r;function r(s){return 38===s?e.check(lb,t,o)(s):(40===s&&n++,41===s?e.check(cb,i,o)(s):vb(s)?t(s):mb(s)?e.check(cb,t,o)(s):(e.consume(s),r))}function o(t){return e.consume(t),r}function i(e){return--n<0?t(e):o(e)}},partial:!0},cb={tokenize:function(e,t,n){return function(t){return e.consume(t),r};function r(o){return mb(o)?(e.consume(o),r):vb(o)?t(o):n(o)}},partial:!0},lb={tokenize:function(e,t,n){return function(t){return e.consume(t),r};function r(t){return Yw(t)?(e.consume(t),r):59===t?(e.consume(t),o):n(t)}function o(e){return vb(e)?t(e):n(e)}},partial:!0},ub={tokenize:function(e,t,n){var r=this;return function(t){if(87!==t&&t-32!=87||!yb(r.previous)||kb(r.events))return n(t);return e.enter("literalAutolink"),e.enter("literalAutolinkWww"),e.check(ib,e.attempt(sb,e.attempt(ab,o),n),n)(t)};function o(n){return e.exit("literalAutolinkWww"),e.exit("literalAutolink"),t(n)}},previous:yb},fb={tokenize:function(e,t,n){var r=this;return function(t){if(72!==t&&t-32!=72||!wb(r.previous)||kb(r.events))return n(t);return e.enter("literalAutolink"),e.enter("literalAutolinkHttp"),e.consume(t),o};function o(t){return 84===t||t-32==84?(e.consume(t),i):n(t)}function i(t){return 84===t||t-32==84?(e.consume(t),s):n(t)}function s(t){return 80===t||t-32==80?(e.consume(t),a):n(t)}function a(t){return 83===t||t-32==83?(e.consume(t),c):c(t)}function c(t){return 58===t?(e.consume(t),l):n(t)}function l(t){return 47===t?(e.consume(t),u):n(t)}function u(t){return 47===t?(e.consume(t),f):n(t)}function f(t){return tb(t)||ob(t)||rb(t)?n(t):e.attempt(sb,e.attempt(ab,d),n)(t)}function d(n){return e.exit("literalAutolinkHttp"),e.exit("literalAutolink"),t(n)}},previous:wb},db={tokenize:function(e,t,n){var r,o=this;return function(t){if(!gb(t)||!bb(o.previous)||kb(o.events))return n(t);return e.enter("literalAutolink"),e.enter("literalAutolinkEmail"),i(t)};function i(t){return gb(t)?(e.consume(t),i):64===t?(e.consume(t),s):n(t)}function s(t){return 46===t?e.check(cb,u,a)(t):45===t||95===t?e.check(cb,n,c)(t):eb(t)?(e.consume(t),s):u(t)}function a(t){return e.consume(t),r=!0,s}function c(t){return e.consume(t),l}function l(t){return 46===t?e.check(cb,n,a)(t):s(t)}function u(o){return r?(e.exit("literalAutolinkEmail"),e.exit("literalAutolink"),t(o)):n(o)}},previous:bb},pb={};Zw.text=pb;for(var hb=48;hb<123;)pb[hb]=db,58===++hb?hb=65:91===hb&&(hb=97);function mb(e){return 33===e||34===e||39===e||41===e||42===e||44===e||46===e||58===e||59===e||60===e||63===e||95===e||126===e}function vb(e){return null===e||e<0||32===e||60===e}function gb(e){return 43===e||45===e||46===e||95===e||eb(e)}function yb(e){return null===e||e<0||32===e||40===e||42===e||95===e||126===e}function wb(e){return null===e||!Yw(e)}function bb(e){return 47!==e&&wb(e)}function kb(e){for(var t=e.length;t--;)if(("labelLink"===e[t][1].type||"labelImage"===e[t][1].type)&&!e[t][1]._balanced)return!0}pb[43]=db,pb[45]=db,pb[46]=db,pb[95]=db,pb[72]=[db,fb],pb[104]=[db,fb],pb[87]=[db,ub],pb[119]=[db,ub];var xb=Zw,Sb=function(e){var t=(e||{}).singleTilde,n={tokenize:function(e,n,r){var o=this.previous,i=this.events,s=0;return a;function a(t){return 126!==t||126===o&&"characterEscape"!==i[i.length-1][1].type?r(t):(e.enter("strikethroughSequenceTemporary"),c(t))}function c(i){var a,l,u=Cb(o);return 126===i?s>1?r(i):(e.consume(i),s++,c):s<2&&!t?r(i):(a=e.exit("strikethroughSequenceTemporary"),l=Cb(i),a._open=!l||2===l&&u,a._close=!u||2===u&&l,n(i))}},resolveAll:function(e,t){var n,r,o,i,s=-1;for(;++s<e.length;)if("enter"===e[s][0]&&"strikethroughSequenceTemporary"===e[s][1].type&&e[s][1]._close)for(o=s;o--;)if("exit"===e[o][0]&&"strikethroughSequenceTemporary"===e[o][1].type&&e[o][1]._open&&e[s][1].end.offset-e[s][1].start.offset==e[o][1].end.offset-e[o][1].start.offset){e[s][1].type="strikethroughSequence",e[o][1].type="strikethroughSequence",n={type:"strikethrough",start:Ab(e[o][1].start),end:Ab(e[s][1].end)},r={type:"strikethroughText",start:Ab(e[o][1].end),end:Ab(e[s][1].start)},i=[["enter",n,t],["enter",e[o][1],t],["exit",e[o][1],t],["enter",r,t]],Mb(i,i.length,0,Ob(t.parser.constructs.insideSpan.null,e.slice(o+1,s),t)),Mb(i,i.length,0,[["exit",r,t],["enter",e[s][1],t],["exit",e[s][1],t],["exit",n,t]]),Mb(e,o-1,s-o+3,i),s=o+i.length-2;break}return function(e){var t=-1,n=e.length;for(;++t<n;)"strikethroughSequenceTemporary"===e[t][1].type&&(e[t][1].type="data");return e}(e)}};null==t&&(t=!0);return{text:{126:n},insideSpan:{null:n}}},Cb=Hc,Mb=La,Ob=Cc,Ab=Wa;var Eb={};Eb.flow={null:{tokenize:function(e,t,n){var r,o,i=[],s=0;return function(t){if(null===t||-5===t||-4===t||-3===t)return n(t);if(e.enter("table")._align=i,e.enter("tableHead"),e.enter("tableRow"),124===t)return a(t);return s++,e.enter("temporaryTableCellContent"),u(t)};function a(t){return e.enter("tableCellDivider"),e.consume(t),e.exit("tableCellDivider"),r=!0,c}function c(t){return null===t||-5===t||-4===t||-3===t?function(t){if(null===t)return n(t);return e.exit("tableRow"),e.exit("tableHead"),e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),e.check(Nb,n,Tb(e,d,"linePrefix",4))}(t):-2===t||-1===t||32===t?(e.enter("whitespace"),e.consume(t),l):(r&&(r=void 0,s++),124===t?a(t):(e.enter("temporaryTableCellContent"),u(t)))}function l(t){return-2===t||-1===t||32===t?(e.consume(t),l):(e.exit("whitespace"),c(t))}function u(t){return null===t||t<0||32===t||124===t?(e.exit("temporaryTableCellContent"),c(t)):(e.consume(t),92===t?f:u)}function f(t){return 92===t||124===t?(e.consume(t),u):u(t)}function d(t){return null===t||t<0||32===t?n(t):(e.enter("tableDelimiterRow"),p(t))}function p(t){return null===t||-5===t||-4===t||-3===t?y(t):-2===t||-1===t||32===t?(e.enter("whitespace"),e.consume(t),h):45===t?(e.enter("tableDelimiterFiller"),e.consume(t),o=!0,i.push(null),m):58===t?(e.enter("tableDelimiterAlignment"),e.consume(t),e.exit("tableDelimiterAlignment"),i.push("left"),v):124===t?(e.enter("tableCellDivider"),e.consume(t),e.exit("tableCellDivider"),p):n(t)}function h(t){return-2===t||-1===t||32===t?(e.consume(t),h):(e.exit("whitespace"),p(t))}function m(t){return 45===t?(e.consume(t),m):(e.exit("tableDelimiterFiller"),58===t?(e.enter("tableDelimiterAlignment"),e.consume(t),e.exit("tableDelimiterAlignment"),i[i.length-1]="left"===i[i.length-1]?"center":"right",g):p(t))}function v(t){return 45===t?(e.enter("tableDelimiterFiller"),e.consume(t),o=!0,m):n(t)}function g(t){return null===t||-5===t||-4===t||-3===t?y(t):-2===t||-1===t||32===t?(e.enter("whitespace"),e.consume(t),h):124===t?(e.enter("tableCellDivider"),e.consume(t),e.exit("tableCellDivider"),p):n(t)}function y(t){return e.exit("tableDelimiterRow"),o&&s===i.length?null===t?w(t):e.check(Db,w,b)(t):n(t)}function w(n){return e.exit("table"),t(n)}function b(t){return e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),Tb(e,k,"linePrefix",4)}function k(t){return e.enter("tableBody"),x(t)}function x(t){return e.enter("tableRow"),124===t?S(t):(e.enter("temporaryTableCellContent"),O(t))}function S(t){return e.enter("tableCellDivider"),e.consume(t),e.exit("tableCellDivider"),C}function C(t){return null===t||-5===t||-4===t||-3===t?function(t){if(e.exit("tableRow"),null===t)return E(t);return e.check(Db,E,T)(t)}(t):-2===t||-1===t||32===t?(e.enter("whitespace"),e.consume(t),M):124===t?S(t):(e.enter("temporaryTableCellContent"),O(t))}function M(t){return-2===t||-1===t||32===t?(e.consume(t),M):(e.exit("whitespace"),C(t))}function O(t){return null===t||t<0||32===t||124===t?(e.exit("temporaryTableCellContent"),C(t)):(e.consume(t),92===t?A:O)}function A(t){return 92===t||124===t?(e.consume(t),O):O(t)}function E(t){return e.exit("tableBody"),w(t)}function T(t){return e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),Tb(e,x,"linePrefix",4)}},resolve:function(e,t){var n,r,o,i,s,a,c,l,u,f,d=e.length,p=-1;for(;++p<d;)n=e[p][1],i&&("temporaryTableCellContent"===n.type&&(l=l||p,u=p),"tableCellDivider"!==n.type&&"tableRow"!==n.type||!u||(a={type:"tableContent",start:e[l][1].start,end:e[u][1].end},c={type:"chunkText",start:a.start,end:a.end,contentType:"text"},e.splice(l,u-l+1,["enter",a,t],["enter",c,t],["exit",c,t],["exit",a,t]),p-=u-l-3,d=e.length,l=void 0,u=void 0)),"exit"===e[p][0]&&f&&f+1<p&&("tableCellDivider"===n.type||"tableRow"===n.type&&(f+3<p||"whitespace"!==e[f][1].type))&&(s={type:o?"tableDelimiter":r?"tableHeader":"tableData",start:e[f][1].start,end:e[p][1].end},e.splice(p+("tableCellDivider"===n.type?1:0),0,["exit",s,t]),e.splice(f,0,["enter",s,t]),p+=2,d=e.length,f=p+1),"tableRow"===n.type&&(i="enter"===e[p][0])&&(f=p+1),"tableDelimiterRow"===n.type&&(o="enter"===e[p][0])&&(f=p+1),"tableHead"===n.type&&(r="enter"===e[p][0]);return e},interruptible:!0}};var Tb=xa,Nb={tokenize:function(e,t,n){return function(t){if(45!==t)return n(t);return e.enter("setextUnderline"),r(t)};function r(t){return 45===t?(e.consume(t),r):o(t)}function o(r){return-2===r||-1===r||32===r?(e.consume(r),o):null===r||-5===r||-4===r||-3===r?t(r):n(r)}},partial:!0},Db={tokenize:function(e,t,n){var r=0;return function(t){return e.enter("check"),e.consume(t),o};function o(i){return-1===i||32===i?(e.consume(i),4===++r?t:o):null===i||i<0?t(i):n(i)}},partial:!0};var zb=Eb,Ib={},$b=Pc,Rb=xa,Fb=Ba,Pb={tokenize:function(e,t,n){var r=this;return function(t){if(91!==t||null!==r.previous||!r._gfmTasklistFirstContentOfListItem)return n(t);return e.enter("taskListCheck"),e.enter("taskListCheckMarker"),e.consume(t),e.exit("taskListCheckMarker"),o};function o(t){return-2===t||32===t?(e.enter("taskListCheckValueUnchecked"),e.consume(t),e.exit("taskListCheckValueUnchecked"),i):88===t||120===t?(e.enter("taskListCheckValueChecked"),e.consume(t),e.exit("taskListCheckValueChecked"),i):n(t)}function i(r){return 93===r?(e.enter("taskListCheckMarker"),e.consume(r),e.exit("taskListCheckMarker"),e.exit("taskListCheck"),e.check({tokenize:_b},t,n)):n(r)}}};function _b(e,t,n){var r=this;return Rb(e,(function(e){return Fb(r.events,"whitespace")&&null!==e&&!$b(e)?t(e):n(e)}),"whitespace")}Ib.text={91:Pb};var Bb=kc,jb=xb,Lb=Sb,Vb=zb,Wb=Ib;var qb=function(e){return Bb([jb,Lb(e),Vb,Wb])},Hb={};var Jb=function(e,t,n,r){var o,i;"string"==typeof t||t&&"function"==typeof t.exec?i=[[t,n]]:(i=t,r=n);return Xb(e,o=r||{},function e(t){var n=t[0];return r;function r(r,i){var s,a,c,l,u=n[0],f=n[1],d=[],p=0,h=i.children.indexOf(r);for(u.lastIndex=0,a=u.exec(r.value);a&&(s=a.index,!1!==(l=f.apply(null,[].concat(a,{index:a.index,input:a.input})))&&(p!==s&&d.push({type:"text",value:r.value.slice(p,s)}),"string"==typeof l&&l.length>0&&(l={type:"text",value:l}),l&&(d=[].concat(d,l)),p=s+a[0].length),u.global);)a=u.exec(r.value);if(void 0===s?(d=[r],h--):(p<r.value.length&&d.push({type:"text",value:r.value.slice(p)}),d.unshift(h,1),Qb.apply(i.children,d)),t.length>1)for(c=e(t.slice(1)),s=-1;++s<d.length;)"text"===(r=d[s]).type?c(r,i):Xb(r,o,c);return h+d.length+1}}(function(e){var t,n,r=[];if("object"!=typeof e)throw new Error("Expected array or object as schema");if("length"in e)for(n=-1;++n<e.length;)r.push([Zb(e[n][0]),Yb(e[n][1])]);else for(t in e)r.push([Zb(t),Yb(e[t])]);return r}(i))),e},Kb=yy,Ub=my,Gb=e=>{if("string"!=typeof e)throw new TypeError("Expected a string");return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")},Qb=[].splice;function Xb(e,t,n){var r=Ub(t.ignore||[]);return Kb(e,"text",(function(e,t){var o,i,s=-1;for(;++s<t.length;){if(o=t[s],r(o,i?i.children.indexOf(o):void 0,i))return;i=o}return n(e,i)})),[]}function Zb(e){return"string"==typeof e?new RegExp(Gb(e),"g"):e}function Yb(e){return"function"==typeof e?e:function(){return e}}var ek=function(e,t){var n,r=String(e),o=0;if("string"!=typeof t)throw new Error("Expected character");n=r.indexOf(t);for(;-1!==n;)o++,n=r.indexOf(t,n+t.length);return o},tk=Jb,nk=jc,rk=Lc;function ok(e){this.config.enter.autolinkProtocol.call(this,e)}function ik(e,t,n,r,o){var i,s,a="";return!!ak(o)&&(/^w/i.test(t)&&(n=t+n,t="",a="http://"),!!function(e){var t=e.split(".");if(t.length<2||t[t.length-1]&&(/_/.test(t[t.length-1])||!/[a-zA-Z\d]/.test(t[t.length-1]))||t[t.length-2]&&(/_/.test(t[t.length-2])||!/[a-zA-Z\d]/.test(t[t.length-2])))return!1;return!0}(n)&&(!!(i=function(e){var t,n,r,o=/[!"&'),.:;<>?\]}]+$/.exec(e);if(o)for(e=e.slice(0,o.index),t=(o=o[0]).indexOf(")"),n=ek(e,"("),r=ek(e,")");-1!==t&&n>r;)e+=o.slice(0,t+1),t=(o=o.slice(t+1)).indexOf(")"),r++;return[e,o]}(n+r))[0]&&(s={type:"link",title:null,url:a+t+i[0],children:[{type:"text",value:t+i[0]}]},i[1]&&(s=[s,{type:"text",value:i[1]}]),s)))}function sk(e,t,n,r){return!(!ak(r,!0)||/[_-]$/.test(n))&&{type:"link",title:null,url:"mailto:"+t+"@"+n,children:[{type:"text",value:t+"@"+n}]}}function ak(e,t){var n=e.input.charCodeAt(e.index-1);return(n!=n||rk(n)||nk(n))&&(!t||47!==n)}Hb.transforms=[function(e){tk(e,[[/(https?:\/\/|www(?=\.))([-.\w]+)([^ \t\r\n]*)/i,ik],[/([-.\w+]+)@([-\w]+(?:\.[-\w]+)+)/,sk]],{ignore:["link","linkReference"]})}],Hb.enter={literalAutolink:function(e){this.enter({type:"link",title:null,url:"",children:[]},e)},literalAutolinkEmail:ok,literalAutolinkHttp:ok,literalAutolinkWww:ok},Hb.exit={literalAutolink:function(e){this.exit(e)},literalAutolinkEmail:function(e){this.config.exit.autolinkEmail.call(this,e)},literalAutolinkHttp:function(e){this.config.exit.autolinkProtocol.call(this,e)},literalAutolinkWww:function(e){this.config.exit.data.call(this,e),this.stack[this.stack.length-1].url="http://"+this.sliceSerialize(e)}};var ck={};ck.canContainEols=["delete"],ck.enter={strikethrough:function(e){this.enter({type:"delete",children:[]},e)}},ck.exit={strikethrough:function(e){this.exit(e)}};var lk={};function uk(e){this.exit(e)}function fk(e){this.enter({type:"tableCell",children:[]},e)}function dk(e,t){return"|"===t?t:e}lk.enter={table:function(e){this.enter({type:"table",align:e._align,children:[]},e),this.setData("inTable",!0)},tableData:fk,tableHeader:fk,tableRow:function(e){this.enter({type:"tableRow",children:[]},e)}},lk.exit={codeText:function(e){var t=this.resume();this.getData("inTable")&&(t=t.replace(/\\([\\|])/g,dk));this.stack[this.stack.length-1].value=t,this.exit(e)},table:function(e){this.exit(e),this.setData("inTable")},tableData:uk,tableHeader:uk,tableRow:uk};var pk={};function hk(e){this.stack[this.stack.length-2].checked="taskListCheckValueChecked"===e.type}pk.exit={taskListCheckValueChecked:hk,taskListCheckValueUnchecked:hk,paragraph:function(e){var t,n=this.stack[this.stack.length-2],r=this.stack[this.stack.length-1],o=n.children,i=r.children[0],s=-1;if(n&&"listItem"===n.type&&"boolean"==typeof n.checked&&i&&"text"===i.type){for(;++s<o.length;)if("paragraph"===o[s].type){t=o[s];break}t===r&&(i.value=i.value.slice(1),0===i.value.length?r.children.shift():(i.position.start.column++,i.position.start.offset++,r.position.start=Object.assign({},i.position.start)))}this.exit(e)}};var mk={}.hasOwnProperty,vk=function(e){var t={transforms:[],canContainEols:[]},n=e.length,r=-1;for(;++r<n;)gk(t,e[r]);return t}([Hb,ck,lk,pk]);function gk(e,t){var n,r,o;for(n in t)r=mk.call(e,n)?e[n]:e[n]={},o=t[n],"canContainEols"===n||"transforms"===n?e[n]=[].concat(r,o):Object.assign(r,o)}var yk={},wk=["autolink","link","image","label"];yk.unsafe=[{character:"@",before:"[+\\-.\\w]",after:"[\\-.\\w]",inConstruct:"phrasing",notInConstruct:wk},{character:".",before:"[Ww]",after:"[\\-.\\w]",inConstruct:"phrasing",notInConstruct:wk},{character:":",before:"[ps]",after:"\\/",inConstruct:"phrasing",notInConstruct:wk}];var bk={},kk=qd;function xk(e,t,n){var r=n.enter("emphasis"),o=kk(e,n,{before:"~",after:"~"});return r(),"~~"+o+"~~"}bk.unsafe=[{character:"~",inConstruct:"phrasing"}],bk.handlers={delete:xk},xk.peek=function(){return"~"};var Sk=id,Ck=function(e,t){var n,r,o,i,s,a,c,l,u,f,d,p=t||{},h=!1!==p.padding,m=!1!==p.delimiterStart,v=!1!==p.delimiterEnd,g=(p.align||[]).concat(),y=!1!==p.alignDelimiters,w=[],b=p.stringLength||Ak,k=-1,x=e.length,S=[],C=[],M=[],O=[],A=[],E=0;for(;++k<x;){for(n=e[k],r=-1,o=n.length,M=[],O=[],o>E&&(E=o);++r<o;)T=n[r],a=null==T?"":String(T),!0===y&&(s=b(a),O[r]=s,(void 0===(i=A[r])||s>i)&&(A[r]=s)),M.push(a);S[k]=M,C[k]=O}var T;if(r=-1,o=E,"object"==typeof g&&"length"in g)for(;++r<o;)w[r]=Ek(g[r]);else for(d=Ek(g);++r<o;)w[r]=d;r=-1,o=E,M=[],O=[];for(;++r<o;)d=w[r],u="",f="",108===d?u=":":d===Ok?f=":":99===d&&(u=":",f=":"),s=y?Math.max(1,A[r]-u.length-f.length):1,a=u+Sk("-",s)+f,!0===y&&((s=u.length+s+f.length)>A[r]&&(A[r]=s),O[r]=s),M[r]=a;S.splice(1,0,M),C.splice(1,0,O),k=-1,x=S.length,c=[];for(;++k<x;){for(M=S[k],O=C[k],r=-1,o=E,l=[];++r<o;)a=M[r]||"",u="",f="",!0===y&&(s=A[r]-(O[r]||0),(d=w[r])===Ok?u=Sk(" ",s):99===d?s%2==0?(u=Sk(" ",s/2),f=u):(u=Sk(" ",s/2+.5),f=Sk(" ",s/2-.5)):f=Sk(" ",s)),!0===m&&0===r&&l.push("|"),!0!==h||!1===y&&""===a||!0!==m&&0===r||l.push(" "),!0===y&&l.push(u),l.push(a),!0===y&&l.push(f),!0===h&&l.push(" "),!0!==v&&r===o-1||l.push("|");l=l.join(""),!1===v&&(l=l.replace(Mk,"")),c.push(l)}return c.join("\n")},Mk=/ +$/,Ok=114;function Ak(e){return e.length}function Ek(e){var t="string"==typeof e?e.charCodeAt(0):0;return 76===t||108===t?108:82===t||t===Ok?Ok:67===t||99===t?99:0}var Tk=qd,Nk=fp,Dk=Ck,zk=function(e){var t=e||{},n=t.tableCellPadding,r=t.tablePipeAlign,o=t.stringLength,i=n?" ":"|";return{unsafe:[{character:"\r",inConstruct:"tableCell"},{character:"\n",inConstruct:"tableCell"},{atBreak:!0,character:"|",after:"[\t :-]"},{character:"|",inConstruct:"tableCell"},{atBreak:!0,character:":",after:"-"},{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{table:function(e,t,n){return a(function(e,t){var n=e.children,r=-1,o=n.length,i=[],s=t.enter("table");for(;++r<o;)i[r]=c(n[r],t);return s(),i}(e,n),e.align)},tableRow:function(e,t,n){var r=a([c(e,n)]);return r.slice(0,r.indexOf("\n"))},tableCell:s,inlineCode:function(e,t,n){var r=Nk(e,t,n);-1!==n.stack.indexOf("tableCell")&&(r=r.replace(/\|/g,"\\$&"));return r}}};function s(e,t,n){var r=n.enter("tableCell"),o=Tk(e,n,{before:i,after:i});return r(),o}function a(e,t){return Dk(e,{align:t,alignDelimiters:r,padding:n,stringLength:o})}function c(e,t){for(var n=e.children,r=-1,o=n.length,i=[],a=t.enter("tableRow");++r<o;)i[r]=s(n[r],0,t);return a(),i}};var Ik={},$k=Tp;Ik.unsafe=[{atBreak:!0,character:"-",after:"[:|-]"}],Ik.handlers={listItem:function(e,t,n){var r=$k(e,t,n),o=e.children[0];"boolean"==typeof e.checked&&o&&"paragraph"===o.type&&(r=r.replace(/^(?:[*+-]|\d+\.)([\r\n]| {1,3})/,(function(t){return t+"["+(e.checked?"x":" ")+"] "})));return r}};var Rk=yk,Fk=bk,Pk=zk,_k=Ik,Bk=td;var jk,Lk=qb,Vk=vk,Wk=function(e){var t=Bk({handlers:{},join:[],unsafe:[],options:{}},{extensions:[Rk,Fk,Pk(e),_k]});return Object.assign(t.options,{handlers:t.handlers,join:t.join,unsafe:t.unsafe})},qk=function(e){var t=this.data();!jk&&(this.Parser&&this.Parser.prototype&&this.Parser.prototype.blockTokenizers||this.Compiler&&this.Compiler.prototype&&this.Compiler.prototype.visitors)&&(jk=!0,console.warn("[remark-gfm] Warning: please upgrade to remark 13 to use this plugin"));function n(e,n){t[e]?t[e].push(n):t[e]=[n]}n("micromarkExtensions",Lk(e)),n("fromMarkdownExtensions",Vk),n("toMarkdownExtensions",Wk(e))};const Hk=e=>bg((e=>"table"===e.type.spec.tableRole))(e),Jk=(e,t=3,n=3)=>{const{cell:r,header_cell:o,row:i,table:s}=Qy(e),a=Array(n).fill(0).map((()=>r.createAndFill(null))),c=Array(n).fill(0).map((()=>o.createAndFill(null))),l=Array(t).fill(0).map(((e,t)=>i.create(null,0===t?c:a)));return s.create(null,l)},Kk=e=>t=>n=>{const r=Hk(n.selection),o="row"===e;if(r){const e=Jy.get(r.node);if(t>=0&&t<(o?e.height:e.width)){const i=e.positionAt(o?t:e.height-1,o?e.width-1:t,r.node),s=n.doc.resolve(r.start+i),a=o?aw.rowSelection:aw.colSelection,c=e.positionAt(o?t:0,o?0:t,r.node),l=n.doc.resolve(r.start+c);return wg(n.setSelection(a(s,l)))}}return n},Uk=e=>{const t=(e=>{const t=Hk(e);if(!t)return;const n=Jy.get(t.node);return n.cellsInRect({left:0,right:n.width,top:0,bottom:n.height}).map((e=>{const n=t.node.nodeAt(e),r=e+t.start;return{pos:r,start:r+1,node:n}}))})(e.selection);if(t){const n=e.doc.resolve(t[0].pos),r=e.doc.resolve(t[t.length-1].pos);return wg(e.setSelection(new aw(r,n)))}return e};function Gk(e,{map:t,tableStart:n,table:r},o){const i=Array(o).fill(0).reduce(((e,t,n)=>e+r.child(n).nodeSize),n),{cell:s,row:a}=Qy(r.type.schema),c=Array(t.width).fill(0).map(((e,n)=>{const o=r.nodeAt(t.map[n]);return s.createAndFill({alignment:null==o?void 0:o.attrs.alignment})}));return e.insert(i,a.create(null,c)),e}const Qk=function(e){var t=e.cellAttributes||{},n={colspan:{default:1},rowspan:{default:1},colwidth:{default:null}};for(var r in t)n[r]={default:t[r].default};return{table:{content:"table_row+",tableRole:"table",isolating:!0,group:e.tableGroup,parseDOM:[{tag:"table"}],toDOM:function(){return["table",["tbody",0]]}},table_row:{content:"(table_cell | table_header)*",tableRole:"row",parseDOM:[{tag:"tr"}],toDOM:function(){return["tr",0]}},table_cell:{content:e.cellContent,attrs:n,tableRole:"cell",isolating:!0,parseDOM:[{tag:"td",getAttrs:function(e){return Uy(e,t)}}],toDOM:function(e){return["td",Gy(e,t),0]}},table_header:{content:e.cellContent,attrs:n,tableRole:"header_cell",isolating:!0,parseDOM:[{tag:"th",getAttrs:function(e){return Uy(e,t)}}],toDOM:function(e){return["th",Gy(e,t),0]}}}}({tableGroup:"block",cellContent:"paragraph",cellAttributes:{alignment:{default:"left",getFromDOM:e=>e.style.textAlign||"left",setDOMAttr:(e,t)=>{t.style=`text-align: ${e||"left"}`}}}}),Xk=_v`
    /* copy from https://github.com/ProseMirror/prosemirror-tables/blob/master/style/tables.css */
    .ProseMirror .tableWrapper {
        overflow-x: auto;
    }
    .ProseMirror table {
        border-collapse: collapse;
        table-layout: fixed;
        width: 100%;
        overflow: hidden;
    }
    .ProseMirror td,
    .ProseMirror th {
        vertical-align: top;
        box-sizing: border-box;
        position: relative;
    }
    .ProseMirror .column-resize-handle {
        position: absolute;
        right: -2px;
        top: 0;
        bottom: 0;
        width: 4px;
        z-index: 20;
        background-color: #adf;
        pointer-events: none;
    }
    .ProseMirror.resize-cursor {
        cursor: ew-resize;
        cursor: col-resize;
    }
    /* Give selected cells a blue overlay */
    .ProseMirror .selectedCell:after {
        z-index: 2;
        position: absolute;
        content: '';
        left: 0;
        right: 0;
        top: 0;
        bottom: 0;
        background: rgba(200, 200, 255, 0.4);
        pointer-events: none;
    }
`,Zk={NextCell:"NextCell",PrevCell:"PrevCell",ExitTable:"ExitTable"},Yk=wm(),ex=wm(),tx=wm(),nx=wm(),rx=pg(((e,t)=>{const n="table";return(e=>{const t=Pv;e.getStyle((({size:e,palette:n,mixin:r})=>{var o,i,s;t`
            ${Xk}

            .tableWrapper {
                margin: 0 !important;

                ${null===(o=r.scrollbar)||void 0===o?void 0:o.call(r,"x")};

                width: 100%;

                table {
                    width: calc(100% - 2rem) !important;
                    border-radius: ${e.radius};
                    box-sizing: border-box;
                    margin: 1rem 0 1rem 1rem !important;
                    overflow: auto !important;
                    * {
                        margin: 0 !important;
                        box-sizing: border-box;
                        font-size: 1rem;
                    }
                    tr {
                        ${null===(i=r.border)||void 0===i?void 0:i.call(r,"bottom")};
                    }

                    th {
                        background: ${n("background",.5)};
                        font-weight: 400;
                    }

                    th,
                    td {
                        min-width: 100px;
                        ${null===(s=r.border)||void 0===s?void 0:s.call(r)};
                        text-align: left;
                        position: relative;
                        line-height: 3rem;
                        box-sizing: border-box;
                        height: 3rem;
                    }

                    .selectedCell {
                        &::after {
                            background: ${n("secondary",.38)};
                        }
                        & ::selection {
                            background: transparent;
                        }
                    }

                    .column-resize-handle {
                        background: ${n("primary")};
                        width: ${e.lineWidth};
                    }

                    th,
                    td {
                        padding: 0 1rem;
                        p {
                            line-height: unset !important;
                        }
                    }

                    .milkdown-cell-left,
                    .milkdown-cell-point,
                    .milkdown-cell-top {
                        position: absolute;

                        &::after {
                            cursor: pointer;
                            position: absolute;
                            top: 0;
                            left: 0;
                            height: 100%;
                            width: 100%;
                            display: block;
                            transition: all 0.2s ease-in-out;
                            background: ${n("secondary",.12)};
                            content: '';
                        }
                        &:hover::after {
                            background: ${n("secondary",.38)};
                        }
                    }

                    .milkdown-cell-left {
                        left: calc(-6px - 0.5rem);
                        top: 0;
                        bottom: 0;
                        width: 0.5rem;
                    }

                    .milkdown-cell-top {
                        left: 0;
                        right: 0;
                        top: calc(-6px - 0.5rem);
                        height: 0.5rem;
                    }

                    .milkdown-cell-point {
                        left: calc(-2px - 1rem);
                        top: calc(-2px - 1rem);
                        width: 1rem;
                        height: 1rem;

                        .icon {
                            position: absolute;
                            top: 0;
                            bottom: 0;
                            left: 0;
                            right: 0;
                        }
                    }
                }
            }
        `}))})(t),{id:n,schema:Qk.table,parser:{match:e=>"table"===e.type,runner:(e,t,n)=>{const r=t.align,o=t.children.map(((e,t)=>Object.assign(Object.assign({},e),{align:r,isHeader:0===t})));e.openNode(n),e.next(o),e.closeNode()}},serializer:{match:e=>e.type.name===n,runner:(e,t)=>{var n;const r=null===(n=t.content.firstChild)||void 0===n?void 0:n.content;if(!r)return;const o=[];r.forEach((e=>{o.push(e.attrs.alignment)})),e.openNode("table",void 0,{align:o}),e.next(t.content),e.closeNode()}},inputRules:(e,t)=>[new pi(/^\|\|\s$/,((n,r,o,i)=>{const s=n.doc.resolve(o);if(!s.node(-1).canReplaceWith(s.index(-1),s.indexAfter(-1),e))return null;const a=Jk(t),c=n.tr.replaceRangeWith(o,i,a).scrollIntoView();return c.setSelection(Rt.create(c.doc,o+3))}))],commands:(e,t)=>[gm(Yk,(()=>jw(-1))),gm(ex,(()=>jw(1))),gm(tx,(()=>{return e=t.nodes.paragraph,(t,n)=>{if(!Yy(t))return!1;const{$head:r}=t.selection,o=r.after(),i=t.tr.replaceWith(o,o,e.createAndFill());return i.setSelection(zt.near(i.doc.resolve(o),1)),null==n||n(i.scrollIntoView()),!0};var e})),gm(nx,(()=>(e,n)=>{const{selection:r,tr:o}=e,{from:i}=r,s=Jk(t),a=o.replaceSelectionWith(s),c=zt.findFrom(a.doc.resolve(i),1,!0);return c&&(null==n||n(a.setSelection(c))),!0}))],shortcuts:{[Zk.NextCell]:mg(ex,"Mod-]"),[Zk.PrevCell]:mg(Yk,"Mod-["),[Zk.ExitTable]:mg(tx,"Mod-Enter")}}})),ox=pg((()=>{const e="table_cell";return{id:e,schema:Qk.table_cell,parser:{match:e=>"tableCell"===e.type&&!e.isHeader,runner:(e,t,n)=>{const r=t.align;e.openNode(n,{alignment:r}).openNode(e.schema.nodes.paragraph).next(t.children).closeNode().closeNode()}},serializer:{match:t=>t.type.name===e,runner:(e,t)=>{e.openNode("tableCell").next(t.content).closeNode()}}}})),ix=pg((()=>{const e="table_header";return{id:e,schema:Qk.table_header,parser:{match:e=>"tableCell"===e.type&&!!e.isHeader,runner:(e,t,n)=>{const r=t.align;e.openNode(n,{alignment:r}),e.openNode(e.schema.nodes.paragraph),e.next(t.children),e.closeNode(),e.closeNode()}},serializer:{match:t=>t.type.name===e,runner:(e,t)=>{e.openNode("tableCell"),e.next(t.content),e.closeNode()}}}})),sx=pg((()=>{const e="table_row";return{id:e,schema:Qk.table_row,parser:{match:e=>"tableRow"===e.type,runner:(e,t,n)=>{const r=t.align,o=t.children.map(((e,n)=>Object.assign(Object.assign({},e),{align:r[n],isHeader:t.isHeader})));e.openNode(n),e.next(o),e.closeNode()}},serializer:{match:t=>t.type.name===e,runner:(e,t)=>{e.openNode("tableRow"),e.next(t.content),e.closeNode()}}}})),ax=ag.create([rx(),sx(),ox(),ix()]),cx=e=>e.state.selection;var lx,ux;(ux=lx||(lx={}))[ux.AddColLeft=0]="AddColLeft",ux[ux.AddColRight=1]="AddColRight",ux[ux.AddRowTop=2]="AddRowTop",ux[ux.AddRowBottom=3]="AddRowBottom",ux[ux.AlignLeft=4]="AlignLeft",ux[ux.AlignCenter=5]="AlignCenter",ux[ux.AlignRight=6]="AlignRight",ux[ux.Delete=7]="Delete";const fx=e=>({[lx.AddColLeft]:{$:e.ctx.get(Kv).slots.icon("leftArrow"),command:()=>Dw,disable:e=>!cx(e).isColSelection()},[lx.AddColRight]:{$:e.ctx.get(Kv).slots.icon("rightArrow"),command:()=>zw,disable:e=>!cx(e).isColSelection()},[lx.AddRowTop]:{$:e.ctx.get(Kv).slots.icon("upArrow"),command:()=>(e,t)=>{if(!Yy(e))return!1;if(t){const n=Tw(e);t(Gk(e.tr,n,n.top))}return!0},disable:e=>!cx(e).isRowSelection()||"table_header"===cx(e).$head.parent.type.name},[lx.AddRowBottom]:{$:e.ctx.get(Kv).slots.icon("downArrow"),command:()=>(e,t)=>{if(!Yy(e))return!1;if(t){const n=Tw(e);t(Gk(e.tr,n,n.bottom))}return!0},disable:e=>!cx(e).isRowSelection()},[lx.AlignLeft]:{$:e.ctx.get(Kv).slots.icon("alignLeft"),command:()=>Pw("alignment","left"),disable:e=>!cx(e).isColSelection()},[lx.AlignCenter]:{$:e.ctx.get(Kv).slots.icon("alignCenter"),command:()=>Pw("alignment","center"),disable:e=>!cx(e).isColSelection()},[lx.AlignRight]:{$:e.ctx.get(Kv).slots.icon("alignRight"),command:()=>Pw("alignment","right"),disable:e=>!cx(e).isColSelection()},[lx.Delete]:{$:e.ctx.get(Kv).slots.icon("delete"),command:(e,t)=>{const n=cx(t),r=n.isColSelection(),o=n.isRowSelection();return r&&o?Lw:r?$w:Fw},disable:e=>{const t=cx(e);return!!t.isRowSelection()&&(!t.isColSelection()&&(e=>{const t=Jy.get(e.$anchorCell.node(-1)),n=e.$anchorCell.start(-1),r=t.cellsInRect({left:0,right:t.width,top:0,bottom:1}),o=t.cellsInRect(t.rectBetween(e.$anchorCell.pos-n,e.$headCell.pos-n));for(let i=0,s=r.length;i<s;i++)if(-1===o.indexOf(r[i]))return!1;return!0})(t))}}});var dx,px;(px=dx||(dx={})).Left="Left",px.Top="Top",px.Point="Point";const hx=({size:e,mixin:t,palette:n})=>{var r,o;return _v`
    display: inline-flex;
    cursor: pointer;
    z-index: 2;

    justify-content: space-evenly;

    position: absolute;

    border-radius: ${e.radius};

    ${null===(r=t.border)||void 0===r?void 0:r.call(t)};

    ${null===(o=t.shadow)||void 0===o?void 0:o.call(t)};

    overflow: hidden;
    background: ${n("surface")};

    .icon {
        position: relative;
        color: ${n("solid",.87)};

        width: 3rem;
        line-height: 3rem;
        text-align: center;
        transition: all 0.4s ease-in-out;
        &:hover {
            background-color: ${n("secondary",.12)};
        }
        &.active {
            color: ${n("primary")};
        }
        &:not(:last-child)::after {
            content: '';
            position: absolute;
            right: 0px;
            top: 0;
            width: ${e.lineWidth};
            bottom: 0;
            background: ${n("line")};
        }
    }
    &.hide,
    .hide {
        display: none;
    }
`};function mx(e,t,n,r=0){return To.widget(t.pos+1,(t=>{const o=document.createElement("div");return o.classList.add((e=>{switch(e){case dx.Left:return"milkdown-cell-left";case dx.Top:return"milkdown-cell-top";case dx.Point:default:return"milkdown-cell-point"}})(n)),n===dx.Point&&o.appendChild(e.get(Kv).slots.icon("select")),o.addEventListener("mousedown",(e=>{if(t)switch(e.preventDefault(),n){case dx.Point:return void t.dispatch(Uk(t.state.tr));case dx.Left:return void t.dispatch(Kk("row")(r)(t.state.tr));case dx.Top:return void t.dispatch(Kk("col")(r)(t.state.tr))}})),o}))}const vx=hg(((e,t)=>{const n=fx(t),r=document.createElement("div"),o=t.getStyle(hx);o&&r.classList.add(o),r.classList.add("table-tooltip","hide");return{id:"table-operator",plugin:new Zt({key:new tn("MILKDOWN_TABLE_OP"),props:{decorations:e=>{const n=[],r=(o=0,e=>{const t=Hk(e);if(!t)return;const n=Jy.get(t.node);return o<0||o>=n.width?void 0:n.cellsInRect({left:o,right:o+1,top:0,bottom:n.height}).map((e=>{const n=t.node.nodeAt(e);if(!n)throw new Error;const r=e+t.start;return{pos:r,start:r+1,node:n}}))})(e.selection);var o;if(!r)return null;const i=(s=0,e=>{const t=Hk(e);if(!t)return;const n=Jy.get(t.node);return s<0||s>=n.height?void 0:n.cellsInRect({left:0,right:n.width,top:s,bottom:s+1}).map((e=>{const n=t.node.nodeAt(e);if(!n)throw new Error;const r=e+t.start;return{pos:r,start:r+1,node:n}}))})(e.selection);var s;if(!i)return null;const[a]=r;return n.push(mx(t.ctx,a,dx.Point)),r.forEach(((e,r)=>{n.push(mx(t.ctx,e,dx.Left,r))})),i.forEach(((e,r)=>{n.push(mx(t.ctx,e,dx.Top,r))})),Io.create(e.doc,n)}},view:e=>{var t;Object.values(n).forEach((({$:e})=>r.appendChild(e))),null===(t=e.dom.parentNode)||void 0===t||t.appendChild(r);const o=t=>{e&&(t.stopPropagation(),t.preventDefault(),Object.values(n).forEach((({$:n,command:r})=>{n.contains(t.target)&&r(t,e)(e.state,e.dispatch,e)})))},i=()=>{r.classList.add("hide")};return r.addEventListener("mousedown",o),{update:(e,t)=>{const o=e.state;if((null==t?void 0:t.doc.eq(o.doc))&&t.selection.eq(o.selection))return;o.selection instanceof aw&&e.editable?(((e,t)=>{Object.values(e).forEach((e=>{var n;(null===(n=e.disable)||void 0===n?void 0:n.call(e,t))?e.$.classList.add("hide"):e.$.classList.remove("hide")}))})(n,e),Object.values(n).every((({$:e})=>e.classList.contains("hide")))?i():(r.classList.remove("hide"),((e,t)=>{const{selection:n}=e.state,r=n.isColSelection(),o=n.isRowSelection();gg(e,t,((e,t,n)=>{let i=o?e.left-n.left-t.width/2-8:e.left-n.left+(e.width-t.width)/2;return i<0&&(i=0),[e.top-n.top-t.height-(r?14:0)-14,i]}))})(e,r))):i()},destroy:()=>{r.removeEventListener("mousedown",o),r.remove()}}}})}})),gx=gh(qk),yx=mh((()=>[Hw({}),Xw()])),wx=ag.create([gx,yx,vx()]);ag.create([...wx,...ax]);const bx=mh(hi({rules:[new pi(/(https?:\/\/)?www\.[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-zA-Z]{2,}\b(?:[-a-zA-Z0-9@:%._+~#=?!&/]*)(?:[-a-zA-Z0-9@:%._+~#=?!&/]*)$/,((e,t,n,r)=>{const{schema:o}=e,[i]=t;return i?e.tr.replaceWith(n,r,o.text(i)).addMark(n,i.length+n,o.marks.link.create({href:i.startsWith("www")?`https://${i}`:i})):null}))]})),kx=Object.assign(Object.assign(Object.assign({},xg),Zk),{StrikeThrough:"StrikeThrough",TaskList:"TaskList"}),xx=wm(),Sx=dg(((e,t)=>{const n="strike_through",r=t.getStyle((e=>_v`
                text-decoration-color: ${e.palette("secondary")};
            `));return{id:n,schema:{parseDOM:[{tag:"del"},{style:"text-decoration",getAttrs:e=>"line-through"===e}],toDOM:e=>["del",{class:t.getClassName(e.attrs,"strike-through",r)}]},parser:{match:e=>"delete"===e.type,runner:(e,t,n)=>{e.openMark(n),e.next(t.children),e.closeMark(n)}},serializer:{match:e=>e.type.name===n,runner:(e,t)=>{e.withMark(t,"delete")}},inputRules:e=>[vg(/(?:~~)([^~]+)(?:~~)$/,e),vg(/(?:^|[^~])(~([^~]+)~)$/,e)],commands:e=>[gm(xx,(()=>ii(e)))],shortcuts:{[kx.StrikeThrough]:mg(xx,"Mod-Alt-x")}}})),Cx=wm(),Mx=wm(),Ox=wm(),Ax=wm(),Ex=pg(((e,t)=>{const n="task_list_item",r=t.getStyle((({palette:e,size:t})=>_v`
                list-style-type: none;
                position: relative;

                & > div {
                    overflow: hidden;
                    padding: 0 2px;
                }

                label {
                    position: absolute;
                    top: 0;
                    left: -2rem;
                    display: inline-block;
                    width: 1.5rem;
                    height: 1.5rem;
                    margin: 0.5rem 0;
                    input {
                        visibility: hidden;
                    }
                }
                label:before {
                    position: absolute;
                    top: 0;
                    right: 0;
                    bottom: 0;
                    left: 0;
                    border-radius: ${t.radius};
                }
                label:hover:before {
                    background: ${e("background")};
                }
                &[data-checked='true'] {
                    label {
                        color: ${e("primary")};
                    }
                }
                &[data-checked='false'] {
                    label {
                        color: ${e("solid",.87)};
                    }
                }
                .paragraph {
                    margin: 0.5rem 0;
                }
            `));return{id:n,schema:{group:"listItem",content:"paragraph block*",defining:!0,attrs:{checked:{default:!1}},parseDOM:[{tag:'li[data-type="task-list-item"]',getAttrs:e=>{if(!(e instanceof HTMLElement))throw new Error;return{checked:"true"===e.dataset.checked}}}],toDOM:e=>["li",{"data-type":"task-item","data-checked":e.attrs.checked?"true":"false",class:t.getClassName(e.attrs,"task-list-item",r)},0]},parser:{match:({type:e,checked:t})=>"listItem"===e&&null!==t,runner:(e,t,n)=>{e.openNode(n,{checked:t.checked}),e.next(t.children),e.closeNode()}},serializer:{match:e=>e.type.name===n,runner:(e,t)=>{e.openNode("listItem",void 0,{checked:t.attrs.checked}),e.next(t.content),e.closeNode()}},inputRules:e=>[vi(/^\s*(\[([ |x])\])\s$/,e,(e=>({checked:"x"===e[e.length-1]})))],commands:e=>[gm(Cx,(()=>ty(e))),gm(Mx,(()=>ry(e))),gm(Ox,(()=>ny(e))),gm(Ax,(()=>ri(e)))],shortcuts:{[kx.NextListItem]:mg(Cx,"Enter"),[kx.SinkListItem]:mg(Mx,"Mod-]"),[kx.LiftListItem]:mg(Ox,"Mod-["),[kx.TaskList]:mg(Ax,"Mod-Alt-9")},view:(o,i,s,a,c,l)=>{if(null==e?void 0:e.view)return e.view(o,i,s,a,c,l);const u=t.ctx.get(Kv).slots.icon,f=document.createElement("li"),d=document.createElement("label"),p=document.createElement("span"),h=document.createElement("input"),m=document.createElement("div");let v=u("unchecked");d.appendChild(v);const g=e=>{const t=u(e);d.replaceChild(t,v),v=t};d.contentEditable="false",h.type="checkbox";const y=e=>{const t=e.target;if(!(t instanceof HTMLInputElement))return;if(!a.editable)return void(h.checked=!h.checked);const{tr:n}=a.state;a.dispatch(n.setNodeMarkup(c(),void 0,{checked:t.checked}))};h.addEventListener("change",y),f.dataset.checked=s.attrs.checked,s.attrs.checked&&h.setAttribute("checked","checked"),d.append(h,p),f.append(d,m);const w={"data-type":"task-item","data-checked":s.attrs.checked?"true":"false",class:t.getClassName(s.attrs,"task-list-item",r)};return Object.entries(w).forEach((([e,t])=>{f.setAttribute(e,t)})),g(s.attrs.checked?"checked":"unchecked"),{dom:f,contentDOM:m,update:e=>e.type.name===n&&(f.dataset.checked=e.attrs.checked,e.attrs.checked?h.setAttribute("checked","checked"):h.removeAttribute("checked"),g(e.attrs.checked?"checked":"unchecked"),!0),destroy:()=>{h.removeEventListener("change",y)}}}}})),Tx=ag.create([...Ry,...ax,Sx(),Ex()]),Nx=ag.create([...wx,...$y,bx]),Dx=ag.create([...Tx,...Nx]);Object.assign(Object.assign({},Py),{ToggleStrikeThrough:xx,TurnIntoTaskList:Ax,SinkTaskListItem:Mx,LiftTaskListItem:Ox,SplitTaskListItem:Cx});const zx=({palette:e,size:t})=>({scrollbar:(t="y")=>_v`
        scrollbar-width: thin;
        scrollbar-color: ${e("secondary",.38)} ${e("secondary",.12)};
        -webkit-overflow-scrolling: touch;

        &::-webkit-scrollbar {
            ${"y"===t?"width":"height"}: 4px;
            padding: 0 2px;
            background: ${e("surface")};
        }

        &::-webkit-scrollbar-track {
            border-radius: 4px;
            background: ${e("secondary",.12)};
        }

        &::-webkit-scrollbar-thumb {
            border-radius: 4px;
            background: ${e("secondary",.38)};
        }

        &::-webkit-scrollbar-thumb:hover {
            background: ${e("secondary")};
        }
    `,shadow:()=>{const{lineWidth:n}=t;return _v`
            box-shadow: 0px ${n} ${n} ${e("shadow",.14)},
                0px 2px ${n} ${e("shadow",.12)}, 0px ${n} 3px ${e("shadow",.2)};
        `},border:n=>n?_v`
            ${`border-${n}`}: ${t.lineWidth} solid ${e("line")};
        `:_v`
                border: ${t.lineWidth} solid ${e("line")};
            `}),Ix="#2e3440",$x="#d8dee9",Rx="#eceff4",Fx={shadow:"#3b4252",primary:"#5e81ac",secondary:"#81a1c1",light:{neutral:Ix,solid:"#4c566a",line:$x,background:Rx,surface:"#fff"},dark:{neutral:Rx,solid:$x,line:"#434c5e",background:"#252932",surface:Ix}},Px=({palette:e,mixin:t,size:n,font:r})=>{var o,i;return _v`
    .milkdown {
        color: ${e("neutral",.87)};
        background: ${e("surface")};

        position: relative;
        font-family: ${r.typography};
        margin-left: auto;
        margin-right: auto;
        ${null===(o=t.shadow)||void 0===o?void 0:o.call(t)};
        padding: 3.125rem 1.25rem;
        box-sizing: border-box;

        .editor {
            outline: none;
            & > * {
                margin: 1.875rem 0;
            }
        }

        .ProseMirror-selectednode {
            outline: ${n.lineWidth} solid ${e("line")};
        }

        li.ProseMirror-selectednode {
            outline: none;
        }

        li.ProseMirror-selectednode::after {
            ${null===(i=t.border)||void 0===i?void 0:i.call(t)};
        }

        @media only screen and (min-width: 72rem) {
            max-width: 57.375rem;
            padding: 3.125rem 7.25rem;
        }

        & ::selection {
            background: ${e("secondary",.38)};
        }
    }
`},_x={h1:"looks_one",h2:"looks_two",h3:"looks_3",loading:"hourglass_empty",quote:"format_quote",code:"code",table:"table_chart",divider:"horizontal_rule",image:"image",brokenImage:"broken_image",bulletList:"format_list_bulleted",orderedList:"format_list_numbered",taskList:"checklist",bold:"format_bold",italic:"format_italic",inlineCode:"code",strikeThrough:"strikethrough_s",link:"link",leftArrow:"chevron_left",rightArrow:"chevron_right",upArrow:"expand_less",downArrow:"expand_more",alignLeft:"format_align_left",alignRight:"format_align_right",alignCenter:"format_align_center",delete:"delete",select:"select_all",unchecked:"check_box_outline_blank",checked:"check_box"},Bx=_v`
    /* copy from https://github.com/ProseMirror/prosemirror-view/blob/master/style/prosemirror.css */
    .ProseMirror {
        position: relative;
    }

    .ProseMirror {
        word-wrap: break-word;
        white-space: pre-wrap;
        white-space: break-spaces;
        -webkit-font-variant-ligatures: none;
        font-variant-ligatures: none;
        font-feature-settings: 'liga' 0; /* the above doesn't seem to work in Edge */
    }

    .ProseMirror pre {
        white-space: pre-wrap;
    }

    .ProseMirror li {
        position: relative;
    }

    .ProseMirror-hideselection *::selection {
        background: transparent;
    }
    .ProseMirror-hideselection *::-moz-selection {
        background: transparent;
    }
    .ProseMirror-hideselection {
        caret-color: transparent;
    }

    .ProseMirror-selectednode {
        outline: 2px solid #8cf;
    }

    /* Make sure li selections wrap around markers */

    li.ProseMirror-selectednode {
        outline: none;
    }

    li.ProseMirror-selectednode:after {
        content: '';
        position: absolute;
        left: -32px;
        right: -2px;
        top: -2px;
        bottom: -2px;
        border: 2px solid #8cf;
        pointer-events: none;
    }
`,jx={typography:["Roboto","HelveticaNeue-Light","Helvetica Neue Light","Helvetica Neue","Helvetica","Arial","Lucida Grande","sans-serif"],code:["Consolas","Monaco","Andale Mono","Ubuntu Mono","monospace"]},Lx={radius:"4px",lineWidth:"1px"};Uv({font:jx,size:Lx,color:Fx,mixin:zx,slots:()=>({icon:e=>{const t=document.createElement("span");return t.className="icon material-icons material-icons-outlined",t.textContent=_x[e],t}}),global:e=>{Pv`
            ${Bx};
            ${Px(e)}
        `}});const Vx={h1:"h1",h2:"h2",h3:"h3",loading:"loading",quote:"quote",code:"code",table:"table",divider:"line",image:"image",brokenImage:"image",bulletList:"unorder-list",orderedList:"order-list",taskList:"checklist",bold:"bold",italic:"italic",inlineCode:"code",strikeThrough:"text-delete",link:"link",leftArrow:"arrow-left",rightArrow:"arrow-right",upArrow:"arrow-up",downArrow:"arrow-down",alignLeft:"align-left",alignRight:"align-right",alignCenter:"align-center",delete:"delete",select:"select-all",unchecked:"unchecked",checked:"checked"};var Wx=Uv({font:jx,size:Lx,color:Fx,mixin:zx,slots:()=>({icon:e=>{const t=document.createElement("span");return t.className=`icon ed-icon icon-${Vx[e]}`,t}}),global:e=>{Pv`
          ${Bx};
          ${Px(e)}
      `}});const qx=e({props:{enableTooltip:{type:Boolean,default:!1},enableSlash:{type:Boolean,default:!1},enableHistory:{type:Boolean,default:!1},enablePrism:{type:Boolean,default:!1},markdown:{type:String,default:""},textColor:{type:String,default:"#494e59"},fontSize:{type:Number,default:16}},emits:["change"],setup(e,{expose:d,emit:p}){const h=e;t((t=>({"0b476070":e.textColor,"25098a16":f(m)})));const m=n((()=>g(h.textColor,50))),v=r(),y=r(!0);o((()=>{b()}));let w="";const b=async()=>{const e=ig.make().config((e=>{e.set(pm,v.value),e.set(em,h.markdown),e.set(_y,{markdown:[e=>{w=e(),p("change",w)}]})})).use(Wx).use(Fy).use(Dx).use(By);if(h.enableTooltip){const{tooltip:t}=await i((()=>import("./index.38e1f38f.js")),["assets/index.38e1f38f.js","assets/index.d598616c.js","assets/index.c4a3e30d.css","assets/node.a14d04b7.js","assets/color.556e4bcb.js"]);e.use(t)}if(h.enableSlash){const{slash:t}=await i((()=>import("./index.8aded7d2.js")),["assets/index.8aded7d2.js","assets/index.d598616c.js","assets/index.c4a3e30d.css","assets/color.556e4bcb.js"]);e.use(t)}if(h.enablePrism){const{prism:t}=await i((()=>import("./index.b66f9ff0.js")),["assets/index.b66f9ff0.js","assets/index.d598616c.js","assets/index.c4a3e30d.css","assets/node.a14d04b7.js","assets/color.556e4bcb.js"]);k(),e.use(t)}if(h.enableHistory){const{history:t}=await i((()=>import("./index.22dd76ba.js")),["assets/index.22dd76ba.js","assets/index.d598616c.js","assets/index.c4a3e30d.css","assets/color.556e4bcb.js"]);e.use(t)}e.create()},k=()=>{const e=document.querySelector("#prism-theme");if(e)return e;const t=document.createElement("link");t.id="prism-theme",t.setAttribute("rel","stylesheet"),t.setAttribute("href","https://unpkg.com/prism-themes/themes/prism-material-light.css"),document.head.appendChild(t)};return d({update:async()=>{y.value=!1,await u(),y.value=!0,await u(),b()}}),(t,n)=>y.value?(s(),a("div",{key:0,ref:(e,t)=>{t.editorRef=e,v.value=e},class:"milkdown-wrapper",style:c({width:"100%",height:"100%",fontSize:e.fontSize+"px"})},null,4)):l("",!0)}});const Hx={class:"wrapper"};var Jx=d(e({props:{componentSetting:{type:Object,required:!0},element:{type:Object,required:!0},isAction:{type:Boolean,default:!1}},setup(e){const t=e,o=p(),i=n((()=>o.state.isLock)),l=r();h((()=>t.componentSetting.enableTooltip),(()=>l.value.update())),h((()=>t.componentSetting.enableSlash),(()=>l.value.update())),h((()=>t.componentSetting.enablePrism),(()=>l.value.update())),h((()=>t.componentSetting.enableHistory),(()=>l.value.update()));const u=e=>{const n=JSON.parse(JSON.stringify(v(t.element)));t.isAction?(n.actionSetting.actionClickValue.componentSetting.markdown=e,o.commit("updateActionElement",n)):n.componentSetting.markdown=e,o.commit("editComponent",n)};return(t,n)=>(s(),a("div",Hx,[m(qx,{ref:(e,t)=>{t.milkdown=e,l.value=e},style:c({padding:e.componentSetting.padding+"px",fontFamily:e.componentSetting.fontFamily,pointerEvents:f(i)?"auto":"none"}),textColor:e.componentSetting.textColor,fontSize:e.componentSetting.textFontSize,enableTooltip:e.componentSetting.enableTooltip,enableSlash:e.componentSetting.enableSlash,enableHistory:e.componentSetting.enableHistory,enablePrism:e.componentSetting.enablePrism,markdown:e.componentSetting.markdown,onChange:u},null,8,["style","textColor","fontSize","enableTooltip","enableSlash","enableHistory","enablePrism","markdown"])]))}}),[["__scopeId","data-v-e1828862"]]),Kx=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:Jx});export{ag as A,mh as B,tt as C,Io as D,Di as E,Kx as F,Zg as I,Eg as M,tn as P,Rt as T,Fg as W,ym as a,Xg as b,wm as c,kg as d,Ng as e,bg as f,Mg as g,xx as h,Sg as i,Ag as j,yg as k,_v as l,hg as m,Zt as n,Kg as o,cy as p,Ax as q,$g as r,Sh as s,Kv as t,nx as u,jg as v,Gg as w,To as x,gg as y,ml as z};
