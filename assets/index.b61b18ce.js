import{_ as R,d as T,u as D,G as E,H as N,I as j,a as q,x as J,y as Z,r as _,o as c,h as g,e as n,F,j as H,A as C,C as f,t as y,L as A,g as v,f as P,b as B,N as I,P as W,O as V,k as G,W as Q,n as X,p as Y,s as x,v as ee}from"./index.824ed447.js";import{a as U,b as te}from"./images.45bfa74c.js";const b={tab:{span:1},Q:{keyCode:81},W:{keyCode:87},E:{keyCode:69},R:{keyCode:82},T:{keyCode:84},Y:{keyCode:89},U:{keyCode:85},I:{keyCode:73},O:{keyCode:79},P:{keyCode:80},brackets:{span:1},caps:{span:2},A:{keyCode:65},S:{keyCode:83},D:{keyCode:68},F:{keyCode:70},G:{keyCode:71},H:{keyCode:72},J:{keyCode:74},K:{keyCode:75},L:{keyCode:76},semi:{span:2},shift:{span:3},Z:{keyCode:90},X:{keyCode:88},C:{keyCode:67},V:{keyCode:86},B:{keyCode:66},N:{keyCode:78},M:{keyCode:77}};const ne=T({name:"Collection",props:{componentSetting:{type:Object,required:!0},element:{type:Object,required:!0},isAction:{type:Boolean,default:!1}},setup(e){const s=D(),r=E(()=>e.componentSetting.userSettingKeyMap||{}),w=E(()=>N(e.componentSetting.position)),{t:S}=j(),t=q({editingActive:!1,editingInfo:{key:"",url:"",remark:""}}),k=a=>{if(!e.componentSetting.useKeyboardEvent||!s.isLock||document.querySelector("input:focus")||document.querySelector("textarea:focus")||document.querySelector(".ProseMirror-focused")||document.querySelector(".action-popover"))return;const o=a.keyCode,u=Object.keys(b).find(m=>b[m].keyCode===o);u&&r.value[u]&&K(r.value[u].url)};J(()=>{document.addEventListener("keydown",k)}),Z(()=>{document.removeEventListener("keydown",k)});const i=_(!1),d=(a,o)=>{o&&r.value[o]?K(r.value[o].url):(i.value=!0,t.editingInfo.key=o,setTimeout(()=>{t.editingActive=!0},200))},l=()=>{t.editingInfo.key="",t.editingInfo.url="",t.editingInfo.remark="",t.editingActive=!1},L=(a,o)=>{i.value=!0,t.editingInfo.key=o;const{url:u,remark:m}=r.value[o];t.editingInfo.url=u,t.editingInfo.remark=m,setTimeout(()=>{t.editingActive=!0},200)},O=()=>{if(t.editingInfo.url&&t.editingInfo.remark&&confirm(S("\u786E\u5B9A\u6E05\u9664\u8BE5\u6309\u952E\u7ED1\u5B9A\u7684\u7F51\u9875\u5417?"))){t.editingInfo.url="",t.editingInfo.remark="";const a=G(r);delete a[t.editingInfo.key],M(a),l(),i.value=!1}},h=_(!1),$=async()=>{if(!(!t.editingInfo.url||!t.editingInfo.remark))if(/[-A-Za-z0-9+&@#/%?=~_|!:,.;]+[-A-Za-z0-9+&@#/%=~_|]/.test(t.editingInfo.url)){/https?:\/\/[-A-Za-z0-9+&@#/%?=~_|!:,.;]+[-A-Za-z0-9+&@#/%=~_|]/.test(t.editingInfo.url)||(t.editingInfo.url="https://"+t.editingInfo.url),h.value=!0;let[a,o]=await Q(te(U(t.editingInfo.url)));a&&(o=`${new URL(t.editingInfo.url).origin}/favicon.ico`);const u=JSON.parse(JSON.stringify(r.value));u[t.editingInfo.key]={url:t.editingInfo.url,remark:t.editingInfo.remark,icon:o},M(u),setTimeout(()=>{l(),h.value=!1,i.value=!1},400)}else window.alert(S("URL\u5730\u5740\u4E0D\u6B63\u786E"))},z=a=>{const o=a.currentTarget;o.style.visibility="hidden",o.nextElementSibling.style.visibility="inherit"},M=a=>{const o=JSON.parse(JSON.stringify(X(e.element)));e.isAction?(o.actionSetting.actionClickValue.componentSetting.userSettingKeyMap=a,s.updateActionElement(o)):o.componentSetting.userSettingKeyMap=a,s.editComponent(o)},K=a=>{e.componentSetting.jumpType===2?window.location.href=a:window.open(a)};return{keyboardMap:b,userSettingKeyMap:r,handleKeyClick:d,handleDialogClose:l,showDialog:L,editState:t,clearEidtInfo:O,handleImgError:z,handleUserKeySave:$,saveLoading:h,dialogVisible:i,positionCSS:w,getTargetIconV2:U}}}),p=e=>(x("data-v-db1d19c0"),e=e(),ee(),e),oe=["onClick"],ie={class:"keys"},se={class:"keys-name"},ae=["onClick"],de=p(()=>n("svg",{class:"icon",viewBox:"0 0 1024 1024",width:"14",height:"14"},[n("path",{d:"M231.08266667 509.49688889c-0.11377778 51.76888889-41.87022222 93.52533333-93.75288889 93.41155556-51.65511111-0.11377778-93.63911111-42.09777778-93.52533333-93.86666667 0-51.54133333 42.21155555-93.52533333 93.98044444-93.41155556 51.65511111 0.11377778 93.29777778 41.984 93.29777778 93.86666667z m656.49777778-93.75288889c51.76888889 0 93.86666667 41.87022222 93.86666666 93.52533333 0.11377778 51.65511111-41.87022222 93.75288889-93.63911111 93.75288889-51.88266667 0-93.75288889-41.64266667-93.75288889-93.52533333s41.64266667-93.75288889 93.52533334-93.75288889zM512.45511111 603.02222222c-51.65511111 0-93.98044445-42.43911111-93.75288889-93.75288889 0.34133333-51.76888889 42.21155555-93.52533333 93.98044445-93.52533333 51.65511111 0 93.86666667 42.21155555 93.63911111 93.75288889-0.11377778 51.65511111-42.09777778 93.52533333-93.86666667 93.52533333z"})],-1)),re=[de],le={key:1,class:"plus-box"},ue=p(()=>n("svg",{class:"icon",viewBox:"0 0 1024 1024",width:"20",height:"20"},[n("path",{d:"M896 469.333333H554.666667V128a42.666667 42.666667 0 0 0-85.333334 0v341.333333H128a42.666667 42.666667 0 0 0 0 85.333334h341.333333v341.333333a42.666667 42.666667 0 0 0 85.333334 0V554.666667h341.333333a42.666667 42.666667 0 0 0 0-85.333334z"})],-1)),ce=[ue],ge={key:2,class:"icon-box"},pe=["src"],ye={class:"no-icon",style:{visibility:"hidden"}},fe={key:3,class:"mark-text"},ke={class:"keys-wrapper",style:{width:"9.08%"}},me=p(()=>n("div",{class:"keys"},null,-1)),ve=[me],Se={class:"editing-key"},he=p(()=>n("div",{class:"label"},"URL",-1)),Ce=p(()=>n("div",{class:"line"},null,-1)),Ie=p(()=>n("div",{class:"label"},"Remark",-1)),be=p(()=>n("div",{class:"line"},null,-1)),we={class:"footer",style:{"text-align":"right",padding:"12px"}},Me=["disabled"],Ke=["loading"];function Ee(e,s,r,w,S,t){const k=Y("easy-dialog");return c(),g("div",{class:"wrapper",style:f({...e.positionCSS})},[n("div",{class:"keyboard-mode",style:f({maxWidth:e.componentSetting.keyboardMaxWidth+"px"})},[(c(!0),g(F,null,H(e.keyboardMap,(i,d)=>(c(),g("div",{class:C(["keys-wrapper",{hidden:i.span}]),key:d,style:f({width:`${i.span?i.span*4.5:9}%`,padding:`${e.componentSetting.keyGutter}px`})},[n("div",{class:"keys-box",onClick:l=>e.handleKeyClick(l,d),style:f({background:e.componentSetting.keyBackground,borderRadius:e.componentSetting.keyBorderRadius})},[n("div",ie,[n("div",se,y(d),1),e.userSettingKeyMap[d]?(c(),g("div",{key:0,class:"edit-icon-box",onClick:A(l=>e.showDialog(l,d),["stop"])},re,8,ae)):v("",!0),e.userSettingKeyMap[d]?v("",!0):(c(),g("div",le,ce)),e.userSettingKeyMap[d]?(c(),g("div",ge,[n("img",{class:"icon",src:e.userSettingKeyMap[d].icon||e.getTargetIconV2(e.userSettingKeyMap[d].url),alt:"link",onError:s[0]||(s[0]=(...l)=>e.handleImgError&&e.handleImgError(...l))},null,40,pe),n("div",ye,y(e.userSettingKeyMap[d].remark.slice(0,1)),1)])):v("",!0),e.userSettingKeyMap[d]&&e.userSettingKeyMap[d].remark?(c(),g("div",fe,y(e.userSettingKeyMap[d].remark),1)):v("",!0)])],12,oe)],6))),128)),n("div",ke,[n("div",{class:"keys-box",style:f({background:e.componentSetting.keyBackground,borderRadius:e.componentSetting.keyBorderRadius})},ve,4)])],4),P(k,{modelValue:e.dialogVisible,"onUpdate:modelValue":s[6]||(s[6]=i=>e.dialogVisible=i),width:"300px",height:"330px",closeOnClickOutside:"",onClose:e.handleDialogClose},{footer:B(()=>[n("div",we,[n("button",{type:"button",class:"btn",disabled:!e.editState.editingInfo.url&&!e.editState.editingInfo.remark,onClick:s[4]||(s[4]=(...i)=>e.clearEidtInfo&&e.clearEidtInfo(...i))},y(e.$t("\u6E05\u7A7A")),9,Me),n("button",{type:"button",class:"btn btn-primary",loading:e.saveLoading,onClick:s[5]||(s[5]=(...i)=>e.handleUserKeySave&&e.handleUserKeySave(...i))},y(e.$t("\u786E\u8BA4")),9,Ke)])]),default:B(()=>[I(n("div",{class:"edit-content",onKeydown:s[3]||(s[3]=A(()=>{},["stop"]))},[n("div",Se,y(e.editState.editingInfo.key),1),n("div",{class:C(["row-input",{active:e.editState.editingInfo.url.length>0}])},[I(n("input",{type:"text","onUpdate:modelValue":s[1]||(s[1]=i=>e.editState.editingInfo.url=i)},null,512),[[V,e.editState.editingInfo.url]]),he,Ce],2),n("div",{class:C(["row-input",{active:e.editState.editingInfo.remark.length>0}])},[I(n("input",{type:"text","onUpdate:modelValue":s[2]||(s[2]=i=>e.editState.editingInfo.remark=i)},null,512),[[V,e.editState.editingInfo.remark]]),Ie,be],2)],544),[[W,e.editState.editingActive]])]),_:1},8,["modelValue","onClose"])],4)}var Be=R(ne,[["render",Ee],["__scopeId","data-v-db1d19c0"]]);export{Be as default};
