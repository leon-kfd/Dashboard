import{_ as $,d as R,I as B,r,x as E,R as u,b as L,o,i,f as l,t as V,g as S,e as I,F as m,k as b,h,K as N,s as j,v as A}from"./index.84fadd0e.js";const D=c=>(j("data-v-050265e8"),c=c(),A(),c),U={class:"tips"},F={key:0,class:"video-wrapper"},O=["onClick"],z={class:"img-wrapper"},K=["src"],M={key:1,class:"loading-wrapper"},Q=D(()=>l("div",{class:"custom-loading"},[l("span",{class:"loader"})],-1)),T=[Q],W=R({__name:"RecommendVideo",emits:["submit"],setup(c,{emit:f}){const{t:g}=B(),p=r(!1),d=r(!1),v=r(!1),y=r([]);E(async()=>{const n=await(await fetch(`${u}/staticVideos`)).json(),e=await(await fetch(`${u}/pixabayVideos`)).json();y.value=[...n.data.list.map(t=>(t.source="static",t)),...e.data.list.map(t=>(t.source="pixabay",t))]});const w=()=>{d.value=!0,p.value||(p.value=!0)},k=async a=>{try{if(v.value=!0,a.source==="pixabay"){const s=await(await fetch(`${u}/tapi/pixabay/videos/?id=${a.id}`)).json();if((s==null?void 0:s.hits)&&s.hits.length){const e=s.hits[0];let _=Object.values(e.videos).find(C=>C.width===1920);_||(_=e.videos.large);const x=_.url;f("submit",x),d.value=!1}else throw new Error("Something error")}else if(a.source==="static"){const s=await(await fetch(`${u}/getQiNiuWallpaperURL?fileName=${a.filename}`)).json();if(s.url)f("submit",s.url),d.value=!1;else throw new Error("Something error")}}catch{N({title:g("\u9519\u8BEF"),type:"error",message:g("\u83B7\u53D6\u52A8\u6001\u58C1\u7EB8URL\u5931\u8D25")})}finally{v.value=!1}};return(a,n)=>{const s=L("easy-dialog");return o(),i(m,null,[l("button",{type:"button",class:"btn btn-small btn-primary",style:{margin:"0","margin-right":"5px"},onClick:w},V(a.$t("\u52A8\u6001\u58C1\u7EB8\u63A8\u8350")),1),S(s,{modelValue:d.value,"onUpdate:modelValue":n[0]||(n[0]=e=>d.value=e),title:a.$t("\u52A8\u6001\u58C1\u7EB8\u63A8\u8350"),width:"min(760px, 94vw)",height:"min(480px, 80vh)"},{default:I(()=>[l("div",U,V(a.$t("recommendVideoTips")),1),p.value?(o(),i("div",F,[(o(!0),i(m,null,b(y.value,e=>(o(),i("div",{class:"video",key:e.img,onClick:t=>k(e)},[l("div",z,[e.img?(o(),i("img",{key:0,src:e.img,loading:"lazy"},null,8,K)):h("",!0)])],8,O))),128)),(o(),i(m,null,b(4,e=>l("div",{class:"video-fake",key:e})),64))])):h("",!0),v.value?(o(),i("div",M,T)):h("",!0)]),_:1},8,["modelValue","title"])],64)}}});var G=$(W,[["__scopeId","data-v-050265e8"]]);export{G as default};
